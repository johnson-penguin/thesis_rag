![](media/image1.jpeg){width="1.6979166666666667in"
height="0.8645833333333334in"}

Contents {#contents .TT}
========

[9](#foreword)

[10](#scope)

[10](#references)

[10](#definitions-symbols-and-abbreviations)

[10](#definitions)

[12](#symbols)

[13](#abbreviations)

[14](#multiplexing-channel-coding-and-interleaving)

[14](#general)

[14](#general-codingmultiplexing-of-trchs)

[19](#transport-channel-concatenation)

[19](#crc-attachment)

[19](#crc-calculation)

[20](#relation-between-input-and-output-of-the-crc-attachment-block)

[20](#transport-block-concatenation-and-code-block-segmentation)

[20](#concatenation-of-transport-blocks)

[20](#code-block-segmentation)

[21](#channel-coding)

[22](#convolutional-coding)

[23](#turbo-coding)

[23](#turbo-coder)

[23](#trellis-termination-for-turbo-coder)

[24](#turbo-code-internal-interleaver)

[27](#concatenation-of-encoded-blocks)

[27](#radio-frame-size-equalisation)

[28](#st-interleaving)

[28](#void)

[28](#st-interleaver-operation)

[29](#relation-between-input-and-output-of-1st-interleaving-in-uplink)

[29](#relation-between-input-and-output-of-1st-interleaving-in-downlink)

[29](#radio-frame-segmentation)

[30](#relation-between-input-and-output-of-the-radio-frame-segmentation-block-in-uplink)

[30](#relation-between-input-and-output-of-the-radio-frame-segmentation-block-in-downlink)

[30](#rate-matching)

[32](#determination-of-rate-matching-parameters-in-uplink)

[32](#determination-of-sf-and-number-of-phchs-needed)

[35](#determination-of-rate-matching-parameters-in-downlink)

[35](#determination-of-rate-matching-parameters-for-fixed-positions-of-trchs)

[37](#a-determination-of-rate-matching-parameters-for-pseudo-flexible-positions-of-trchs)

[37](#determination-of-rate-matching-parameters-for-flexible-positions-of-trchs)

[39](#bit-separation-and-collection-in-uplink)

[41](#bit-separation)

[41](#bit-collection)

[42](#bit-separation-and-collection-in-downlink)

[43](#bit-separation-1)

[43](#bit-collection-1)

[44](#rate-matching-pattern-determination)

[45](#trch-multiplexing)

[45](#insertion-of-discontinuous-transmission-dtx-indication-bits)

[45](#st-insertion-of-dtx-indication-bits)

[46](#nd-insertion-of-dtx-indication-bits)

[47](#physical-channel-segmentation)

[47](#relation-between-input-and-output-of-the-physical-segmentation-block-in-uplink)

[47](#relation-between-input-and-output-of-the-physical-segmentation-block-in-downlink)

[47](#nd-interleaving)

[48](#nd-interleaving-for-secondary-ccpch-with-16qam)

[49](#physical-channel-mapping)

[49](#uplink)

[49](#ul_dpch_10ms_mode-is-not-configured-by-higher-layers-or-no-compressed-mode-transmission-gap-overlaps-with-the-first-radio-frame-in-the-20ms-ci)

[49](#ul_dpch_10ms_mode-is-configured-by-higher-layers-and-a-compressed-mode-transmission-gap-overlaps-with-the-first-radio-frame-in-20ms-ci)

[50](#downlink)

[50](#restrictions-on-different-types-of-cctrchs)

[50](#uplink-dedicated-channel-dch)

[51](#random-access-channel-rach)

[51](#void-2)

[51](#downlink-dedicated-channel-dch)

[51](#void-3)

[51](#broadcast-channel-bch)

[51](#forward-access-and-paging-channels-fach-and-pch)

[51](#high-speed-downlink-shared-channel-hs-dsch-associated-with-a-dch)

[52](#enhanced-dedicated-channel-e-dch)

[52](#multiplexing-of-different-transport-channels-into-one-cctrch-and-mapping-of-one-cctrch-onto-physical-channels)

[53](#allowed-cctrch-combinations-for-one-ue)

[53](#allowed-cctrch-combinations-on-the-uplink)

[53](#allowed-cctrch-combinations-on-the-downlink)

[53](#transport-format-detection)

[54](#blind-transport-format-detection)

[54](#a-single-transport-format-detection)

[54](#transport-format-detection-based-on-tfci)

[55](#coding-of-transport-format-combination-indicator-tfci)

[56](#void-4)

[56](#mapping-of-tfci-words)

[56](#mapping-of-tfci-word-in-normal-mode-in-downlink-and-in-uplink-when-uplink-dpcch-slot-format-is-not-5)

[56](#a-mapping-of-tfci-word-in-normal-mode-in-uplink-when-uplink-dpcch-slot-format-is-5)

[56](#mapping-of-tfci-bits-for-secondary-ccpch-with-16qam)

[56](#mapping-of-tfci-word-in-compressed-mode)

[57](#uplink-compressed-mode)

[57](#downlink-compressed-mode)

[58](#a-mapping-of-dl-fet-acknack-bits)

[59](#compressed-mode)

[59](#frame-structure-in-the-uplink)

[59](#frame-structure-types-in-the-downlink)

[60](#a-frame-structure-in-the-downlink-for-f-dpch)

[60](#b-frame-structure-in-the-downlink-for-f-tpich)

[60](#transmission-time-reduction-method)

[60](#void-5)

[60](#compressed-mode-by-reducing-the-spreading-factor-by-2)

[60](#compressed-mode-by-higher-layer-scheduling)

[61](#transmission-gap-position)

[62](#transmission-gap-position-for-edch)

[62](#edpdch-transmission-gap-position-during-initial-transmissions)

[63](#edpdch-transmission-gap-position-during-retransmissions)

[63](#edpcch-transmission-gap-position)

[63](#coding-for-hs-dsch)

[64](#crc-attachment-for-hs-dsch)

[64](#crc-attachment-method-1-for-hs-dsch)

[65](#crc-attachment-method-2-for-hs-dsch)

[65](#a-bit-scrambling-for-hs-dsch)

[65](#code-block-segmentation-for-hs-dsch)

[66](#channel-coding-for-hs-dsch)

[66](#hybrid-arq-for-hs-dsch)

[66](#harq-bit-separation)

[66](#harq-first-rate-matching-stage)

[67](#harq-second-rate-matching-stage)

[68](#harq-bit-collection)

[68](#physical-channel-segmentation-for-hs-dsch)

[69](#interleaving-for-hs-dsch)

[69](#constellation-re-arrangement-for-16-qam-and-64qam)

[70](#physical-channel-mapping-for-hs-dsch)

[70](#coding-for-hs-scch-type-1)

[70](#overview)

[72](#hs-scch-information-field-mapping)

[72](#redundancy-and-constellation-version-coding)

[73](#modulation-scheme-mapping)

[73](#channelization-code-set-mapping)

[74](#ue-identity-mapping)

[74](#harq-process-identifier-mapping)

[74](#transport-block-size-index-mapping)

[74](#multiplexing-of-hs-scch-information)

[74](#crc-attachment-for-hs-scch)

[75](#channel-coding-for-hs-scch)

[75](#rate-matching-for-hs-scch)

[75](#ue-specific-masking-for-hs-scch)

[75](#physical-channel-mapping-for-hs-scch)

[75](#a-coding-for-hs-scch-type-2)

[75](#a.1-overview)

[76](#a.2-hs-scch-type-2-information-field-mapping)

[76](#a.2.1-the-first-transmission)

[77](#a.2.2-the-second-and-the-third-transmissions)

[77](#a.2.2.1-special-information-mapping)

[77](#a.2.2.1.1-transport-block-size-information-mapping)

[77](#a.2.2.1.2-pointer-to-the-previous-transmission-mapping)

[77](#a.2.2.1.3-second-or-third-transmission-mapping)

[78](#a.2.2.2-redundancy-and-constellation-version-mapping)

[78](#a.2.2.3-modulation-scheme-mapping)

[78](#a.2.2.4-channelization-code-set-mapping)

[78](#a.2.2.5-ue-identity-mapping)

[78](#a.3-multiplexing-of-hs-scch-type-2-information)

[78](#a.4-crc-attachment-for-hs-scch-type-2)

[78](#a.5-channel-coding-for-hs-scch-type-2)

[78](#a.6-rate-matching-for-hs-scch-type-2)

[78](#a.7-ue-specific-masking-for-hs-scch-type-2)

[78](#a.8-physical-channel-mapping-for-hs-scch-type-2)

[79](#b-coding-for-hs-scch-type-3)

[79](#b.1-overview)

[80](#b.2-hs-scch-type-3-information-field-mapping)

[80](#b.2.1-redundancy-and-constellation-version-coding)

[81](#b.2.2-modulation-scheme-and-number-of-transport-blocks-mapping)

[81](#b.2.3-channelization-code-set-mapping)

[82](#b.2.4-ue-identity-mapping)

[82](#b.2.5-harq-process-identifier-mapping)

[82](#b.2.6-transport-block-size-index-mapping)

[82](#b.2.7-precoding-weight-information-mapping)

[83](#b.3-multiplexing-of-hs-scch-type-3-information)

[83](#b.4-crc-attachment-for-hs-scch-type-3)

[84](#b.5-channel-coding-for-hs-scch-type-3)

[84](#b.6-rate-matching-for-hs-scch-type-3)

[84](#b.7-ue-specific-masking-for-hs-scch-type-3)

[84](#b.8-physical-channel-mapping-for-hs-scch-type-3)

[85](#c-coding-for-hs-scch-orders)

[85](#c.1-overview)

[85](#c.2-hs-scch-order-information-field-mapping-in-the-cell_dch-state)

[85](#c.2.1-order-type-mapping)

[85](#c.2.2-order-mapping)

[85](#c.2.2.1-orders-for-activation-and-deactivation-of-dtx-drx-and-hs-scch-less-operation-and-for-hs-dsch-serving-cell-change)

[86](#c.2.2.2-orders-for-activation-and-deactivation-of-secondary-serving-hs-dsch-cells-and-secondary-uplink-frequency)

[93](#c.2.2.3-orders-for-switching-between-uplink-closed-loop-transmit-diversity-activation-states)

[93](#c.2.2.4-orders-for-activating-and-de-activating-demodulation-common-pilots-d-cpich-when-the-ue-is-configured-in-mimo-mode-with-four-transmit-antennas)

[94](#c.2.2.5-orders-for-switching-the-e-dch-tti-and-for-startstop-a-simplified-hs-scch-type-1-transmission-interval)

[95](#c.2.3-ue-identity-mapping)

[95](#c.3-hs-scch-order-information-field-mapping-in-the-cell_fach-and-cell_pch-states)

[95](#c.3.1-order-type-mapping)

[95](#c.3.2-order-mapping)

[95](#c.3.2.1-orders-for-network-triggered-hs-dpcch-transmission)

[95](#c.3.2.2-orders-for-hs-dsch-reception-during-cell_fach-hs-scch-drx-operation)

[95](#d-coding-for-hs-scch-type-4)

[95](#d.1-overview)

[96](#d.2-hs-scch-type-4-information-field-mapping)

[96](#d.2.1-redundancy-and-constellation-version-coding)

[97](#d.2.2-modulation-scheme-and-number-of-transport-blocks-mapping)

[98](#d.2.3-channelization-code-set-mapping)

[99](#d.2.4-ue-identity-mapping)

[99](#d.2.5-harq-process-identifier-mapping)

[99](#d.2.6-transport-block-size-index-mapping)

[100](#d.2.7-precoding-weight-information-mapping)

[101](#d.3-multiplexing-of-hs-scch-type-4-information)

[102](#d.4-crc-attachment-for-hs-scch-type-4)

[102](#d.5-channel-coding-for-hs-scch-type-4)

[102](#d.6-rate-matching-for-hs-scch-type-4)

[103](#d.7-ue-specific-masking-for-hs-scch-type-4)

[103](#d.8-physical-channel-mapping-for-hs-scch-type-4)

[103](#coding-for-hs-dpcch)

[103](#overview-1)

[108](#channel-coding-for-hs-dpcch-when-the-ue-is-not-configured-in-mimo-mode-and-not-configured-in-mimo-mode-with-four-transmit-antennas-in-the-serving-hs-dsch-cell-and-secondary_cell_enabled-is-0-or-1-and-secondary_cell_active-is-0)

[108](#channel-coding-for-hs-dpcch-harq-ack)

[108](#channel-coding-for-hs-dpcch-channel-quality-indication)

[109](#channel-coding-for-hs-dpcch-when-the-ue-is-configured-in-mimo-mode-in-the-serving-hs-dsch-cell-and-secondary_cell_enabled-is-0)

[109](#channel-coding-for-hs-dpcch-harq-ack-1)

[110](#channel-coding-for-hs-dpcch-composite-precoding-control-indication-and-channel-quality-indication)

[110](#bit-mapping-of-type-a-channel-quality-indication)

[110](#bit-mapping-of-type-b-channel-quality-indication)

[110](#bit-mapping-of-precoding-control-indication)

[110](#composite-precoding-control-indication-and-channel-quality-indication-bits)

[111](#block-encoding-of-composite-precoding-control-indication-and-channel-quality-indication-bits)

[112](#a-channel-coding-for-hs-dpcch-when-the-ue-is-not-configured-in-mimo-mode-in-any-cell-and-secondary_cell_enabled-is-1-and-secondary_cell_active-is-1)

[112](#a.1-channel-coding-for-the-composite-hs-dpcch-harq-ack)

[113](#a.2-channel-coding-for-hs-dpcch-composite-channel-quality-indication)

[113](#a.2.1-composite-channel-quality-indication-bits)

[114](#a.2.2-block-encoding-of-composite-channel-quality-indication-bits)

[114](#b-channel-coding-for-hs-dpcch-when-secondary_cell_enabled-is-at-least-3-or-when-the-ue-is-configured-in-mimo-mode-in-at-least-one-cell-and-secondary_cell_enabled-is-greater-than-0)

[114](#b.1-channel-coding-for-the-composite-hs-dpcch-harq-ack)

[116](#b.2-channel-coding-for-hs-dpcch-composite-precoding-control-indication-and-channel-quality-indication)

[116](#c-channel-coding-for-hs-dpcch-when-the-ue-is-not-configured-in-mimo-mode-in-any-cell-and-secondary_cell_enabled-is-2)

[116](#c.1-channel-coding-for-the-composite-hs-dpcch-harq-ack)

[117](#c.2-channel-coding-for-hs-dpcch-channel-quality-indication)

[117](#d-channel-coding-for-hs-dpcch-when-the-ue-is-configured-in-multiflow-mode)

[117](#d.1-channel-coding-for-the-composite-hs-dpcch-harq-ack)

[118](#d.2-channel-coding-for-hs-dpcch-channel-quality-indication)

[118](#e-channel-coding-for-hs-dpcch-when-the-ue-is-configured-in-mimo-mode-with-4-transmit-antennas)

[118](#e.1-channel-coding-for-hs-dpcch-when-the-ue-is-configured-in-mimo-mode-with-four-transmit-antennas-and-secondary_cell_enabled-is-0)

[118](#e.1.1-channel-coding-for-hs-dpcch-harq-ack)

[120](#e.1.2-channel-coding-for-hs-dpcch-composite-number-of-transport-blocks-preferred-precoding-control-indication-and-channel-quality-indication)

[122](#e.2-channel-coding-for-hs-dpcch-when-the-ue-is-configured-in-mimo-mode-with-four-transmit-antennas-in-any-cell-and-secondary_cell_enabled-is-1)

[122](#e.2.1-channel-coding-for-the-composite-hs-dpcch-harq-ack)

[123](#e.2.2-channel-coding-for-hs-dpcch-composite-number-of-transport-blocks-preferred-precoding-control-indication-and-channel-quality-indication)

[123](#e.3-channel-coding-for-hs-dpcch-when-the-ue-is-configured-in-mimo-mode-with-four-transmit-antennas-in-any-cell-and-secondary_cell_enabled-is-2)

[123](#e.3.1-channel-coding-for-the-composite-hs-dpcch-harq-ack)

[123](#e.3.2-channel-coding-for-hs-dpcch-composite-number-of-transport-blocks-preferred-precoding-control-indication-and-channel-quality-indication)

[123](#e.4-channel-coding-for-hs-dpcch-when-the-ue-is-configured-in-mimo-mode-with-four-transmit-antennas-in-any-cell-and-secondary_cell_enabled-is-3)

[124](#e.4.1-channel-coding-for-the-composite-hs-dpcch-harq-ack)

[124](#e.4.2-channel-coding-for-hs-dpcch-composite-number-of-transport-blocks-preferred-precoding-control-indication-and-channel-quality-indication)

[124](#physical-channel-mapping-for-hs-dpcch)

[124](#physical-channel-mapping-for-hs-dpcch-harq-ack)

[127](#physical-channel-mapping-for-hs-dpcch-pcicqi)

[132](#physical-channel-mapping-for-hs-dpcch-harq-ack-and-pcicqi-when-the-ue-is-configured-in-multiflow-mode)

[132](#physical-channel-mapping-for-hs-dpcch-harq-ack-and-pcicqi-when-the-ue-is-configured-with-one-serving-and-one-assisting-serving-hs-dsch-cell)

[133](#physical-channel-mapping-for-hs-dpcch-harq-ack-and-pcicqi-when-the-ue-is-configured-with-two-serving-and-one-assisting-serving-or-one-serving-and-two-assisting-serving-hs-dsch-cells)

[135](#physical-channel-mapping-for-hs-dpcch-harq-ack-and-pcicqi-when-the-ue-is-configured-with-two-serving-and-two-assisting-serving-hs-dsch-cells)

[135](#physical-channel-mapping-for-hs-dpcch-harq-ack-and-pcicqi-when-the-ue-is-configured-with-three-serving-and-one-assisting-serving-hs-dsch-cells-or-one-serving-and-three-assisting-serving-hs-dsch-cells)

[137](#physical-channel-mapping-for-hs-dpcch-when-the-ue-is-configured-in-mimo-mode-with-four-transmit-antennas-in-at-least-one-cell)

[137](#physical-channel-mapping-for-hs-dpcch-harq-ack-1)

[138](#physical-channel-mapping-for-hs-dpcch-ntbppcicqi)

[140](#coding-for-edch)

[142](#crc-attachment-for-e-dch)

[142](#code-block-segmentation-for-e-dch)

[142](#channel-coding-for-e-dch)

[142](#physical-layer-harq-functionality-and-rate-matching-for-e-dch)

[142](#determination-of-sf-modulation-scheme-and-number-of-e-dpdch-phchs-needed)

[144](#a-determination-of-sf-modulation-scheme-and-number-of-s-e-dpdch-phchs-needed)

[145](#harq-bit-separation-1)

[145](#harq-rate-matching-stage)

[146](#harq-bit-collection-1)

[146](#physical-channel-segmentation-for-edch)

[146](#interleaving-for-edch)

[147](#physical-channel-mapping-for-edch)

[147](#coding-for-edpcch)

[148](#overview-2)

[148](#edpcch-information-field-mapping)

[148](#information-field-mapping-of-etfci)

[148](#information-field-mapping-of-retransmission-sequence-number)

[149](#information-field-mapping-of-the-happy-bit)

[149](#multiplexing-of-edpcch-information)

[149](#channel-coding-for-edpcch)

[149](#physical-channel-mapping-for-edpcch)

[150](#a-coding-for-s-edpcch)

[150](#a.1-overview-1)

[150](#a.2-s-edpcch-information-field-mapping)

[150](#a.2.1-information-field-mapping-of-etfci)

[150](#a.2.2-information-field-mapping-of-retransmission-sequence-number)

[150](#a.2.3-information-field-mapping-of-the-spare-bit)

[150](#a.3-multiplexing-of-s-edpcch-information)

[150](#a.4-channel-coding-for-s-edpcch)

[150](#a.5-physical-channel-mapping-for-s-edpcch)

[150](#coding-for-eagch)

[150](#overview-3)

[151](#a-e-agch-information-field-mapping)

[151](#a.1-information-field-mapping-of-the-absolute-grant-value)

[153](#a.2-information-field-mapping-of-the-absolute-grant-scope)

[153](#b-multiplexing-of-e-agch-information)

[154](#crc-attachment-for-eagch)

[154](#channel-coding-for-eagch)

[154](#rate-matching-for-eagch)

[154](#physical-channel-mapping-for-eagch)

[154](#a-coding-for-e-roch)

[154](#a.1-overview-2)

[155](#a.2-e-roch-information-field-mapping)

[155](#a.2.1-information-field-mapping-of-the-s-etfc-offset)

[156](#a.2.2-information-field-mapping-of-the-rank-indication)

[156](#a.3-multiplexing-of-e-roch-information)

[156](#a.4-crc-attachment-for-e-roch)

[157](#a.5-channel-coding-for-e-roch)

[157](#a.6-rate-matching-for-e-roch)

[157](#a.7-physical-channel-mapping-for-e-roch)

[157](#mapping-for-ergch-relative-grant)

[157](#overview-4)

[157](#relative-grant-mapping)

[157](#mapping-for-e-hich-acknack)

[157](#overview-5)

[157](#acknack-mapping)

[159](#annex-a-informative-blind-transport-format-detection)

[159](#a.1-blind-transport-format-detection-using-fixed-positions)

[159](#a.1.1-blind-transport-format-detection-using-received-power-ratio)

[159](#a.1.2-blind-transport-format-detection-using-crc)

[161](#a.2-blind-transport-format-detection-using-pseudo-flexible-positions)

[162](#annex-b-informative-compressed-mode-idle-lengths)

[162](#b.1-idle-lengths-for-dl-ul-and-dlul-compressed-mode-for-dpch)

[164](#annex-c-informative-change-history)Foreword 1 Scope 2 References
3 Definitions, symbols and abbreviations 3.1 Definitions 3.2 Symbols 3.3
Abbreviations 4 Multiplexing, channel coding and interleaving 4.1
General 4.2 General coding/multiplexing of TrCHs 4.2.0 Transport channel
concatenation 4.2.1 CRC attachment 4.2.1.1 CRC Calculation 4.2.1.2
Relation between input and output of the CRC attachment block 4.2.2
Transport block concatenation and code block segmentation 4.2.2.1
Concatenation of transport blocks 4.2.2.2 Code block segmentation 4.2.3
Channel coding 4.2.3.1 Convolutional coding 4.2.3.2 Turbo coding
4.2.3.2.1 Turbo coder 4.2.3.2.2 Trellis termination for Turbo coder
4.2.3.2.3 Turbo code internal interleaver 4.2.3.3 Concatenation of
encoded blocks 4.2.4 Radio frame size equalisation 4.2.5 1^st^
interleaving 4.2.5.1 Void 4.2.5.2 1^st^ interleaver operation 4.2.5.3
Relation between input and output of 1^st^ interleaving in uplink
4.2.5.4 Relation between input and output of 1^st^ interleaving in
downlink 4.2.6 Radio frame segmentation 4.2.6.1 Relation between input
and output of the radio frame segmentation block in uplink 4.2.6.2
Relation between input and output of the radio frame segmentation block
in downlink 4.2.7 Rate matching 4.2.7.1 Determination of rate matching
parameters in uplink 4.2.7.1.1 Determination of SF and number of PhCHs
needed 4.2.7.2 Determination of rate matching parameters in downlink
4.2.7.2.1 Determination of rate matching parameters for fixed positions
of TrCHs 4.2.7.2.1A Determination of rate matching parameters for
pseudo-flexible positions of TrCHs 4.2.7.2.2 Determination of rate
matching parameters for flexible positions of TrCHs 4.2.7.3 Bit
separation and collection in uplink 4.2.7.3.1 Bit separation 4.2.7.3.2
Bit collection 4.2.7.4 Bit separation and collection in downlink
4.2.7.4.1 Bit separation 4.2.7.4.2 Bit collection 4.2.7.5 Rate matching
pattern determination 4.2.8 TrCH multiplexing 4.2.9 Insertion of
discontinuous transmission (DTX) indication bits 4.2.9.1 1^st^ insertion
of DTX indication bits 4.2.9.2 2^nd^ insertion of DTX indication bits
4.2.10 Physical channel segmentation 4.2.10.1 Relation between input and
output of the physical segmentation block in uplink 4.2.10.2 Relation
between input and output of the physical segmentation block in downlink
4.2.11 2^nd^ interleaving 4.2.11.1 2^nd^ interleaving for Secondary
CCPCH with 16QAM 4.2.12 Physical channel mapping 4.2.12.1 Uplink
4.2.12.1.1 UL\_DPCH\_10ms\_Mode is not configured by higher layers, or,
no compressed-mode transmission gap overlaps with the first radio frame
in the 20ms CI 4.2.12.1.2 UL\_DPCH\_10ms\_Mode is configured by higher
layers, and, a compressed-mode transmission gap overlaps with the first
radio frame in 20ms CI 4.2.12.2 Downlink 4.2.13 Restrictions on
different types of CCTrCHs 4.2.13.1 Uplink Dedicated channel (DCH)
4.2.13.2 Random Access Channel (RACH) 4.2.13.3 Void 4.2.13.4 Downlink
Dedicated Channel (DCH) 4.2.13.5 Void 4.2.13.6 Broadcast channel (BCH)
4.2.13.7 Forward access and paging channels (FACH and PCH) 4.2.13.8 High
Speed Downlink Shared Channel (HS-DSCH) associated with a DCH 4.2.13.9
Enhanced Dedicated Channel (E-DCH) 4.2.14 Multiplexing of different
transport channels into one CCTrCH, and mapping of one CCTrCH onto
physical channels 4.2.14.1 Allowed CCTrCH combinations for one UE
4.2.14.1.1 Allowed CCTrCH combinations on the uplink 4.2.14.1.2 Allowed
CCTrCH combinations on the downlink 4.3 Transport format detection 4.3.1
Blind transport format detection 4.3.1A Single transport format
detection 4.3.2 Transport format detection based on TFCI 4.3.3 Coding of
Transport-Format-Combination Indicator (TFCI) 4.3.4 Void 4.3.5 Mapping
of TFCI words 4.3.5.1 Mapping of TFCI word in normal mode in downlink,
and in uplink when uplink DPCCH slot format is not 5 4.3.5.1A Mapping of
TFCI word in normal mode in uplink when uplink DPCCH slot format is 5
4.3.5.1.1 Mapping of TFCI bits for Secondary CCPCH with 16QAM 4.3.5.2
Mapping of TFCI word in compressed mode 4.3.5.2.1 Uplink compressed mode
4.3.5.2.2 Downlink compressed mode 4.3A Mapping of DL FET ACK/NACK bits
4.4 Compressed mode 4.4.1 Frame structure in the uplink 4.4.2 Frame
structure types in the downlink 4.4.2A Frame structure in the downlink
for F-DPCH 4.4.2B Frame structure in the downlink for F-TPICH 4.4.3
Transmission time reduction method 4.4.3.1 Void 4.4.3.2 Compressed mode
by reducing the spreading factor by 2 4.4.3.3 Compressed mode by higher
layer scheduling 4.4.4 Transmission gap position 4.4.5 Transmission gap
position for E‑DCH 4.4.5.1 E‑DPDCH Transmission Gap Position during
Initial Transmissions 4.4.5.2 E‑DPDCH Transmission Gap Position during
Retransmissions 4.4.5.3 E‑DPCCH Transmission Gap Position 4.5 Coding for
HS-DSCH 4.5.1 CRC attachment for HS-DSCH 4.5.1.1 CRC attachment method 1
for HS-DSCH 4.5.1.2 CRC attachment method 2 for HS-DSCH 4.5.1A Bit
scrambling for HS-DSCH 4.5.2 Code block segmentation for HS-DSCH 4.5.3
Channel coding for HS-DSCH 4.5.4 Hybrid ARQ for HS-DSCH 4.5.4.1 HARQ bit
separation 4.5.4.2 HARQ First Rate Matching Stage 4.5.4.3 HARQ Second
Rate Matching Stage 4.5.4.4 HARQ bit collection 4.5.5 Physical channel
segmentation for HS-DSCH 4.5.6 Interleaving for HS-DSCH 4.5.7
Constellation re-arrangement for 16 QAM and 64QAM 4.5.8 Physical channel
mapping for HS-DSCH 4.6 Coding for HS-SCCH type 1 4.6.1 Overview 4.6.2
HS-SCCH information field mapping 4.6.2.1 Redundancy and constellation
version coding 4.6.2.2 Modulation scheme mapping 4.6.2.3 Channelization
code-set mapping 4.6.2.4 UE identity mapping 4.6.2.5 HARQ process
identifier mapping 4.6.2.6 Transport block size index mapping 4.6.3
Multiplexing of HS-SCCH information 4.6.4 CRC attachment for HS-SCCH
4.6.5 Channel coding for HS-SCCH 4.6.6 Rate matching for HS-SCCH 4.6.7
UE specific masking for HS-SCCH 4.6.8 Physical channel mapping for
HS-SCCH 4.6A Coding for HS-SCCH type 2 4.6A.1 Overview 4.6A.2 HS-SCCH
Type 2 information field mapping 4.6A.2.1 The first transmission
4.6A.2.2 The second and the third transmissions 4.6A.2.2.1 Special
Information mapping 4.6A.2.2.1.1 Transport-block size information
mapping 4.6A.2.2.1.2 Pointer to the previous transmission mapping
4.6A.2.2.1.3 Second or third transmission mapping 4.6A.2.2.2 Redundancy
and Constellation Version mapping 4.6A.2.2.3 Modulation scheme mapping
4.6A.2.2.4 Channelization code-set mapping 4.6A.2.2.5 UE identity
mapping 4.6A.3 Multiplexing of HS-SCCH Type 2 information 4.6A.4 CRC
attachment for HS-SCCH Type 2 4.6A.5 Channel coding for HS-SCCH Type 2
4.6A.6 Rate matching for HS-SCCH Type 2 4.6A.7 UE specific masking for
HS-SCCH Type 2 4.6A.8 Physical channel mapping for HS-SCCH Type 2 4.6B
Coding for HS-SCCH type 3 4.6B.1 Overview 4.6B.2 HS-SCCH type 3
information field mapping 4.6B.2.1 Redundancy and constellation version
coding 4.6B.2.2 Modulation scheme and number of transport blocks mapping
4.6B.2.3 Channelization code-set mapping 4.6B.2.4 UE identity mapping
4.6B.2.5 HARQ process identifier mapping 4.6B.2.6 Transport block size
index mapping 4.6B.2.7 Precoding Weight Information mapping 4.6B.3
Multiplexing of HS-SCCH type 3 information 4.6B.4 CRC attachment for
HS-SCCH type 3 4.6B.5 Channel coding for HS-SCCH type 3 4.6B.6 Rate
matching for HS-SCCH type 3 4.6B.7 UE specific masking for HS-SCCH type
3 4.6B.8 Physical channel mapping for HS-SCCH type 3 4.6C Coding for
HS-SCCH orders 4.6C.1 Overview 4.6C.2 HS-SCCH Order information field
mapping in the CELL\_DCH state 4.6C.2.1 Order type mapping 4.6C.2.2
Order mapping 4.6C.2.2.1 Orders for activation and deactivation of DTX,
DRX and HS-SCCH-less operation and for HS-DSCH serving cell change
4.6C.2.2.2 Orders for activation and deactivation of Secondary serving
HS-DSCH cells and Secondary uplink frequency 4.6C.2.2.3 Orders for
Switching between Uplink Closed Loop Transmit Diversity Activation
states 4.6C.2.2.4 Orders for activating and de-activating demodulation
common pilots (D-CPICH) when the UE is configured in MIMO mode with four
transmit antennas 4.6C.2.2.5 Orders for switching the E-DCH TTI, and for
start/stop a simplified HS-SCCH type 1 transmission interval 4.6C.2.3 UE
identity mapping 4.6C.3 HS-SCCH order information field mapping in the
CELL\_FACH and CELL\_PCH states 4.6C.3.1 Order type mapping 4.6C.3.2
Order mapping 4.6C.3.2.1 Orders for network triggered HS-DPCCH
transmission 4.6C.3.2.2 Orders for HS-DSCH reception during CELL\_FACH
HS-SCCH DRX operation 4.6D Coding for HS-SCCH type 4 4.6D.1 Overview
4.6D.2 HS-SCCH type 4 information field mapping 4.6D.2.1 Redundancy and
constellation version coding 4.6D.2.2 Modulation scheme and number of
transport blocks mapping 4.6D.2.3 Channelization code-set mapping
4.6D.2.4 UE identity mapping 4.6D.2.5 HARQ process identifier mapping
4.6D.2.6 Transport block size index mapping 4.6D.2.7 Precoding Weight
Information mapping 4.6D.3 Multiplexing of HS-SCCH type 4 information
4.6D.4 CRC attachment for HS-SCCH type 4 4.6D.5 Channel coding for
HS-SCCH type 4 4.6D.6 Rate matching for HS-SCCH type 4 4.6D.7 UE
specific masking for HS-SCCH type 4 4.6D.8 Physical channel mapping for
HS-SCCH type 4 4.7 Coding for HS-DPCCH 4.7.1 Overview 4.7.2 Channel
coding for HS-DPCCH when the UE is not configured in MIMO mode and not
configured in MIMO mode with four transmit antennas in the serving
HS-DSCH cell and Secondary\_Cell\_Enabled is 0 or 1 and
Secondary\_Cell\_Active is 0 4.7.2.1 Channel coding for HS-DPCCH
HARQ-ACK 4.7.2.2 Channel coding for HS-DPCCH channel quality indication
4.7.3 Channel coding for HS-DPCCH when the UE is configured in MIMO mode
in the serving HS-DSCH cell and Secondary\_Cell\_Enabled is 0 4.7.3.1
Channel coding for HS-DPCCH HARQ-ACK 4.7.3.2 Channel coding for HS-DPCCH
composite precoding control indication and channel quality indication
4.7.3.2.1 Bit mapping of Type A channel quality indication 4.7.3.2.2 Bit
mapping of Type B channel quality indication 4.7.3.2.3 Bit mapping of
precoding control indication 4.7.3.2.4 Composite precoding control
indication and channel quality indication bits 4.7.3.2.5 Block encoding
of composite precoding control indication and channel quality indication
bits 4.7.3A Channel coding for HS-DPCCH when the UE is not configured in
MIMO mode in any cell and Secondary\_Cell\_Enabled is 1 and
Secondary\_Cell\_Active is 1 4.7.3A.1 Channel coding for the composite
HS-DPCCH HARQ-ACK 4.7.3A.2 Channel coding for HS-DPCCH composite channel
quality indication 4.7.3A.2.1 Composite channel quality indication bits
4.7.3A.2.2 Block encoding of composite channel quality indication bits
4.7.3B Channel coding for HS-DPCCH when Secondary\_Cell\_Enabled is at
least 3 or when the UE is configured in MIMO mode in at least one cell
and Secondary\_Cell\_Enabled is greater than 0 4.7.3B.1 Channel coding
for the composite HS-DPCCH HARQ-ACK 4.7.3B.2 Channel coding for HS-DPCCH
composite precoding control indication and channel quality indication
4.7.3C Channel coding for HS-DPCCH when the UE is not configured in MIMO
mode in any cell and Secondary\_Cell\_Enabled is 2 4.7.3C.1 Channel
coding for the composite HS-DPCCH HARQ-ACK 4.7.3C.2 Channel coding for
HS-DPCCH channel quality indication 4.7.3D Channel coding for HS-DPCCH
when the UE is configured in Multiflow mode 4.7.3D.1 Channel coding for
the composite HS-DPCCH HARQ-ACK 4.7.3D.2 Channel coding for HS-DPCCH
channel quality indication 4.7.3E Channel coding for HS-DPCCH when the
UE is configured in MIMO mode with 4 transmit antennas 4.7.3E.1 Channel
coding for HS-DPCCH when the UE is configured in MIMO mode with four
transmit antennas and Secondary\_Cell\_Enabled is 0 4.7.3E.1.1 Channel
coding for HS-DPCCH HARQ-ACK 4.7.3E.1.2 Channel coding for HS-DPCCH
composite number of transport blocks preferred, precoding control
indication and channel quality indication 4.7.3E.2 Channel coding for
HS-DPCCH when the UE is configured in MIMO mode with four transmit
antennas in any cell and Secondary\_Cell\_Enabled is 1 4.7.3E.2.1
Channel coding for the composite HS-DPCCH HARQ-ACK 4.7.3E.2.2 Channel
coding for HS-DPCCH composite number of transport blocks preferred,
precoding control indication and channel quality indication 4.7.3E.3
Channel coding for HS-DPCCH when the UE is configured in MIMO mode with
four transmit antennas in any cell and Secondary\_Cell\_Enabled is 2
4.7.3E.3.1 Channel coding for the composite HS-DPCCH HARQ-ACK 4.7.3E.3.2
Channel coding for HS-DPCCH composite number of transport blocks
preferred, precoding control indication and channel quality indication
4.7.3E.4 Channel coding for HS-DPCCH when the UE is configured in MIMO
mode with four transmit antennas in any cell and
Secondary\_Cell\_Enabled is 3 4.7.3E.4.1 Channel coding for the
composite HS-DPCCH HARQ-ACK 4.7.3E.4.2 Channel coding for HS-DPCCH
composite number of transport blocks preferred, precoding control
indication and channel quality indication 4.7.4 Physical channel mapping
for HS-DPCCH 4.7.4.1 Physical Channel mapping for HS-DPCCH HARQ-ACK
4.7.4.2 Physical Channel mapping for HS-DPCCH PCI/CQI 4.7.4.3 Physical
Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI when the UE is
configured in Multiflow mode 4.7.4.3.1 Physical Channel mapping for
HS-DPCCH HARQ-ACK and PCI/CQI when the UE is configured with one serving
and one assisting serving HS-DSCH cell 4.7.4.3.2 Physical Channel
mapping for HS-DPCCH HARQ-ACK and PCI/CQI when the UE is configured with
two serving and one assisting serving or one serving and two assisting
serving HS-DSCH cells 4.7.4.3.3 Physical Channel mapping for HS-DPCCH
HARQ-ACK and PCI/CQI when the UE is configured with two serving and two
assisting serving HS-DSCH cells 4.7.4.3.4 Physical Channel mapping for
HS-DPCCH HARQ-ACK and PCI/CQI when the UE is configured with three
serving and one assisting serving HS-DSCH cells or one serving and three
assisting serving HS-DSCH cells 4.7.4.4 Physical Channel mapping for
HS-DPCCH when the UE is configured in MIMO mode with four transmit
antennas in at least one cell 4.7.4.4.1 Physical Channel mapping for
HS-DPCCH HARQ-ACK 4.7.4.4.2 Physical Channel mapping for HS-DPCCH
NTBP/PCI/CQI 4.8 Coding for E‑DCH 4.8.1 CRC attachment for E-DCH 4.8.2
Code block segmentation for E-DCH 4.8.3 Channel coding for E-DCH 4.8.4
Physical layer HARQ functionality and rate matching for E-DCH 4.8.4.1
Determination of SF, modulation scheme and number of E-DPDCH PhCHs
needed 4.8.4.1A Determination of SF, modulation scheme and number of
S-E-DPDCH PhCHs needed 4.8.4.2 HARQ bit separation 4.8.4.3 HARQ Rate
Matching Stage 4.8.4.4 HARQ bit collection 4.8.5 Physical channel
segmentation for E‑DCH 4.8.6 Interleaving for E‑DCH 4.8.7 Physical
channel mapping for E‑DCH 4.9 Coding for E‑DPCCH 4.9.1 Overview 4.9.2
E‑DPCCH information field mapping 4.9.2.1 Information field mapping of
E‑TFCI 4.9.2.2 Information field mapping of retransmission sequence
number 4.9.2.3 Information field mapping of the \"Happy\" bit 4.9.3
Multiplexing of E‑DPCCH information 4.9.4 Channel coding for E‑DPCCH
4.9.5 Physical channel mapping for E‑DPCCH 4.9A Coding for S-E‑DPCCH
4.9A.1 Overview 4.9A.2 S-E‑DPCCH information field mapping 4.9A.2.1
Information field mapping of E‑TFCI 4.9A.2.2 Information field mapping
of retransmission sequence number 4.9A.2.3 Information field mapping of
the Spare bit 4.9A.3 Multiplexing of S-E‑DPCCH information 4.9A.4
Channel coding for S-E‑DPCCH 4.9A.5 Physical channel mapping for
S-E‑DPCCH 4.10 Coding for E‑AGCH 4.10.1 Overview 4.10.1A E-AGCH
information field mapping 4.10.1A.1 Information field mapping of **the**
Absolute Grant Value 4.10.1A.2 Information field mapping of the Absolute
Grant Scope 4.10.1B Multiplexing of E-AGCH information 4.10.2 CRC
attachment for E‑AGCH 4.10.3 Channel coding for E‑AGCH 4.10.4 Rate
matching for E‑AGCH 4.10.5 Physical channel mapping for E‑AGCH 4.10A
Coding for E-ROCH 4.10A.1 Overview 4.10A.2 E-ROCH information field
mapping 4.10A.2.1 Information field mapping of **the S-ETFC Offset**
4.10A.2.2 Information field mapping of the Rank Indication 4.10A.3
Multiplexing of E-ROCH information 4.10A.4 CRC attachment for E-ROCH
4.10A.5 Channel coding for E-ROCH 4.10A.6 Rate matching for E-ROCH
4.10A.7 Physical channel mapping for E-ROCH 4.11 Mapping for E‑RGCH
Relative Grant 4.11.1 Overview 4.11.2 Relative Grant mapping 4.12
Mapping for E-HICH ACK/NACK 4.12.1 Overview 4.12.2 ACK/NACK mapping
Annex A (informative): Blind transport format detection A.1 Blind
transport format detection using fixed positions A.1.1 Blind transport
format detection using received power ratio A.1.2 Blind transport format
detection using CRC A.2 Blind transport format detection using
pseudo-flexible positions Annex B (informative): Compressed mode idle
lengths B.1 Idle lengths for DL, UL and DL+UL compressed mode for DPCH
Annex C (informative): Change history

Foreword
========

This Technical Specification (TS) has been produced by the 3^rd^
Generation Partnership Project (3GPP).

The contents of the present document are subject to continuing work
within the TSG and may change following formal TSG approval. Should the
TSG modify the contents of the present document, it will be re-released
by the TSG with an identifying change of release date and an increase in
version number as follows:

Version x.y.z

where:

x the first digit:

1 presented to TSG for information;

2 presented to TSG for approval;

3 or greater indicates TSG approved document under change control.

y the second digit is incremented for all changes of substance, i.e.
technical enhancements, corrections, updates, etc.

z the third digit is incremented when editorial only changes have been
incorporated in the document.

1 Scope
=======

The present document describes the characteristics of the Layer 1
multiplexing and channel coding in the FDD mode of UTRA.

2 References
============

The following documents contain provisions which, through reference in
this text, constitute provisions of the present document.

\- References are either specific (identified by date of publication,
edition number, version number, etc.) or non‑specific.

\- For a specific reference, subsequent revisions do not apply.

\- For a non-specific reference, the latest version applies.

\[1\] 3GPP TS 25.201: \"Physical layer - General Description\".

\[2\] 3GPP TS 25.211: \"Physical channels and mapping of transport
channels onto physical channels (FDD)\".

\[3\] 3GPP TS 25.213: \"Spreading and modulation (FDD)\".

\[4\] 3GPP TS 25.214: \"Physical layer procedures (FDD)\".

\[5\] 3GPP TS 25.215: \"Physical layer -- Measurements (FDD)\".

\[6\] 3GPP TS 25.221: \"Physical channels and mapping of transport
channels onto physical channels (TDD)\".

\[7\] 3GPP TS 25.222: \"Multiplexing and channel coding (TDD)\".

\[8\] 3GPP TS 25.223: \"Spreading and modulation (TDD)\".

\[9\] 3GPP TS 25.224: \"Physical layer procedures (TDD)\".

\[10\] 3GPP TS 25.225: \"Physical layer -- Measurements (TDD)\".

\[11\] 3GPP TS 25.302: \"Services Provided by the Physical Layer\".

\[12\] 3GPP TS 25.402: \"Synchronization in UTRAN, Stage 2\".

\[13\] 3GPP TS 25.331: \"Radio Resource Control (RRC); Protocol
Specification\".

\[14\] ITU-T Recommendation X.691 (12/97) \"Information technology -
ASN.1 encoding rules: Specification of Packed Encoding Rules (PER)\"

\[15\] 3GPP TS 25.306: \"UE Radio Access capabilities\".

\[16\] 3GPP TS 25.321: \"Medium Access Control (MAC) protocol
specification\".

3 Definitions, symbols and abbreviations
========================================

3.1 Definitions
---------------

For the purposes of the present document, the following terms and
definitions apply:

**Assisting secondary serving HS-DSCH Cell(s):** In addition to the
serving HS-DSCH cell, a cell in the secondary downlink frequency, where
the UE is configured to simultaneously monitor a HS-SCCH set and receive
HS-DSCH if it is scheduled in that cell. There can be up to two
assisting secondary serving HS-DSCH cells.

**Assisting serving HS-DSCH Cell:** In addition to the serving HS-DSCH
cell, a cell in the same frequency, where the UE is configured to
simultaneously monitor a HS-SCCH set and receive HS-DSCH if it is
scheduled in that cell.

**Cell group**: A group of (one, two, or three) Multiflow mode cells
that have the same CPICH timing. The cells that belong to a cell group
are indicated by higher layers.

**DL FET:** DL FET refers to early termination of DL DPCH transmission
upon receiving an acknowledgement message. In this context, a DL FET
ACK/NACK message represents an acknowledge message sent on UL DPCCH for
DL FET.

**DL\_DCH\_FET\_Config**: Higher layers signal this configuration
parameter to indicate enhanced DCH physical layer configuration. The
possible values are 0 and 1. The value 0 indicates Mode 0 configuration
where DL transport channels concatenation and DL FET ACK/NACK signalling
on UL are not configured. The value 1 indicates Mode 1 where DL
transport channel concatenation and DL FET ACK/NACK signalling on UL are
configured.

**MIMO mode:** This term refers to the downlink MIMO configuration with
two transmit antennas

**MIMO mode with four transmit antennas:** This term refers to the
downlink MIMO configuration with four transmit antennas

**Multiflow mode:** The UE is configured in Multiflow mode when it is
configured with assisting serving HS-DSCH cell.

**Primary uplink frequency:** If a single uplink frequency is configured
for the UE, then it is the *primary uplink frequency*. In case more than
one uplink frequency is configured for the UE, then the primary uplink
frequency is the frequency on which the E-DCH corresponding to the
serving E-DCH cell associated with the serving HS-DSCH cell is
transmitted. The association between a pair of uplink and downlink
frequencies is indicated by higher layers.

**Secondary uplink frequency:** A *secondary uplink frequency* is a
frequency on which an E-DCH corresponding to a serving E-DCH cell
associated with a secondary serving HS-DSCH cell is transmitted. The
association between a pair of uplink and downlink frequencies is
indicated by higher layers.

**TG:** Transmission Gap is consecutive empty slots that have been
obtained with a transmission time reduction method. The transmission gap
can be contained in one or two consecutive radio frames.

**TGL:** Transmission Gap Length is the number of consecutive empty
slots that have been obtained with a transmission time reduction method.
0 ≤*TGL*≤ 14. The CFNs of the radio frames containing the first empty
slot of the transmission gaps, the CFNs of the radio frames containing
the last empty slot, the respective positions N~first~ and N~last~
within these frames of the first and last empty slots of the
transmission gaps, and the transmission gap lengths can be calculated
with the compressed mode parameters described in \[5\].

**TrCH number:** The transport channel number identifies a TrCH in the
context of L1. The L3 transport channel identity (TrCH ID) maps onto the
L1 transport channel number. The mapping between the transport channel
number and the TrCH ID is as follows: TrCH 1 corresponds to the TrCH
with the lowest TrCH ID, TrCH 2 corresponds to the TrCH with the next
lowest TrCH ID and so on.

**UL DPCH 10ms Mode**: When configured by higher layers for the TTI to
be transmitted \[16\], UL DPCH follows physical channel procedures
specific to this mode. UL DPCH 10ms Mode can only happen when
DL\_DCH\_FET\_Config is configured.

**UL 20ms Compression Interval (CI):** A time interval of 20ms duration
aligned to a 20ms TTI defined for UL DPCH physical layer procedures when
DL\_DCH\_FET\_Config is configured by higher layers.

**1^st^ secondary serving HS-DSCH cell**: If the UE is configured with
two uplink frequencies, the 1^st^ secondary serving HS-DSCH cell is the
secondary serving HS-DSCH cell that is associated with the secondary
uplink frequency. If the UE is configured with a single uplink
frequency, the 1^st^ secondary serving HS-DSCH cell is a secondary
serving HS-DSCH cell whose index is indicated by higher layers.

**2^nd^ secondary serving HS-DSCH cell**: If the UE is configured with
more than two serving HS-DSCH cells, the 2^nd^ secondary serving HS-DSCH
cell is a secondary serving HS-DSCH cell whose index is indicated by
higher layers.

**3^rd^ secondary serving HS-DSCH cell**: If the UE is configured with
more than three serving HS-DSCH cells, the 3rd secondary serving HS-DSCH
cell is a secondary serving HS-DSCH cell whose index is indicated by
higher layers.

**4^th^ secondary serving HS-DSCH cell**: If the UE is configured with
more than four serving HS-DSCH cells, the 4^th^ secondary serving
HS-DSCH cell is a secondary serving HS-DSCH cell whose index is
indicated by higher layers.

**5^th^ secondary serving HS-DSCH cell**: If the UE is configured with
more than five serving HS-DSCH cells, the 5^th^ secondary serving
HS-DSCH cell is a secondary serving HS-DSCH cell whose index is
indicated by higher layers.

**6^th^ secondary serving HS-DSCH cell**: If the UE is configured with
more than six serving HS-DSCH cells, the 6^th^ secondary serving HS-DSCH
cell is a secondary serving HS-DSCH cell whose index is indicated by
higher layers.

**7^th^ secondary serving HS-DSCH cell**: If the UE is configured with
eight serving HS-DSCH cells, the 7^th^ secondary serving HS-DSCH cell is
a secondary serving HS-DSCH cell whose index is indicated by higher
layers.

3.2 Symbols
-----------

For the purposes of the present document, the following symbols apply:

*x* round towards *∞*, i.e. integer such that *x ≤ x \< x+*1

*x* round towards -*∞*, i.e. integer such that *x-*1 *\< x ≤ x*

*x* absolute value of *x*

sgn(*x*) signum function, i.e.
![](media/image2.wmf){width="1.7638888888888888in" height="0.5in"}

*N~first~* The first slot in the *TG*, located in the first compressed
radio frame if the TG spans two frames.

*N~last~* The last slot in the *TG*, located in the second compressed
radio frame if the TG spans two frames.

*N~tr~* Number of transmitted slots in a radio frame.

Unless otherwise is explicitly stated when the symbol is used, the
meaning of the following symbols is:

*Λ List of transport channels numbers i~1~, i~2~, ..., i~B~,
corresponding to downlink transport channels to be concatenated when*
DL\_DCH\_FET\_Config = 1.

*i* TrCH number

*j* TFC number

*k* Bit number

*l* TF number

*m* Transport block number

*n~i~* Radio frame number of TrCH *i*.

*p* PhCH number

r Code block number

*I* Number of TrCHs in a CCTrCH.

*C~i~* Number of code blocks in one TTI of TrCH *i*.

*F~i~* Number of radio frames in one TTI of TrCH *i,* except for uplink
when UL\_DPCH\_10ms\_Mode is configured. In uplink, when
UL\_DPCH\_10ms\_Mode is configured, *F~i~ is the number of radio frames
in the transmission time interval of TrCH i divided by 2.*

*M~i~* Number of transport blocks in one TTI of TrCH *i*.

*N~data,j~* Number of data bits that are available for the CCTrCH in a
radio frame with TFC *j*.

![](media/image3.wmf){width="0.44375in" height="0.2777777777777778in"}
Number of data bits that are available for the CCTrCH in a compressed
radio frame with TFC *j*.

*P* Number of PhCHs used for one CCTrCH.

*PL* Puncturing Limit for the uplink. Signalled from higher layers

*RM~i~* Rate Matching attribute for TrCH *i*. Signalled from higher
layers, or determined as specified in clause 4.2.0.

Temporary variables, i.e. variables used in several (sub)clauses with
different meaning.

x, X

y, Y

z, Z

3.3 Abbreviations
-----------------

For the purposes of the present document, the following abbreviations
apply:

ARQ Automatic Repeat Request

BCH Broadcast Channel

BER Bit Error Rate

BLER Block Error Rate

BS Base Station

CCPCH Common Control Physical Channel

CCTrCH Coded Composite Transport Channel

CFN Connection Frame Number

CLTD Closed Loop Transmit Diversity

CRC Cyclic Redundancy Check

DCH Dedicated Channel

DL Downlink (Forward link)

DPCCH Dedicated Physical Control Channel

DPCCH2 Dedicated Physical Control Channel 2

DPCH Dedicated Physical Channel

DPDCH Dedicated Physical Data Channel

DS-CDMA Direct-Sequence Code Division Multiple Access

DTX Discontinuous Transmission

FACH Forward Access Channel

E-AGCH E-DCH Absolute Grant Channel

E-DCH Enhanced Dedicated Channel

E-DPCCH E-DCH Dedicated Physical Control Channel

E-DPDCH E-DCH Dedicated Physical Data Channel

E-HICH E-DCH Hybrid ARQ Indicator Channel

E-RGCH E-DCH Relative Grant Channel

E-RNTI E-DCH Radio Network Temporary Identifier

E-ROCH E-DCH Rank and Offset Channel

FDD Frequency Division Duplex

F-DPCH Fractional Dedicated Physical Channel

F-TPICH Fractional Transmitted Precoding Indicator Channel

FER Frame Error Rate

GF Galois Field

HARQ Hybrid Automatic Repeat reQuest

HS-DPCCH Dedicated Physical Control Channel (uplink) for HS-DSCH

HS-DPCCH~2~ Secondary Dedicated Physical Control Channel (uplink) for
HS-DSCH, when Secondary\_Cell\_Enabled is greater than 3

HS-DSCH High Speed Downlink Shared Channel

HS-PDSCH High Speed Physical Downlink Shared Channel

HS-SCCH Shared Control Channel for HS-DSCH

MAC Medium Access Control

MBSFN MBMS over a Single Frequency Network

Mcps Mega Chip Per Second

MIMO Multiple Input Multiple Output

MS Mobile Station

OVSF Orthogonal Variable Spreading Factor (codes)

PCCC Parallel Concatenated Convolutional Code

PCH Paging Channel

PhCH Physical Channel

PRACH Physical Random Access Channel

RACH Random Access Channel

RSC Recursive Systematic Convolutional Coder

RV Redundancy Version

RX Receive

SCH Synchronization Channel

SF Spreading Factor

SFN System Frame Number

SIR Signal-to-Interference Ratio

SNR Signal to Noise Ratio

S-DPCCH Secondary Dedicated Physical Control Channel

S-E-DPCCH Secondary Dedicated Physical Control Channel for E-DCH

S-E-DPDCH Secondary Dedicated Physical Data Channel for E-DCH

S-E-RNTI Secondary E-RNTI

TF Transport Format

TFC Transport Format Combination

TFCI Transport Format Combination Indicator

TPC Transmit Power Control

TPI Transmitted Precoding Indicator

TrCH Transport Channel

TTI Transmission Time Interval

TX Transmit

UL Uplink (Reverse link)

4 Multiplexing, channel coding and interleaving
===============================================

4.1 General
-----------

Data stream from/to MAC and higher layers (Transport block / Transport
block set) is encoded/decoded to offer transport services over the radio
transmission link. Channel coding scheme is a combination of error
detection, error correcting, rate matching, interleaving and transport
channels mapping onto/splitting from physical channels.

4.2 General coding/multiplexing of TrCHs
----------------------------------------

This section only applies to the transport channels: DCH, RACH, BCH,
FACH and PCH. Other transport channels which do not use the general
method are described separately below.

Data arrives to the coding/multiplexing unit in form of transport block
sets once every transmission time interval. The transmission time
interval is transport-channel specific from the set {10 ms, 20 ms, 40
ms, 80 ms}, where 80 ms TTI for DCH shall not be used unless SF=512.

The following coding/multiplexing steps can be identified:

\- add CRC to each transport block (see subclause 4.2.1);

\- transport block concatenation and code block segmentation (see
subclause 4.2.2);

\- channel coding (see subclause 4.2.3);

\- radio frame equalisation (see subclause 4.2.4);

\- rate matching (see subclause 4.2.7);

\- insertion of discontinuous transmission (DTX) indication bits (see
subclause 4.2.9);

\- interleaving (two steps, see subclauses 4.2.5 and 4.2.11);

\- radio frame segmentation (see subclause 4.2.6);

\- multiplexing of transport channels (see subclause 4.2.8);

\- physical channel segmentation (see subclause 4.2.10);

\- mapping to physical channels (see subclause 4.2.12).

The coding/multiplexing steps for uplink and downlink are shown in
figure 1 and figure 2 respectively.

![](media/image4.wmf){width="4.9527777777777775in" height="8.88125in"}

Figure 1: Transport channel multiplexing structure for uplink

![](media/image5.wmf){width="5.5in" height="9.00625in"}

Figure 2: Downlink transport channel multiplexing structure for
transport channels that are not concatenated.

![](media/image6.wmf){width="5.114583333333333in"
height="9.397916666666667in"}

Figure 2A: Downlink transport channel processing for transport channels
that are concatenated. The concatenated transport channel inherits the
parameters of the transport channel *i~1~*.

The single output data stream from the TrCH multiplexing, including DTX
indication bits in downlink, is denoted *Coded Composite Transport
Channel (CCTrCH)*. A CCTrCH can be mapped to one or several physical
channels.

### 4.2.0 Transport channel concatenation

When DL\_DCH\_FET\_Config is configured with value 1, downlink transport
blocks of transport channels with a transport channel number *i~l~* ∈ Λ
are concatenated to form a concatenated transport channel. In this case,
higher layers ensure that TTI values of transport channels that are
concatenated are the same.

Let *i~1~, i~2~, i~3~,...,i~B~* denote in ascending order the transport
channel numbers in Λ,  *i~1~ \< i~2~ \< i~3~ \<... \< i~B~* . Τhe
concatenated transport channel is treated as a regular transport channel
in layer 1, inheriting the parameters of transport channel number
*i~1~,* e.g., the transport channel number, and the rate matching
attribute of the concatenated transport channel are *i~1~* and
respectively.All transport blocks of all the transport channels to be
concatenated are serially concatenated into a single transport block, in
ascending order. The bits input to the transport channel concatenation
are denoted by for , and *m = 1, ..., , where i~k~ denotes* the TrCH
number, *m* denotes the transport block number for the transport channel
*i~k~* , and is the number of bits in each transport block of transport
channel *i~k~*. The bits after transport channel concatenation are
denoted by , where *A* =denotes the total number of bits in the signle
transport block of the concatenated transport channel. The bits are
defined by the following set of relations:

,

for *m* = 1, ...,*, and .*

### 4.2.1 CRC attachment

Error detection is provided on transport blocks through a Cyclic
Redundancy Check (CRC). The size of the CRC is 24, 16, 12, 8 or 0 bits
and it is signalled from higher layers what CRC size that should be used
for each TrCH.

#### 4.2.1.1 CRC Calculation

The entire transport block is used to calculate the CRC parity bits for
each transport block. The parity bits are generated by one of the
following cyclic generator polynomials:

\- g~CRC24~(*D*) = *D*^24^ + *D*^23^ + *D*^6^ + *D*^5^ + *D* + 1;

\- g~CRC16~(*D*) = *D*^16^ + *D*^12^ + *D*^5^ + 1;

\- g~CRC12~(*D*) = *D*^12^ + *D*^11^ + *D*^3^ + *D*^2^ + *D* + 1;

\- g~CRC8~(*D*) = *D*^8^ + *D*^7^ + *D*^4^ + *D*^3^ + *D* + 1.

Denote the bits in a transport block delivered to layer 1 by
![](media/image18.wmf){width="1.5138888888888888in"
height="0.2638888888888889in"}, and the parity bits by
![](media/image19.wmf){width="1.5166666666666666in"
height="0.22152777777777777in"}. *A~i~* is the size of a transport block
of TrCH *i, m* is the transport block number, and *L~i~* is the number
of parity bits. *L~i~* can take the values 24, 16, 12, 8, or 0 depending
on what is signalled from higher layers, except for a concatenated
transport channel (Subclause 4.2.0) where the number of parity bits is
always 16.

The encoding is performed in a systematic form, which means that in
GF(2), the polynomial:

![](media/image20.wmf){width="5.375in" height="0.2777777777777778in"}

yields a remainder equal to 0 when divided by g~CRC24~(*D*), polynomial:

![](media/image21.wmf){width="5.166666666666667in"
height="0.2777777777777778in"}

yields a remainder equal to 0 when divided by g~CRC16~(*D*), polynomial:

![](media/image22.wmf){width="5.277777777777778in"
height="0.2777777777777778in"}

yields a remainder equal to 0 when divided by g~CRC12~(*D*) and
polynomial:

![](media/image23.wmf){width="4.888888888888889in"
height="0.2777777777777778in"}

yields a remainder equal to 0 when divided by g~CRC8~(*D*).

If no transport blocks are input to the CRC calculation (*M~i\ ~*= 0),
no CRC attachment shall be done. If transport blocks are input to the
CRC calculation (*M~i\ ~*≠ 0) and the size of a transport block is zero
(*A~i\ ~*= 0), CRC shall be attached, i.e. all parity bits equal to
zero.

#### 4.2.1.2 Relation between input and output of the CRC attachment block

The bits after CRC attachment are denoted by
![](media/image24.wmf){width="1.3888888888888888in"
height="0.2638888888888889in"}, where *B~i~* = *A~i~*+ *L~i~*. The
relation between *a~imk~* and *b~imk~* is:

![](media/image25.wmf){width="0.6805555555555556in" height="0.25in"} *k*
= 1, 2, 3, ..., *A~i~*

![](media/image26.wmf){width="1.3055555555555556in"
height="0.2638888888888889in"} *k* = *A~i~* + 1, *A~i~* + 2, *A~i~* + 3,
..., *A~i~* + *L~i~*

### 4.2.2 Transport block concatenation and code block segmentation

All transport blocks in a TTI are serially concatenated. If the number
of bits in a TTI is larger than *Z*, the maximum size of a code block in
question, then code block segmentation is performed after the
concatenation of the transport blocks. The maximum size of the code
blocks depends on whether convolutional coding or turbo coding is used
for the TrCH.

#### 4.2.2.1 Concatenation of transport blocks

The bits input to the transport block concatenation are denoted by
![](media/image27.wmf){width="1.3888888888888888in"
height="0.2638888888888889in"} where *i* is the TrCH number, *m* is the
transport block number, and *B~i~* is the number of bits in each block
(including CRC). The number of transport blocks on TrCH *i* is denoted
by *M~i~*. The bits after concatenation are denoted by
![](media/image28.wmf){width="1.1666666666666667in"
height="0.2638888888888889in"}, where *i* is the TrCH number and
*X~i~=M~i~B~i~*. They are defined by the following relations:

![](media/image29.wmf){width="0.5965277777777778in" height="0.25in"} *k
=* 1, 2*, ..., B~i~*

![](media/image30.wmf){width="0.9166666666666666in"
height="0.2638888888888889in"} *k = B~i~* *+* 1*, B~i~* *+* 2*, ...,*
2*B~i~*

![](media/image31.wmf){width="0.9583333333333334in"
height="0.2638888888888889in"} *k =* 2*B~i~* *+* 1, 2*B~i~* *+* 2*,
...,* 3*B~i~*

![](media/image32.wmf){width="0.19375in"
height="9.652777777777778e-2in"}

![](media/image33.wmf){width="1.3194444444444444in"
height="0.2638888888888889in"} *k =* (*M~i~* - 1)*B~i~* *+* 1*,* (*M~i~*
- 1)*B~i~* *+* 2*, ..., M~i~B~i~*

#### 4.2.2.2 Code block segmentation

Segmentation of the bit sequence from transport block concatenation is
performed if *X~i~\>Z.* The code blocks after segmentation are of the
same size. The number of code blocks on TrCH *i* is denoted by *C~i~*.
If the number of bits input to the segmentation, *X~i~*, is not a
multiple of *C~i~*, filler bits are added to the beginning of the first
block. If turbo coding is selected and *X~i~ \<* 40, filler bits are
added to the beginning of the code block. The filler bits are
transmitted and they are always set to 0. The maximum code block sizes
are:

\- convolutional coding: *Z* = 504;

\- turbo coding: *Z* = 5114.

The bits output from code block segmentation, for *C~i~* ≠ 0, are
denoted by ![](media/image34.wmf){width="1.3194444444444444in"
height="0.2638888888888889in"}, where *i* is the TrCH number, *r* is the
code block number, and *K~i~* is the number of bits per code block.

Number of code blocks:

Number of bits in each code block (applicable for *C~i~* ≠ 0 only):

if *X~i~* \< 40 and Turbo coding is used, then

*K~i~* = 40

else

*K~i~ = X~i~ / C~i~*

end if

Number of filler bits: *Y~i~ = C~i~K~i~ - X~i~*

for *k =* 1 to *Y~i\ ~*\-- Insertion of filler bits

![](media/image36.wmf){width="0.45902777777777776in" height="0.2125in"}

end for

for *k = Y~i~+*1 to *K~i~*

![](media/image37.wmf){width="0.8611111111111112in"
height="0.2638888888888889in"}

end for

*r =* 2 \-- Segmentation

while *r ≤ C~i~*

for *k =* 1 to *K~i~*

![](media/image38.wmf){width="1.25in"
height="0.2638888888888889in"}*~I~*

end for

*r = r+*1

end while

### 4.2.3 Channel coding

Code blocks are delivered to the channel coding block. They are denoted
by ![](media/image39.wmf){width="1.3194444444444444in"
height="0.2638888888888889in"}, where *i* is the TrCH number, *r* is the
code block number, and *K~i~* is the number of bits in each code block.
The number of code blocks on TrCH *i* is denoted by *C~i~*. After
encoding the bits are denoted by
![](media/image40.wmf){width="1.4305555555555556in"
height="0.2638888888888889in"}, where *Y~i~* is the number of encoded
bits. The relation between *o~irk~* and *y~irk~* and between *K~i~* and
*Y~i~* is dependent on the channel coding scheme.

The following channel coding schemes can be applied to TrCHs:

\- convolutional coding;

\- turbo coding.

Usage of coding scheme and coding rate for the different types of TrCH
is shown in table 1.

The values of *Y~i~* in connection with each coding scheme:

\- convolutional coding with rate 1/2: *Y~i~* = 2*\*K~i~ +* 16; rate
1/3: *Y~i~* = 3*\*K~i~ +* 24;

\- turbo coding with rate 1/3: *Y~i~* = 3*\*K~i~ +* 12.

Table 1: Usage of channel coding scheme and coding rate

  -------------- ---------------------- -------------
  Type of TrCH   Coding scheme          Coding rate
  BCH            Convolutional coding   1/2
  PCH                                   
  RACH                                  
  DCH, FACH                             1/3, 1/2
                 Turbo coding^\*^       1/3
  -------------- ---------------------- -------------

\* For DCH, turbo coding is not allowed when DL\_DCH\_FET\_Config is
configured by higher layers.

#### 4.2.3.1 Convolutional coding

Convolutional codes with constraint length 9 and coding rates 1/3 and
1/2 are defined.

The configuration of the convolutional coder is presented in figure 3.

Output from the rate 1/3 convolutional coder shall be done in the order
output0, output1, output2, output0, output1, output 2, output
0,...,output2. Output from the rate 1/2 convolutional coder shall be
done in the order output 0, output 1, output 0, output 1, output 0, ...,
output 1.

8 tail bits with binary value 0 shall be added to the end of the code
block before encoding.

The initial value of the shift register of the coder shall be \"all 0\"
when starting to encode the input bits.

![](media/image41.wmf){width="6.692361111111111in"
height="3.5854166666666667in"}

Figure 3: Rate 1/2 and rate 1/3 convolutional coders

#### 4.2.3.2 Turbo coding

##### 4.2.3.2.1 Turbo coder

The scheme of Turbo coder is a Parallel Concatenated Convolutional Code
(PCCC) with two 8-state constituent encoders and one Turbo code internal
interleaver. The coding rate of Turbo coder is 1/3. The structure of
Turbo coder is illustrated in figure 4.

The transfer function of the 8-state constituent code for PCCC is:

*G*(*D*) = ![](media/image42.wmf){width="0.69375in"
height="0.5555555555555556in"},

where

*g*~0~(*D*) = 1 + *D*^2^ + *D*^3^,

*g*~1~(*D*) = 1 + *D* + *D*^3^.

The initial value of the shift registers of the 8-state constituent
encoders shall be all zeros when starting to encode the input bits.

Output from the Turbo coder is

*x*~1~, *z*~1~, *z*\'~1~, *x*~2~, *z*~2~, *z*\'~2~, ..., *x~K~*, *z~K~*,
*z*\'*~K~*,

where *x*~1~, *x*~2~, ..., *x~K~* are the bits input to the Turbo coder
i.e. both first 8-state constituent encoder and Turbo code internal
interleaver, and *K* is the number of bits, and *z*~1~, *z*~2~, ...,
*z~K~* and *z*\'~1~, *z*\'~2~, ..., *z*\'*~K~* are the bits output from
first and second 8-state constituent encoders, respectively.

The bits output from Turbo code internal interleaver are denoted by
*x*\'~1~, *x*\'~2~, ..., *x*\'*~K~*, and these bits are to be input to
the second 8-state constituent encoder.

![](media/image43.wmf){width="4.33125in" height="2.9916666666666667in"}

Figure 4: Structure of rate 1/3 Turbo coder (dotted lines apply for
trellis termination only)

##### 4.2.3.2.2 Trellis termination for Turbo coder

Trellis termination is performed by taking the tail bits from the shift
register feedback after all information bits are encoded. Tail bits are
padded after the encoding of information bits.

The first three tail bits shall be used to terminate the first
constituent encoder (upper switch of figure 4 in lower position) while
the second constituent encoder is disabled. The last three tail bits
shall be used to terminate the second constituent encoder (lower switch
of figure 4 in lower position) while the first constituent encoder is
disabled.

The transmitted bits for trellis termination shall then be:

*x~K~*~+1~, *z~K~*~+1~, *x~K~*~+2~, *z~K~*~+2~, *x~K~*~+3~, *z~K~*~+3~,
*x*\'~*K*+1~, *z*\'~*K*+1~, *x*\'~*K*+2~, *z*\'~*K*+2~, *x*\'~*K*+3~,
*z*\'~*K*+3~.

##### 4.2.3.2.3 Turbo code internal interleaver

The Turbo code internal interleaver consists of bits-input to a
rectangular matrix with padding, intra-row and inter-row permutations of
the rectangular matrix, and bits-output from the rectangular matrix with
pruning. The bits input to the Turbo code internal interleaver are
denoted by ![](media/image44.wmf){width="1.0416666666666667in"
height="0.25in"}, where *K* is the integer number of the bits and takes
one value of 40 ![](media/image45.wmf){width="0.1388888888888889in"
height="0.16666666666666666in"} *K*
![](media/image45.wmf){width="0.1388888888888889in"
height="0.16666666666666666in"} 5114. The relation between the bits
input to the Turbo code internal interleaver and the bits input to the
channel coding is defined by
![](media/image46.wmf){width="0.5694444444444444in" height="0.25in"} and
*K* = *K~i~*.

The following subclause specific symbols are used in subclauses
4.2.3.2.3.1 to 4.2.3.2.3.3:

> *K* Number of bits input to Turbo code internal interleaver
>
> *R* Number of rows of rectangular matrix
>
> *C* Number of columns of rectangular matrix
>
> *p* Prime number
>
> *v* Primitive root
>
> ![](media/image47.wmf){width="0.9722222222222222in"
> height="0.2638888888888889in"} Base sequence for intra-row permutation
>
> *q~i~* Minimum prime integers
>
> *r~i~* Permuted prime integers
>
> ![](media/image48.wmf){width="0.9722222222222222in"
> height="0.3055555555555556in"} Inter-row permutation pattern
>
> ![](media/image49.wmf){width="1.0694444444444444in"
> height="0.3333333333333333in"} Intra-row permutation pattern of *i*-th
> row
>
> *i* Index of row number of rectangular matrix
>
> *j* Index of column number of rectangular matrix
>
> *k* Index of bit sequence

##### 4.2.3.2.3.1 Bits-input to rectangular matrix with padding {#bits-input-to-rectangular-matrix-with-padding .H6}

The bit sequence ![](media/image44.wmf){width="1.0416666666666667in"
height="0.25in"} input to the Turbo code internal interleaver is written
into the rectangular matrix as follows.

\(1\) Determine the number of rows of the rectangular matrix, *R*, such
that:

![](media/image50.wmf){width="2.888888888888889in"
height="0.6666666666666666in"}.

The rows of rectangular matrix are numbered 0, 1, ..., *R* - 1 from top
to bottom.

\(2\) Determine the prime number to be used in the intra-permutation,
*p*, and the number of columns of rectangular matrix, *C*, such that:

if (481 ![](media/image45.wmf){width="0.1388888888888889in"
height="0.16666666666666666in"} *K*
![](media/image45.wmf){width="0.1388888888888889in"
height="0.16666666666666666in"} 530) then

*p = 53* and *C* = *p*.

else

Find minimum prime number *p* from table 2 such that

![](media/image51.wmf){width="0.875in" height="0.20833333333333334in"},

and determine *C* such that

![](media/image52.wmf){width="2.3194444444444446in"
height="0.6527777777777778in"}.

end if

The columns of rectangular matrix are numbered 0, 1, ..., *C* - 1 from
left to right.

Table 2: List of prime number *p* and associated primitive root *v*

  ----- ----- ----- ----- ----- ----- ----- ----- ----- -----
  *p*   *v*   *p*   *v*   *p*   *v*   *p*   *v*   *p*   *v*
  7     3     47    5     101   2     157   5     223   3
  11    2     53    2     103   5     163   2     227   2
  13    2     59    2     107   2     167   5     229   6
  17    3     61    2     109   6     173   2     233   3
  19    2     67    2     113   3     179   2     239   7
  23    5     71    7     127   3     181   2     241   7
  29    2     73    5     131   2     191   19    251   6
  31    3     79    3     137   3     193   5     257   3
  37    2     83    2     139   2     197   2           
  41    6     89    3     149   2     199   3           
  43    3     97    5     151   6     211   2           
  ----- ----- ----- ----- ----- ----- ----- ----- ----- -----

\(3\) Write the input bit sequence
![](media/image44.wmf){width="1.0416666666666667in" height="0.25in"}
into the *R* ![](media/image53.wmf){width="0.125in"
height="0.1388888888888889in"}*C* rectangular matrix row by row starting
with bit *y*~1~ in column 0 of row 0:

![](media/image54.wmf){width="2.7222222222222223in" height="0.875in"}

> where *y*~k~ = *x*~k~ for *k* = 1, 2, ..., *K* and if
> *R*![](media/image53.wmf){width="0.125in"
> height="0.1388888888888889in"}*C*![](media/image55.wmf){width="0.125in"
> height="0.125in"}*K*, the dummy bits are padded such that
> ![](media/image56.wmf){width="0.6111111111111112in"
> height="0.20833333333333334in"} for *k* = *K* + 1, *K* + 2, ...,
> *R*![](media/image53.wmf){width="0.125in"
> height="0.1388888888888889in"}*C*. These dummy bits are pruned away
> from the output of the rectangular matrix after intra-row and
> inter-row permutations.

##### 4.2.3.2.3.2 Intra-row and inter-row permutations {#intra-row-and-inter-row-permutations .H6}

After the bits-input to the *R*![](media/image53.wmf){width="0.125in"
height="0.1388888888888889in"}*C* rectangular matrix, the intra-row and
inter-row permutations for the *R*![](media/image53.wmf){width="0.125in"
height="0.1388888888888889in"}*C* rectangular matrix are performed
stepwise by using the following algorithm with steps (1) -- (6):

\(1\) Select a primitive root *v* from table 2 in clause 4.2.3.2.3.1,
which is indicated on the right side of the prime number *p*.

\(2\) Construct the base sequence
![](media/image47.wmf){width="0.9722222222222222in"
height="0.2638888888888889in"} for intra-row permutation as:

![](media/image57.wmf){width="1.4583333333333333in"
height="0.20833333333333334in"}, *j* = 1, 2,..., (*p* - 2), and *s*(0) =
1.

\(3\) Assign *q*~0~ = 1 to be the first prime integer in the sequence
![](media/image58.wmf){width="0.8333333333333334in"
height="0.2638888888888889in"}, and determine the prime integer *q~i~*
in the sequence ![](media/image58.wmf){width="0.8333333333333334in"
height="0.2638888888888889in"} to be a least prime integer such that
g.c.d(*q~i~*, *p* - 1) = 1*,* *q~i~* \> 6, and *q~i~* \>
*q*~(*i*\ -\ 1)~ for each *i* = 1, 2, ..., *R* -- 1. Here g.c.d. is
greatest common divisor.

\(4\) Permute the sequence
![](media/image58.wmf){width="0.8333333333333334in"
height="0.2638888888888889in"} to make the sequence
![](media/image59.wmf){width="0.8055555555555556in"
height="0.2638888888888889in"} such that

*r~T~*~(*i*)~ = *q~i~*, *i* = 0, 1, ..., *R* - 1,

> where ![](media/image48.wmf){width="0.9722222222222222in"
> height="0.3055555555555556in"} is the inter-row permutation pattern
> defined as the one of the four kind of patterns, which are shown in
> table 3, depending on the number of input bits *K*.

Table 3: Inter-row permutation patterns for Turbo code internal
interleaver

+-----------------------+--------------------+-----------------------+
| Number of input bits  | Number of rows *R* | Inter-row permutation |
|                       |                    | patterns              |
| *K*                   |                    |                       |
|                       |                    | \<*T*(0), *T*(1),     |
|                       |                    | ..., *T*(*R* - 1)\>   |
+-----------------------+--------------------+-----------------------+
| (40![](media/image60  | 5                  | \<4, 3, 2, 1, 0\>     |
| .wmf){width="0.125in" |                    |                       |
| height="              |                    |                       |
| 0.1527777777777778in" |                    |                       |
| }*K*![](media/image60 |                    |                       |
| .wmf){width="0.125in" |                    |                       |
| height="0.152         |                    |                       |
| 7777777777778in"}159) |                    |                       |
+-----------------------+--------------------+-----------------------+
| (160![](media/image60 | 10                 | \<9, 8, 7, 6, 5, 4,   |
| .wmf){width="0.125in" |                    | 3, 2, 1, 0\>          |
| height="              |                    |                       |
| 0.1527777777777778in" |                    |                       |
| }*K*![](media/image60 |                    |                       |
| .wmf){width="0.125in" |                    |                       |
| height="0.152         |                    |                       |
| 7777777777778in"}200) |                    |                       |
| or                    |                    |                       |
| (481![](media/image60 |                    |                       |
| .wmf){width="0.125in" |                    |                       |
| height="              |                    |                       |
| 0.1527777777777778in" |                    |                       |
| }*K*![](media/image60 |                    |                       |
| .wmf){width="0.125in" |                    |                       |
| height="0.152         |                    |                       |
| 7777777777778in"}530) |                    |                       |
+-----------------------+--------------------+-----------------------+
| (                     | 20                 | \<19, 9, 14, 4, 0, 2, |
| 2281![](media/image60 |                    | 5, 7, 12, 18, 16, 13, |
| .wmf){width="0.125in" |                    | 17, 15, 3, 1, 6, 11,  |
| height="              |                    | 8, 10\>               |
| 0.1527777777777778in" |                    |                       |
| }*K*![](media/image60 |                    |                       |
| .wmf){width="0.125in" |                    |                       |
| height="0.1527        |                    |                       |
| 777777777778in"}2480) |                    |                       |
| or                    |                    |                       |
| (                     |                    |                       |
| 3161![](media/image60 |                    |                       |
| .wmf){width="0.125in" |                    |                       |
| height="              |                    |                       |
| 0.1527777777777778in" |                    |                       |
| }*K*![](media/image60 |                    |                       |
| .wmf){width="0.125in" |                    |                       |
| height="0.1527        |                    |                       |
| 777777777778in"}3210) |                    |                       |
+-----------------------+--------------------+-----------------------+
| *K* = any other value | 20                 | \<19, 9, 14, 4, 0, 2, |
|                       |                    | 5, 7, 12, 18, 10, 8,  |
|                       |                    | 13, 17, 3, 1, 16, 6,  |
|                       |                    | 15, 11\>              |
+-----------------------+--------------------+-----------------------+

\(5\) Perform the *i*-th (*i* = 0, 1, ..., *R* - 1) intra-row
permutation as:

if (*C* = *p*) then

![](media/image61.wmf){width="1.6388888888888888in"
height="0.20833333333333334in"}, *j* = 0, 1, ..., (*p* - 2), and
*U~i~*(*p* - 1) = 0,

where *U~i~*(*j*) is the original bit position of *j*-th permuted bit of
*i*-th row.

end if

if (*C* = *p* + 1) then

> ![](media/image61.wmf){width="1.6388888888888888in"
> height="0.20833333333333334in"}, *j* = 0, 1, ..., (*p* - 2).
> *U~i~*(*p* - 1) = 0, and *U~i~*(*p*) = *p*,
>
> where *U~i~*(*j*) is the original bit position of *j*-th permuted bit
> of *i*-th row, and

if (*K* = *R*![](media/image53.wmf){width="0.125in"
height="0.1388888888888889in"}*C*) then

Exchange *U~R~*~-1~(*p*) with *U~R~*~-1~(0).

end if

end if

if (*C* = *p* - 1) then

![](media/image62.wmf){width="1.8194444444444444in"
height="0.20833333333333334in"}, *j* = 0, 1, ..., (*p* - 2),

where *U~i~*(*j*) is the original bit position of *j*-th permuted bit of
*i*-th row.

end if

\(6\) Perform the inter-row permutation for the rectangular matrix based
on the pattern ![](media/image48.wmf){width="0.9722222222222222in"
height="0.3055555555555556in"},

where *T*(*i*) is the original row position of the *i*-th permuted row.

##### 4.2.3.2.3.3 Bits-output from rectangular matrix with pruning {#bits-output-from-rectangular-matrix-with-pruning .H6}

After intra-row and inter-row permutations, the bits of the permuted
rectangular matrix are denoted by *y*\'*~k~*:

![](media/image63.wmf){width="2.3194444444444446in" height="0.875in"}

The output of the Turbo code internal interleaver is the bit sequence
read out column by column from the intra-row and inter-row permuted *R*
![](media/image64.wmf){width="0.125in" height="0.125in"} *C* rectangular
matrix starting with bit *y*\'~1~ in row 0 of column 0 and ending with
bit *y*\'*~CR~* in row *R* - 1 of column *C* - 1. The output is pruned
by deleting dummy bits that were padded to the input of the rectangular
matrix before intra-row and inter row permutations, i.e. bits *y*\'*~k~*
that corresponds to bits *y~k~* with *k \> K* are removed from the
output. The bits output from Turbo code internal interleaver are denoted
by *x*\'~1~, *x*\'~2~, ..., *x*\'*~K~*, where *x*\'~1~ corresponds to
the bit *y*\'*~k~* with smallest index *k* after pruning, *x*\'~2~ to
the bit *y*\'*~k~* with second smallest index *k* after pruning, and so
on. The number of bits output from Turbo code internal interleaver is
*K* and the total number of pruned bits is:

*R* ![](media/image53.wmf){width="0.125in"
height="0.1388888888888889in"} *C* -- *K*.

#### 4.2.3.3 Concatenation of encoded blocks

After the channel coding for each code block, if *C~i~* is greater than
1, the encoded blocks are serially concatenated so that the block with
lowest index *r* is output first from the channel coding block,
otherwise the encoded block is output from channel coding block as it
is. The bits output are denoted by
![](media/image65.wmf){width="1.125in" height="0.2638888888888889in"},
where *i* is the TrCH number and *E~i~* = *C~i~Y~i~*. The output bits
are defined by the following relations:

![](media/image66.wmf){width="0.625in" height="0.25in"} *k =* 1, 2*,
..., Y~i~*

![](media/image67.wmf){width="0.9166666666666666in"
height="0.2638888888888889in"} *k = Y~i~* *+* 1*, Y~i~* *+* 2*, ...,*
2*Y~i~*

![](media/image68.wmf){width="0.9722222222222222in"
height="0.2638888888888889in"} *k =* 2*Y~i~* *+* 1, 2*Y~i~* *+* 2*,
...,* 3*Y~i~*

![](media/image32.wmf){width="0.19375in"
height="9.652777777777778e-2in"}

![](media/image69.wmf){width="1.2361111111111112in"
height="0.2638888888888889in"} *k =* (*C~i~* - 1)*Y~i~* *+* 1*,* (*C~i~*
- 1)*Y~i~* *+* 2*, ..., C~i~Y~i~*

If no code blocks are input to the channel coding (*C~i~* = 0), no bits
shall be output from the channel coding, i.e. *E~i~* = 0.

### 4.2.4 Radio frame size equalisation

Radio frame size equalisation is padding the input bit sequence in order
to ensure that the output can be segmented in *F~i~* data segments of
same size as described in subclause 4.2.7. Radio frame size equalisation
is only performed in the UL.

The input bit sequence to the radio frame size equalisation is denoted
by![](media/image70.wmf){width="1.1527777777777777in"
height="0.2638888888888889in"}, where *i* is TrCH number and *E~i~* the
number of bits. The output bit sequence is denoted
by![](media/image71.wmf){width="1.0416666666666667in"
height="0.2638888888888889in"}, where *T~i~* is the number of bits. The
output bit sequence is derived as follows:

\- *t~ik~* = *c~ik~*~,~ for k = 1... *E~i~*; and

\- *t~ik~* = {0, 1} for k= *E~i~* +1... *T~i~*, if *E~i~* \< *T~i~*;

where

\- T*~i~* = *F~i~* \* *N~i~*; and

\- ![](media/image72.wmf){width="0.8006944444444445in"
height="0.20833333333333334in"} is the number of bits per segment after
size equalisation.

### 4.2.5 1^st^ interleaving

#### 4.2.5.1 Void

#### 4.2.5.2 1^st^ interleaver operation

The 1^st^ interleaving is a block interleaver with inter-column
permutations. The input bit sequence to the block interleaver is denoted
by ![](media/image73.wmf){width="1.3194444444444444in"
height="0.2638888888888889in"}, where *i* is TrCH number and *X~i~* the
number of bits. Here *X~i~* is guaranteed to be an integer multiple of
*F~i~*. The output bit sequence from the block interleaver is derived as
follows:

\(1\) Select the number of columns C1 from Table 4 or 4A depending on
the TTI. The columns are numbered 0, 1, ..., C1 - 1 from left to right.
Table 4A is used in uplink when UL\_DPCH\_10ms\_Mode is configured by
higher layers, and Table 4 is used in all other cases.

\(2\) Determine the number of rows of the matrix, R1 defined as

R1 = *X~i\ ~*/ C1.

The rows of the matrix are numbered 0, 1, ..., R1 - 1 from top to
bottom.

\(3\) Write the input bit sequence into the R1
![](media/image53.wmf){width="0.125in" height="0.1388888888888889in"} C1
matrix row by row starting with bit
![](media/image74.wmf){width="0.2361111111111111in"
height="0.2638888888888889in"} in column 0 of row 0 and ending with bit
![](media/image75.wmf){width="0.5416666666666666in"
height="0.2638888888888889in"} in column C1 - 1 of row R1 - 1:

![](media/image76.wmf){width="3.6527777777777777in"
height="1.0277777777777777in"}

\(4\) Perform the inter-column permutation for the matrix based on the
pattern ![](media/image77.wmf){width="1.2916666666666667in"
height="0.3055555555555556in"} shown in table 4, where P1~C1~ (*j*) is
the original column position of the *j*-th permuted column. After
permutation of the columns, the bits are denoted by *y~ik~*:

![](media/image78.wmf){width="2.9305555555555554in"
height="1.0277777777777777in"}

\(5\) Read the output bit sequence
![](media/image79.wmf){width="1.5833333333333333in"
height="0.2638888888888889in"} of the block interleaver column by column
from the inter-column permuted R1 ![](media/image53.wmf){width="0.125in"
height="0.1388888888888889in"} C1 matrix. Bit
![](media/image80.wmf){width="0.2361111111111111in"
height="0.2638888888888889in"} corresponds to row 0 of column 0 and bit
![](media/image81.wmf){width="0.5555555555555556in"
height="0.2638888888888889in"} corresponds to row R1 - 1 of column C1 -
1.

Table 4: Inter-column permutation patterns for 1st interleaving for
downlink, and for uplink when UL\_DPCH\_10ms\_Mode is not configured by
higher layers

+-------+----------------------+---------------------------------------------+
| TTI   | Number of columns C1 | Inter-column permutation patterns           |
|       |                      |                                             |
|       |                      | \<P1~C1~(0), P1~C1~(1), ..., P1~C1~(C1-1)\> |
+-------+----------------------+---------------------------------------------+
| 10 ms | 1                    | \<0\>                                       |
+-------+----------------------+---------------------------------------------+
| 20 ms | 2                    | \<0,1\>                                     |
+-------+----------------------+---------------------------------------------+
| 40 ms | 4                    | \<0,2,1,3\>                                 |
+-------+----------------------+---------------------------------------------+
| 80 ms | 8                    | \<0,4,2,6,1,5,3,7\>                         |
+-------+----------------------+---------------------------------------------+

Table 4A: Inter-column permutation patterns for 1st interleaving for
uplink when UL\_DPCH\_10ms\_Mode is configured by higher layers

+-------+----------------------+---------------------------------------------+
| TTI   | Number of columns C1 | Inter-column permutation patterns           |
|       |                      |                                             |
|       |                      | \<P1~C1~(0), P1~C1~(1), ..., P1~C1~(C1-1)\> |
+-------+----------------------+---------------------------------------------+
| 20 ms | 1                    | \<0\>                                       |
+-------+----------------------+---------------------------------------------+
| 40 ms | 2                    | \<0,1\>                                     |
+-------+----------------------+---------------------------------------------+
| 80 ms | 4                    | \<0,2,1,3\>                                 |
+-------+----------------------+---------------------------------------------+

#### 4.2.5.3 Relation between input and output of 1^st^ interleaving in uplink

The bits input to the 1^st^ interleaving are denoted by
![](media/image82.wmf){width="1.1527777777777777in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *T~i~*
the number of bits. Hence, x*~i,k~ = t~i,k~* and X*~i~* *=* *T~i~*.

The bits output from the 1^st^ interleaving are denoted by
![](media/image83.wmf){width="1.3333333333333333in"
height="0.2638888888888889in"}, and d*~i,k~ = y~i,k~*.

#### 4.2.5.4 Relation between input and output of 1^st^ interleaving in downlink

If fixed positions of the TrCHs in a radio frame is used then the bits
input to the 1^st^ interleaving are denoted by
![](media/image84.wmf){width="1.2083333333333333in"
height="0.2638888888888889in"}, where *i* is the TrCH number. Hence,
x*~ik~ = h~ik~* and X*~i~ = D~i~*.

If flexible positions of the TrCHs in a radio frame is used then the
bits input to the 1^st^ interleaving are denoted by
![](media/image85.wmf){width="1.2361111111111112in"
height="0.2638888888888889in"}, where *i* is the TrCH number. Hence,
x*~ik~ = g~ik~* and X*~i~ = G~i~*.

The bits output from the 1^st^ interleaving are denoted by
![](media/image86.wmf){width="1.1805555555555556in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *Q~i~*
is the number of bits. Hence, *q~ik~ = y~ik~*, *Q~i~* = *F~i~H~i~* if
fixed positions are used, and *Q~i~* = *G~i~* if flexible positions are
used. *H~i~* is defined in subclause 4.2.9.1.

### 4.2.6 Radio frame segmentation

When the transmission time interval is longer than 10 ms, the input bit
sequence is segmented and mapped onto *F~i~* segments. Following rate
matching in the DL and radio frame size equalisation in the UL the input
bit sequence length is guaranteed to be an integer multiple of *F~i~*.

The input bit sequence is denoted by
![](media/image87.wmf){width="1.1666666666666667in"
height="0.2638888888888889in"} where *i* is the TrCH number and *X~i~*
is the number bits. The *F~i~* output bit sequences per TTI are denoted
by ![](media/image88.wmf){width="1.6666666666666667in"
height="0.2638888888888889in"}where *n~i~* is the segment number and
*Y~i~* is the number of bits per radio frame for TrCH *i*. The output
sequences are defined as follows:

![](media/image89.wmf){width="0.3333333333333333in"
height="0.2638888888888889in"}=
![](media/image90.wmf){width="0.7083333333333334in"
height="0.2638888888888889in"}, *n~i~* = 1...*F~i~*, *k* = 1...*Y~i~*

where

*Y~i~* = (*X~i~* / *F~i~*) is the number of bits per segment.

In downlink, the *n~i~* -th segment is mapped to the radio frame *n~i~*
-1 of the transmission time interval.

In uplink when UL\_DPCH\_10ms\_Mode is not configured by higher layers,
the *n~i~* -th segment, 1 ≤ *n~i~* ≤ *F~i~* is mapped to radio frame
*n~i~* -1 of the transmission time interval.

In uplink when UL\_DPCH\_10ms\_Mode is configured by higher layers, the
*n~i~*^th^ segment, 1 ≤ *n~i~* ≤ *F~i~*, is mapped to theradio frame
2*n~i\ ~*-- 2 of the transmission time interval. No bits are input to
the radio frame 2*n~i\ ~*-- 1.

#### 4.2.6.1 Relation between input and output of the radio frame segmentation block in uplink

The input bit sequence to the radio frame segmentation is denoted by
![](media/image91.wmf){width="1.2361111111111112in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *T~i~*
the number of bits. Hence, *x~ik~ = d~ik~* and *X~i~ = T~i~*.

The output bit sequence corresponding to radio frame *n~i~* is denoted
by ![](media/image92.wmf){width="1.125in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *N~i~*
is the number of bits. Hence,
![](media/image93.wmf){width="0.7083333333333334in"
height="0.2638888888888889in"}and *N~i~ = Y~i~*.

#### 4.2.6.2 Relation between input and output of the radio frame segmentation block in downlink

The bits input to the radio frame segmentation are denoted by
![](media/image94.wmf){width="1.1805555555555556in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *Q~i~*
the number of bits. Hence, *x~ik~ = q~ik~* and *X~i~ = Q~i~*.

The output bit sequence corresponding to radio frame *n~i~* is denoted
by ![](media/image95.wmf){width="1.25in" height="0.2638888888888889in"},
where *i* is the TrCH number and *V~i~* is the number of bits. Hence,
![](media/image96.wmf){width="0.7222222222222222in"
height="0.2638888888888889in"}and *V~i~ = Y~i~*.

### 4.2.7 Rate matching

Rate matching means that bits on a transport channel are repeated or
punctured. Higher layers assign a rate-matching attribute for each
transport channel. This attribute is semi-static and can only be changed
through higher layer signalling. The rate-matching attribute is used
when the number of bits to be repeated or punctured is calculated.

The number of bits on a transport channel can vary between different
transmission time intervals. In the downlink the transmission is
interrupted if the number of bits is lower than maximum. When the number
of bits between different transmission time intervals in uplink is
changed, bits are repeated or punctured to ensure that the total bit
rate after TrCH multiplexing is identical to the total channel bit rate
of the allocated dedicated physical channels.

If no bits are input to the rate matching for all TrCHs within a CCTrCH,
the rate matching shall output no bits for all TrCHs within the CCTrCH
and no uplink DPDCH will be selected in the case of uplink rate
matching.

**Notation used in subclause 4.2.7 and subclauses:**

*N~i,j~:* For uplink: Number of bits in a radio frame before rate
matching on TrCH *i* with transport format combination *j* . When
UL\_DPCH\_10ms Mode is configured by higher layers, the derivation of
*N~i,j~* is described in detail in subclauses 4.2.6 and 4.2.6.1.

For downlink: An intermediate calculation variable (not an integer but a
multiple of 1/8).

![](media/image97.wmf){width="0.31875in"
height="0.2569444444444444in"}*:* Number of bits in a transmission time
interval before rate matching on TrCH *i* with transport format *l*.
Used in downlink only.

![](media/image98.wmf){width="0.3576388888888889in"
height="0.24375in"}*:* For uplink: If positive - number of bits that
should be repeated in each radio frame on TrCH *i* with transport format
combination *j*.

If negative - number of bits that should be punctured in each radio
frame on TrCH *i* with transport format combination *j*.

For downlink : An intermediate calculation variable (not an integer but
a multiple of 1/8).

![](media/image99.wmf){width="0.4076388888888889in"
height="0.2569444444444444in"}*:* If positive - number of bits to be
repeated in each transmission time interval on TrCH *i* with transport
format *l*.

If negative - number of bits to be punctured in each transmission time
interval on TrCH *i* with transport format *l*.

Used in downlink only.

*N~TGL~*: Positive or null: number of bits in the radio frame
corresponding to the gap for compressed mode for the CCTrCH.

*RM~i~:* Semi-static rate matching attribute for transport channel *i*.
*RM~i~* is provided by higher layers or takes a value as indicated in
subclause 4.2.13 or subclause 4.2.0.

*PL:* Puncturing limit for uplink. This value limits the amount of
puncturing that can be applied in order to avoid multicode or to enable
the use of a higher spreading factor. Signalled from higher layers. The
allowed puncturing in % is actually equal to (1-PL)\*100.

*N~data,j~:* Total number of bits that are available for the CCTrCH in a
radio frame with transport format combination *j*.

*I:* Number of TrCHs in the CCTrCH.

*Z~i,j~:* Intermediate calculation variable.

*F~i~:* Number of radio frames in the transmission time interval of TrCH
*i,* except for uplink when UL\_DPCH\_10ms\_Mode is configured. In
uplink, when UL\_DPCH\_10ms\_Mode is configured, *F~i~ is the number of
radio frames in the transmission time interval of TrCH i divided by 2*.

*n~i~:* Radio frame number in the transmission time interval of TrCH
*i*. In downlink, and in uplink when UL\_DPCH\_10ms\_Mode is not
configured by higher layers, *0 ≤ n~i~ \< F~i~*. In uplink when
UL\_DPCH\_10ms\_Mode is configured by higher layers, *0 ≤ n~i~ \<
2F~i~*.

*q:* Average puncturing or repetition distance (normalised to only show
the remaining rate matching on top of an integer number of repetitions).
Used in uplink only.

P1*~F~(n~i~):* The column permutation function of the 1^st^ interleaver,
P1*~F~*(x) is the original position of column with number x after
permutation. P1 is defined on table 4 of clause 4.2.5.2 (note that the
P1~F~ is self-inverse). Used for rate matching in uplink only.

*S*\[*n*\]*:* The shift of the puncturing or repetition pattern for
radio frame *n~i~* when
![](media/image100.wmf){width="0.8465277777777778in"
height="0.2534722222222222in"}. Used in uplink only.

*TF~i~*(*j*)*:* Transport format of TrCH *i* for the transport format
combination *j*.

*TFS*(*i*) The set of transport format indexes *l* for TrCH *i*.

*TFCS* The set of transport format combination indexes *j.*

*e~ini\ ~* Initial value of variable *e* in the rate matching pattern
determination algorithm of subclause 4.2.7.5.

e~plus~ Increment of variable *e* in the rate matching pattern
determination algorithm of subclause4.2.7.5.

e~minus~ Decrement of variable *e* in the rate matching pattern
determination algorithm of subclause 4.2.7.5.

*b:* Indicates systematic and parity bits

*b*=1: Systematic bit. *x~k~* in subclause 4.2.3.2.1.

*b*=2: 1^st^ parity bit (from the upper Turbo constituent encoder).
*z~k~* in subcaluse 4.2.3.2.1.

*b*=3: 2^nd^ parity bit (from the lower Turbo constituent encoder).
*z*\'*~k~* in subclause 4.2.3.2.1.

The \* (star) notation is used to replace an index *x* when the indexed
variable *X~x~* does not depend on the index *x.* In the left wing of an
assignment the meaning is that \"*X~\*~* = *Y*\" is equivalent to
\"**for all** *[x]{.underline}* **do** *X~x~* = *Y* \". In the right
wing of an assignment, the meaning is that \"*Y* = *X~\*~* \" is
equivalent to \"**take any** *[x]{.underline}* **and do** *Y = X~x~*\".

The following relations, defined for all TFC *j*, are used when
calculating the rate matching parameters:

![](media/image101.wmf){width="0.5555555555555556in"
height="0.2638888888888889in"}

![](media/image102.wmf){width="2.4805555555555556in"
height="0.9423611111111111in"} for all *i* = 1 ... *I* (1)

![](media/image103.wmf){width="1.69375in" height="0.2638888888888889in"}
for all *i* = 1 ... *I*

#### 4.2.7.1 Determination of rate matching parameters in uplink

##### 4.2.7.1.1 Determination of SF and number of PhCHs needed

In uplink, puncturing can be applied to match the CCTrCH bit rate to the
PhCH bit rate. The bit rate of the PhCH(s) is limited by the UE
capability and restrictions imposed by UTRAN, through limitations on the
PhCH spreading factor. The maximum amount of puncturing that can be
applied is 1-PL, PL is signalled from higher layers. The number of
available bits in the radio frames of one PhCH for all possible
spreading factors is given in \[2\]. Denote these values by *N~256~,
N~128~, N~64~, N~32~, N~16~, N~8~,* and *N~4~,* where the index refers
to the spreading factor. The possible number of bits available to the
CCTrCH on all PhCHs, *N~data~*, then are { *N*~256~, *N*~128~, *N*~64~,
*N*~32~, *N*~16~, *N*~8~, *N*~4,~ 2×*N*~4~, 3×*N*~4~, 4×*N*~4~,
5×*N*~4~*,* 6×*N*~4~}*.*

For a RACH CCTrCH SET0 represents the set of *N~data~* values allowed by
the UTRAN, as set by the minimum SF provided by higher layers. SET0 may
be a sub-set of { *N*~256~, *N*~128~, *N*~64~, *N*~32~ }. SET0 does not
take into account the UE's capability.

For other CCTrCHs, SET0 denotes the set of *N~data~* values allowed by
the UTRAN and supported by the UE, as part of the UE's capability. SET0
can be a subset of { *N*~256~, *N*~128~, *N*~64~, *N*~32~, *N*~16~,
*N*~8~, *N*~4,~ 2×*N*~4~, 3×*N*~4~, 4×*N*~4~, 5×*N*~4~*,* 6×*N*~4~}*.*
When UL DPCH 10ms Mode is configured, SET0 shall include *N~data~*
values associated with spreading factors larger than or equal to the
minimum SF provided by higher layers divided by 2. *N~data,\ j~* for the
transport format combination *j* is determined by executing the
following algorithm:

SET1 = { *N~data~* in SET0 such that
![](media/image104.wmf){width="2.8958333333333335in"
height="0.5513888888888889in"} is non negative }

If SET1 is not empty and the smallest element of SET1 requires just one
PhCH then

*N~data,j~* = min SET1

else

SET2 = { *N~data~* in SET0 such that
![](media/image105.wmf){width="3.307638888888889in"
height="0.5513888888888889in"} is non negative }

Sort SET2 in ascending order

*N~data\ ~*= min SET2

While *N~data~* is not the max of SET2 and the follower of
*N~data\ ~*requires no additional PhCH do

*N~data\ ~*= follower of *N~data~* in SET2

End while

*N~data~*~,*j*~ = *N~data~*

End if

For a RACH CCTrCH, if *N~data,j~* is not part of the UE's capability
then the TFC *j* cannot be used.

##### 4.2.7.1.2 Determination of parameters needed for calculating the rate matching pattern {#determination-of-parameters-needed-for-calculating-the-rate-matching-pattern .H6}

The number of bits to be repeated or punctured, *∆N~i,j~*, within one
radio frame for each TrCH *i* is calculated with equation 1 for all
possible transport format combinations *j* and selected every radio
frame. *N~data,j~* is given from subclause 4.2.7.1.1.

In a compressed radio frame when UL\_DPCH\_10ms\_Mode is not configured
by higher layers, ![](media/image106.wmf){width="0.44375in"
height="0.2777777777777778in"} is replaced
by![](media/image107.wmf){width="0.44375in"
height="0.2777777777777778in"} in Equation 1.
![](media/image107.wmf){width="0.44375in" height="0.2777777777777778in"}
is given as follows:

In a radio frame compressed by higher layer scheduling,
![](media/image108.wmf){width="0.44375in" height="0.2777777777777778in"}
is obtained by executing the algorithm in subclause 4.2.7.1.1 but with
the number of bits in one radio frame of one PhCH reduced to
![](media/image109.wmf){width="0.3055555555555556in" height="0.44375in"}
of the value in normal mode.

*N~tr~* is the number of transmitted slots in a compressed radio frame
and is defined by the following relation:

+----------------------------------+----------------------------------+
| ![](media/image110.w             | ![](media/image111.w             |
| mf){width="0.8229166666666666in" | mf){width="0.6465277777777778in" |
| height="1.0in"}                  | height="0.19375in"}, if          |
|                                  | *N~first~ + TGL* ≤ 15            |
|                                  |                                  |
|                                  | ![](media/image112.wm            |
|                                  | f){width="0.36527777777777776in" |
|                                  | height="0.2638888888888889in"},  |
|                                  | in first frame if *N~first~ +    |
|                                  | TGL* \> 15                       |
|                                  |                                  |
|                                  | ![](media/image113.w             |
|                                  | mf){width="1.1256944444444446in" |
|                                  | height="0.2638888888888889in"},  |
|                                  | in second frame if *N~first~ +   |
|                                  | TGL* \> 15                       |
+----------------------------------+----------------------------------+

*N~first~* and *TGL* are defined in subclause 4.4.

In a radio frame compressed by spreading factor reduction,
![](media/image114.wmf){width="1.8055555555555556in"
height="0.2777777777777778in"}, where
![](media/image115.wmf){width="1.625in" height="0.4305555555555556in"}

If *∆N~i,j~* = 0 then the output data of the rate matching is the same
as the input data and the rate matching algorithm of subclause 4.2.7.5
does not need to be executed.

If *∆N~i,j~* ≠ 0 the parameters listed in subclauses 4.2.7.1.2.1 and
4.2.7.1.2.2 shall be used for determining *e~ini~*, *e~plus~*, and
*e~minus~* (regardless if the radio frame is compressed or not).

##### 4.2.7.1.2.1 Convolutionally encoded TrCHs {#convolutionally-encoded-trchs .H6}

*R* = ∆*N~i~*~,*j*~ mod *N~i~*~,*j*~ \-- note: in this context
∆*N~i~*~,*j*~ mod *N~i~*~,*j*~ is in the range of 0 to *N~ij~*-1 i.e. -1
mod 10 = 9.

if *R* ≠ 0 and 2×*R* ≤ *N~ij~*

then q =  *N~i,j~* / *R* 

else

q =  *N~i~*~,*j*~ / (*R* - *N~i~*~,*j*~) 

endif

\-- note: q is a signed quantity.

if q is even

then q\' = q + gcd(q, *F~i~*)/ *F~i~* \-- where gcd (q, *F~i~*)
means greatest common divisor of q and *F~i~*

\-- note that q\' is not an integer, but a multiple of 1/8

else

q\' = q

endif

for *x* = 0 to *F~i~* - 1

S\[ *x*×q\'  mod *F~i~*\] = ( *x*×q\'  div *F~i~*)

end for

∆*N~i~* = ∆*N~i~*~,*j*~

a = 2

For each radio frame, the rate-matching pattern is calculated with the
algorithm in subclause 4.2.7.5, where :

*X~i~* = *N~i~*~,*j*~., and

*e~ini~* = (a×S\[P1*~Fi~*(*n~i~*)\]×\|∆*N~i~* \| + 1) mod (a⋅*N~ij~*).

*e*~plus~ = a×*N~i~*~,*j*~

*e*~minus~ = a×\|∆*N~i~*\|

puncturing for ∆*N* \<0, repetition otherwise.

##### 4.2.7.1.2.2 Turbo encoded TrCHs {#turbo-encoded-trchs .H6}

If repetition is to be performed on turbo encoded TrCHs, i.e. ∆*N~i,j~
\>*0, the parameters in subclause 4.2.7.1.2.1 are used.

If puncturing is to be performed, the parameters below shall be used.
Index *b* is used to indicate systematic (*b*=1), 1^st^ parity (*b*=2),
and 2^nd^ parity bit (*b*=3).

*a=2* when *b*=2

*a=1* when *b*=3

![](media/image116.wmf){width="1.7222222222222223in"
height="0.5277777777777778in"}

If ![](media/image117.wmf){width="0.2916666666666667in"
height="0.2222222222222222in"} is calculated as 0 for *b*=2 or *b*=3,
then the following procedure and the rate matching algorithm of
subclause 4.2.7.5 don\'t need to be performed for the corresponding
parity bit stream.

X~i~ = N~i,j~ /3 ,

q = X~i~ /\|∆N~i~\| 

if(q![](media/image118.wmf){width="0.1388888888888889in"
height="0.16666666666666666in"}2)

for *r=*0 to *F~i~*-1

S\[(3×*r*+b-1) mod *F~I~*\] = *r* mod 2;

end for

else

if *q* is even

then q\' = q -- *gcd(* q*,* *F~i~)*/ *F~i~* \-- where *gcd (* q*, F~i~)*
means greatest common divisor of q and *F~i~*\
\-- note that q\' is not an integer, but a multiple of 1/8

else q\' = q

endif

for *x*=0 to *F~i~* -1

r = *x*×q\' mod *F~i~*;

S\[(3×r+b-1) mod *F~i~*\] = *x*×q\' div *F~i~*;

endfor

endif

For each radio frame, the rate-matching pattern is calculated with the
algorithm in subclause 4.2.7.5, where:

*X~i~* is as above:

e~ini~ = (a×S\[P1*~Fi~*(*n~i~*)\] ×\|∆N~i~\| + X~i~) mod (a×*X~i~*), if
e~ini~ =0 then *e~ini~* = a×*X~i~*

e~plus~ = a×*X~i~*

e~minus~ = a×∆*N~i~*

#### 4.2.7.2 Determination of rate matching parameters in downlink

For downlink channels, *N~data,j~* does not depend on the transport
format combination *j*. *N~data,\*~* is given by the channelization
code(s) assigned by higher layers.

Denote the number of physical channels used for the CCTrCH by *P*.
*N~data,\*~* is the number of bits available to the CCTrCH in one radio
frame and defined as *N~data,\*~*=*P*×15×(*N~data~*~1~+*N~data~*~2~),
where *N~data1~* and *N~data2~* are defined in \[2\]. Note that contrary
to the uplink, the same rate matching patterns are used in TTIs
containing no compressed radio frames and in TTIs containing radio
frames compressed by spreading factor reduction or higher layer
scheduling.

##### 4.2.7.2.1 Determination of rate matching parameters for fixed positions of TrCHs

##### 4.2.7.2.1.1 Calculation of ∆*N~i~*~,max~ for normal mode and compressed mode by spreading factor reduction {#calculation-of-nimax-for-normal-mode-and-compressed-mode-by-spreading-factor-reduction .H6}

First an intermediate calculation variable
![](media/image119.wmf){width="0.2916666666666667in"
height="0.2638888888888889in"} is calculated for all transport channels
*i* by the following formula:

![](media/image120.wmf){width="1.5145833333333334in"
height="0.4263888888888889in"}

In order to compute the ![](media/image121.wmf){width="0.44375in"
height="0.2777777777777778in"} parameters for all TrCH *i* and all TF
*l*, we first compute an intermediate parameter ∆*N~i,~*~max~ by the
following formula, where ![](media/image122.wmf){width="0.375in"
height="0.2638888888888889in"} is derived from
![](media/image123.wmf){width="0.2916666666666667in"
height="0.2638888888888889in"} by the formula given at subclause 4.2.7:

![](media/image124.wmf){width="1.3055555555555556in"
height="0.2638888888888889in"}

If ![](media/image125.wmf){width="0.7777777777777778in"
height="0.2638888888888889in"} then, for TrCH *i*, the output data of
the rate matching is the same as the input data and the rate matching
algorithm of subclause 4.2.7.5 does not need to be executed. In this
case we have :

![](media/image126.wmf){width="1.5in" height="0.2777777777777778in"}

If ![](media/image127.wmf){width="0.7777777777777778in"
height="0.2638888888888889in"} the parameters listed in subclauses
4.2.7.2.1.3 and 4.2.7.2.1.4 shall be used for determining *e~ini~*,
*e~plus~*, and *e~minus~,* and ![](media/image121.wmf){width="0.44375in"
height="0.2777777777777778in"}.

##### 4.2.7.2.1.2 Void {#void-1 .H6}

##### 4.2.7.2.1.3 Determination of rate matching parameters for convolutionally encoded TrCHs {#determination-of-rate-matching-parameters-for-convolutionally-encoded-trchs .H6}

![](media/image128.wmf){width="0.94375in" height="0.2638888888888889in"}

*a*=2

![](media/image129.wmf){width="1.2222222222222223in"
height="0.3333333333333333in"}

For each transmission time interval of TrCH *i* with TF *l*, the
rate-matching pattern is calculated with the algorithm in subclause
4.2.7.5. The following parameters are used as input:

![](media/image130.wmf){width="0.7083333333333334in"
height="0.2638888888888889in"}

![](media/image131.wmf){width="0.3888888888888889in" height="0.25in"}1

![](media/image132.wmf){width="1.0138888888888888in"
height="0.2638888888888889in"}

![](media/image133.wmf){width="1.1111111111111112in"
height="0.2777777777777778in"}

Puncturing if ![](media/image134.wmf){width="0.5694444444444444in"
height="0.25in"}, repetition otherwise. The values of
![](media/image135.wmf){width="0.44375in"
height="0.2777777777777778in"}may be computed by counting repetitions or
puncturing when the algorithm of subclause 4.2.7.5 is run. The resulting
values of ![](media/image135.wmf){width="0.44375in"
height="0.2777777777777778in"} can be represented with following
expression.

![](media/image136.wmf){width="2.19375in" height="0.5277777777777778in"}

##### 4.2.7.2.1.4 Determination of rate matching parameters for Turbo encoded TrCHs {#determination-of-rate-matching-parameters-for-turbo-encoded-trchs .H6}

If repetition is to be performed on turbo encoded TrCHs,
i.e.![](media/image137.wmf){width="0.7777777777777778in"
height="0.2638888888888889in"}, the parameters in subclause 4.2.7.2.1.3
are used.

If puncturing is to be performed, the parameters below shall be used.
Index *b* is used to indicate systematic (*b*=1), 1^st^ parity (*b*=2),
and 2^nd^ parity bit (*b*=3).

*a=2* when *b=*2

*a=1* when *b=*3

The bits indicated by *b*=1 shall not be punctured.

![](media/image138.wmf){width="2.0965277777777778in"
height="0.5277777777777778in"}

![](media/image139.wmf){width="1.5277777777777777in"
height="0.3333333333333333in"}

For each transmission time interval of TrCH *i* with TF *l*, the
rate-matching pattern is calculated with the algorithm in subcaluse
4.2.7.5. The following parameters are used as input:

![](media/image140.wmf){width="0.8888888888888888in"
height="0.2638888888888889in"}

![](media/image141.wmf){width="0.7083333333333334in" height="0.25in"}

![](media/image142.wmf){width="1.0138888888888888in"
height="0.2638888888888889in"}

![](media/image143.wmf){width="1.1527777777777777in"
height="0.3055555555555556in"}

The values of ![](media/image135.wmf){width="0.44375in"
height="0.2777777777777778in"}may be computed by counting puncturing
when the algorithm of subclause 4.2.7.5 is run. The resulting values of
![](media/image135.wmf){width="0.44375in" height="0.2777777777777778in"}
can be represented with following expression.

![](media/image144.wmf){width="3.138888888888889in"
height="0.6388888888888888in"}

In the above equation, the first term of the right hand side represents
the amount of puncturing for *b*=2 and the second term represents the
amount of puncturing for *b*=3.

##### 4.2.7.2.1A Determination of rate matching parameters for pseudo-flexible positions of TrCHs

Pseudo-flexible rate matching is identical to fixed-position rate
matching, with a difference that in psueduo-flexible rate matching, rate
matching parameters are re-evaluated for each maximum TTI, and the value
of *RM~i~* is set to 0 in Equation (1) of subclause 4.2.7 if *M~i\ ~*=0
(i.e., no transport blocks are sent in the TTI) for each transport
channel *i* with the maximum TTI value among all the transport channels
multiplexed into the CCTrCH.

When there is a configuration with more than one transport channel
having the maximum TTI and more than one of those transport channels
having a transport format with no transport blocks multiplexed into a
CCTrCH, the UE behaviour is unspecified.

As a consequence of re-evaluating rate-matching parameters per maximum
TTI in pseudo-flexible rate matching, derived parameters dependent on
rate matching, for example the parameters corresponding to DTX
indication bits in Section 4.2.9.1, can change from one maximum TTI to
another in pseudo-flexible rate matching, unlike in fixed position rate
matching.

##### 4.2.7.2.2 Determination of rate matching parameters for flexible positions of TrCHs

##### 4.2.7.2.2.1 Calculations for normal mode, compressed mode by higher layer scheduling, and compressed mode by spreading factor reduction {#calculations-for-normal-mode-compressed-mode-by-higher-layer-scheduling-and-compressed-mode-by-spreading-factor-reduction .H6}

First an intermediate calculation variable
![](media/image145.wmf){width="0.2361111111111111in"
height="0.2638888888888889in"} is calculated for all transport channels
*i* and all transport format combinations *j* by the following formula:

![](media/image146.wmf){width="1.2861111111111112in"
height="0.4722222222222222in"}

Then rate matching ratios *RF~i~* are calculated for each the transport
channel *i* in order to minimise the number of DTX bits when the bit
rate of the CCTrCH is maximum. The *RF~i~* ratios are defined by the
following formula:

![](media/image147.wmf){width="2.1131944444444444in"
height="0.6472222222222223in"}

The computation of ![](media/image121.wmf){width="0.44375in"
height="0.2777777777777778in"} parameters is then performed in two
phases. In a first phase, tentative temporary values of
![](media/image121.wmf){width="0.44375in" height="0.2777777777777778in"}
are computed, and in the second phase they are checked and corrected.
The first phase, by use of the *RF~i~* ratios, ensures that the number
of DTX indication bits inserted is minimum when the CCTrCH bit rate is
maximum, but it does not ensure that the maximum CCTrCH bit rate is not
greater than *N~data,\*~*. per 10ms. The latter condition is ensured
through the checking and possible corrections carried out in the second
phase.

At the end of the second phase, the latest value of
![](media/image121.wmf){width="0.44375in"
height="0.2777777777777778in"}is the definitive value.

The first phase defines the tentative temporary
![](media/image121.wmf){width="0.44375in" height="0.2777777777777778in"}
for all transport channel *i* and any of its transport format *l* by use
of the following formula:

![](media/image148.wmf){width="4.163888888888889in"
height="0.7076388888888889in"}

The second phase is defined by the following algorithm:

for all ![](media/image149.wmf){width="0.1388888888888889in"
height="0.20833333333333334in"} in *TFCS* in ascending order of TFCI do
\-- for all TFC

![](media/image150.wmf){width="1.7916666666666667in"
height="0.5138888888888888in"} \-- CCTrCH bit rate (bits per 10ms) for
TFC *j*

if ![](media/image151.wmf){width="0.7361111111111112in"
height="0.2638888888888889in"} then

for *i* = 1 to *I* do \-- for all TrCH

![](media/image152.wmf){width="1.0965277777777778in"
height="0.2638888888888889in"} \--
![](media/image153.wmf){width="0.3888888888888889in"
height="0.2638888888888889in"}  is derived from
![](media/image154.wmf){width="0.2916666666666667in"
height="0.2638888888888889in"} by the formula given at subclause 4.2.7.

if ![](media/image155.wmf){width="1.0277777777777777in"
height="0.2777777777777778in"}then

![](media/image156.wmf){width="1.0277777777777777in"
height="0.2777777777777778in"}

end-if

end-for

end-if

end-for

If ![](media/image157.wmf){width="0.7083333333333334in"
height="0.2777777777777778in"} then, for TrCH *i* at TF *l*, the output
data of the rate matching is the same as the input data and the rate
matching algorithm of subclause 4.2.7.5 does not need to be executed.

If ![](media/image158.wmf){width="0.7222222222222222in"
height="0.2777777777777778in"} the parameters listed in subclauses
4.2.7.2.2.2 and 4.2.7.2.2.3 shall be used for determining *e~ini~*,
*e~plus~*, and *e~minus~*.

##### 4.2.7.2.2.2 Determination of rate matching parameters for convolutionally encoded TrCHs {#determination-of-rate-matching-parameters-for-convolutionally-encoded-trchs-1 .H6}

![](media/image159.wmf){width="0.8888888888888888in"
height="0.2638888888888889in"}

*a=2*

For each transmission time interval of TrCH *i* with TF *l*, the
rate-matching pattern is calculated with the algorithm in subclause
4.2.7.5. The following parameters are used as input:

![](media/image160.wmf){width="0.7083333333333334in"
height="0.2638888888888889in"}

![](media/image131.wmf){width="0.3888888888888889in" height="0.25in"}1

![](media/image161.wmf){width="1.0416666666666667in"
height="0.2777777777777778in"}

![](media/image162.wmf){width="1.1388888888888888in"
height="0.2777777777777778in"}

puncturing for ![](media/image163.wmf){width="0.5694444444444444in"
height="0.25in"}, repetition otherwise.

##### 4.2.7.2.2.3 Determination of rate matching parameters for Turbo encoded TrCHs {#determination-of-rate-matching-parameters-for-turbo-encoded-trchs-1 .H6}

If repetition is to be performed on turbo encoded TrCHs, i.e.
![](media/image164.wmf){width="0.7083333333333334in"
height="0.2638888888888889in"}, the parameters in subclause 4.2.7.2.2.2
are used.

If puncturing is to be performed, the parameters below shall be used.
Index *b* is used to indicate systematic (*b*=1), 1^st^ parity (*b*=2),
and 2^nd^ parity bit (*b*=3).

*a=2* when *b*=2

*a=1* when *b=*3

The bits indicated by *b*=1 shall not be punctured.

![](media/image165.wmf){width="1.7638888888888888in"
height="0.5277777777777778in"}

For each transmission time interval of TrCH *i* with TF *l*, the
rate-matching pattern is calculated with the algorithm in
subclause 4.2.7.5. The following parameters are used as input:

![](media/image166.wmf){width="0.8888888888888888in"
height="0.2638888888888889in"},

![](media/image167.wmf){width="0.5833333333333334in" height="0.25in"},

![](media/image168.wmf){width="0.9027777777777778in"
height="0.2638888888888889in"}

![](media/image169.wmf){width="1.1388888888888888in"
height="0.2777777777777778in"}

#### 4.2.7.3 Bit separation and collection in uplink

The systematic bits of turbo encoded TrCHs shall not be punctured, the
other bits may be punctured. The systematic bits, first parity bits, and
second parity bits in the bit sequence input to the rate matching block
are therefore separated into three sequences.

The first sequence contains:

\- All of the systematic bits that are from turbo encoded TrCHs.

\- From 0 to 2 first and/or second parity bits that are from turbo
encoded TrCHs. These bits come into the first sequence when the total
number of bits in a block after radio frame segmentation is not a
multiple of three.

\- Some of the systematic, first parity and second parity bits that are
for trellis termination.

The second sequence contains:

\- All of the first parity bits that are from turbo encoded TrCHs,
except those that go into the first sequence when the total number of
bits is not a multiple of three.

\- Some of the systematic, first parity and second parity bits that are
for trellis termination.

The third sequence contains:

\- All of the second parity bits that are from turbo encoded TrCHs,
except those that go into the first sequence when the total number of
bits is not a multiple of three.

\- Some of the systematic, first parity and second parity bits that are
for trellis termination.

The second and third sequences shall be of equal length, whereas the
first sequence can contain from 0 to 2 more bits. Puncturing is applied
only to the second and third sequences.The bit separation function is
transparent for convolutionally encoded TrCHs and for turbo encoded
TrCHs with repetition. The bit separation and bit collection are
illustrated in figures 5 and 6.

![](media/image170.wmf){width="6.125694444444444in" height="3.225in"}

Figure 5: Puncturing of turbo encoded TrCHs in uplink

![](media/image171.wmf){width="6.690277777777778in"
height="3.1909722222222223in"}

Figure 6: Rate matching for convolutionally encoded TrCHs\
and for turbo encoded TrCHs with repetition in uplink

The bit separation is dependent on the 1^st^ interleaving and offsets
are used to define the separation for different TTIs. *b* indicates the
three sequences defined in this section, with *b*=1 indicating the first
sequence, *b* = 2 the second one, and *b* = 3 the third one. The offsets
*α~b~* for these sequences are listed in table 5.

Table 5: TTI dependent offset needed for bit separation

  ---------- -------- -------- --------
  TTI (ms)   *α*~1~   *α*~2~   *α*~3~
  10, 40     0        1        2
  20, 80     0        2        1
  ---------- -------- -------- --------

The bit separation is different for different radio frames in the TTI. A
second offset is therefore needed. The radio frame number for TrCH *i*
is denoted by *n~i~*. and the offset by
![](media/image172.wmf){width="0.25in" height="0.2638888888888889in"}.

Table 6: Radio frame dependent offset needed for bit separation

  ---------- -------- -------- -------- -------- -------- -------- -------- --------
  TTI (ms)   *β*~0~   *β*~1~   *β*~2~   *β*~3~   *β*~4~   *β*~5~   *β*~6~   *β*~7~
  10         0        NA       NA       NA       NA       NA       NA       NA
  20         0        1        NA       NA       NA       NA       NA       NA
  40         0        1        2        0        NA       NA       NA       NA
  80         0        1        2        0        1        2        0        1
  ---------- -------- -------- -------- -------- -------- -------- -------- --------

##### 4.2.7.3.1 Bit separation

The bits input to the rate matching are denoted
by![](media/image173.wmf){width="1.1527777777777777in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *N~i~*
is the number of bits input to the rate matching block. Note that the
transport format combination number *j* for simplicity has been left out
in the bit numbering, i.e. *N~i~*=*N~ij~*. The bits after separation are
denoted by![](media/image174.wmf){width="1.3888888888888888in"
height="0.2638888888888889in"}. For turbo encoded TrCHs with puncturing,
*b* indicates the three sequences defined in clause 4.2.7.3, with *b*=1
indicating the first sequence, and so forth. For all other cases *b* is
defined to be 1. *X~i~* is the number of bits in each separated bit
sequence. The relation between *e~ik~* and *x~bik~* is given below.

For turbo encoded TrCHs with puncturing:

![](media/image175.wmf){width="1.6805555555555556in"
height="0.2916666666666667in"} *k* = 1, 2, 3, ..., *X~i~ X~i~ =* *N~i~*
/3

![](media/image176.wmf){width="1.44375in" height="0.2638888888888889in"}
*k* = 1, ..., *N~i~* mod 3 Note: When (*N~i~* mod 3) = 0 this row is not
needed.

![](media/image177.wmf){width="1.7222222222222223in"
height="0.2916666666666667in"} *k* = 1, 2, 3, ..., *X~i~* *X~i~* =
*N~i~* /3

![](media/image178.wmf){width="1.7083333333333333in"
height="0.2916666666666667in"} *k* = 1, 2, 3, ..., *X~i~* *X~i~* =
*N~i~* /3

For convolutionally encoded TrCHs and turbo encoded TrCHs with
repetition:

![](media/image179.wmf){width="0.6805555555555556in"
height="0.2638888888888889in"} *k* = 1, 2, 3, ..., *X~i~* *X~i~ = N~i~*

##### 4.2.7.3.2 Bit collection

The bits *x~bik~* are input to the rate matching algorithm described in
subclause 4.2.7.5. The bits output from the rate matching algorithm are
denoted![](media/image180.wmf){width="1.4027777777777777in"
height="0.2638888888888889in"}.

Bit collection is the inverse function of the separation. The bits after
collection are denoted by
![](media/image181.wmf){width="1.3465277777777778in"
height="0.2638888888888889in"}*.* After bit collection, the bits
indicated as punctured are removed and the bits are then denoted
by![](media/image182.wmf){width="1.2222222222222223in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *V~i~*=
*N~ij~*+*∆N~ij~*. The relations between *y~bik~*, *z~bik~*, and *f~ik~*
are given below.

For turbo encoded TrCHs with puncturing (*Y~i~=X~i~*):

![](media/image183.wmf){width="1.7083333333333333in"
height="0.2916666666666667in"} *k* = 1, 2, 3, ..., *Y~i~*

![](media/image184.wmf){width="1.4583333333333333in"
height="0.2638888888888889in"} *k* = 1, ..., *N~i~* mod 3 Note: When
(*N~i~* mod 3) = 0 this row is not needed.

![](media/image185.wmf){width="1.7361111111111112in"
height="0.2916666666666667in"} *k* = 1, 2, 3, ..., *Y~i~*

![](media/image186.wmf){width="1.75in" height="0.2916666666666667in"}
*k* = 1, 2, 3, ..., *Y~i~*

After the bit collection, bits *z~i,k~* with value *δ*, where
*δ[∉]{.underline}*{0, 1}, are removed from the bit sequence. Bit
*f~i,~*~1~ corresponds to the bit *z~i,k~* with smallest index *k* after
puncturing, bit *f~i,~*~2~ corresponds to the bit *z~i,k~* with second
smallest index *k* after puncturing, and so on.

For convolutionally encoded TrCHs and turbo encoded TrCHs with
repetition:

![](media/image187.wmf){width="0.7083333333333334in"
height="0.2638888888888889in"} *k* = 1, 2, 3, ..., *Y~i~*

When repetition is used, *f~i,k~*=*z~i,k~* and *Y~i~*=*V~i~*.

When puncturing is used, *Y~i~*=*X~i~* and bits *z~i,k~* with value *δ*,
where *δ∉*{0, 1}, are removed from the bit sequence. Bit *f~i,~*~1~
corresponds to the bit *z~i,k~* with smallest index *k* after
puncturing, bit *f~i,~*~2~ corresponds to the bit *z~i,k~* with second
smallest index *k* after puncturing, and so on.

#### 4.2.7.4 Bit separation and collection in downlink

The systematic bits of turbo encoded TrCHs shall not be punctured, the
other bits may be punctured.

The systematic bits, first parity bits and second parity bits in the bit
sequence input to the rate matching block are therefore separated into
three sequences of equal lengths.

The first sequence contains :

\- All of the systematic bits that are from turbo encoded TrCHs.

\- Some of the systematic, first parity and second parity bits that are
for trellis termination.

The second sequence contains:

\- All of the first parity bits that are from turbo encoded TrCHs.

\- Some of the systematic, first parity and second parity bits that are
for trellis termination.

The third sequence contains:

\- All of the second parity bits that are from turbo encoded TrCHs.

\- Some of the systematic, first parity and second parity bits that are
for trellis termination.

Puncturing is applied only to the second and third sequences.

The bit separation function is transparent for convolutionally encoded
TrCHs and for turbo encoded TrCHs with repetition. The bit separation
and bit collection are illustrated in figures 7 and 8.

![](media/image188.wmf){width="6.125694444444444in" height="2.6125in"}

Figure 7: Puncturing of turbo encoded TrCHs in downlink

![](media/image189.wmf){width="6.690277777777778in"
height="2.5770833333333334in"}

Figure 8: Rate matching for convolutionally encoded TrCHs\
and for turbo encoded TrCHs with repetition in downlink

##### 4.2.7.4.1 Bit separation

The bits input to the rate matching are denoted
by![](media/image190.wmf){width="1.1527777777777777in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *E~i~*
is the number of bits input to the rate matching block. Note that *E~i~*
is a multiple of 3 for turbo encoded TrCHs and that the transport format
*l* for simplicity has been left out in the bit numbering, i.e.
*E~i~*=![](media/image191.wmf){width="0.34652777777777777in"
height="0.2638888888888889in"}. The bits after separation are denoted
by![](media/image174.wmf){width="1.3888888888888888in"
height="0.2638888888888889in"}. For turbo encoded TrCHs with puncturing,
*b* indicates the three sequences defined in clause 4.2.7.4, with b=1
indicating the first sequence, and so forth. For all other cases *b* is
defined to be 1. *X~i~* is the number of bits in each separated bit
sequence. The relation between *c~ik~* and *x~bik~* is given below.

For turbo encoded TrCHs with puncturing:

![](media/image192.wmf){width="1.0in" height="0.2638888888888889in"} *k*
= 1, 2, 3, ..., *X~i~ X~i~ = E~i~* /3

![](media/image193.wmf){width="1.0416666666666667in"
height="0.2638888888888889in"} *k* = 1, 2, 3, ..., *X~i~* *X~i~* =
*E~i~* /3

![](media/image194.wmf){width="1.0277777777777777in"
height="0.2638888888888889in"} *k* = 1, 2, 3, ..., *X~i~* *X~i~* =
*E~i~* /3

For convolutionally encoded TrCHs and turbo encoded TrCHs with
repetition:

![](media/image195.wmf){width="0.69375in" height="0.2638888888888889in"}
*k* = 1, 2, 3, ..., *X~i~* *X~i~ = E~i~*

##### 4.2.7.4.2 Bit collection

The bits *x~bik~* are input to the rate matching algorithm described in
subclause 4.2.7.5. The bits output from the rate matching algorithm are
denoted![](media/image180.wmf){width="1.4027777777777777in"
height="0.2638888888888889in"}.

Bit collection is the inverse function of the separation. The bits after
collection are denoted by
![](media/image181.wmf){width="1.3465277777777778in"
height="0.2638888888888889in"}*.* After bit collection, the bits
indicated as punctured are removed and the bits are then denoted
by![](media/image196.wmf){width="1.2777777777777777in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *G~i~*=
![](media/image191.wmf){width="0.34652777777777777in"
height="0.2638888888888889in"}+![](media/image197.wmf){width="0.44375in"
height="0.2638888888888889in"}. The relations between *y~bik~*,
*z~bik~*, and *g~ik~* are given below.

For turbo encoded TrCHs with puncturing (*Y~i~=X~i~*):

![](media/image198.wmf){width="1.0277777777777777in"
height="0.2638888888888889in"} *k* = 1, 2, 3, ..., *Y~i~*

![](media/image199.wmf){width="1.0555555555555556in"
height="0.2638888888888889in"} *k* = 1, 2, 3, ..., *Y~i~*

![](media/image200.wmf){width="1.0416666666666667in"
height="0.2638888888888889in"} *k* = 1, 2, 3, ..., *Y~i~*

After the bit collection, bits *z~i,k~* with value *δ*, where *δ∉*{0,
1}, are removed from the bit sequence. Bit *g~i,~*~1~ corresponds to the
bit *z~i,k~* with smallest index *k* after puncturing, bit *g~i,~*~2~
corresponds to the bit *z~i,k~* with second smallest index *k* after
puncturing, and so on.

For convolutionally encoded TrCHs and turbo encoded TrCHs with
repetition:

![](media/image187.wmf){width="0.7083333333333334in"
height="0.2638888888888889in"} *k* = 1, 2, 3, ..., *Y~i~*

When repetition is used, *g~i,k~*=*z~i,k~* and *Y~i~*=*G~i~*.

When puncturing is used, *Y~i~*=*X~i~* and bits *z~i,k~* with value *δ*,
where *δ∉*{0, 1}, are removed from the bit sequence. Bit *g~i,~*~1~
corresponds to the bit *z~i,k~* with smallest index *k* after
puncturing, bit *g~i,~*~2~ corresponds to the bit *z~i,k~* with second
smallest index *k* after puncturing, and so on.

#### 4.2.7.5 Rate matching pattern determination

Denote the bits before rate matching by:

![](media/image201.wmf){width="1.2083333333333333in"
height="0.2638888888888889in"}, where *i* is the TrCH number and the
sequence is defined in 4.2.7.3 for uplink or in 4.2.7.4 for downlink.
Parameters *X~i~*, e~ini~, e~plus~, and e~minus~ are given in 4.2.7.1
for uplink or in 4.2.7.2 for downlink.

The rate matching rule is as follows:

if puncturing is to be performed

e = e~ini~ \-- initial error between current and desired puncturing
ratio

m = 1 \-- index of current bit

do while m \<= X~i~

e = e -- e~minus~ \-- update error

if e \<= 0 then \-- check if bit number m should be punctured

set bit x~i,m~ to *δ* where *δ∉*{0, 1}

e = e + e~plus~ \-- update error

end if

m = m + 1 \-- next bit

end do

else

e = e~ini~ \-- initial error between current and desired puncturing
ratio

m = 1 \-- index of current bit

do while m \<= X~i~

e = e -- e~minus~ \-- update error

do while e \<= 0 \-- check if bit number m should be repeated

repeat bit *x~i,m~*

*e = e + e~plus~ \-- update error*

end do

*m = m + 1 \-- next bit*

end do

end if

A repeated bit is placed directly after the original one.

### 4.2.8 TrCH multiplexing

Every 10 ms, one radio frame from each TrCH is delivered to the TrCH
multiplexing. These radio frames are serially multiplexed into a coded
composite transport channel (CCTrCH).

The bits input to the TrCH multiplexing are denoted by
![](media/image202.wmf){width="1.1805555555555556in"
height="0.2638888888888889in"}, where *i* is the TrCH number and *V~i~*
is the number of bits in the radio frame of TrCH *i*. The number of
TrCHs is denoted by *I*. The bits output from TrCH multiplexing are
denoted by ![](media/image203.wmf){width="0.9305555555555556in"
height="0.25in"}, where *S* is the number of bits, i.e.
![](media/image204.wmf){width="0.6388888888888888in" height="0.375in"}.
The TrCH multiplexing is defined by the following relations:

![](media/image205.wmf){width="0.5416666666666666in" height="0.25in"} *k
=* 1, 2*, ..., V*~1~

![](media/image206.wmf){width="0.8194444444444444in"
height="0.2638888888888889in"} *k = V*~1~*+*1*, V*~1~*+*2*, ...,
V*~1~*+V*~2~

![](media/image207.wmf){width="1.0555555555555556in"
height="0.2638888888888889in"} *k = (V*~1~*+V*~2~*)+*1*,
(V*~1~*+V*~2~*)+*2*, ..., (V*~1~*+V*~2~*)+V*~3~

![](media/image32.wmf){width="0.19375in"
height="9.652777777777778e-2in"}

![](media/image208.wmf){width="1.4583333333333333in"
height="0.2638888888888889in"} *k = (V*~1~*+V*~2~*+...+V~I~*~-1~*)+*1*,
(V*~1~*+V*~2~*+...+V~I~*~-1~*)+*2*, ...,
(V*~1~*+V*~2~*+...+V~I~*~-1~*)+V~I~*

### 4.2.9 Insertion of discontinuous transmission (DTX) indication bits

In the downlink, DTX is used to fill up the radio frame with bits. The
insertion point of DTX indication bits depends on whether fixed or
flexible positions of the TrCHs in the radio frame are used. It is up to
the UTRAN to decide for each CCTrCH whether fixed, pseudo-flexible
(Subclause 4.2.7.2.1A), or flexible positions are used during the
connection. DTX indication bits only indicate when the transmission
should be turned off, they are not transmitted. Pseudo-flexible rate
matching is always used when DL\_DCH\_FET\_Config is configured by
higher layers. Otherwise pseudo-flexible rate matching is not used.

#### 4.2.9.1 1^st^ insertion of DTX indication bits

This step of inserting DTX indication bits is used only if the positions
of the TrCHs in the radio frame are fixed. With fixed position scheme a
fixed number of bits is reserved for each TrCH in the radio frame.

The bits from rate matching are denoted by
![](media/image209.wmf){width="1.2361111111111112in"
height="0.2638888888888889in"}, where *G~i~* is the number of bits in
one TTI of TrCH *i*. Denote the number of bits in one radio frame of
TrCH *i* by *H~i~*. Denote *D~i~* the number of bits output of the first
DTX insertion block.

In TTIs containing no compressed frames or frames compressed by
spreading factor reduction, *H~i~* is constant and corresponds to the
maximum number of bits from TrCH *i* in one radio frame for any
transport format of TrCH *i* and *D~i~* *=* *F~i~* × *H~i~*.

The bits output from the DTX insertion are denoted by *h ~i1~, h ~i2~, h
~i3~, ..., h ~iDi~* Note that these bits are three valued. They are
defined by the following relations:

![](media/image210.wmf){width="0.5694444444444444in" height="0.25in"} *k
=* 1, 2, 3, ..., *G~i~*

![](media/image211.wmf){width="0.4861111111111111in" height="0.25in"} *k
= G~i~+*1*, G~i~+*2*, G~i~+*3*, ..., D~i~*

where DTX indication bits are denoted by *δ*. Here *g~ik~* ∈{0, 1} and
*δ* ∉{0, 1}.

In pseudo-flexible rate matching, the 1^st^ insertion of DTX indication
bits is the same as the above for fixed position rate matching, with a
difference that the above procedure is applied to each TTI independently
of others.

#### 4.2.9.2 2^nd^ insertion of DTX indication bits

The DTX indication bits inserted in this step shall be placed at the end
of the radio frame. Note that the DTX will be distributed over all slots
after 2^nd^ interleaving.

The bits input to the DTX insertion block are denoted by
![](media/image212.wmf){width="0.9305555555555556in"
height="0.25in"},where *S* is the number of bits from TrCH multiplexing.
The number of PhCHs is denoted by *P* and the number of bits in one
radio frame, including DTX indication bits, for each PhCH by *R*..

In non-compressed frames,
![](media/image213.wmf){width="2.2222222222222223in"
height="0.4583333333333333in"}, where *N~data~*~1~ and *N~data~*~2~ are
defined in \[2\].

For compressed frames, *N\'~data,\*~* is defined as
![](media/image214.wmf){width="2.1527777777777777in"
height="0.2777777777777778in"}.
![](media/image215.wmf){width="0.4027777777777778in"
height="0.2638888888888889in"}and
![](media/image216.wmf){width="0.4166666666666667in"
height="0.2638888888888889in"} are the number of bits in the data fields
of the slot format used for the current compressed frame, i.e. slot
format A or B as defined in \[2\] corresponding to the spreading factor
and the number of transmitted slots in use.

In frames compressed by higher layer scheduling, additional DTX with
respect to normal mode shall be inserted if the transmission time
reduction does not exactly create a transmission gap of the desired
*TGL*.

The number of bits available to the CCTrCH in one radio frame compressed
by spreading factor reduction or by higher layer scheduling is denoted
by ![](media/image217.wmf){width="0.4305555555555556in"
height="0.2777777777777778in"} and
![](media/image218.wmf){width="0.7777777777777778in"
height="0.4722222222222222in"}.

For frames compressed by spreading factor reduction
![](media/image219.wmf){width="1.1111111111111112in"
height="0.4583333333333333in"}.

For frames compressed by higher layer scheduling the exact value of
![](media/image220.wmf){width="0.4305555555555556in"
height="0.2777777777777778in"} is dependent on the *TGL* which is
signalled from higher layers. It can be calculated
as![](media/image221.wmf){width="1.4722222222222223in"
height="0.2777777777777778in"}.

*N~TGL~* is the number of bits that are located within the transmission
gap and defined as:

+----------------------------------+----------------------------------+
| ![](media/image222.w             | ![](media/image223.w             |
| mf){width="0.8229166666666666in" | mf){width="0.8756944444444444in" |
| height="1.5729166666666667in"}   | height="0.4305555555555556in"},  |
|                                  | if *N~first~ + TGL* ≤ 15         |
|                                  |                                  |
|                                  | ![](media/image224.w             |
|                                  | mf){width="1.2090277777777778in" |
|                                  | height="0.4583333333333333in"},  |
|                                  | in first frame if *N~first~ +    |
|                                  | TGL* \> 15                       |
|                                  |                                  |
|                                  | ![](media/image225.w             |
|                                  | mf){width="1.7715277777777778in" |
|                                  | height="0.4583333333333333in"},  |
|                                  | in second frame if *N~first~ +   |
|                                  | TGL* \> 15                       |
+----------------------------------+----------------------------------+

*N~first~* and *TGL* are defined in subclause 4.4.

The bits output from the DTX insertion block are denoted by
![](media/image226.wmf){width="1.3194444444444444in"
height="0.2638888888888889in"}. Note that these bits are three valued.
They are defined by the following relations:

![](media/image227.wmf){width="0.5138888888888888in" height="0.25in"} k
= 1, 2, 3, ..., S

![](media/image228.wmf){width="0.5in" height="0.25in"} k = S+1, S+2,
S+3, ..., *P⋅R*

where DTX indication bits are denoted by *δ*. Here *s*~k~ ∈{0,1, p}and
*δ* ∉{0,1}.

### 4.2.10 Physical channel segmentation

When more than one PhCH is used, physical channel segmentation divides
the bits among the different PhCHs. The bits input to the physical
channel segmentation are denoted by
![](media/image229.wmf){width="1.0555555555555556in" height="0.25in"},
where *X* is the number of bits input to the physical channel
segmentation block. The number of PhCHs is denoted by *P.*

The bits after physical channel segmentation are denoted
![](media/image230.wmf){width="1.3194444444444444in"
height="0.2361111111111111in"}, where *p* is PhCH number and *U* is the
number of bits in one radio frame for each PhCH, i.e.
![](media/image231.wmf){width="0.4583333333333333in"
height="0.4305555555555556in"}. The relation between *x~k~* and *u~p,k~*
is given below.

For all modes, some bits of the input flow are mapped to each code until
the number of bits on the code is *U*. All bits of the input flow are
taken to be mapped to the codes.

Bits on first PhCH after physical channel segmentation:

*u~1,\ k~ = x~k~ k =* 1, 2 , ..., *U*

Bits on second PhCH after physical channel segmentation:

*u~2,\ k~ = x~k+U\ ~* *k =* 1, 2 , ..., *U*

...

Bits on the *P^th^* PhCH after physical channel segmentation:

*u~P,k~ = x ~k+(P-1)~*~×*U*~ *k =* 1, 2 , ..., *U*

#### 4.2.10.1 Relation between input and output of the physical segmentation block in uplink

The bits input to the physical segmentation are denoted by
![](media/image232.wmf){width="0.94375in" height="0.25in"}. Hence, *x~k~
= s~k~* and *Y = S*.

#### 4.2.10.2 Relation between input and output of the physical segmentation block in downlink

The bits input to the physical segmentation are denoted by
![](media/image233.wmf){width="1.2638888888888888in"
height="0.2638888888888889in"}. Hence, *x~k~ = w~k~* and *Y = PU*.

### 4.2.11 2^nd^ interleaving

The 2^nd^ interleaving is a block interleaver and consists of bits input
to a matrix with padding, the inter-column permutation for the matrix
and bits output from the matrix with pruning. The bits input to the
block interleaver are denoted by
![](media/image234.wmf){width="1.44375in"
height="0.2638888888888889in"}, where *p* is PhCH number and *U* is the
number of bits in one radio frame for one PhCH. The output bit sequence
from the block interleaver is derived as follows:

\(1\) Assign C2 *=* 30 to be the number of columns of the matrix. The
columns of the matrix are numbered 0, 1, 2, ..., C2 *-* 1 from left to
right.

\(2\) Determine the number of rows of the matrix, R2, by finding minimum
integer R2 such that:

*U ≤* R2 × C2*.*

The rows of rectangular matrix are numbered 0, 1, 2, ..., R2 - 1 from
top to bottom.

\(3\) Write the input bit sequence
![](media/image230.wmf){width="1.3194444444444444in"
height="0.2361111111111111in"} into the R2
![](media/image53.wmf){width="0.125in" height="0.1388888888888889in"} C2
matrix row by row starting with bit
![](media/image235.wmf){width="0.2638888888888889in"
height="0.2361111111111111in"} in column 0 of row 0:

![](media/image236.wmf){width="3.9305555555555554in"
height="1.0277777777777777in"}

> where ![](media/image237.wmf){width="0.7361111111111112in"
> height="0.2638888888888889in"} for *k* = 1, 2, ..., *U* and if R2 × C2
> \> *U*, the dummy bits are padded such that
> ![](media/image238.wmf){width="0.2916666666666667in"
> height="0.2638888888888889in"} = 0 or 1 for *k* = *U* + 1, *U* + 2,
> ..., R2 × C2. These dummy bits are pruned away from the output of the
> matrix after the inter-column permutation.

\(4\) Perform the inter-column permutation for the matrix based on the
pattern ![](media/image239.wmf){width="1.2083333333333333in"
height="0.3055555555555556in"} that is shown in table 7, where P2(*j*)
is the original column position of the *j*-th permuted column. After
permutation of the columns, the bits are denoted by
![](media/image240.wmf){width="0.3055555555555556in"
height="0.2361111111111111in"}.

![](media/image241.wmf){width="3.236111111111111in"
height="1.0277777777777777in"}

\(5\) The output of the block interleaver is the bit sequence read out
column by column from the inter-column permuted R2
![](media/image53.wmf){width="0.125in" height="0.1388888888888889in"} C2
matrix. The output is pruned by deleting dummy bits that were padded to
the input of the matrix before the inter-column permutation, i.e. bits
![](media/image240.wmf){width="0.3055555555555556in"
height="0.2361111111111111in"} that corresponds to bits
![](media/image242.wmf){width="0.2777777777777778in"
height="0.2361111111111111in"} with *k\>U* are removed from the output.
The bits after 2^nd^ interleaving are denoted by
![](media/image243.wmf){width="1.0965277777777778in"
height="0.2638888888888889in"}, where *v~p,~*~1~ corresponds to the bit
![](media/image240.wmf){width="0.3055555555555556in"
height="0.2361111111111111in"} with smallest index *k* after pruning,
*v~p,~*~2~ to the bit
![](media/image240.wmf){width="0.3055555555555556in"
height="0.2361111111111111in"} with second smallest index *k* after
pruning, and so on.

Table 7 Inter-column permutation pattern for 2nd interleaving

+----------------------+----------------------------------------------+
| Number of columns C2 | Inter-column permutation pattern             |
|                      |                                              |
|                      | \< P2(0), P2(1), ..., P2(C2-1) \>            |
+----------------------+----------------------------------------------+
| 30                   | \<0, 20, 10, 5, 15, 25, 3, 13, 23, 8, 18,    |
|                      | 28, 1, 11, 21,                               |
|                      |                                              |
|                      | 6, 16, 26, 4, 14, 24, 19, 9, 29, 12, 2, 7,   |
|                      | 22, 27, 17\>                                 |
+----------------------+----------------------------------------------+

#### 4.2.11.1 2^nd^ interleaving for Secondary CCPCH with 16QAM

For MBSFN transmissions with 16QAM, the 2^nd^ interleaving for Secondary
CCPCH is done as illustrated in figure 8a below. The basic block
interleaver is as described in Clause 4.2.11. For 16QAM modulated bits,
there are two identical basic block interleavers of size R2×30, where R2
is the minimum integer fulfilling

$\left\lceil \frac{U}{2} \right\rceil \leq R2 \times \text{30}$,

The output bits from the physical channel segmentation are divided two
by two between the interleavers: bits *u~p,k~* and u~p,k+1~ go to the
first interleaver and bits *u~p,k+2~* and *u~p,k+3~* go to the second
interleaver. Bits are collected two by two from the interleavers: bits
*v~p,k~* and *v~p,k+1~*are obtained from the first interleaver and bits
*v~p,k+2~* and *v~p,k+3~* are obtained from the second interleaver,
where k mod 4=1.

![](media/image244.wmf){width="6.5in" height="1.9916666666666667in"}

Figure 8a: Interleaver structure for Secondary CCPCH

### 4.2.12 Physical channel mapping

The PhCH for both uplink and downlink is defined in \[2\]. The bits
input to the physical channel mapping are denoted by
![](media/image243.wmf){width="1.0965277777777778in"
height="0.2638888888888889in"}, where *p* is the PhCH number and *U* is
the number of bits in one radio frame for one PhCH. The bits *v~p,k~*
are mapped to the PhCHs so that the bits for each PhCH are transmitted
over the air in ascending order with respect to *k*.

In compressed mode, no bits are mapped to certain slots of the PhCH(s).
If *N~first~* + *TGL* ≤ 15, no bits are mapped to slots *N~first~* to
*N~last~*. If *N~first~* + *TGL* \> 15, i.e. the transmission gap spans
two consecutive radio frames, the mapping is as follows:

\- In the first radio frame, no bits are mapped to slots *N~first~,
N~first~*+1, *N~first~*+2, ..., 14.

\- In the second radio frame, no bits are mapped to the slots 0, 1, 2,
..., *N~last~*.

*TGL, N~first~*, and *N~last~* are defined in subclause 4.4.

#### 4.2.12.1 Uplink

When UL\_DPCH\_10ms\_Mode is configured, uplink physical channel mapping
depends on whether a compressed-mode transmission gap overlaps with the
first radio frame in 20ms CI. A distinction is made between the
following cases:

##### 4.2.12.1.1 UL\_DPCH\_10ms\_Mode is not configured by higher layers, or, no compressed-mode transmission gap overlaps with the first radio frame in the 20ms CI 

In uplink, the PhCHs used during a radio frame are either completely
filled with bits that are transmitted over the air or not used at all.
The only exception is when the UE is in compressed mode. The
transmission can then be turned off during consecutive slots of the
radio frame.

##### 4.2.12.1.2 UL\_DPCH\_10ms\_Mode is configured by higher layers, and, a compressed-mode transmission gap overlaps with the first radio frame in 20ms CI

In this case, physical channel mapping is performed over 20ms
Compression Intervals (20m CI). Note that as a consequence of radio
frame segmentation procedure in Subclause 4.2.6, there are no bit inputs
to the second radio frame in one 20ms CI. Denote the bit inputs to the
physical channel mapping in a 20ms CI by
![](media/image245.png){width="1.34375in"
height="0.17708333333333334in"}, where *p* is the PhCH number and
*[U]{.underline}* is the number of bits in one radio frame for one
PhCH[.]{.underline} *Then,* the 15 slots used to map the bits
![](media/image245.png){width="1.34375in"
height="0.17708333333333334in"}are the first 15 slots in the 20ms CI
excluding slots in the compressed-mode transmission gap. In other words,

*if N~first~* + *TGL* ≤ 15, i.e., the transmission gap spans only one
radio frame, and the mapping is as follows

> The 15 slots used for mapping are slots 0 to *N~first~* -- 1 in the
> first 10ms radio frame in the 20ms CI, slots *N~last~* + 1 *to slot 14
> in* in the first 10ms radio frame in the 20ms CI, and slots 0 to TGL
> -- 1 in the second radio frame of the 20ms CI.

*Else if N~first~* + *TGL* \> 15, i.e., the transmission gap spans two
consecutive radio frames, the mapping is as follows:

If the transmission gap occurs at the beginning of the first radio frame
of the 20ms CI, then the 15 slots used for mapping are slots *N~last~ +
1 to slot 14 of the first radio frame of the 20ms CI and slots 0 to
N~last~ of the second radio frame of the 20ms CI;*

*Else, if* the transmission gap occurs at the end of the first radio
frame of the 20ms CI, then the 15 slots used for mapping are slots 0 to
*N~first~ -- 1 of the first radio frame of the 20ms CI and slots N~last~
+ 1 to N~last~ + 15 - N~first~ of the second radio frame of the 20ms
CI.*

#### 4.2.12.2 Downlink

In downlink, the PhCHs do not need to be completely filled with bits
that are transmitted over the air. Values *v~p,k~* ∉{0, 1} correspond to
DTX indicators, which are mapped to the DPCCH/DPDCH fields but are not
transmitted over the air.

In compressed mode when DL\_DCH\_FET\_Config is configured by higher
layers, the mapping of data bits onto the slots of the PhCH is the same
as normal mode, with a difference that the data bits that are mapped to
slots in a transmission gap are not transmitted over the air.

During compressed mode by reducing the spreading factor by 2, the data
bits are always mapped into 7.5 slots within a compressed frame. No bits
are mapped to the DPDCH field as follows:

If *N~first~* + *TGL* ≤ 15, i.e. the transmission gap spans one radio
frame,

if *N~first~* + 7 ≤ 14

no bits are mapped to slots *N~first~*,*N~first~* + 1, *N~first~*
+2,..., *N~first~+6*

no bits are mapped to the first (N~Data1~+ N~Data2~)/2 bit positions of
slot *N~first~+7*

else

no bits are mapped to slots *N~first~*, *N~first~* + 1, *N~first~* +
2,..., 14

no bits are mapped to slots *N~first~* - 1, *N~first~* - 2, *N~first~* -
3, ..., *8*

no bits are mapped to the last (N~Data1~+ N~Data2~)/2 bit positions of
slot 7

end if

If *N~first~* + *TGL* \> 15, i.e. the transmission gap spans two
consecutive radio frames,

> In the first radio frame, no bits are mapped to last (N~Data1~+
> N~Data2~)/2 bit positions in slot 7 as well as to slots 8, 9, 10,
> \..., 14.
>
> In the second radio frame, no bits are mapped to slots 0, 1, 2, \...,
> 6 as well as to first (N~Data1~+ N~Data2~)/2 bit positions in slot 7.

N~Data1~and N~Data2~ are defined in \[2\].

### 4.2.13 Restrictions on different types of CCTrCHs

Restrictions on the different types of CCTrCHs are described in general
terms in TS 25.302\[11\]. In this subclause those restrictions are given
with layer 1 notation.

#### 4.2.13.1 Uplink Dedicated channel (DCH)

The maximum value of the number of TrCHs *I* in a CCTrCH, the maximum
value of the number of transport blocks *M~i~* on each transport
channel, and the maximum value of the number of DPDCHs *P* are given
from the UE capability class.

#### 4.2.13.2 Random Access Channel (RACH)

\- There can only be one TrCH in each RACH CCTrCH, i.e. *I*=1, *s~k~ =
f*~1*k*~ and *S* = *V*~1~.

\- The maximum value of the number of transport blocks *M*~1~ on the
transport channel is given from the UE capability class.

\- The transmission time interval is either 10 ms or 20 ms.

\- Only one PRACH is used, i.e. *P*=1, *u*~1*k*~ = *s~k~*, and *U* =
*S*.

\- The Static rate matching parameter *RM*~1~ is not provided by higher
layer signalling on the System information as the other transport
channel parameters. Any value may be used as there is one transport
channel in the CCTrCH, hence one transport channel per Transport Format
Combination and no need to do any balancing between multiple transport
channels.

#### 4.2.13.3 Void

#### 4.2.13.4 Downlink Dedicated Channel (DCH)

The maximum value of the number of TrCHs *I* in a CCTrCH, the maximum
value of the number of transport blocks *M~i~* on each transport
channel, and the maximum value of the number of DPDCHs *P* are given
from the UE capability class.

#### 4.2.13.5 Void

#### 4.2.13.6 Broadcast channel (BCH)

\- There can only be one TrCH in a BCH CCTrCH, i.e. *I*=1, *s~k~ =
f*~1*k*~, and *S* = *V*~1~.

\- There can only be one transport block in each transmission time
interval, i.e. *M*~1~ = 1.

\- All transport format attributes have predefined values which are
provided in \[11\] apart from the rate matching *RM*~1~.

\- The Static rate matching parameter *RM*~1~ is not provided by higher
layer signalling neither fixed. Any value may be used as there is one
transport channel in the CCTrCH, hence one transport channel per
Transport Format Combination and no need to do any balancing between
multiple transport channels.

\- Only one primary or secondary CCPCH is used per CCTrCH, i.e. *P*=1.

#### 4.2.13.7 Forward access and paging channels (FACH and PCH)

\- The maximum value of the number of TrCHs *I* in a CCTrCH and the
maximum value of the number of transport blocks *M~i~* on each transport
channel are given from the UE capability class.

\- The transmission time interval for TrCHs of PCH type is always 10 ms.

\- Only one secondary CCPCH is used per CCTrCH, i.e. *P*=1.

#### 4.2.13.8 High Speed Downlink Shared Channel (HS-DSCH) associated with a DCH

\- There can be only one TrCH in an HS-DSCH CCTrCH, i.e. *I* = 1,

\- In case the UE is not configured in MIMO mode and not in MIMO mode
with four transmit antennas or the UE is configured in MIMO mode and
single-stream restriction is configured, there can only be one transport
block in each transmission time interval, i.e. *M~1~* = 1. In case the
UE is configured in MIMO mode, there can be one or two transport blocks
in each transmission time interval and in case the UE is configured in
MIMO mode with four transmit antennas, there can be up to four transport
blocks in each transmission time interval.

\- The transmission time interval for TrCHs of HS-DSCH type is always 2
ms.

\- The maximum value of the number of HS-PDSCHs *P* are given from the
UE capability class.

#### 4.2.13.9 Enhanced Dedicated Channel (E-DCH)

\- There can be only one TrCH in the E-DCH CCTrCH, i.e. *I* = 1.

\- If the UL\_MIMO\_Enabled is not set to TRUE, there can only be one
transport block in each transmission time interval, i.e. *M~1~* = 1. If
the UL\_MIMO\_Enabled is set to TRUE, there can be one or two transport
blocks in each transmission time interval..

\- The transmission time interval for TrCHs of E-DCH type is 2 ms or
10 ms. If the UL\_MIMO\_Enabled is set to TRUE, the transmission time
interval for TrCHs of E-DCH type is always set to 2 ms.

\- The maximum value of the number of E-DPDCHs *P* are given from the UE
capabilities.

### 4.2.14 Multiplexing of different transport channels into one CCTrCH, and mapping of one CCTrCH onto physical channels

The following rules shall apply to the different transport channels
which are part of the same CCTrCH:

1\) Transport channels multiplexed into one CCTrCh shall have
co-ordinated timings. When the TFCS of a CCTrCH is changed because one
or more transport channels are added to the CCTrCH or reconfigured
within the CCTrCH, or removed from the CCTrCH, the change may only be
made at the start of a radio frame with CFN fulfilling the relation

CFN mod F~max~ = 0,

> where F~max~ denotes the maximum number of radio frames within the
> transmission time intervals of all transport channels which are
> multiplexed into the same CCTrCH, including any transport channels *i*
> which are added, reconfigured or have been removed, and CFN denotes
> the connection frame number of the first radio frame of the changed
> CCTrCH.
>
> After addition or reconfiguration of a transport channel *i* within a
> CCTrCH, the TTI of transport channel *i* may only start in radio
> frames with CFN fulfilling the relation:

CFN mod F~i~ = 0.

2\) Only transport channels with the same active set can be mapped onto
the same CCTrCH.

3\) Different CCTrCHs cannot be mapped onto the same PhCH.

4\) One CCTrCH shall be mapped onto one or several PhCHs. These physical
channels shall all have the same SF, except for the case of four
E-DPDCHs, where two E-DPDCHs have spreading factor 2 and the other two
E-DPDCHs have spreading factor 4, and for the case of four S-E-DPDCHs,
where two S-E-DPDCHs have spreading factor 2 and the other two
S-E-DPDCHs have spreading factor 4.

> All physical channels belonging to the same CCTrCH shall use the same
> modulation scheme with the exception that, when transmitted, the
> modulation scheme used by the four S-E-DPDCHsmay be different from
> that used by the four E-DPDCHs.
>
> The 4PAM modulation shall only be used for orthogonal PhCH pairs which
> are orthogonal in phase and use the same OVSF code.
>
> The 8PAM modulation shall only be used for orthogonal PhCH pairs which
> are orthogonal in phase and use the same OVSF code.

5\) Dedicated Transport channels and common transport channels cannot be
multiplexed into the same CCTrCH.

6\) For the common transport channels, only the FACH and PCH may belong
to the same CCTrCH.

There are hence two types of CCTrCH:

1\) CCTrCH of dedicated type, corresponding to the result of coding and
multiplexing of one or several DCHs or one E-DCH.

2\) CCTrCH of common type, corresponding to the result of the coding and
multiplexing of a common channel, RACH in the uplink, HS-DSCH, BCH, or
FACH/PCH for the downlink.

#### 4.2.14.1 Allowed CCTrCH combinations for one UE

##### 4.2.14.1.1 Allowed CCTrCH combinations on the uplink

The following CCTrCH combinations for one UE are allowed:

1\) one CCTrCH of dedicated type or

1a) two CCTrCHs of dedicated type, one being of DCH type and the other
one of E-DCH type or

2\) one CCTrCH of common type.

##### 4.2.14.1.2 Allowed CCTrCH combinations on the downlink

The following CCTrCH combinations for one UE are allowed:

\- x CCTrCH of dedicated type + y CCTrCH of common type. The allowed
combination of CCTrCHs of dedicated and common type are given from UE
radio access capabilities. There can be a maximum of one CCTrCH of
common type for HS-DSCH. The maximum number of CCTrCHs of common type
for FACH is determined from UE capabilities. With one CCTrCH of common
type for HS-DSCH, there shall be only one CCTrCH of dedicated type.

NOTE 1: There is only one DPCCH in the uplink, hence one TPC bits flow
on the uplink to control possibly the different DPDCHs on the downlink,
part of the same or several CCTrCHs.

NOTE 2: There is only one DPCCH in the downlink, even with multiple
CCTrCHs. With multiple CCTrCHs, the DPCCH is transmitted on one of the
physical channels of that CCTrCH which has the smallest SF among the
multiple CCTrCHs. Thus there is only one TPC command flow and only one
TFCI word in downlink even with multiple CCTrCHs.

NOTE 3: in the current release, only 1 CCTrCH of dedicated type is
supported.

4.3 Transport format detection
------------------------------

If the transport format set of a TrCH *i* contains more than one
transport format, the transport format can be detected according to one
of the following methods:

\- TFCI based detection: This method is applicable when the transport
format combination is signalled using the TFCI field;

\- explicit blind detection: This method typically consists of detecting
the TF of TrCH *i* by use of channel decoding and CRC check;

\- guided detection: This method is applicable when there is at least
one other TrCH *i\'*, hereafter called guiding TrCH, such that:

\- the guiding TrCH has the same TTI duration as the TrCH under
consideration, i.e. F~i\'~ = F~i~;

\- different TFs of the TrCH under consideration correspond to different
TFs of the guiding TrCH;

\- explicit blind detection is used on the guiding TrCH.

If the transport format set for a TrCH *i* does not contain more than
one transport format with more than zero transport blocks, no explicit
blind transport format detection needs to be performed for this TrCH.
The UE can use guided detection for this TrCH or single transport format
detection, where the UE always assumes the transport format
corresponding to more than zero transport blocks for decoding.

For uplink, blind transport format detection is a network controlled
option. For downlink, the UE shall be capable of performing blind
transport format detection, if certain restrictions on the configured
transport channels are fulfilled.

### 4.3.1 Blind transport format detection

When no TFCI is available then explicit blind detection or guided
detection shall be performed on all TrCHs within the CCTrCH that have
more than one transport format and that do not use single transport
format detection. The UE shall only be required to support blind
transport format detection if all of the following restrictions are
fulfilled:

1\. either only one CCTrCH is received, or one CCTrCH of dedicated type
and one CCTrCH of common type for HS-DSCH are received by the UE;

> If only one CCTrCH is received by the UE, the following conditions
> apply to that CCTrCH and those TrCHs that are multiplexed on the
> CCTrCH. If one CCTrCH of dedicated type and one CCTrCH of common type
> for HS-DSCH are received by the UE, the following conditions apply to
> the dedicated type CCTrCH and the TrCHs that are multiplexed on the
> dedicated type CCTrCH.

2\. the number of CCTrCH bits received per radio frame is 600 or less;

3\. the number of transport format combinations of the CCTrCH is 64 or
less;

4\. fixed positions of the transport channels is used on the CCTrCH to
be detectable;

5\. convolutional coding is used on all explicitly detectable TrCHs;

6\. CRC with non-zero length is appended to all transport blocks on all
explicitly detectable TrCHs;

7\. at least one transport block shall be transmitted per TTI on each
explicitly detectable TrCH;

8\. the number of explicitly detectable TrCHs is 3 or less;

9\. for all explicitly detectable TrCHs *i*, the number of code blocks
in one TTI (C~i~) shall not exceed 1;

10\. the sum of the transport format set sizes of all explicitly
detectable TrCHs, is 16 or less. The transport format set size is
defined as the number of transport formats within the transport format
set;

11\. there is at least one TrCH that can be used as the guiding
transport channel for all transport channels using guided detection.

Examples of blind transport format detection methods are given in annex
A.

### 4.3.1A Single transport format detection

When no TFCI is available, then single transport format detection shall
be applied on all TrCHs within the CCTrCH that have a transport format
set not containing more than one transport format with more than zero
transport blocks and that do not use guided detection. The UE shall only
be required to support single transport format detection if the
following restrictions are fulfilled:

> 1\. For each transport channel that is single transport format
> detected, CRC with non-zero length is appended to all transport blocks
> within the non-zero transport block transport format;
>
> 2\. fixed positions of the transport channels is used on the CCTrCH to
> be detectable.

### 4.3.2 Transport format detection based on TFCI

If a TFCI is available, then TFCI based detection shall be applicable to
all TrCHs within the CCTrCH. The TFCI informs the receiver about the
transport format combination of the CCTrCHs. As soon as the TFCI is
detected, the transport format combination, and hence the transport
formats of the individual transport channels are known.

If higher layers indicate that S-CCPCHs can be soft combined during a
period of consecutive TTIs, then the same TFC is used on those S-CCPCHs
for each combinable TTI. The UE may therefore detect TFCI on one S-CCPCH
to determine the TFC on all S-CCPCHs that can be soft combined. (S-CCPCH
soft combining is further specified in \[4\]).

### 4.3.3 Coding of Transport-Format-Combination Indicator (TFCI)

The TFCI is encoded using a (32, 10) sub-code of the second order
Reed-Muller code. The coding procedure is as shown in figure 9.

![](media/image246.wmf){width="3.95in" height="0.7902777777777777in"}

Figure 9: Channel coding of TFCI information bits

If the TFCI consist of less than 10 bits, it is padded with zeros to 10
bits, by setting the most significant bits to zero. The length of the
TFCI code word is 32 bits.

The code words of the (32,10) sub-code of second order Reed-Muller code
are linear combination of 10 basis sequences. The basis sequences are as
in the following table 8.

Table 8: Basis sequences for (32,10) TFCI code

  ---- -------- -------- -------- -------- -------- -------- -------- -------- -------- --------
  i    M~i,0~   M~i,1~   M~i,2~   M~i,3~   M~i,4~   M~i,5~   M~i,6~   M~i,7~   M~i,8~   M~i,9~
  0    1        0        0        0        0        1        0        0        0        0
  1    0        1        0        0        0        1        1        0        0        0
  2    1        1        0        0        0        1        0        0        0        1
  3    0        0        1        0        0        1        1        0        1        1
  4    1        0        1        0        0        1        0        0        0        1
  5    0        1        1        0        0        1        0        0        1        0
  6    1        1        1        0        0        1        0        1        0        0
  7    0        0        0        1        0        1        0        1        1        0
  8    1        0        0        1        0        1        1        1        1        0
  9    0        1        0        1        0        1        1        0        1        1
  10   1        1        0        1        0        1        0        0        1        1
  11   0        0        1        1        0        1        0        1        1        0
  12   1        0        1        1        0        1        0        1        0        1
  13   0        1        1        1        0        1        1        0        0        1
  14   1        1        1        1        0        1        1        1        1        1
  15   1        0        0        0        1        1        1        1        0        0
  16   0        1        0        0        1        1        1        1        0        1
  17   1        1        0        0        1        1        1        0        1        0
  18   0        0        1        0        1        1        0        1        1        1
  19   1        0        1        0        1        1        0        1        0        1
  20   0        1        1        0        1        1        0        0        1        1
  21   1        1        1        0        1        1        0        1        1        1
  22   0        0        0        1        1        1        0        1        0        0
  23   1        0        0        1        1        1        1        1        0        1
  24   0        1        0        1        1        1        1        0        1        0
  25   1        1        0        1        1        1        1        0        0        1
  26   0        0        1        1        1        1        0        0        1        0
  27   1        0        1        1        1        1        1        1        0        0
  28   0        1        1        1        1        1        1        1        1        0
  29   1        1        1        1        1        1        1        1        1        1
  30   0        0        0        0        0        1        0        0        0        0
  31   0        0        0        0        1        1        1        0        0        0
  ---- -------- -------- -------- -------- -------- -------- -------- -------- -------- --------

When UL\_DPCH\_10ms\_Mode is not configured by higher layers, the TFCI
information bits a~0~ , a~1~ , a~2~ , a~3~ , a~4~ , a~5~ , a~6~ , a~7~ ,
a~8~ , a~9~ (where a~0~ is LSB and a~9~ is MSB) shall correspond to the
TFC index (expressed in unsigned binary form) defined by the RRC layer
to reference the TFC of the CCTrCH in the associated DPCH radio frame.

When UL\_DPCH\_10ms\_Mode is configured by higher layers, the TFCI
information bits a~0~ , a~1~ , a~2~ , a~3~ , a~4~ , a~5~ , a~6~ , a~7~ ,
a~8~ , a~9~ (where a~0~ is LSB and a~9~ is MSB) shall correspond to
unsigned binary expression of the sum of the TFC index and the size of
TFCS.

The output code word bits b~i~ are given by:

![](media/image247.wmf){width="1.7638888888888888in"
height="0.4722222222222222in"}

where *i* = 0, ..., 31.

The output bits are denoted by *b~k~*, *k* = 0, 1, 2, ..., 31.

In downlink, when the SF \< 128 the encoded TFCI code words are repeated
yielding 8 encoded TFCI bits per slot in normal mode and 16 encoded TFCI
bits per slot in compressed mode. Mapping of repeated bits to slots is
explained in subclause 4.3.5.

### 4.3.4 Void

### 4.3.5 Mapping of TFCI words

#### 4.3.5.1 Mapping of TFCI word in normal mode in downlink, and in uplink when uplink DPCCH slot format is not 5

The bits of the code word are directly mapped to the slots of the radio
frame. Within a slot the bit with lower index is transmitted before the
bit with higher index. The coded bits *b~k~*, are mapped to the
transmitted TFCI bits *d~k~*, according to the following formula:

*d~k~* = *b~k~* ~mod\ 32~

For uplink physical channels regardless of the SF and downlink physical
channels, if SF≥128, *k* = 0, 1, 2, ..., 29. Note that this means that
bits *b~30~* and *b~31~* are not transmitted.

For downlink physical channels whose SF \< 128, *k* = 0, 1, 2, ..., 119.
Note that this means that bits *b~0~* to *b~23~* are transmitted four
times and bits *b~24~* to *b~31~* are transmitted three times.

#### 4.3.5.1A Mapping of TFCI word in normal mode in uplink when uplink DPCCH slot format is 5

In each 20ms CI, the first 10 slots of uplink DPCCH contain TFCI bits.
The bits of the codeword are directly mapped to the slots of the radio
frame. Within a slot, the bit with lower index is transmitted before the
bit with higher index. The coded bits *b~k~*, are mapped to the
transmitted TFCI bits *d~k~*, according to the following formula:

*d~k~* = *b~k~, , for k = 0,..., 19.*

##### 4.3.5.1.1 Mapping of TFCI bits for Secondary CCPCH with 16QAM

For MBSFN transmissions with 16QAM, the coded bits *b~k~*, are mapped to
the transmitted TFCI bits according to the following formulas:

*d~4k~* = *b*~2k\ mod\ 32~ *,*

*d~4k+1~* = *b~2k~*~+1\ mod\ 32~ ,

*d~4k+2~* = *( d~4k~* *+ d~4k+1~ ) mod 2,*

*d~4k+3~* = *( 1* *+ d~4k~* *+ d~4k+1~ ) mod 2,*

where *k* = 0, 1, 2,..., 59 for SF \< 128 and *k* = 0, 1, 2,..., 14 for
SF≥128.

#### 4.3.5.2 Mapping of TFCI word in compressed mode

The mapping of the TFCI bits in compressed mode is different for uplink,
downlink with SF ≥ 128 and downlink with SF \< 128.

##### 4.3.5.2.1 Uplink compressed mode

##### 4.3.5.2.1.1 Uplink DPCCH slot formats other than 5 {#uplink-dpcch-slot-formats-other-than-5 .H6}

For uplink compressed mode, the slot format is changed so that no TFCI
coded bits are lost. The different slot formats in compressed mode do
not match the exact number of TFCI coded bits for all possible TGLs.
Repetition of the TFCI bits is therefore used.

Denote the number of bits available in the TFCI fields of one compressed
radio frame by *D* and the number of bits in the TFCI field in a slot by
N~TFCI~. The parameter *E* is used to determine the number of the first
TFCI bit to be repeated.

*E*= N~first~ N~TFCI~, if the start of the transmission gap is allocated
to the current frame.

*E* = *0*, if the start of the transmission gap is allocated to the
previous frame and the end of the transmission gap is allocated to the
current frame.

The TFCI coded bits *b~k~* are mapped to the bits in the TFCI fields
*d~k~*. The following relations define the mapping for each compressed
frame.

*d~k~* = *b~k~*

where *k* = 0, 1, 2, ..., min (31, *D*-1).

If *D* \> 32, the remaining positions are filled by repetition (in
reversed order):

*d~D-k~*~-1~ = *b*~(*E+k*)\ mod\ 32~

where *k* = 0, ..., *D*-33.

##### 4.3.5.2.1.2 Uplink DPCCH slot format 5 {#uplink-dpcch-slot-format-5 .H6}

In each 20ms CI, the first 10 UL DPCCH slots that are not in a
compressed mode transmission gap contain TFCI information. The bits of
the codeword are directly mapped to these slots. Within a slot, the bit
with lower index is transmitted before the bit with higher index. The
coded bits *b~k~*, are mapped to the transmitted TFCI bits *d~k~*,
according to the following formula:

*d~k~* = *b~k~, , for k = 0,..., 19.*

##### 4.3.5.2.2 Downlink compressed mode

For downlink compressed mode, the slot format is changed so that no TFCI
coded bits are lost. The different slot formats in compressed mode do
not match the exact number of TFCI bits for all possible TGLs. DTX is
therefore used if the number of bits available in the TFCI fields in one
compressed frame exceeds the number of TFCI bits given from the slot
format. The block of bits in the TFCI fields where DTX is used starts on
the first TFCI field after the transmission gap. If there are more bits
available in the TFCI fields before the transmission gap than TFCI bits,
DTX is also used on the bits in the last TFCI fields before the
transmission gap.

Denote the number of bits available in the TFCI fields of one compressed
radio frame by *D* and the number of bits in the TFCI field in a slot by
N~TFCI~. The parameter *E* is used to determine the position of the
first bit in the TFCI field on which DTX is used.

*E* = N~first~ N~TFCI~, if the start of the transmission gap is
allocated to the current frame.

*E* = 0, if the start of the transmission gap is allocated to the
previous frame and the end of the transmission gap is allocated to the
current frame.

Denote the total number of TFCI bits to be transmitted by *F*. *F* = 32
for slot formats *n*A or *n*B, where *n* = 0, 1, ..., 11 (see table 11
in \[2\]). Otherwise, *F* = 128. The TFCI coded bits *b~k~* are mapped
to the bits in the TFCI fields *d~k~*. The following relations define
the mapping for each compressed frame.

If *E* \> 0,

*d~k~* = *b~k~* ~mod\ 32~

where *k* = 0, 1, 2, ..., min (*E*, *F*)-1.

If *E* \< *F*,

*d~k+D-F~* = *b~k~* ~mod\ 32~

where *k* = *E*, \..., *F* -1.

DTX is used on *d~k~* where *k* = min (*E*, *F*), \..., min (*E*, *F*)
+*D* - *F* -1.

4.3A Mapping of DL FET ACK/NACK bits
------------------------------------

When slot format 5 is used for uplink DPCCH, TFCI fields in each 20ms
TTI contain DL FET ACK/NACK indicators in all transmitted slots that do
not contain TFCI bits (see subclauses 4.3.5.1A and 4.3.5.2.1.2). Each DL
FET ACK/NACK indicator is encoded as specified in Table 9. When
DL\_DCH\_FET\_Config = 0, the bits that replace DL FET ACK/NACK
indicators are unspecified.

Table 9: ACK/NACK transmission on uplink DPCCH

  --------------------------- ------------------
  DL FET ACK/NACK indicator   bits in slot *i*
  ACK                         1
  NACK                        0
  --------------------------- ------------------

Let the slots in a 20ms CI be numbered 0,1,...29. For each *i*
=0,1,...29, if slot *i* is not in a compressed-mode gap and does not
contain TFCI bits, then a DL FET NACK indicator is transmitted in slot
*i* if at least one of the following conditions holds:

a\) At least one of the transport blocks transmitted on downlink DPDCH
with a TTI that includes slot *i* has not been successfully decoded by
the UE.

b\) *i* belongs in the set S={11, 13, 15, 17, 19, 21, 23, 25, 27, 29},
and a DL FET ACK indication has not been sent in any prior slot *j,*0 *≤
j* \< *i,* in this 20ms TTI.

c\) A downlink slot containing bits of a non-zero transport block of a
maximum TTI TrCH overlaps with slot i.

A DL FET ACK indicator is sent in all transmitted UL DPCCH slots that do
not fall in a compressed mode gap and do not contain a DL FET NACK
indicator or TFCI bit. If a 20ms CI contains a DL FET ACK indication, it
always contains at least two slots carrying a DL FET ACK indication.

4.4 Compressed mode
-------------------

In compressed frames, TGL slots from N~first~ to N~last~ are not used
for transmission of data. As illustrated in figure 11, the instantaneous
transmit power is increased in the compressed frame in order to keep the
quality (BER, FER, etc.) unaffected by the reduced processing gain. The
amount of power increase depends on the transmission time reduction
method (see subclause 4.4.3). What frames are compressed, are decided by
the network. When in compressed mode, compressed frames can occur
periodically, as illustrated in figure 11, or requested on demand. The
rate and type of compressed frames is variable and depends on the
environment and the measurement requirements.

![](media/image248.wmf){width="6.139583333333333in"
height="2.4006944444444445in"}

Figure 11: Compressed mode transmission

### 4.4.1 Frame structure in the uplink

The frame structure for uplink compressed frames is illustrated in
figure 12.

![](media/image249.wmf){width="5.875694444444444in"
height="1.3215277777777779in"}

Figure 12: Frame structure in uplink compressed transmission

### 4.4.2 Frame structure types in the downlink

There are two different types of frame structures defined for downlink
compressed frames. Type A maximises the transmission gap length and type
B is optimised for power control. The frame structure type A or B is set
by higher layers independent from the downlink slot format type A or B.

\- With frame structure of type A, the pilot field of the last slot in
the transmission gap is transmitted. Transmission is turned off during
the rest of the transmission gap (figure 13(a)). In case the length of
the pilot field is 2 bits and STTD is used on the radio link, the pilot
bits in the last slot of the transmission gap shall be STTD encoded
assuming DTX indicators as the two last bits in the Data2 field.

\- With frame structure of type B, the TPC field of the first slot in
the transmission gap and the pilot field of the last slot in the
transmission gap is transmitted. Transmission is turned off during the
rest of the transmission gap (figure 13(b)). In case the length of the
pilot field is 2 bits and STTD is used on the radio link, the pilot bits
in the last slot of the transmission gap shall be STTD encoded assuming
DTX indicators as the two last bits of the Data2 field. Similarly, the
TPC bits in the first slot of the transmission gap shall be STTD encoded
assuming DTX indicators as the two last bits in the Data1 field.

![](media/image250.wmf){width="5.875694444444444in"
height="0.8284722222222223in"}

\(a\) Frame structure type A

![](media/image251.wmf){width="5.875694444444444in"
height="0.8284722222222223in"}

\(b\) Frame structure type B

Figure 13: Frame structure types in downlink compressed transmission

### 4.4.2A Frame structure in the downlink for F-DPCH

There is only one type of frame structure defined for downlink F-DPCH
compressed frames: transmission is turned off during the whole
transmission gap i.e. in slots N~first~ to N~last~.

### 4.4.2B Frame structure in the downlink for F-TPICH

There is only one type of frame structure defined for downlink F-TPICH
compressed frames: transmission is turned off during the whole
transmission gap i.e. in slots N~first~ to N~last~. TPI will not be
transmitted in either of the both slots *in the case where only one of
the two slots carrying the TPI information overlaps with the
transmission gap.*

### 4.4.3 Transmission time reduction method

When in compressed mode, the information normally transmitted during a
10 ms frame is compressed in time. The mechanisms provided for achieving
this are reduction of the spreading factor by a factor of two , and
higher layer scheduling. In the downlink and the uplink, all methods are
supported. The maximum idle length is defined to be 7 slots per one 10
ms frame. The slot formats that are used in compressed frames are listed
in \[2\].

In downlink when DL\_DCH\_FET\_Config is configured by higher layers,
and in uplink when UL\_DPCH\_10ms\_Mode is configured by higher layers,
the same slot format is used in compressed frames and normal frames.

In case F-DPCH is configured in the downlink, no transmission time
reduction method is needed during compressed frames. The same slot
format is used in compressed frames and normal frames.

#### 4.4.3.1 Void

#### 4.4.3.2 Compressed mode by reducing the spreading factor by 2

The spreading factor (SF) can be reduced by 2 during one compressed
radio frame to enable the transmission of the information bits in the
remaining time slots of the compressed frame. This method is not
supported for SF=4.

On the downlink, UTRAN can also order the UE to use a different
scrambling code in a compressed frame than in a non-compressed frame. If
the UE is ordered to use a different scrambling code in a compressed
frame, then there is a one-to-one mapping between the scrambling code
used in the non-compressed frame and the one used in the compressed
frame, as described in \[3\] subclause 5.2.1.

#### 4.4.3.3 Compressed mode by higher layer scheduling

Compressed frames can be obtained by higher layer scheduling. Higher
layers then set restrictions so that only a subset of the allowed TFCs
are used in a compressed frame. The maximum number of bits that will be
delivered to the physical layer during the compressed radio frame is
then known and a transmission gap can be generated. Note that in the
downlink, the TFCI field is expanded on the expense of the data fields
and this shall be taken into account by higher layers when setting the
restrictions on the TFCs. Compressed mode by higher layer scheduling
shall not be used with fixed starting positions of the TrCHs in the
radio frame. Compressed mode by higher layer scheduling shall not be
used when DL\_DCH\_FET\_Config is configured by higher layers.

### 4.4.4 Transmission gap position

Transmission gaps can be placed at different positions as shown in
figures 14 and 15 for each purpose such as interfrequency power
measurement, acquisition of control channel of other system/carrier, and
actual handover operation.

The restrictions listed below apply to DPCCH/DPCCH2/S-DPCCH/DPDCH in the
uplink and DPCH or F-DPCH in the downlink.

When using single frame method, the transmission gap is located within
the compressed frame depending on the transmission gap length (TGL) as
shown in figure 14 (1). When using double frame method, the transmission
gap is located on the center of two connected frames as shown in figure
14 (2).

![](media/image252.wmf){width="5.75in" height="2.725in"}

Figure 14: Transmission gap position

Parameters of the transmission gap positions are calculated as follows.

TGL is the number of consecutive idle slots during the compressed mode
transmission gap:

TGL = 3, 4, 5, 7, 10, 14

N~first~ specifies the starting slot of the consecutive idle slots,

N~first~ = 0,1,2,3,...,14.

N~last~ shows the number of the final idle slot and is calculated as
follows;

If N~first~ + TGL ≤ 15, then N~last~ = N~first~ + TGL --1 ( in the same
frame ),

If N~first~ + TGL \> 15, then N~last~ = (N~first~ + TGL -- 1) mod 15 (
in the next frame ).

When the transmission gap spans two consecutive radio frames, N~first~
and TGL must be chosen so that at least 8 slots in each radio frame are
transmitted.

![](media/image253.wmf){width="5.8069444444444445in" height="6.125in"}

Figure 15: Transmission gap positions with different Nfirst

### 4.4.5 Transmission gap position for E‑DCH

In the following, the transmission gap position for E‑DCH during
compressed frames is specified for the case when E‑DCH TTI length is 10
ms. Slots that are not idle due to uplink compressed mode are termed
\"available\".

The parameter *n~first~* and *n~last~* are used to determine the
transmission gap position due to uplink compressed mode in the current
radio frame. If the start of the transmission gap is allocated in the
current frame *n~first~*=*N~first~* else *n~first~*=0. If the end of a
transmission gap is allocated in the current frame *n~last~*=*N~last~*
else *n~last~*=14.

#### 4.4.5.1 E‑DPDCH Transmission Gap Position during Initial Transmissions

If an initial transmission overlaps with a compressed frame the starting
slot of the consecutive E‑DPDCH idle slots within the E‑DCH TTI is
*n~first~*, and *n~last~* is the final idle slot within the 10 ms E‑DCH
TTI. The number of transmitted slots *n~tx1~* is given by
*n~tx1~*=14+*n~first~*-*n~last~*.

If the initial transmission occurs in a non‑compressed uplink frame,
*n~tx1~*=15.

#### 4.4.5.2 E‑DPDCH Transmission Gap Position during Retransmissions

If the current retransmission occurs in a compressed frame the maximum
number of slots available for the retransmission is given by
*n~max~*=14+*n~first~*-*n~last~*. Else the maximum number of slots
available for the retransmission *n~max~* is 15.

If the initial transmission was compressed and in the retransmission
more than *n~tx1~* slots are available for transmission
(*n~max~*\>*n~tx1~*), the last *n~dtx~*=*n~max~*-*n~tx1~* available
slots of the E‑DPDCH frame are E‑DPDCH idle slots. The parameter
*n~tx1~* refers to the number of transmitted slots calculated as defined
in 4.4.5.1 for the corresponding initial transmission.

The E‑DPDCH transmission gap in case a retransmission occurs in a
compressed frame or a retransmission occurs in a non‑compressed frame
for which initial transmission was compressed is defined as follows:

> If *n~max\ ~*≤ *n~tx1~*
>
> E‑DPDCH idle slots are slots *n~first~*, *n~first~*+1, .., *n~last~*
>
> Else
>
> If a retransmission occurs in a compressed frame and *n~first~* \<
> *n~tx1~*
>
> E‑DPDCH idle slots are the slots *n~first~*, *n~first~*+1, ..,
> *n~last~* and 15-*n~dtx~*, 15-*n~dtx~*+1, ..,14
>
> Else
>
> E‑DPDCH idle slots are the slots *n~tx1~, n~tx1~+1,* ..,14

#### 4.4.5.3 E‑DPCCH Transmission Gap Position

If a transmission overlaps with an uplink compressed frame the starting
slot of the compressed mode gap within the E‑DCH TTI is *n~first~*, and
*n~last~* is the final E‑DPCCH idle slot within the 10 ms E‑DCH TTI.

4.5 Coding for HS-DSCH
----------------------

Data arrives to the coding unit in form of a maximum of one transport
block once every transmission time interval. The transmission time
interval is 2 ms which is mapped to a radio sub-frame of 3 slots.

The following coding steps can be identified:

\- add CRC to each transport block (see subclause 4.5.1);

\- bit scrambling (see subclause 4.5.1A);

\- code block segmentation (see subclause 4.5.2);

\- channel coding (see subclause 4.5.3);

\- hybrid ARQ (see subclause 4.5.4);

\- physical channel segmentation (see subclause 4.5.5);

\- interleaving for HS-DSCH (see subclause 4.5.6);

\- constellation re-arrangement for 16QAM and 64QAM (see subclause
4.5.7);

\- mapping to physical channels (see subclause 4.5.8).

The coding steps for HS-DSCH are shown in the figure below.

Figure 16: Coding chain for HS-DSCH

In the following the number of transport blocks and the number of
transport channels is always one i.e. m=1, i=1. When referencing non
HS-DSCH formulae which are used in correspondence with HS-DSCH formulae
the convention is used that transport block subscripts may be omitted
(e.g. X~1~ may be written X).

### 4.5.1 CRC attachment for HS-DSCH

#### 4.5.1.1 CRC attachment method 1 for HS-DSCH

CRC attachment method 1 for the HS-DSCH transport channel shall be done
using the general method described in 4.2.1 above with the following
specific parameters.

The CRC length shall always be L~1~ = 24 bits.

#### 4.5.1.2 CRC attachment method 2 for HS-DSCH

CRC attachment method 2 for the HS-DSCH transport channel shall be done
according to the following method.

From the sequence of bits *a~1~, a~2~, a~3~,..., a~A~* , where *A* is
the size of the HS-DSCH transport block*,* a CRC of length L~1~ = 24
bits is calculated according to Clause 4.2.1.1 above. This gives a
sequence of bits *c~im1~, c~im2~, c~im3~,..., c~im24\ ~* where

$c_{k} = p_{\text{im}(\text{25} - k)}$ *k=1,2,...,24*

This sequence of bits is then masked with the UE Identity *x~ue,1~,
x~ue,2~, ..., x~ue,16~* and then appended to the sequence of bits *a~1~,
a~2~, a~3~,..., a~A~* to form the sequence of bits *b~1~, b~2~,
b~3~,..., b~B~*, where *B* = *A* + 24, and

*b~k~ = a~k~ k=1,2,...,A*

*b~k~ = c~k-A~ k=A+1,...,A+8*

*b~k~ =* (*c~k-A~* + *x~ue~*,*~k-A-8~*) mod 2 *k=A+9, ...,A+24*

### 4.5.1A Bit scrambling for HS-DSCH

The bits output from the HS-DSCH CRC attachment are scrambled in the bit
scrambler. The bits input to the bit scrambler are denoted by
$b_{\text{im},1},b_{\text{im},2},b_{\text{im},3},\text{.}\text{.}\text{.},b_{\text{im},B}$,
where *B* is the number of bits input to the HS-DSCH bit scrambler The
bits after bit scrambling are denoted
$d_{\text{im},1},d_{\text{im},2},d_{\text{im},3},\text{.}\text{.}\text{.},d_{\text{im},B}$.

Bit scrambling is defined by the following relation:

$d_{\text{im},k} = \left( b_{\text{im},k} + y_{k} \right)\text{mod}2$
*k* = 1,2,...,*B*

and $y_{k}$ results from the following operation:

$y'_{\gamma} = 0$ -15 \< *γ*\< 1

$y'_{\gamma} = 1$ *γ*= 1

$y'_{\gamma} = \left( \sum_{x = 1}^{\text{16}}{g_{x} \cdot y'_{\gamma - x}} \right)\text{mod}2$
$1 < \gamma \leq B$,

where
$g = \left\{ g_{1},g_{2},\ldots,g_{\text{16}} \right\} = \left\{ 0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1 \right\}$
,

$y_{k} = y'_{k}$ *k* = 1,2,...,*B*.

### 4.5.2 Code block segmentation for HS-DSCH

Code block segmentation for the HS-DSCH transport channel shall be done
with the general method described in 4.2.2.2 above with the following
specific parameters.

There will be a maximum of one transport block, i=1. The bits *d~im1~,
d~im2~, d~im3~,...d~imB~* input to the block are mapped to the bits
x~i1~, x~i2~, x~i3~,...x~iXi~ directly. It follows that X~1~ = B. Note
that the bits x referenced here refer only to the internals of the code
block segmentation function. The output bits from the code block
segmentation function are o~ir1~, o~ir2~, o~ir3~,...o~irK~.

The value of Z = 5114 for turbo coding shall be used.

### 4.5.3 Channel coding for HS-DSCH

Channel coding for the HS-DSCH transport channel shall be done with the
general method described in 4.2.3 above with the following specific
parameters.

There will be a maximum of one transport block, i=1. The rate 1/3 turbo
coding shall be used.

### 4.5.4 Hybrid ARQ for HS-DSCH

The hybrid ARQ functionality matches the number of bits at the output of
the channel coder to the total number of bits of the HS-PDSCH set to
which the HS-DSCH is mapped. The hybrid ARQ functionality is controlled
by the redundancy version (RV) parameters. The exact set of bits at the
output of the hybrid ARQ functionality depends on the number of input
bits, the number of output bits, and the RV parameters.

The hybrid ARQ functionality consists of two rate-matching stages and a
virtual buffer as shown in the figure below.

The first rate matching stage matches the number of input bits to the
virtual IR buffer, information about which is provided by higher layers.
Note that, if the number of input bits does not exceed the virtual IR
buffering capability, the first rate-matching stage is transparent.

The second rate matching stage matches the number of bits after first
rate matching stage to the number of physical channel bits available in
the HS-PDSCH set in the TTI.

Figure 17: HS-DSCH hybrid ARQ functionality

#### 4.5.4.1 HARQ bit separation

The HARQ bit separation function shall be performed in the same way as
bit separation for turbo encoded TrCHs with puncturing in 4.2.7.4.1
above.

#### 4.5.4.2 HARQ First Rate Matching Stage

HARQ first stage rate matching for the HS-DSCH transport channel shall
be done with the general method described in 4.2.7.2.2.3 above with the
following specific parameters.

The maximum number of soft channel bits available in the virtual IR
buffer is N~IR~ which is signalled from higher layers for each HARQ
process. The number of coded bits in a TTI before rate matching is
N^TTI^ this is deduced from information signalled from higher layers and
parameters signalled on the HS-SCCH for each TTI. Note that HARQ
processing and physical layer storage occurs independently for each HARQ
process currently active.

If N~IR~ is greater than or equal to N^TTI^ (i.e. all coded bits of the
corresponding TTI can be stored) the first rate matching stage shall be
transparent. This can, for example, be achieved by setting
*e~minus~* = 0. Note that no repetition is performed.

If N~IR~ is smaller than N^TTI^ the parity bit streams are punctured as
in 4.2.7.2.2.3 above by setting the rate matching parameter
$\text{ΔN}_{\text{il}}^{\text{TTI}} = N_{\text{IR}} - N^{\text{TTI}}$where
the subscripts i and l refer to transport channel and transport format
in the referenced sub-clause. Note the negative value is expected when
the rate matching implements puncturing. Bits selected for puncturing
which appear as δ in the algorithm in 4.2.7 above shall be discarded and
not counted in the totals for the streams through the virtual IR buffer.

#### 4.5.4.3 HARQ Second Rate Matching Stage

HARQ second stage rate matching for the HS-DSCH transport channel shall
be done with the general method described in 4.2.7.5 above with the
following specific parameters. Bits selected for puncturing which appear
as *δ* in the algorithm in 4.2.7.5 above shall be discarded and are not
counted in the streams towards the bit collection.

The parameters of the second rate matching stage depend on the value of
the RV parameters s and r. The parameter s can take the value 0 or 1 to
distinguish between transmissions that prioritise systematic bits (s =
1) and non systematic bits (s = 0). The parameter r (range 0 to
*r~max~-1*) changes the initial error variable *e~ini~* in the case of
puncturing. In case of repetition both parameters *r* and *s* change the
initial error variable *e~ini~*. The parameters X~i~, e~plus~ and
e~minus~ are calculated as per table 10 below.

Denote the number of bits before second rate matching as *N~sys~* for
the systematic bits, *N~p1~* for the parity 1 bits, and *N~p2~* for the
parity 2 bits, respectively. Denote the number of physical channels used
for the HS-DSCH by *P*. *N~data~* is the number of bits available to the
HS-DSCH in one TTI and defined as *N~data~*=*P*×3×*N~data~*~1~, where
*N~data1~* is defined in \[2\]. The rate matching parameters are
determined as follows.

For $N_{\text{data}} \leq N_{\text{sys}} + N_{p1} + N_{p2}$, puncturing
is performed in the second rate matching stage. The number of
transmitted systematic bits in a transmission is
$N_{t,\text{sys}} = \text{min}\left\{ N_{\text{sys}},N_{\text{data}} \right\}$
for a transmission that prioritises systematic bits and
$N_{t,\text{sys}} = \text{max}\left\{ N_{\text{data}} - \left( N_{p1} + N_{p2} \right),0 \right\}$
for a transmission that prioritises non systematic bits.

For $N_{\text{data}} > N_{\text{sys}} + N_{p1} + N_{p2}$ repetition is
performed in the second rate matching stage. A similar repetition rate
in all bit streams is achieved by setting the number of transmitted
systematic bits to
$N_{t,\text{sys}} = \left\lfloor N_{\text{sys}} \cdot \frac{N_{\text{data}}}{N_{\text{sys}} + 2N_{p1}} \right\rfloor$.

The number of parity bits in a transmission is:
$N_{t,p1} = \left\lfloor \frac{N_{\text{data}} - N_{t,\text{sys}}}{2} \right\rfloor$
and
$N_{t,p2} = \left\lceil \frac{N_{\text{data}} - N_{t,\text{sys}}}{2} \right\rceil$
for the parity 1 and parity 2 bits, respectively.

Table 10 below summarizes the resulting parameter choice for the second
rate matching stage.

Table 10: Parameters for HARQ second rate matching

  ------------- -------- ----------- ------------
                *X~i~*   *e~plus~*   *e~minus~*

  Systematic\                        
  RM S                               

  Parity 1\                          
  RM P1\_2                           

  Parity 2\                          
  RM P2\_2                           
  ------------- -------- ----------- ------------

The rate matching parameter *e~ini~* is calculated for each bit stream
according to the RV parameters r and s using

$e_{\text{ini}}(r) = \left\{ \left( X_{i} - \left\lfloor \frac{r \cdot e_{\text{plus}}}{r_{\text{max}}} \right\rfloor - 1 \right)\ \text{mod}e_{\text{plus}} \right\} + 1$
in the case of puncturing ,
i.e.,$N_{\text{data}} \leq N_{\text{sys}} + N_{p1} + N_{p2}$, and

$e_{\text{ini}}(r) = \left\{ \left( X_{i} - \left\lfloor (s + 2 \cdot r\frac{) \cdot e_{\text{plus}}}{(}2 \cdot r_{\text{max}}) \right\rfloor - 1 \right)\ \text{mod}e_{\text{plus}} \right\} + 1$
for repetition, i.e.,
$N_{\text{data}} > N_{\text{sys}} + N_{p1} + N_{p2}$. Where and is the
total number of redundancy versions allowed by varying as defined in
4.6.2. Note that r~max~ varies depending on the modulation mode, i.e.
for 16QAM and 64QAM, *r~max~* = 2 and for QPSK *r~max~* = 4.

Note: For the modulo operation the following clarification is used: the
value of (x mod y) is strictly in the range of 0 to *y*-1 (i.e. -1 mod
10 = 9).

#### 4.5.4.4 HARQ bit collection

The HARQ bit collection is achieved using a rectangular interleaver of
size .

The number of rows and columns are determined from:

$N_{\text{row}} = 6$ for 64QAM,$N_{\text{row}} = 4$ for 16QAM and
$N_{\text{row}} = 2$ for QPSK

$N_{\text{col}} = \frac{N_{\text{data}}}{N_{\text{row}}}$

where *N~data~* is used as defined in 4.5.4.3.

Data is written into the interleaver column by column, and read out of
the interleaver column by column starting from the first column.

*N~t,sys~* is the number of transmitted systematic bits. Intermediate
values *N~r~* and *N~c~* are calculated using:

$N_{r} = \left\lfloor \frac{N_{t,\text{sys}}}{N_{\text{col}}} \right\rfloor$
and $N_{c} = N_{t,\text{sys}} - N_{r} \cdot N_{\text{col}}$.

If *N~c~*=0 and *N~r\ ~*\> 0, the systematic bits are written into rows
1...*N~r~.*

Otherwise systematic bits are written into rows 1...*N~r~+1* in the
first *N~c~* columns and, if *N~r\ ~*\> 0, also into rows 1...*N~r~* in
the remaining *N~col~-N~c~* columns.

The remaining space is filled with parity bits. The parity bits are
written column wise into the remaining rows of the respective columns.
Parity 1 and 2 bits are written in alternating order, starting with a
parity 2 bit in the first available column with the lowest index number.

In the case of 64QAM for each column the bits are read out of the
interleaver in the order row 1, row 2, row 3, row 4, row 5, row 6. In
the case of 16QAM for each column the bits are read out of the
interleaver in the order row 1, row 2, row 3, row 4. In the case of QPSK
for each column the bits are read out of the interleaver in the order
row1, row2.

### 4.5.5 Physical channel segmentation for HS-DSCH

When more than one HS-PDSCH is used, physical channel segmentation
divides the bits among the different physical channels. The bits input
to the physical channel segmentation are denoted by w~1~, w~2~,
w~3~,...w~R~, where R is the number of bits input to the physical
channel segmentation block. The number of PhCHs is denoted by *P.*

The bits after physical channel segmentation are denoted
![](media/image260.wmf){width="1.2916666666666667in"
height="0.2638888888888889in"}, where *p* is PhCH number and *U* is the
number of bits in one radio sub-frame for each HS-PDSCH, i.e. . The
relation between w*~k~* and *u~p,k~* is given below.

For all modes, some bits of the input flow are mapped to each code until
the number of bits on the code is *U*.

Bits on first PhCH after physical channel segmentation:

*u~1,\ k~ = w~k~ k =* 1, 2 , ..., *U*

Bits on second PhCH after physical channel segmentation:

*u~2,\ k~ = w~k+U~* *k =* 1, 2 , ..., *U*

...

Bits on the *P^th^* PhCH after physical channel segmentation:

*u~P,k~ = w~k+(P-1)~*~×*U*~ *k =* 1, 2 , ..., *U*

### 4.5.6 Interleaving for HS-DSCH

The interleaving for FDD is done as shown in figure 18 below, separately
for each physical channel. The bits input to the block interleaver are
denoted by $u_{p,1},u_{p,2},u_{p,3},\text{.}\text{.}\text{.},u_{p,U}$,
where *p* is PhCH number and *U* is the number of bits in one TTI for
one PhCH. For QPSK *U* = 960, for 16QAM *U* = 1920 and for 64QAM *U* =
2880. The basic interleaver is as the 2^nd^ interleaver described in
Clause 4.2.11. The interleaver is of fixed size: R2=32 rows and C2=30
columns.

![](media/image262.wmf){width="6.5in" height="3.013888888888889in"}

Figure 18: Interleaver structure for HS-DSCH

For 16QAM, there are two identical interleavers of the same fixed size
R2×C2 = 32×30. The output bits from the physical channel segmentation
are divided two by two between the interleavers: bits *u~p,k~* and
u~p,k+1~ go to the first interleaver and bits *u~p,k+2~* and *u~p,k+3~*
go to the second interleaver. Bits are collected two by two from the
interleavers: bits *v~p,k~* and *v~p,k+1~*are obtained from the first
interleaver and bits *v~p,k+2~* and *v~p,k+3~* are obtained from the
second interleaver, where k mod 4=1.

For 64QAM, there are three identical interleavers of the same fixed size
R2×C2 = 32×30. The output bits from the physical channel segmentation
are divided two by two between the interleavers: bits *u~p,k~* and
u~p,k+1~ go to the first interleaver, bits *u~p,k+2~* and *u~p,k+3~* go
to the second interleaver and bits *u~p,k+4~* and *u~p,k+5~* go to the
third interleaver. Bits are collected two by two from the interleavers:
bits *v~p,k~* and *v~p,k+1~*are obtained from the first interleaver,
bits *v~p,k+2~* and *v~p,k+3~* are obtained from the second interleaver
and bits *v~p,k+4~* and *v~p,k+5~* are obtained from the third
interleaver, where k mod 6=1.

### 4.5.7 Constellation re-arrangement for 16 QAM and 64QAM

This function only applies to 16QAM and 64QAM modulated bits. In case of
QPSK it is transparent.

Table 11 describes the operations that produce the different
rearrangements for 16QAM. The bits of the input sequence are mapped in
groups of 4 so that *v~p,k~, v~p,k+1~, v~p,k+2~, v~p,k+3~* are used,
where k mod 4 = 1. The output bit sequences map to the output bits in
groups of 4, i.e. *r~p,k~, r~p,k+1~, r~p,k+2~, r~p,k+3~*, where k mod 4
= 1.

Table 11: Constellation re-arrangement for 16QAM

  ------------------------------------- --------------------- -----------------------------------------------------------------
  constellation version parameter *b*   Output bit sequence   Operation
  0                                                           None
  1                                                           Swapping MSBs with LSBs
  2                                                           Inversion of the logical values of LSBs
  3                                                           Swapping MSBs with LSBs and inversion of logical values of LSBs
  ------------------------------------- --------------------- -----------------------------------------------------------------

Table 11A describes the operations that produce the different
rearrangements for 64QAM. The bits of the input sequence are mapped in
groups of 6 so that *v~p,k~, v~p,k+1~, v~p,k+2~, v~p,k+3~, v~p,k+4~,
v~p,k+5~* are used, where k mod 6 = 1. The output bit sequences map to
the output bits in groups of 6, i.e. *r~p,k~, r~p,k+1~, r~p,k+2~,
r~p,k+3~, r~p,k+4~, r~p,k+5~*, where k mod 6 = 1.

Table 11A: Constellation re-arrangement for 64QAM

  ------------------------------------- --------------------- -------------------------------------------------------------
  constellation version parameter *b*   Output bit sequence   Operation
  0                                                           None
  1                                                           Swapping MSBs and LSBs. Inversion of Middle SBs
  2                                                           Left circular shift of pair of SBs. Inversion of Middle SBs
  3                                                           Inversion of Middle SBs
  ------------------------------------- --------------------- -------------------------------------------------------------

### 4.5.8 Physical channel mapping for HS-DSCH

The HS-PDSCH is defined in \[2\]. The bits input to the physical channel
mapping are denoted by *r~p,1~*, *r~p,2~*,\...,*r~p,U~*, where *p* is
the physical channel number and *U* is the number of bits in one radio
sub-frame for one HS-PDSCH. The bits *r~p,k~* are mapped to the PhCHs so
that the bits for each PhCH are transmitted over the air in ascending
order with respect to *k*.

4.6 Coding for HS-SCCH type 1
-----------------------------

### 4.6.1 Overview

HS-SCCH shall be of type 1 when the following two conditions are both
true:

\- the UE is not configured in MIMO mode and not in MIMO mode with four
transmit antennas, and

\- the conditions for usage of HS-SCCH type 2 are not met.

In this section, the terms "HS-SCCH" and "HS-SCCH type 1" are used
interchangeably.

The following information is transmitted by means of the HS-SCCH type 1
physical channel.

\- Channelization-code-set information (7 bits): *x~ccs,1~, x~ccs,2~,
..., x~ccs,7~*

\- Modulation scheme information (1 bit): *x~ms,1~*

\- Transport-block size information (6 bits): *x~tbs,1~, x~tbs,2~, ...,
x~tbs,6~*

\- Hybrid-ARQ process information (3 bits): *x~hap,1~, x~hap,2~,
x~hap,3~*

\- Redundancy and constellation version (3 bits): *x~rv,1~, x~rv,2~,
x~rv,3~*

\- New data indicator (1 bit): *x~nd,1~*

\- UE identity (16 bits): *x~ue,1~, x~ue,2~, ..., x~ue,16~*

For an HS-SCCH order,

\- x~ccs,1~, x~ccs,2~, ..., x~ccs,7~*,* x~ms,1~ shall be set to
\'\'11100000'

\- x~tbs,1~, x~tbs,2~, ..., x~tbs,~~4~ *shall be set to \'\'*1111*'*

\- x~tbs,5~*,* ~tbs,6~ *shall be set to* x~eodt,1~, x~eodt,2~

\- x~hap,1~, x~hap,2~, x~hap,3~, x~rv,1~, x~rv,2~, x~rv,3~ *shall be set
to* x~odt,1~, x~odt,2~, x~odt,3~*, x~ord,1~, x~or~*~d,2~, x~ord,3~

\- x~nd,1~ *is reserved*

*where x~eodt,1~, x~eodt,2~, x~odt,1~, x~odt,2~, x~odt,3~, x~ord,1~,
x~ord,2~, x~ord,3~ are defined in subclause 4.6C.*

Figure 19 below illustrates the overall coding chain for HS-SCCH type 1.

Figure 19: Coding chain for HS-SCCH type 1

### 4.6.2 HS-SCCH information field mapping

#### 4.6.2.1 Redundancy and constellation version coding

The redundancy version (RV) parameters *r*, *s* and constellation
version parameter *b* are coded jointly to produce the value X~rv~.
X~rv~ is alternatively represented as the sequence x~rv,1~, x~rv,2~,
x~rv,3~ where x~rv,1~ is the MSB. This is done according to tables 12
and 13 according to the modulation mode used:

Table 12: RV coding for 16QAM and 64QAM

  --------------- --- --- ---
  X~rv~ (value)   s   R   b
  0               1   0   0
  1               0   0   0
  2               1   1   1
  3               0   1   1
  4               1   0   1
  5               1   0   2
  6               1   0   3
  7               1   1   0
  --------------- --- --- ---

Table 13: RV coding for QPSK

  --------------- --- ---
  X~rv~ (value)   s   r
  0               1   0
  1               0   0
  2               1   1
  3               0   1
  4               1   2
  5               0   2
  6               1   3
  7               0   3
  --------------- --- ---

#### 4.6.2.2 Modulation scheme mapping

The value of *x~ms,1~* is derived from the modulation and given by the
following:

#### 4.6.2.3 Channelization code-set mapping

The channelization code-set bits x~ccs,1~, x~ccs,2~, ..., x~ccs,7~ are
coded according to the following:

Given P (multi-)codes starting at code O, and given the HS-SCCH number
if 64QAM is configured for the UE and x~ms,1~=1, calculate the
information-field using the unsigned binary representation of integers
calculated by the expressions,

for the first three bits (code group indicator) of which *x~ccs,1~* is
the MSB:

*x~ccs,1~, x~ccs,2~, x~ccs,3~* = min(P-1,15-P)

If 64QAM is not configured for the UE, or if 64QAM is configured and
x~ms,1~=0, then

for the last four bits (code offset indicator) of which *x~ccs,4~* is
the MSB:

*x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,7~* = \|O-1-P/8 \*15\|

Otherwise (i.e. if 64QAM is configured for the UE and x~ms,1~=1),

*P* and *O* shall fulfil \|O-1-P/8 \*15\| mod 2 = (HS‑SCCH
number) mod 2, and then

*x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,dummy~* = \|O-1-P/8 \*15\|, where
*x~ccs,dummy~* is a dummy bit that is not transmitted on HS-SCCH.

Furthermore,

$x_{\text{ccs},7} = \left\{ \begin{matrix}
0 & \begin{matrix}
\text{if} & \text{16}\text{QAM} \\
\end{matrix} \\
1 & \begin{matrix}
\text{if} & \text{64}\text{QAM} \\
\end{matrix} \\
\end{matrix} \right.\ $.

The definitions of P and O are given in \[3\]. The HS-SCCH number is
given by the position in the list of HS-SCCH Channelisation Code
Informations signalled by higher layers. The HS-SCCH number is
associated with the code offset indicator and code group indicator as
described above if 64QAM is configured for the UE and x~ms,1~=1.

#### 4.6.2.4 UE identity mapping

The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined
in \[13\]. This is mapped such that x~ue,1~ corresponds to the MSB and
x~ue,16~ to the LSB, cf. \[14\].

#### 4.6.2.5 HARQ process identifier mapping

Hybrid-ARQ process information (3 bits) *x~hap,1~, x~hap,2~, x~hap,3~*
is the unsigned binary representation of the HARQ process identifier
where *x~hap,1~* is MSB.

#### 4.6.2.6 Transport block size index mapping

Transport-block size information (6 bits) *x~tbs,1~, x~tbs,2~, ...,
x~tbs,6\ ~* is unsigned binary representation of the transport block
size index where *x~tbs,1~* is MSB.

### 4.6.3 Multiplexing of HS-SCCH information

The channelization-code-set information *x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~* and modulation-scheme information *x~ms,1~* are multiplexed
together. This gives a sequence of bits *x~1,1~, x~1,2~, ..., x~1,8~*
where

*x~1,i~ = x~ccs,i~ i=1,2,...,7*

*x~1,i~ = x~ms,i-7~ i=8*

The transport-block-size information *x~tbs,1~, x~tbs,2~, ...,
x~tbs,6~*, Hybrid-ARQ-process information *x~hap,1~,x~hap,2~, x~hap,3~*,
redundancy-version information *x~rv,1~, x~rv,2~*, x~rv,3~ and new-data
indicator *x~nd,1~* are multiplexed together. This gives a sequence of
bits *x~2,1~, x~2,2~, ..., x~2,13~* where

*x~2,i~ = x~tbs,i~ i=1,2,...,6*

*x~2,i~ = x~hap,i-6~ i=7,8,9*

*x~2,i~ = x~rv,i-9~ i=10,11,12*

*x~2,i~ = x~nd,i-12~ i=13*

### 4.6.4 CRC attachment for HS-SCCH

From the sequence of bits *x~1,1~, x~1,2~, ..., x~1,8,~ x~2,1~, x~2,2~,
..., x~2,13~* a 16 bits CRC is calculated according to Clause 4.2.1.1.
This gives a sequence of bits *c~1~, c~2~, ..., c~16\ ~*where

$c_{k} = p_{\text{im}(\text{17} - k)}$ *k=1,2,...,16*

This sequence of bits is then masked with the UE Identity *x~ue,1~,
x~ue,2~, ..., x~ue,16~* and then appended to the sequence of bits
*x~2,1~, x~2,2~, ..., x~2,13~* to form the sequence of bits *y~1~, y~2~,
..., y~29~*, where

*y~i~ = x~2,i~ i=1,2,...,13*

*y~i~ =* (*c~i-13~* + *x~ue~*,~i-13~ ) mod 2 *i=14,15,...,29*

### 4.6.5 Channel coding for HS-SCCH

Rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is
applied to the sequence of bits x*~1,1~,x~1,2~, ...,x~1,8~*~.~ This
gives a sequence of bits *z~1,1~, z~1,2~, ..., z~1,48~*~.~

Rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is
applied to the sequence of bits *y~1~, y~2~, ..., y~29~*~.~ This gives a
sequence of bits *z~2,1~, z~2,2~, ..., z~2,111~*~.~

Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.

### 4.6.6 Rate matching for HS-SCCH

From the input sequence *z~1,1~, z~1,2~, ..., z~1,48~* the bits *z~1,1~,
z~1,2~, z~1,4~, z~1,8~, z~1,42~, z~1,45~, z~1,47~, z~1,48~* are
punctured to obtain the output sequence *r~1,1~,r~1,2~...r~1,40~.*

From the input sequence *z~2,1~, z~2,2~, ..., z~2,111~* the bits
*z~2,1~, z~2,2~, z~2,3~, z~2,4~, z~2,5~, z~2,6~, z~2,7~, z~2,8~,
z~2,12~, z~2,14~, z~2,15~, z~2,24~, z~2,42~, z~2,48~, z~2,54~, z~2,57~,
z~2,60~, z~2,66~, z~2,69~, z~2,96~, z~2,99~, z~2,101~, z~2,102~,
z~2,104~, z~2,105~, z~2,106~, z~2,107~, z~2,108~, z~2,109~, z~2,110~,
z~2,111~* are punctured to obtain the output sequence
*r~2,1~,r~2,2~...r~2,80~*.

### 4.6.7 UE specific masking for HS-SCCH

The rate matched bits *r~1,1~,r~1,2~...r~1,40~* shall be masked in an UE
specific way using the UE identity *x~ue,1~, x~ue,2~, ..., x~ue,16~,* to
produce the bits *s~1,1~,s~1,2~...s~1,40~*.

Intermediate code word bits b~i~, i=1,2...,48, are defined by encoding
the UE identity bits using the rate ½ convolutional coding described in
Clause 4.2.3.1. Eight bits out of the resulting 48 convolutionally
encoded bits are punctured using the rate matching rule of Clause 4.6.6
for the HS-SCCH part 1 sequence, that is, the intermediate code word
bits b~1~, b~2~, b~4~, b~8~, b~42~, b~45~, b~47~, b~48,~ are punctured
to obtain the 40 bit UE specific scrambling sequence c~1~, c~2~,
....c~40~. *.*

The mask output bits *s~1,1~,s~1,2~...s~1,40~* are calculated as
follows:

*s~1,k~ =*(*r~1,k~ + c~k~*) *mod 2* for k = 1,2...40

### 4.6.8 Physical channel mapping for HS-SCCH

The HS-SCCH sub-frame is described in\[2\].

The sequence of bits *s~1,1~, s~1,2~,, ..., s~1,40~* is mapped to the
first slot of the HS-SCCH sub frame. The bits *s~1,k~* are mapped to the
PhCHs so that the bits for each PhCH are transmitted over the air in
ascending order with respect to *k*.

The sequence of bits *r~2,1~, r~2,2~,, ...,,r~2,80~* is mapped to the
second and third slot of the HS-SCCH sub frame. The bits *r~2,k~* are
mapped to the PhCHs so that the bits for each PhCH are transmitted over
the air in ascending order with respect to *k*.

4.6A Coding for HS-SCCH type 2
------------------------------

### 4.6A.1 Overview

HS-SCCH type 2 is used for HS-SCCH-less operation. HS-SCCH type 2 is not
used when the UE is configured in MIMO mode or in MIMO mode with four
transmit antennas. During second and third transmission, the following
information is transmitted by means of the HS-SCCH type 2 physical
channel.

\- Channelization-code-set information (7 bits): *x~ccs,1~, x~ccs,2~,
..., x~ccs,7~*

\- Modulation scheme information (1 bit): *x~ms,1~*

\- Special Information type (6 bits): *x~type,1~, x~type,2~, ...,
x~type,6~*

\- Special Information (7 bits): *x~info,1~, x~info,2~, x~info,3~,
x~info,4~, x~info,5~, x~info,6~, x~info,7~*

\- UE identity (16 bits): *x~ue,1~, x~ue,2~, ..., x~ue,16~*

Figure 19A below illustrates the overall coding chain for HS-SCCH type
2.

Figure 19A: Coding chain for HS-SCCH type 2

### 4.6A.2 HS-SCCH Type 2 information field mapping

##### 4.6A.2.1 The first transmission

When HS-SCCH\_less\_mode=1 for a UE (as defined in \[4\]), the first
transmission of an HS-DSCH transport block using CRC attachment method 2
shall be sent without an associated HS-SCCH. In this case, the UE shall
use the following signalling values in order to attempt to decode the
transport block:

\- Channelization-code-set information: *Configured by higher layers*

\- Modulation scheme information: *QPSK*

\- Transport-block size information: *Each of four possible sizes
configured by higher layers*

\- Redundancy and constellation version: X~rv~ *=0* (see 4.6.2.1)

\- UE identity: *Configured by higher layers*

##### 4.6A.2.2 The second and the third transmissions

For HS-SCCH\_less\_mode=1 there are at maximum 3 transmissions for a
HS-DSCH transport block using CRC attachment method 2. The 2^nd^ and
3^rd^ transmissions of a transport block that was sent without an
associated HS-SCCH in the first transmission, as described in subclause
4.6A.2.1.1, are associated with an HS-SCCH of type 2.

###### 4.6A.2.2.1 Special Information mapping

The Special Information type *x~type,1~, x~type,2~, ..., x~type,6~*
shall be set to \'\'111110' to indicate HS-SCCH less operation.

The Special Information bits *x~info,1~, x~info,2~, ..., x~info,7~ are
comprised of:*

> \- Transport-block size information (2 bits): *x~info,1~, x~info,2~* =
> *x~tbs,1~, x~tbs,2~*
>
> \- Pointer to the previous transmission (3 bits): *x~info,3~,
> x~info,4~, x~info,5~* = *x~ptr,1~, x~ptr,2~, x~ptr,3~*
>
> \- Second or third transmission (1 bit): *x~info,6~* = *x~sec,1~*
>
> \- Reserved (1 bit): *x~info,7~* = *x~res,1~*

####### 4.6A.2.2.1.1 Transport-block size information mapping

The Transport-block size information (2 bits) *x~tbs,1~, x~tbs,2~* is
the unsigned binary representation of a reference to one of the four
Transport-block sizes and the associated number of HS-PDSCH codes for
the first transmission configured by higher layers.

  -------------------- ------------------------------------------------------------------------------------------------------------------------
  x~tbs,1~, x~tbs,2~   **Entry in "Transport Block size list" as signalled in the HS-SCCH-less Information of HS\_SCCH\_LESS\_PARAMS \[13\]**
  \'\'00'              1^st^ entry
  \'\'01'              2^nd^ entry
  \'\'10'              3^rd^ entry
  \'\'11'              4^th^ entry
  -------------------- ------------------------------------------------------------------------------------------------------------------------

####### 4.6A.2.2.1.2 Pointer to the previous transmission mapping

Pointer to the previous transmission (3 bits) *x~ptr,1~, x~ptr,2~,
x~ptr,3\ ~* is the unsigned binary representation of s, such that the
previous transmission of the same transport block started (6+s)
subframes before the start of this transmission.

####### 4.6A.2.2.1.3 Second or third transmission mapping

Second or Third transmission (1 bit) indicates whether this is the
second or third transmission.

If *x~sec,1~*= *\'\'0'*, this is a second transmission.

If *x~sec,1~*= *\'\'1'*, this is a third transmission.

###### 4.6A.2.2.2 Redundancy and Constellation Version mapping

The redundancy version X~rv~ for the second and third transmissions
shall be equal to 3 and 4 respectively, as defined in Table 13.

###### 4.6A.2.2.3 Modulation scheme mapping

The value of *x~ms,1~* shall be set to \'\'0' (QPSK).

###### 4.6A.2.2.4 Channelization code-set mapping

The channelization code-set bits *x~ccs,1~, x~ccs,2~, ..., x~ccs,7~* are
coded as per clause 4.6.2.3 where the value of P shall be set to either
1 or 2.

###### 4.6A.2.2.5 UE identity mapping

The UE identity is encoded as per clause 4.6.2.4.

### 4.6A.3 Multiplexing of HS-SCCH Type 2 information

The channelization-code-set information *x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~* and modulation-scheme information *x~ms,1~* are multiplexed
together. This gives a sequence of bits *x~1,1~, x~1,2~, ..., x~1,8~*
where

*x~1,i~ = x~ccs,i~ i=1,2,...,7*

*x~1,i~ = x~ms,i-7~ i=8*

The Special Information type *x~type,1~, x~type,2~, ..., x~type,6~*, and
Special Information *x~info,1~, x~info,2~, x~info,3~, x~info,4~,
x~info,5~, x~info,6~, x~info,7~* are multiplexed together. This gives a
sequence of bits *x~2,1~, x~2,2~, ..., x~2,13~* where

*x~2,i~ = x~type,i~ i=1,2,...,6*

*x~2,i~ = x~info,i-6~ i=7,8,...,13*

### 4.6A.4 CRC attachment for HS-SCCH Type 2

The sequence of bits *y~1~, y~2~, ..., y~29~*, is calculated according
to Clause 4.6.4.

### 4.6A.5 Channel coding for HS-SCCH Type 2

Channel coding is performed according to Clause 4.6.5.

### 4.6A.6 Rate matching for HS-SCCH Type 2

Rate matching is performed according to Clause 4.6.6.

### 4.6A.7 UE specific masking for HS-SCCH Type 2

The mask output bits *s~1,1~,s~1,2~...s~1,40~* are calculated according
to Clause 4.6.7.

### 4.6A.8 Physical channel mapping for HS-SCCH Type 2

Physical channel mapping is performed according to Clause 4.6.8.

4.6B Coding for HS-SCCH type 3
------------------------------

### 4.6B.1 Overview

HS-SCCH type 3 is used when the UE is configured in MIMO mode. If one
transport block is transmitted on the associated HS-PDSCH(s) or an
HS-SCCH order is transmitted, the following information is transmitted
by means of the HS-SCCH type 3 physical channel:

\- Channelization-code-set information (7 bits): *x~ccs,1~, x~ccs,2~,
..., x~ccs,7~*

\- Modulation scheme and number of transport blocks information (3
bits): *x~ms,1~, x~ms,2~, x~ms,3~*

\- Precoding weight information (2 bits): *x~pwipb,1~, x~pwipb,2~*

\- Transport-block size information (6 bits): *x~tbspb,1~, x~tbspb,2~,
..., x~tbspb,6~*

\- Hybrid-ARQ process information (4 bits): *x~hap,1~, x~hap,2~, ...,
x~hap,4~*

\- Redundancy and constellation version (2 bits): *x~rvpb,1~, x~rvpb,2~*

\- UE identity (16 bits): *x~ue,1~, x~ue,2~, ..., x~ue,16~*

For an HS-SCCH order,

\- x~ccs,1~, x~ccs,2~, ..., x~ccs,7~*,* x~ms,1~, x~ms,2~, x~ms,3~*,*
x~pwipb,1~, x~pwipb,2~ shall be set to \'\'111000000000'

\- x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,4~ *shall be set to \'\'*1111*'*

\- x~tbspb,5~*,* x~tbspb,6~ *shall be set to* x~eodt,1~, x~eodt,2~

\- x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~, x~rvpb,1~, x~rvpb,2~ *shall
be set to* x~odt,1~, x~odt,2~, x~odt,3~*, x~ord,1~, x~or~*~d,2~,
x~ord,3~

*where x~eodt,1~, x~eodt,2~*, *x~odt,1~, x~odt,2~, x~odt,3~, x~ord,1~,
x~ord,2~, x~ord,3~ are defined in subclause 4.6C.*

If two transport blocks are transmitted on the associated HS-PDSCHs (not
applicable when single-stream restriction is configured), the following
information is transmitted by means of the HS-SCCH type 3 physical
channel:

\- Channelization-code-set information (7 bits): *x~ccs,1~, x~ccs,2~,
..., x~ccs,7~*

\- Modulation scheme and number of transport blocks information (3
bits): *x~ms,1~, x~ms,2~, x~ms,3~*

\- Precoding weight information for the primary transport block (2
bits): *x~pwipb,1~, x~pwipb,2~*

\- Transport-block size information for the primary transport block (6
bits): *x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~*

\- Transport-block size information for the secondary transport block (6
bits): *x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6~*

\- Hybrid-ARQ process information (4 bits): *x~hap,1~, x~hap,2~,...,
x~hap,4~*

\- Redundancy and constellation version for the primary transport block
(2 bits): *x~rvpb,1~, x~rvpb,2~*

\- Redundancy and constellation version for the secondary transport
block (2 bits): *x~rvsb,1~, x~rvsb,2~*

\- UE identity (16 bits): *x~ue,1~, x~ue,2~, ..., x~ue,16~*

Figure 19B below illustrates the overall coding chain for HS-SCCH type
3. Note that some information shown is not present if only one transport
block is transmitted on the associated HS-PDSCH(s).

Figure 19B: Coding chain for HS-SCCH type 3

### 4.6B.2 HS-SCCH type 3 information field mapping

#### 4.6B.2.1 Redundancy and constellation version coding

For each of the primary transport block and a secondary transport block
if two transport blocks are transmitted on the associated HS-PDSCH(s),
the redundancy version (RV) parameters *r*, *s* and constellation
version parameter *b* are coded jointly to produce the values X~rvpb~
and X~rvsb~ respectively. The transmitted sequences x~rvpb,1~, x~rvpb,2~
and x~rvsb,1~, x~rvsb,2~ are the binary representations of X~rvpb~ and
X~rvsb~, respectively, where x~rvpb,1~ and x~rvsb,1~ are the MSBs.

For the primary transport block if only one transport block is
transmitted on the associated HS-PDSCH(s), the redundancy version (RV)
parameters *r*, *s* and constellation version parameter *b* are coded
jointly to produce the value X~rvpb~. The transmitted sequence
x~rvpb,1~, x~rvpb,2~ is the binary representation of X~rvpb~, where
x~rvpb,1~ is the MSB.

Joint coding of parameters *r*, *s* and constellation version parameter
*b* is done according to tables 13A and 13B according to the modulation
mode used. If X~rvpb~ = 0 or X~rvsb~ = 0, the UE shall treat the
corresponding transport block as an initial transmission.

Table 13A: RV coding for 16QAM and 64QAM for HS-SCCH type 3

  -------------------------------- --------------------------------- --------------------------------- ------- ------- ------- -------
  **X~rvpb~ or X~rvsb~ (value)**   ***N~sys~* / *N~data~* \< 1/2**   ***N~sys~* / *N~data\ ~*≥ 1/2**                           
                                   **s**                             **r**                             **b**   **s**   **r**   **b**
  0                                1                                 0                                 0       1       0       0
  1                                1                                 1                                 1       0       1       1
  2                                1                                 0                                 2       0       0       0
  3                                1                                 0                                 3       1       0       2
  -------------------------------- --------------------------------- --------------------------------- ------- ------- ------- -------

Table 13B: RV coding for QPSK for HS-SCCH type 3

  -------------------------------- -------------------------------- -------------------------------- ------- -------
  **X~rvpb~ or X~rvsb~ (value)**   ***N~sys~* / *N~data~* \<1/2**   ***N~sys~* / *N~data~* ≥ 1/2**           
                                   **s**                            **r**                            **s**   **r**
  0                                1                                0                                1       0
  1                                1                                1                                0       1
  2                                1                                2                                0       3
  3                                1                                3                                1       2
  -------------------------------- -------------------------------- -------------------------------- ------- -------

#### 4.6B.2.2 Modulation scheme and number of transport blocks mapping

The number of transport blocks transmitted on the associated HS-PDSCH(s)
and the modulation scheme information are jointly coded as shown in
Table 14:

Table 14: Mapping of x~ms~

  ---------------- ---------------------------------------- ------------------------------------------ ----------------------------
  xms,1, xms,2,\   Modulation for primary transport block   Modulation for secondary transport block   Number of transport blocks
  xms,3                                                                                                

  111              16QAM                                    16QAM                                      2

  110              16QAM                                    QPSK                                       2

  101              64QAM                                    Indicated by xccs,7                        Indicated by xccs,7

  100              16QAM                                    n/a                                        1

  011              QPSK                                     QPSK                                       2

  010              64QAM                                    64QAM                                      2

  001              64QAM                                    16QAM                                      2

  000              QPSK                                     n/a                                        1
  ---------------- ---------------------------------------- ------------------------------------------ ----------------------------

In case *x~ms,1~*, *x~ms,2~*, *x~ms,3~* equals "101" x~ccs,7~ is used as
an extra bit in modulation scheme information.

#### 4.6B.2.3 Channelization code-set mapping

The channelization code-set bits *x~ccs,1~, x~ccs,2~, ..., x~ccs,7~* are
coded according to the following:

Given P (multi-)codes starting at code O, and given the HS-SCCH number
if 64QAM is configured for the UE and *x~ms,1~*, *x~ms,2~*, *x~ms,3~* is
equal to "101", calculate the information-field using the unsigned
binary representation of integers calculated by the expressions,

for the first three bits (code group indicator) of which *x~ccs,1~* is
the MSB:

*x~ccs,1~, x~ccs,2~, x~ccs,3~* = min(P-1,15-P)

If 64QAM is not configured for the UE, or if 64QAM is configured and
*x~ms,1~, x~ms,2~, x~ms,3~* is not equal to "101", then

> for the last four bits (code offset indicator) of which *x~ccs,4~* is
> the MSB:
>
> *x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,7~* = \|O-1-P/8 \*15\|

Otherwise (i.e. if 64QAM is configured for the UE and *x~ms,1~, x~ms,2~,
x~ms,3~* is equal to "101"),

> *P* and *O* shall fulfil \|O-1-P/8 \*15\| mod 2 = (HS‑SCCH
> number) mod 2, and then
>
> *x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,dummy~* = \|O-1-P/8 \*15\|,
> where *x~ccs,dummy~* is a dummy bit that is not transmitted on
> HS-SCCH.

Furthermore,

*x~ccs,7~* = 0 if the modulation for the secondary transport block is
QPSK, and

*x~ccs,7~* = 1 if the number of transport blocks = 1.

The definitions of P and O are given in \[3\]. The HS-SCCH number is
given by the position in the list of HS-SCCH Channelisation Code
Informations signalled by higher layers. The HS-SCCH number is
associated with the code offset indicator and code group indicator as
described above if 64QAM is configured for the UE and *x~ms,1~*,
*x~ms,2~*, *x~ms,3~* is equal to "101".

If two transport blocks are transmitted on the associated HS-PDSCH(s),
the same set of channelization codes shall be used for both transport
blocks.

#### 4.6B.2.4 UE identity mapping

The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined
in \[13\]. This is mapped such that x~ue,1~ corresponds to the MSB and
x~ue,16~ to the LSB, cf. \[14\].

#### 4.6B.2.5 HARQ process identifier mapping

If two transport blocks are transmitted on the associated HS-PDSCH(s),
the mapping relationship between the hybrid-ARQ processes and the
transport blocks is such that when the HARQ-process with identifier
*HAP~pb~* is mapped to the primary transport block, the HARQ-process
with the identifier given by
$\left( \text{HAP}_{\text{pb}} + N_{\text{proc}}/2 \right)\text{mod}\left( N_{\text{proc}} \right)$
shall be mapped to the secondary transport block, where *N~proc~* is the
number of HARQ processes configured by higher layers. The combination of
HARQ-processes is indicated by the hybrid-ARQ process information (4
bits) *x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~* which are the unsigned
binary representation of *HAP~pb~* where *x~hap,1~* is MSB.

If only one transport block is transmitted on the associated
HS-PDSCH(s), the above mapping is ignored and the hybrid-ARQ process
information *x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~* is the unsigned
binary representation of the HARQ process identifier where *x~hap,1~* is
MSB.

#### 4.6B.2.6 Transport block size index mapping

The transport-block size information *x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6\ ~* is the unsigned binary representation of the transport
block size index for the primary transport block, where *x~tbspb,1~* is
the MSB.

If two transport blocks are transmitted on the associated HS-PDSCH(s),
the transport-block size information *x~tbssb,1~, x~tbssb,2~, ...,
x~tbssb,6\ ~* is the unsigned binary representation of the transport
block size index for the secondary transport block, where *x~tbssb,1~*
is the MSB.

#### 4.6B.2.7 Precoding Weight Information mapping 

The precoding weight information for the primary transport block
*x~pwipb,1~, x~pwipb,2~* is derived from the precoding weight factor
w~2~ as defined in \[4\], according to Table 14A.

Table 14A: Mapping of precoding weight information for primary transport
block

  ------ --------------------------
  w~2~   *x~pwipb,1~, x~pwipb,2~*
         00
         01
         10
         11
  ------ --------------------------

### 4.6B.3 Multiplexing of HS-SCCH type 3 information

The channelization-code-set information *x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~,* modulation-scheme and number of transport blocks information
*x~ms,1~, x~ms,2~, x~ms,3~* and precoding weight information
*x~pwipb,1~, x~pwipb,2~* are multiplexed together. This gives a sequence
of bits *x~1,1~, x~1,2~, ..., x~1,12,~* where

*x~1,i~ = x~ccs,i~ i=1,2,...,7*

*x~1,i~ = x~ms,i-7~ i=8,9,10*

*x~1,i~ = x~pwipb,i-10~ i=11,12*

If one transport block is transmitted on the associated HS-PDSCH(s), the
transport-block-size information *x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6~*, Hybrid-ARQ-process information *x~hap,1~,x~hap,2~, ...,
x~hap,4~* and redundancy-version information *x~rvpb,1~, x~rvpb,2~* are
multiplexed together. This gives a sequence of bits *x~2,1~, x~2,2~,
..., x~2,12~* where

*x~2,i~ = x~tbs,i~ i=1,2,...,6*

*x~2,i~ = x~hap,i-6~ i=7,8,...,10*

*x~2,i~ = x~rv,i-10~ i=11,12*

If two transport blocks are transmitted on the associated HS-PDSCHs, the
transport-block-size information for the primary transport block
*x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~*, transport-block-size
information for the secondary transport block *x~tbssb,1~, x~tbssb,2~,
..., x~tbssb,6~*, Hybrid-ARQ-process information *x~hap,1~,x~hap,2~,
..., x~hap,4~*, redundancy-version information for the primary transport
block *x~rvpb,1~, x~rvpb,2~*, and redundancy-version information for the
secondary transport block *x~rvsb,1~, x~rvsb,2~* are multiplexed
together. This gives a sequence of bits *x~2,1~, x~2,2~, ..., x~2,20~*
where

*x~2,i~ = x~tbspb,i~ i=1,2,...,6*

*x~2,i~ = x~tbssb,i-6~ i=7,8,...,12*

*x~2,i~ = x~hap,i-12~ i=13,14,\...,16*

*x~2,i~ = x~rvpb,i-16~ i=17,18*

*x~2,i~ = x~rvsb,i-18~ i=19,20*

### 4.6B.4 CRC attachment for HS-SCCH type 3

If one transport block is transmitted on the associated HS-PDSCH(s),
from the sequence of bits *x~1,1~, x~1,2~, ..., x~1,12,~ x~2,1~, x~2,2~,
..., x~2,12~* a 16-bit CRC is calculated according to Clause 4.2.1.1.
This gives a sequence of bits *c~1~, c~2~, ..., c~16\ ~*where

$c_{k} = p_{\text{im}(\text{17} - k)}$ *k=1,2,...,16*

This sequence of bits is then masked with the UE Identity *x~ue,1~,
x~ue,2~, ..., x~ue,16~* and then appended to the sequence of bits
*x~2,1~, x~2,2~, ..., x~2,12~* to form the sequence of bits *y~1~, y~2~,
..., y~28~*, where

*y~i~ = x~2,i~ i=1,2,...,12*

*y~i~ =* (*c~i-12~* + *x~ue~*,~i-12~ ) mod 2 *i=13,14,...,28*

If two transport blocks are transmitted on the associated HS-PDSCHs,
from the sequence of bits *x~1,1~, x~1,2~, ..., x~1,12,~ x~2,1~, x~2,2~,
..., x~2,20~* a 16-bit CRC is calculated according to Clause 4.2.1.1.
This gives a sequence of bits *c~1~, c~2~, ..., c~16\ ~*where

$c_{k} = p_{\text{im}(\text{17} - k)}$ *k=1,2,...,16*

This sequence of bits is then masked with the UE Identity *x~ue,1~,
x~ue,2~, ..., x~ue,16~* and then appended to the sequence of bits
*x~2,1~, x~2,2~, ..., x~2,20~* to form the sequence of bits *y~1~, y~2~,
..., y~36~*, where

*y~i~ = x~2,i~ i=1,2,...,20*

*y~i~ =* (*c~i-20~* + *x~ue~*,~i-20~) mod 2 *i=21,22,...,36*

### 4.6B.5 Channel coding for HS-SCCH type 3

Rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is
applied to the sequence of bits x*~1,1~,x~1,2~, ...,x~1,12~*~.~ This
gives a sequence of bits *z~1,1~, z~1,2~, ..., z~1,60~*~.~

If one transport block is transmitted on the associated HS-PDSCH(s),
rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is
applied to the sequence of bits *y~1~, y~2~, ..., y~28~*~.~ This gives a
sequence of bits *z~2,1~, z~2,2~, ..., z~2,108~*~.~

If two transport blocks are transmitted on the associated HS-PDSCHs,
rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is
applied to the sequence of bits *y~1~, y~2~, ..., y~36~*~.~ This gives a
sequence of bits *z~2,1~, z~2,2~, ..., z~2,132~*~.~

Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.

### 4.6B.6 Rate matching for HS-SCCH type 3

From the input sequence *z~1,1~, z~1,2~, ..., z~1,\ 60~* the bits
*z~1,1~, z~1,2~, z~1,4~, z~1,6~, z~1,8~, z~1,12~, z~1,15~, z~1,18~,
z~1,21~, z~1,24~, z~1,37~, z~1,40~, z~1,43~, z~1,46~, z~1,49~, z~1,53~,
z~1,55~, z~1,57~, z~1,59~, z~1,60~* are punctured to obtain the output
sequence *r~1,1~,r~1,2~...r~1,40~.*

If one transport block is transmitted on the associated HS-PDSCH(s),
from the input sequence *z~2,1~, z~2,2~, ..., z~2,108~* the bits
*z~2,1~, z~2,2~, z~2,3~, z~2,4~, z~2,5~, z~2,6~, z~2,7~, z~2,8~,
z~2,12~, z~2,14~, z~2,15~, z~2,24~, z~2,42~, z~2,48~, z~2,63~, z~2,66~,
z~2,93~, z~2,96~, z~2,98~, z~2,99~, z~2,101~, z~2,102~, z~2,103~,
z~2,104~, z~2,105~, z~2,106~, z~2,107~, z~2,108~* are punctured to
obtain the output sequence *r~2,1~,r~2,2~...r~2,80~*.

If two transport blocks are transmitted on the associated HS-PDSCHs,
from the input sequence *z~2,1~, z~2,2~, ..., z~2,132~* the bits
*z~2,1~, z~2,2~, z~2,3~, z~2,4~, z~2,5~, z~2,6~, z~2,7~, z~2,8~,
z~2,10~, z~2,11~, z~2,13~, z~2,14~, z~2,16~, z~2,19~, z~2,22~, z~2,25~,
z~2,28~, z~2,31~, z~2,34~, z~2,37~, z~2,40~, z~2,43~, z~2,46~, z~2,49~,
z~2,55~, z~2,61~, z~2,72~, z~2,78~, z~2,84~, z~2,87~, z~2,90~, z~2,93~,
z~2,96~, z~2,99~, z~2,102~ , z~2,105~, z~2,108~, z~2,111~, z~2,114~,
z~2,117~, z~2,119~, z~2,120~, z~2,122~, z~2,123~, z~2,125~, z~2,126~,
z~2,127~, z~2,128~, z~2,129~, z~2,130~, z~2,131~, z~2,132~* are
punctured to obtain the output sequence *r~2,1~,r~2,2~...r~2,80~*.

### 4.6B.7 UE specific masking for HS-SCCH type 3

The output bits *s~1,1~,s~1,2~...s~1,40~* are calculated as described in
subclause 4.6.7.

### 4.6B.8 Physical channel mapping for HS-SCCH type 3

The HS-SCCH sub-frame is described in \[2\]. The physical channel
mapping is carried out as described in subclause 4.6.8.

4.6C Coding for HS-SCCH orders
------------------------------

### 4.6C.1 Overview

HS-SCCH orders are commands sent to the UE using HS-SCCH. No HS-PDSCH is
associated with HS-SCCH orders.

The following information is transmitted by means of the HS-SCCH order
physical channel.

> \- Extended order type (2bits) *x~eodt,1~, x~eodt,2~*

\- Order type (3 bits): *x~odt,1~, x~odt,2~, x~odt,3~*

\- Order (3 bits): *x~ord,1~, x~ord,2~, x~ord,3~*

\- UE identity (16 bits): *x~ue,1~, x~ue,2~, ..., x~ue,16~*

The coding for HS-SCCH orders is specified in subclause 4.6.1 for a cell
where the UE is not configured in MIMO mode and not configured in MIMO
mode with four transmit antennas or if the UE is in CELL\_FACH state and
in subclause 4.6B.1 for a cell where the UE is configured in MIMO mode,
in subclause 4.6D.1 for a cell where the UE is configured in MIMO mode
with four transmit antennas with the exception of HS-DSCH serving cell
change order, which is always transmitted using HS-SCCH type 1 specified
in subclause 4.6.1.

### 4.6C.2 HS-SCCH Order information field mapping in the CELL\_DCH state

#### 4.6C.2.1 Order type mapping

If the extended Order type *x~eodt,1~, x~eodt,2\ ~*= '01' and the Order
type *x~odt,1~, x~odt,2~, x~odt,3~* = *\'\'000'*, then the mapping for
*x~ord,1~, x~ord,2~, x~ord,3~* is according to subclause 4.6C.2.2.1.

If the extended Order type *x~eodt,1~, x~eodt,2\ ~*= '01' and the Order
type *x~odt,1~, x~odt,2~, x~odt,3~* = *\'\'011'*, then the mapping for
*x~ord,1~, x~ord,2~, x~ord,3~* is according to subclause 4.6C.2.2.3.

If the extended Order type *x~eodt,1~, x~eodt,2\ ~*= '11' and the Order
type *x~odt,1~, x~odt,2~, x~odt,3~* = *\'\'010'*, then the mapping for
*x~ord,1~, x~ord,2~, x~ord,3~* is according to subclause 4.6C.2.2.4.

If the extended Order type *xeodt,1, xeodt,2* = \"11\" and the Order
type *xodt,1, xodt,2, xodt,3* = *\'\'011\"*, then the mapping for
*x~ord,1~,x~ord,2~, x~ord,3~* is according to subclause 4.6C.2.2.5.

Otherwise the mapping for *x~eodt,1~ , x~eodt,2~,* *x~odt,1~, x~odt,2~,
x~odt,3~*, *x~ord,1~, x~ord,2~, x~ord,3~* is according to subclause
4.6C.2.2.2.

#### 4.6C.2.2 Order mapping

##### 4.6C.2.2.1 Orders for activation and deactivation of DTX, DRX and HS-SCCH-less operation and for HS-DSCH serving cell change

If the order is transmitted from the serving HS-DSCH cell or a secondary
serving HS-DSCH cell, for this Order type, *x~ord,1~, x~ord,2~,
x~ord,3~* is comprised of:

> \- DRX activation (1 bit): *x~ord,1~* = *x~drx,1~*
>
> \- DTX activation (1 bit): *x~ord,2~* = *x~dtx,1~*
>
> \- HS-SCCH-less operation activation (1 bit): *x~ord,3~* =
> *x~hs-scch-less,1~*

If *x~drx,1~*= *\'\'0'*, then the HS-SCCH order is a DRX De-activation
order.

If *x~drx,1~*= *\'\'1'*, then the HS-SCCH order is a DRX Activation
order.

If *x~dtx,1~*= *\'\'0'*, then the HS-SCCH order is a DTX De-activation
order.

If *x~dtx,1~*= *\'\'1'*, then the HS-SCCH order is a DTX Activation
order.

If *x~hs-scch-less,1~*= *\'\'0'*, then the HS-SCCH order is a
HS-SCCH-less operation De-activation order.

If *x~hs-scch-less,1~*= *\'\'1'*, then the HS-SCCH order is a
HS-SCCH-less operation Activation order.

If the order is transmitted from a non-serving cell using HS-SCCH type 1
specified in subclause 4.6.1 and *x~ord,1~, x~ord,2~, x~ord,3~* =
*\'\'000'*, then it is an HS-DSCH serving cell change order .

*x~drx,1~, x~dtx,1~* = *\'\'10'* is a reserved combination (not used in
this release).

##### 4.6C.2.2.2 Orders for activation and deactivation of Secondary serving HS-DSCH cells and Secondary uplink frequency

For these Extended Order types and Order types, the meaning of the
orders is listed in Table 14B for the case where
Secondary\_Cell\_Enabled is less than 4. For the case where
Secondary\_Cell\_Enabled is greater than 3 the meaning of the orders is
listed in Table 14B.1.

When Secondary\_Cell\_Enabled is 1,

\- the order type *x~odt,1~*, *x~odt,2~*, *x~odt,3~* = \'010' is unused;

\- regardless of the signaled value of *x~ord,1~* the UE shall assume
*x~ord,1~* = *\'0'*;

*- x~ord,2~*, *x~ord,3~* = *\'\'10'* is an unused combination.

When the UE is configured in Multiflow mode the following exceptions to
the definitions in table 14B apply:

\- For the orders received from the Serving or the Secondary Serving
HS-DSCH cell, the UE shall consider the 1^st^ Secondary Serving cell to
refer to the Secondary Serving HS-DSCH cell and apply the received order
to that cell. The activation status of all other cells shall remain
unchanged.

\- For the orders received from the Assisting Serving or Assisting
Secondary Serving HS-DSCH cell the UE shall consider the 1^st^ Secondary
Serving cell to refer to the Assisting Secondary Serving HS-DSCH cell
and apply the received order to that cell. The activation status of all
other cells shall remain unchanged.

\- For the orders received from the Assisting Serving or Assisting
Secondary Serving HS-DSCH cell the UE shall ignore activation status
related to the Secondary Uplink Frequency and maintain the activation
status of the Secondary Uplink Frequency unchanged.

\- The order contents related to the 2^nd^ and 3^rd^ Secondary Serving
HS-DSCH cells shall be ignored.

Table 14B: Orders for activation and deactivation of Secondary serving
HS-DSCH cells and Secondary uplink frequency when
Secondary\_Cell\_Enabled is less than 4, or when the UE is configured in
Multiflow mode.

  ---------------------- -------------------------------- --------------- ------------------------------------------------------------------------------------------------------------------ ------------ ------------------------------------------ ------------------------------------------ ------------------------------------------ --------------------------------
  Extended Order Type    Order Type                       Order Mapping   Activation Status of Secondary Serving HS-DSCH cells and Secondary Uplink Frequency A= Activate; D = De-activate                                                                                                                                                 
  x~eodt,1~, x~eodt,2~   *x~odt,1~, x~odt,2~, x~odt,3~*   *x~ord,1~*      *x~ord,2~*                                                                                                         *x~ord,3~*   **1^st^ Secondary Serving HS-DSCH cell**   **2^nd^ Secondary Serving HS-DSCH cell**   **3^rd^ Secondary Serving HS-DSCH cell**   **Secondary Uplink Frequency**
  01                     001                              0               0                                                                                                                  0            D                                          D                                          D                                          D
                                                          0               0                                                                                                                  1            A                                          D                                          D                                          D
                                                          0               1                                                                                                                  1            A                                          D                                          D                                          A
                                                          0               1                                                                                                                  0            D                                          A                                          D                                          D
                                                          1               0                                                                                                                  0            A                                          A                                          D                                          D
                                                          1               0                                                                                                                  1            A                                          A                                          D                                          A
                                                          1               1                                                                                                                  0            D                                          D                                          A                                          D
                                                          1               1                                                                                                                  1            A                                          D                                          A                                          D
                         010                              0               0                                                                                                                  0            A                                          D                                          A                                          A
                                                          0               0                                                                                                                  1            D                                          A                                          A                                          D
                                                          0               1                                                                                                                  0            A                                          A                                          A                                          D
                                                          0               1                                                                                                                  1            A                                          A                                          A                                          A
                                                          1               0                                                                                                                  0            Unused (Reserved)                                                                                                                
                                                          1               0                                                                                                                  1            Unused (Reserved)                                                                                                                
                                                          1               1                                                                                                                  0            Unused (Reserved)                                                                                                                
                                                          1               1                                                                                                                  1            Unused (Reserved)                                                                                                                
  ---------------------- -------------------------------- --------------- ------------------------------------------------------------------------------------------------------------------ ------------ ------------------------------------------ ------------------------------------------ ------------------------------------------ --------------------------------

Table 14B.1: Orders for activation and deactivation of Secondary serving
HS-DSCH cells and Secondary uplink frequency when
Secondary\_Cell\_Enabled is greater than 3.

  --------------------- ------------ -------------------------------- ------------------------------------------------------------------------------------------------------------------ ------------ ------------ ------------------------------------ ------------------------------------ ------------------------------------ ------------------------------------ ------------------------------------ ------------------------------------ ------------------------------------ ---------------------
  Extended Order Type   Order Type   Order Mapping                    Activation Status of Secondary Serving HS-DSCH cells and Secondary Uplink Frequency A= Activate; D = De-activate                                                                                                                                                                                                                                                                                                
  x~eodt,,1~            x~eodt,,2~   *x~odt,1~, x~odt,2~, x~odt,3~*   *x~ord,1~*                                                                                                         *x~ord,2~*   *x~ord,3~*   **1^st^ Sec Serving HS-DSCH cell**   **2^nd^ Sec Serving HS-DSCH cell**   **3^rd^ Sec Serving HS-DSCH cell**   **4^th^ Sec Serving HS-DSCH cell**   **5^th^ Sec Serving HS-DSCH cell**   **6^th^ Sec Serving HS-DSCH cell**   **7^th^ Sec Serving HS-DSCH cell**   **Sec Uplink Freq**
  00                    000          0                                0                                                                                                                  0            A            D                                    A                                    D                                    A                                    D                                    A                                    A                                    
                                     0                                0                                                                                                                  1            D            A                                    A                                    D                                    A                                    D                                    A                                    D                                    
                                     0                                1                                                                                                                  1            A            A                                    A                                    D                                    A                                    D                                    A                                    A                                    
                                     0                                1                                                                                                                  0            A            A                                    A                                    D                                    A                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  0            D            D                                    D                                    A                                    A                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  1            A            D                                    D                                    A                                    A                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  0            D            A                                    D                                    A                                    A                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    D                                    A                                    A                                    D                                    A                                    A                                    
  00                    001          0                                0                                                                                                                  0            A            A                                    D                                    A                                    A                                    D                                    A                                    D                                    
                                     0                                0                                                                                                                  1            A            A                                    D                                    A                                    A                                    D                                    A                                    A                                    
                                     0                                1                                                                                                                  1            A            D                                    A                                    A                                    A                                    D                                    A                                    D                                    
                                     0                                1                                                                                                                  0            D            D                                    A                                    A                                    A                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  0            A            D                                    A                                    A                                    A                                    D                                    A                                    A                                    
                                     1                                0                                                                                                                  1            D            A                                    A                                    A                                    A                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  0            A            A                                    A                                    A                                    A                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            A                                    A                                    A                                    A                                    D                                    A                                    A                                    
  00                    010          0                                0                                                                                                                  0            D            D                                    D                                    D                                    D                                    A                                    A                                    D                                    
                                     0                                0                                                                                                                  1            A            D                                    D                                    D                                    D                                    A                                    A                                    D                                    
                                     0                                1                                                                                                                  1            A            D                                    D                                    D                                    D                                    A                                    A                                    A                                    
                                     0                                1                                                                                                                  0            D            A                                    D                                    D                                    D                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  0            A            A                                    D                                    D                                    D                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  1            A            A                                    D                                    D                                    D                                    A                                    A                                    A                                    
                                     1                                1                                                                                                                  0            D            D                                    A                                    D                                    D                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    A                                    D                                    D                                    A                                    A                                    D                                    
  00                    011          0                                0                                                                                                                  0            A            D                                    A                                    D                                    D                                    A                                    A                                    A                                    
                                     0                                0                                                                                                                  1            D            A                                    A                                    D                                    D                                    A                                    A                                    D                                    
                                     0                                1                                                                                                                  1            A            A                                    A                                    D                                    D                                    A                                    A                                    A                                    
                                     0                                1                                                                                                                  0            A            A                                    A                                    D                                    D                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  0            D            D                                    D                                    A                                    D                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  1            A            D                                    D                                    A                                    D                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  0            D            A                                    D                                    A                                    D                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    D                                    A                                    D                                    A                                    A                                    A                                    
  00                    100          0                                0                                                                                                                  0            A            A                                    D                                    A                                    D                                    A                                    A                                    D                                    
                                     0                                0                                                                                                                  1            A            A                                    D                                    A                                    D                                    A                                    A                                    A                                    
                                     0                                1                                                                                                                  1            A            D                                    A                                    A                                    D                                    A                                    A                                    D                                    
                                     0                                1                                                                                                                  0            D            D                                    A                                    A                                    D                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  0            A            D                                    A                                    A                                    D                                    A                                    A                                    A                                    
                                     1                                0                                                                                                                  1            D            A                                    A                                    A                                    D                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  0            A            A                                    A                                    A                                    D                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            A                                    A                                    A                                    D                                    A                                    A                                    A                                    
  00                    101          0                                0                                                                                                                  0            D            D                                    D                                    D                                    A                                    A                                    A                                    D                                    
                                     0                                0                                                                                                                  1            A            D                                    D                                    D                                    A                                    A                                    A                                    D                                    
                                     0                                1                                                                                                                  1            A            D                                    D                                    D                                    A                                    A                                    A                                    A                                    
                                     0                                1                                                                                                                  0            D            A                                    D                                    D                                    A                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  0            A            A                                    D                                    D                                    A                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  1            A            A                                    D                                    D                                    A                                    A                                    A                                    A                                    
                                     1                                1                                                                                                                  0            D            D                                    A                                    D                                    A                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    A                                    D                                    A                                    A                                    A                                    D                                    
  00                    110          0                                0                                                                                                                  0            A            D                                    A                                    D                                    A                                    A                                    A                                    A                                    
                                     0                                0                                                                                                                  1            D            A                                    A                                    D                                    A                                    A                                    A                                    D                                    
                                     0                                1                                                                                                                  1            A            A                                    A                                    D                                    A                                    A                                    A                                    A                                    
                                     0                                1                                                                                                                  0            A            A                                    A                                    D                                    A                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  0            D            D                                    D                                    A                                    A                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  1            A            D                                    D                                    A                                    A                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  0            D            A                                    D                                    A                                    A                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    D                                    A                                    A                                    A                                    A                                    A                                    
  00                    111          0                                0                                                                                                                  0            A            A                                    D                                    A                                    A                                    A                                    A                                    D                                    
                                     0                                0                                                                                                                  1            A            A                                    D                                    A                                    A                                    A                                    A                                    A                                    
                                     0                                1                                                                                                                  1            A            D                                    A                                    A                                    A                                    A                                    A                                    D                                    
                                     0                                1                                                                                                                  0            D            D                                    A                                    A                                    A                                    A                                    A                                    D                                    
                                     1                                0                                                                                                                  0            A            D                                    A                                    A                                    A                                    A                                    A                                    A                                    
                                     1                                0                                                                                                                  1            D            A                                    A                                    A                                    A                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  0            A            A                                    A                                    A                                    A                                    A                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            A                                    A                                    A                                    A                                    A                                    A                                    A                                    
  01                    001          0                                0                                                                                                                  0            D            D                                    D                                    D                                    D                                    D                                    D                                    D                                    
                                     0                                0                                                                                                                  1            A            D                                    D                                    D                                    D                                    D                                    D                                    D                                    
                                     0                                1                                                                                                                  1            A            D                                    D                                    D                                    D                                    D                                    D                                    A                                    
                                     0                                1                                                                                                                  0            D            A                                    D                                    D                                    D                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  0            A            A                                    D                                    D                                    D                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  1            A            A                                    D                                    D                                    D                                    D                                    D                                    A                                    
                                     1                                1                                                                                                                  0            D            D                                    A                                    D                                    D                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    A                                    D                                    D                                    D                                    D                                    D                                    
  01                    010          0                                0                                                                                                                  0            A            D                                    A                                    D                                    D                                    D                                    D                                    A                                    
                                     0                                0                                                                                                                  1            D            A                                    A                                    D                                    D                                    D                                    D                                    D                                    
                                     0                                1                                                                                                                  1            A            A                                    A                                    D                                    D                                    D                                    D                                    A                                    
                                     0                                1                                                                                                                  0            A            A                                    A                                    D                                    D                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  0            D            D                                    D                                    A                                    D                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  1            A            D                                    D                                    A                                    D                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  0            D            A                                    D                                    A                                    D                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    D                                    A                                    D                                    D                                    D                                    A                                    
  01                    100          0                                0                                                                                                                  0            D            D                                    D                                    D                                    A                                    D                                    D                                    D                                    
                                     0                                0                                                                                                                  1            A            D                                    D                                    D                                    A                                    D                                    D                                    D                                    
                                     0                                1                                                                                                                  1            A            D                                    D                                    D                                    A                                    D                                    D                                    A                                    
                                     0                                1                                                                                                                  0            D            A                                    D                                    D                                    A                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  0            A            A                                    D                                    D                                    A                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  1            A            A                                    D                                    D                                    A                                    D                                    D                                    A                                    
                                     1                                1                                                                                                                  0            D            D                                    A                                    D                                    A                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    A                                    D                                    A                                    D                                    D                                    D                                    
  01                    101          0                                0                                                                                                                  0            A            D                                    A                                    D                                    A                                    D                                    D                                    A                                    
                                     0                                0                                                                                                                  1            D            A                                    A                                    D                                    A                                    D                                    D                                    D                                    
                                     0                                1                                                                                                                  1            A            A                                    A                                    D                                    A                                    D                                    D                                    A                                    
                                     0                                1                                                                                                                  0            A            A                                    A                                    D                                    A                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  0            D            D                                    D                                    A                                    A                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  1            A            D                                    D                                    A                                    A                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  0            D            A                                    D                                    A                                    A                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    D                                    A                                    A                                    D                                    D                                    A                                    
  01                    110          0                                0                                                                                                                  0            A            A                                    D                                    A                                    A                                    D                                    D                                    D                                    
                                     0                                0                                                                                                                  1            A            A                                    D                                    A                                    A                                    D                                    D                                    A                                    
                                     0                                1                                                                                                                  1            A            D                                    A                                    A                                    A                                    D                                    D                                    D                                    
                                     0                                1                                                                                                                  0            D            D                                    A                                    A                                    A                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  0            A            D                                    A                                    A                                    A                                    D                                    D                                    A                                    
                                     1                                0                                                                                                                  1            D            A                                    A                                    A                                    A                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  0            A            A                                    A                                    A                                    A                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            A                                    A                                    A                                    A                                    D                                    D                                    A                                    
  01                    111          0                                0                                                                                                                  0            D            D                                    D                                    D                                    D                                    A                                    D                                    D                                    
                                     0                                0                                                                                                                  1            A            D                                    D                                    D                                    D                                    A                                    D                                    D                                    
                                     0                                1                                                                                                                  1            A            D                                    D                                    D                                    D                                    A                                    D                                    A                                    
                                     0                                1                                                                                                                  0            D            A                                    D                                    D                                    D                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  0            A            A                                    D                                    D                                    D                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  1            A            A                                    D                                    D                                    D                                    A                                    D                                    A                                    
                                     1                                1                                                                                                                  0            D            D                                    A                                    D                                    D                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    A                                    D                                    D                                    A                                    D                                    D                                    
  10                    000          0                                0                                                                                                                  0            A            D                                    A                                    D                                    D                                    A                                    D                                    A                                    
                                     0                                0                                                                                                                  1            D            A                                    A                                    D                                    D                                    A                                    D                                    D                                    
                                     0                                1                                                                                                                  1            A            A                                    A                                    D                                    D                                    A                                    D                                    A                                    
                                     0                                1                                                                                                                  0            A            A                                    A                                    D                                    D                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  0            D            D                                    D                                    A                                    D                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  1            A            D                                    D                                    A                                    D                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  0            D            A                                    D                                    A                                    D                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    D                                    A                                    D                                    A                                    D                                    A                                    
  10                    001          0                                0                                                                                                                  0            A            A                                    D                                    A                                    D                                    A                                    D                                    D                                    
                                     0                                0                                                                                                                  1            A            A                                    D                                    A                                    D                                    A                                    D                                    A                                    
                                     0                                1                                                                                                                  1            A            D                                    A                                    A                                    D                                    A                                    D                                    D                                    
                                     0                                1                                                                                                                  0            D            D                                    A                                    A                                    D                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  0            A            D                                    A                                    A                                    D                                    A                                    D                                    A                                    
                                     1                                0                                                                                                                  1            D            A                                    A                                    A                                    D                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  0            A            A                                    A                                    A                                    D                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            A                                    A                                    A                                    D                                    A                                    D                                    A                                    
  10                    010          0                                0                                                                                                                  0            D            D                                    D                                    D                                    A                                    A                                    D                                    D                                    
                                     0                                0                                                                                                                  1            A            D                                    D                                    D                                    A                                    A                                    D                                    D                                    
                                     0                                1                                                                                                                  1            A            D                                    D                                    D                                    A                                    A                                    D                                    A                                    
                                     0                                1                                                                                                                  0            D            A                                    D                                    D                                    A                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  0            A            A                                    D                                    D                                    A                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  1            A            A                                    D                                    D                                    A                                    A                                    D                                    A                                    
                                     1                                1                                                                                                                  0            D            D                                    A                                    D                                    A                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    A                                    D                                    A                                    A                                    D                                    D                                    
  10                    011          0                                0                                                                                                                  0            A            D                                    A                                    D                                    A                                    A                                    D                                    A                                    
                                     0                                0                                                                                                                  1            D            A                                    A                                    D                                    A                                    A                                    D                                    D                                    
                                     0                                1                                                                                                                  1            A            A                                    A                                    D                                    A                                    A                                    D                                    A                                    
                                     0                                1                                                                                                                  0            A            A                                    A                                    D                                    A                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  0            D            D                                    D                                    A                                    A                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  1            A            D                                    D                                    A                                    A                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  0            D            A                                    D                                    A                                    A                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    D                                    A                                    A                                    A                                    D                                    A                                    
  10                    100          0                                0                                                                                                                  0            A            A                                    D                                    A                                    A                                    A                                    D                                    D                                    
                                     0                                0                                                                                                                  1            A            A                                    D                                    A                                    A                                    A                                    D                                    A                                    
                                     0                                1                                                                                                                  1            A            D                                    A                                    A                                    A                                    A                                    D                                    D                                    
                                     0                                1                                                                                                                  0            D            D                                    A                                    A                                    A                                    A                                    D                                    D                                    
                                     1                                0                                                                                                                  0            A            D                                    A                                    A                                    A                                    A                                    D                                    A                                    
                                     1                                0                                                                                                                  1            D            A                                    A                                    A                                    A                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  0            A            A                                    A                                    A                                    A                                    A                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            A                                    A                                    A                                    A                                    A                                    D                                    A                                    
  10                    101          0                                0                                                                                                                  0            D            D                                    D                                    D                                    D                                    D                                    A                                    D                                    
                                     0                                0                                                                                                                  1            A            D                                    D                                    D                                    D                                    D                                    A                                    D                                    
                                     0                                1                                                                                                                  1            A            D                                    D                                    D                                    D                                    D                                    A                                    A                                    
                                     0                                1                                                                                                                  0            D            A                                    D                                    D                                    D                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  0            A            A                                    D                                    D                                    D                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  1            A            A                                    D                                    D                                    D                                    D                                    A                                    A                                    
                                     1                                1                                                                                                                  0            D            D                                    A                                    D                                    D                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    A                                    D                                    D                                    D                                    A                                    D                                    
  10                    110          0                                0                                                                                                                  0            A            D                                    A                                    D                                    D                                    D                                    A                                    A                                    
                                     0                                0                                                                                                                  1            D            A                                    A                                    D                                    D                                    D                                    A                                    D                                    
                                     0                                1                                                                                                                  1            A            A                                    A                                    D                                    D                                    D                                    A                                    A                                    
                                     0                                1                                                                                                                  0            A            A                                    A                                    D                                    D                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  0            D            D                                    D                                    A                                    D                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  1            A            D                                    D                                    A                                    D                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  0            D            A                                    D                                    A                                    D                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    D                                    A                                    D                                    D                                    A                                    A                                    
  10                    111          0                                0                                                                                                                  0            A            A                                    D                                    A                                    D                                    D                                    A                                    D                                    
                                     0                                0                                                                                                                  1            A            A                                    D                                    A                                    D                                    D                                    A                                    A                                    
                                     0                                1                                                                                                                  1            A            D                                    A                                    A                                    D                                    D                                    A                                    D                                    
                                     0                                1                                                                                                                  0            D            D                                    A                                    A                                    D                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  0            A            D                                    A                                    A                                    D                                    D                                    A                                    A                                    
                                     1                                0                                                                                                                  1            D            A                                    A                                    A                                    D                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  0            A            A                                    A                                    A                                    D                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            A                                    A                                    A                                    D                                    D                                    A                                    A                                    
  11                    000          0                                0                                                                                                                  0            D            D                                    D                                    D                                    A                                    D                                    A                                    D                                    
                                     0                                0                                                                                                                  1            A            D                                    D                                    D                                    A                                    D                                    A                                    D                                    
                                     0                                1                                                                                                                  1            A            D                                    D                                    D                                    A                                    D                                    A                                    A                                    
                                     0                                1                                                                                                                  0            D            A                                    D                                    D                                    A                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  0            A            A                                    D                                    D                                    A                                    D                                    A                                    D                                    
                                     1                                0                                                                                                                  1            A            A                                    D                                    D                                    A                                    D                                    A                                    A                                    
                                     1                                1                                                                                                                  0            D            D                                    A                                    D                                    A                                    D                                    A                                    D                                    
                                     1                                1                                                                                                                  1            A            D                                    A                                    D                                    A                                    D                                    A                                    D                                    
  11                    001          0                                0                                                                                                                  0            A            A                                    D                                    A                                    D                                    D                                    D                                    D                                    
                                     0                                0                                                                                                                  1            A            A                                    D                                    A                                    D                                    D                                    D                                    A                                    
                                     0                                1                                                                                                                  1            A            D                                    A                                    A                                    D                                    D                                    D                                    D                                    
                                     0                                1                                                                                                                  0            D            D                                    A                                    A                                    D                                    D                                    D                                    D                                    
                                     1                                0                                                                                                                  0            A            D                                    A                                    A                                    D                                    D                                    D                                    A                                    
                                     1                                0                                                                                                                  1            D            A                                    A                                    A                                    D                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  0            A            A                                    A                                    A                                    D                                    D                                    D                                    D                                    
                                     1                                1                                                                                                                  1            A            A                                    A                                    A                                    D                                    D                                    D                                    A                                    
  --------------------- ------------ -------------------------------- ------------------------------------------------------------------------------------------------------------------ ------------ ------------ ------------------------------------ ------------------------------------ ------------------------------------ ------------------------------------ ------------------------------------ ------------------------------------ ------------------------------------ ---------------------

##### 4.6C.2.2.3 Orders for Switching between Uplink Closed Loop Transmit Diversity Activation states

For this Order type, the meaning of the orders is listed in Table 14B.2.

When the UE is configured in Multiflow mode, if any of the orders
related to uplink CLTD activation states as defined in Table 14B.2 are
received from the Assisting Serving or Assisting Secondary Serving
HS-DSCH cell, then the UE shall ignore the orders and maintain the
uplink CLTD activation state unchanged.

Table 14B.2: Orders for UE when UL\_CLTD\_Enabled is TRUE

  ---------------------- -------------------------------- ------------------- -------------------------------- ------------ ------------------------------------------------------------- -------------------------------------------- --------------------------------------------
  Extended Order Type    **Order Type**                   **Order Mapping**   **Activation States\                                                                                                                                     
                                                                              A= Activate; D = De-activate**                                                                                                                           

  x~eodt,1~, x~eodt,2~   *x~odt,1~, x~odt,2~, x~odt,3~*   *x~ord,1~*          *x~ord,2~*                       *x~ord,3~*   **1**                                                         **2**                                        **3**

                                                                                                                            **Tx on Antenna 1 and Antenna 2 with Beamforming (Note 1)**   **Single Tx on Antenna 1 with no S-DPCCH**   **Single Tx on Antenna 2 with no S-DPCCH**

  01                     011                              1                   1                                1            A                                                             D                                            D

                                                          0                   0                                1            D                                                             A                                            D

                                                          0                   1                                0            D                                                             D                                            A

                                                          1                   0                                1            Unused (Reserved)                                                                                          

                                                          1                   1                                0            Unused (Reserved)                                                                                          

                                                          0                   0                                0            Unused (Reserved)                                                                                          

                                                          0                   1                                1            Unused (Reserved)                                                                                          

                                                          1                   0                                0            Unused (Reserved)                                                                                          
  ---------------------- -------------------------------- ------------------- -------------------------------- ------------ ------------------------------------------------------------- -------------------------------------------- --------------------------------------------

Note 1: The precoding weights for beamforming are defined in \[4\].

##### 4.6C.2.2.4 Orders for activating and de-activating demodulation common pilots (D-CPICH) when the UE is configured in MIMO mode with four transmit antennas

For this Order type, the meaning of the orders is listed in Table 14B.3.

Table 14B.3: Orders when the UE is configured in MIMO mode with four
transmit antennas

  ---------------------- -------------------------------- --------------- ------------------------------ ------------ -------------------
  Extended Order Type    Order Type                       Order Mapping   D-CPICH Activation States\                  
                                                                          A= Activate; D = De-activate                

  x~eodt,1~, x~eodt,2~   *x~odt,1~, x~odt,2~, x~odt,3~*   *x~ord,1~*      *x~ord,2~*                     *x~ord,3~*   

  11                     010                              1               1                              1            **A**

                                                          0               0                              0            **D**

                                                          0               0                              1            Unused (Reserved)

                                                          0               1                              0            Unused (Reserved)

                                                          0               1                              1            Unused (Reserved)

                                                          1               0                              0            Unused (Reserved)

                                                          1               0                              1            Unused (Reserved)

                                                          1               1                              0            Unused (Reserved)
  ---------------------- -------------------------------- --------------- ------------------------------ ------------ -------------------

Note 1: The activation and de-activation status corresponds to
individual HS-DSCH cell.

Note 2: Activation and de-activation indication applies for all the
demodulation common pilots configured in the cell.

##### 4.6C.2.2.5 Orders for switching the E-DCH TTI, and for start/stop a simplified HS-SCCH type 1 transmission interval

If the order is transmitted from the serving HS-DSCH cell or a secondary
serving HS-DSCH cell, for this Order type, the meaning of the orders for
single cell E-DCH is listed in Table 14B.3A and the meaning of the
orders for dual cell E-DCH is listed in Table 14B.3B.

Table 14B.3A: Orders for switching the E-DCH TTI for single cell E-DCH
and for start/stop a simplified HS-SCCH type 1 transmission interval

  ---------------------- ------------------------------ --------------- ---------------- ---------- -------------------------------------------------------------
  Extended\              Order Type                     Order Mapping   Interpretation              
  Order Type                                                                                        

  x~eodt,1~, x~eodt,2~   x~odt,1~, x~odt,2~, x~odt,3~   x~ord,1~        x~ord,2~         x~ord,3~   

  11                     011                            0               0                0          TTI switch order from 2ms to 10ms

                                                        0               0                1          TTI switch order from 10ms to 2ms

                                                        0               1                0          Start simplified HS-SCCH type 1 transmission interval order

                                                        0               1                1          Stop simplified HS-SCCH type 1 transmission interval order

                                                        1               0                0          Unused (Reserved) for single cell E-DCH

                                                        1               0                1          Unused (Reserved) for single cell E-DCH

                                                        1               1                0          Unused (Reserved) for single cell E-DCH

                                                        1               1                1          Unused (Reserved) for single cell E-DCH
  ---------------------- ------------------------------ --------------- ---------------- ---------- -------------------------------------------------------------

Table 14B.3B: Orders for switching the E-DCH TTI for dual cell E-DCH

  ---------------------- ------------------------------ --------------- ---------------- ---------- ---------------------------------------
  Extended\              Order Type                     Order Mapping   Interpretation              
  Order Type                                                                                        

  x~eodt,1~, x~eodt,2~   x~odt,1~, x~odt,2~, x~odt,3~   x~ord,1~        x~ord,2~         x~ord,3~   

  11                     011                            0               0                0          Unused (Reserved for dual cell E-DCH)

                                                        0               0                1          Unused (Reserved for dual cell E-DCH)

                                                        0               1                0          TTI switch order to 2ms+10ms

                                                        0               1                1          TTI switch order to 10ms+2ms

                                                        1               0                0          TTI switch order to 2ms+2ms

                                                        1               0                1          TTI switch order to 10ms+10ms

                                                        1               1                0          Unused (Reserved for dual cell E-DCH)

                                                        1               1                1          Unused (Reserved for dual cell E-DCH)
  ---------------------- ------------------------------ --------------- ---------------- ---------- ---------------------------------------

NOTE 1: (Table 14B.3B): For the TTI switch orders the TTI length
displayed on the left hand side applies to the primary uplink frequency,
while the TTI length displayed on the right hand side applies to the
secondary uplink frequency.

NOTE 2: (Table 14B.3B): The TTI switch orders also apply if the
secondary uplink frequency is deactivated, but it becomes effective on
the secondary uplink frequency upon its re-activation.

#### 4.6C.2.3 UE identity mapping

The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined
in \[13\]. This is mapped such that x~ue,1~ corresponds to the MSB and
x~ue,16~ to the LSB, cf. \[14\].

### 4.6C.3 HS-SCCH order information field mapping in the CELL\_FACH and CELL\_PCH states

#### 4.6C.3.1 Order type mapping

If the extended Order type *x~eodt,1~, x~eodt,2\ ~*= '01' and the Order
type *x~odt,1~, x~odt,2~, x~odt,3~* = *\'\'000'*, then the mapping for
*x~ord,1~, x~ord,2~, x~ord,3~* is according to subclause 4.6C.3.2.

#### 4.6C.3.2 Order mapping

##### 4.6C.3.2.1 Orders for network triggered HS-DPCCH transmission

For this Order type, the Order mapping *x~ord,1~, x~ord,2~, x~ord,3~*
and the associated meaning is as follows:

If *x~ord,1~, x~ord,2~, x~ord,3~* = *\'\'001'*, then the HS-SCCH order
is an order for triggering the random access procedure in CELL\_FACH as
specified in subclause 6.1A in \[4\].

##### 4.6C.3.2.2 Orders for HS-DSCH reception during CELL\_FACH HS-SCCH DRX operation

For this Order type, the Order mapping *x~ord,1~, x~ord,2~, x~ord,3~*
and the associated meaning is as follows:

If *x~ord,1~, x~ord,2~, x~ord,3~* = *\'\'110"* then the HS-SCCH order is
an order for notifying about an HS-DSCH transmission during CELL\_FACH
HS-SCCH DRX operation as specified in \[4\] subclause 6A.1.3.2.

4.6D Coding for HS-SCCH type 4
------------------------------

### 4.6D.1 Overview

HS-SCCH type 4 is used when the UE is configured in MIMO mode with four
transmit antennas. If one transport block is transmitted on the
associated HS-PDSCH(s) or an HS-SCCH order is transmitted, the following
information is transmitted by means of the HS-SCCH type 4 physical
channel:

\- Channelization-code-set information (7 bits): *x~ccs,1~, x~ccs,2~,
..., x~ccs,7~*

\- Modulation scheme and number of transport blocks information (5
bits): *x~ms,1~, x~ms,2~, x~ms,3,~ x~ms,4~, x~ms,5~*

\- Precoding weight information (4 bits): *x~pwipb,1~, x~pwipb,2,~
x~pwipb,3~, x~pwipb,4~*

\- Transport-block size information (6 bits): *x~tbspb,1~, x~tbspb,2~,
..., x~tbspb,6~*

\- Hybrid-ARQ process information (4 bits): *x~hap,1~, x~hap,2~, ...,
x~hap,4~*

\- Redundancy and constellation version (2 bits): *x~rvpb,1~, x~rvpb,2~*

\- UE identity (16 bits): *x~ue,1~, x~ue,2~, ..., x~ue,16~*

For an HS-SCCH order,

\- x~ccs,1~, x~ccs,2~, ..., x~ccs,7~*,* x~ms,1~, x~ms,2~, x~ms,3~,
x~ms,4,~ x~ms,5~*,* x~pwipb,1~, x~pwipb,2,~ x~pwipb,3~, x~pwipb,4~ shall
be set to \'\'1110000000000000'

\- x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,4~ *shall be set to \'\'*1111*'*

\- x~tbspb,5~*,* x~tbspb,6~ *shall be set to* x~eodt,1~, x~eodt,2~

\- x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~, x~rvpb,1~, x~rvpb,2~ *shall
be set to* x~odt,1~, x~odt,2~, x~odt,3~*, x~ord,1~, x~or~*~d,2~,
x~ord,3~

*where x~eodt,1~, x~eodt,2~*, *x~odt,1~, x~odt,2~, x~odt,3~, x~ord,1~,
x~ord,2~, x~ord,3~ are defined in subclause 4.6C.*

If more than one transport block is transmitted on the associated
HS-PDSCHs, the following information is transmitted by means of the
HS-SCCH type 4 physical channel:

\- Channelization-code-set information (7 bits): *x~ccs,1~, x~ccs,2~,
..., x~ccs,7~*

\- Modulation scheme and number of transport blocks information (5
bits): *x~ms,1~, x~ms,2~, x~ms,3,~ x~ms,4~, x~ms,5~*

\- Precoding weight information (4 bits): *x~pwipb,1~, x~pwipb,2,~
x~pwipb,3~, x~pwipb,4~*

\- Transport-block size information for the primary or/and fourth
transport block (6 bits): *x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~*

\- Transport-block size information for the second or/and third
transport block (6 bits): *x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6~*

\- Hybrid-ARQ process information (4 bits): *x~hap,1~, x~hap,2~,...,
x~hap,4~*

\- Redundancy and constellation version for the primary or/and fourth
transport block (2 bits): *x~rvpb,1~, x~rvpb,2~*

\- Redundancy and constellation version for the second or/and third
transport block (2 bits): *x~rvsb,1~, x~rvsb,2~*

\- UE identity (16 bits): *x~ue,1~, x~ue,2~, ..., x~ue,16~*

The overall coding chain for HS-SCCH type 4 is same as that of HS-SCCH
type 3 as shown in Figure 19 B.

### 4.6D.2 HS-SCCH type 4 information field mapping

#### 4.6D.2.1 Redundancy and constellation version coding

If four transport blocks are transmitted on the associated HS-PDSCH(s),
the redundancy version (RV) parameters *r*, *s* and constellation
version parameter *b* are coded jointly to produce the values X~rvpb~
for the primary and the fourth transport blocks and X~rvsb~ for the
second and the third transport blocks respectively. The transmitted
sequences x~rvpb,1~, x~rvpb,2~ and x~rvsb,1~, x~rvsb,2~ are the binary
representations of X~rvpb~ and X~rvsb~, respectively, where x~rvpb,1~
and x~rvsb,1~ are the MSBs.

If three transport blocks are transmitted on the associated HS-PDSCH(s),
the redundancy version (RV) parameters *r*, *s* and constellation
version parameter *b* are coded jointly to produce the values X~rvpb~
for the primary transport block and X~rvsb~ for the second and the third
transport blocks respectively. The transmitted sequences x~rvpb,1~,
x~rvpb,2~ and x~rvsb,1~, x~rvsb,2~ are the binary representations of
X~rvpb~ and X~rvsb~, respectively, where x~rvpb,1~ and x~rvsb,1~ are the
MSBs.

For each of the primary transport block and a second transport block if
two transport blocks are transmitted on the associated HS-PDSCH(s), the
redundancy version (RV) parameters *r*, *s* and constellation version
parameter *b* are coded jointly to produce the values X~rvpb~ and
X~rvsb~ respectively. The transmitted sequences x~rvpb,1~, x~rvpb,2~ and
x~rvsb,1~, x~rvsb,2~ are the binary representations of X~rvpb~ and
X~rvsb~, respectively, where x~rvpb,1~ and x~rvsb,1~ are the MSBs.

For the primary transport block if only one transport block is
transmitted on the associated HS-PDSCH(s), the redundancy version (RV)
parameters *r*, *s* and constellation version parameter *b* are coded
jointly to produce the value X~rvpb~. The transmitted sequence
x~rvpb,\ 1~, x~rvpb,\ 2~ is the binary representation of X~rvpb~, where
x~rvpb,1~ is the MSB.

Joint coding of parameters *r*, *s* and constellation version parameter
*b* is done according to tables 14B.4 and 14B.5 according to the
modulation mode used. If X~rvpb~ = 0 or X~rvsb~ = 0, the UE shall treat
the corresponding transport block as an initial transmission.

Table 14B.4: RV coding for 16QAM and 64QAM for HS-SCCH type 4

  -------------------------------- --------------------------------- --------------------------------- ------- ------- ------- -------
  **X~rvpb~ or X~rvsb~ (value)**   ***N~sys~* / *N~data~* \< 1/2**   ***N~sys~* / *N~data\ ~*≥ 1/2**                           
                                   **s**                             **r**                             **b**   **s**   **r**   **b**
  0                                1                                 0                                 0       1       0       0
  1                                1                                 1                                 1       0       1       1
  2                                1                                 0                                 2       0       0       0
  3                                1                                 0                                 3       1       0       2
  -------------------------------- --------------------------------- --------------------------------- ------- ------- ------- -------

Table 14B.5: RV coding for QPSK for HS-SCCH type 4

  -------------------------------- -------------------------------- -------------------------------- ------- -------
  **X~rvpb~ or X~rvsb~ (value)**   ***N~sys~* / *N~data~* \<1/2**   ***N~sys~* / *N~data~* ≥ 1/2**           
                                   **s**                            **r**                            **s**   **r**
  0                                1                                0                                1       0
  1                                1                                1                                0       1
  2                                1                                2                                0       3
  3                                1                                3                                1       2
  -------------------------------- -------------------------------- -------------------------------- ------- -------

#### 4.6D.2.2 Modulation scheme and number of transport blocks mapping

The number of transport blocks transmitted on the associated HS-PDSCH(s)
and the modulation scheme information are jointly coded as shown in
Table 14B.6:

Table 14B.6: Mapping of x~ms~

+----------+----------+----------+----------+----------+----------+
| x~ms,1~, | Mo       | Mo       | Mo       | Mo       | Number   |
| x        | dulation | dulation | dulation | dulation |          |
| ~ms,2~,\ | for      | for      | for      | for      | of       |
| x~ms,3~, |          | second   |          |          | t        |
| x        | primary  | t        | third    | fourth   | ransport |
| ~ms,4~,\ | t        | ransport |          | t        | blocks   |
| x~ms,5~  | ransport | block    | t        | ransport |          |
|          | block    |          | ransport | block    |          |
|          |          |          | block    |          |          |
+----------+----------+----------+----------+----------+----------+
| 00000    | QPSK     | Unused   | Unused   | Unused   | 1        |
+----------+----------+----------+----------+----------+----------+
| 00001    | 16QAM    | Unused   | Unused   | Unused   | 1        |
+----------+----------+----------+----------+----------+----------+
| 00010    | 64 QAM   | Unused   | Unused   | Unused   | 1        |
+----------+----------+----------+----------+----------+----------+
| 00011    | QPSK     | QPSK     | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 00100    | QPSK     | 16QAM    | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 00101    | QPSK     | 64QAM    | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 00110    | 16QAM    | QPSK     | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 00111    | 16QAM    | 16QAM    | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 1000     | 16QAM    | 64QAM    | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 01001    | 64QAM    | QPSK     | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 01010    | 64QAM    | 16QAM    | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 01011    | 64QAM    | 64QAM    | Unused   | Unused   | 2        |
+----------+----------+----------+----------+----------+----------+
| 01100    | QPSK     | QPSK     | QPSK     | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 01101    | QPSK     | 16QAM    | 16QAM    | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 01110    | QPSK     | 64QAM    | 64QAM    | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 01111    | 16QAM    | QPSK     | QPSK     | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 10000    | 16QAM    | 16QAM    | 16QAM    | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 10001    | 16QAM    | 64QAM    | 64QAM    | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 10010    | 64QAM    | QPSK     | QPSK     | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 10011    | 64QAM    | 16QAM    | 16QAM    | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 10100    | 64QAM    | 64QAM    | 64QAM    | Unused   | 3        |
+----------+----------+----------+----------+----------+----------+
| 10101    | QPSK     | QPSK     | QPSK     | QPSK     | 4        |
+----------+----------+----------+----------+----------+----------+
| 10110    | QPSK     | 16QAM    | 16QAM    | QPSK     | 4        |
+----------+----------+----------+----------+----------+----------+
| 10111    | QPSK     | 64QAM    | 64QAM    | QPSK     | 4        |
+----------+----------+----------+----------+----------+----------+
| 11000    | 16QAM    | QPSK     | QPSK     | 16QAM    | 4        |
+----------+----------+----------+----------+----------+----------+
| 11001    | 16QAM    | 16QAM    | 16QAM    | 16QAM    | 4        |
+----------+----------+----------+----------+----------+----------+
| 11010    | 16QAM    | 64QAM    | 64QAM    | 16QAM    | 4        |
+----------+----------+----------+----------+----------+----------+
| 11011    | 64QAM    | QPSK     | QPSK     | 64QAM    | 4        |
+----------+----------+----------+----------+----------+----------+
| 11100    | 64QAM    | 16QAM    | 16QAM    | 64QAM    | 4        |
+----------+----------+----------+----------+----------+----------+
| 11101    | 64 QAM   | 64QAM    | 64QAM    | 64 QAM   | 4        |
+----------+----------+----------+----------+----------+----------+
| 11110    | Unused   |          |          |          |          |
|          | (R       |          |          |          |          |
|          | eserved) |          |          |          |          |
+----------+----------+----------+----------+----------+----------+
| 11111    | Unused   |          |          |          |          |
|          | (R       |          |          |          |          |
|          | eserved) |          |          |          |          |
+----------+----------+----------+----------+----------+----------+

#### 4.6D.2.3 Channelization code-set mapping 

The channelization code-set bits x~ccs,1~, x~ccs,2~, ..., x~ccs,7~ are
coded according to the following:

Given P (multi-)codes starting at code O calculate the information-field
using the unsigned binary representation of integers calculated by the
expressions,

for the first three bits (code group indicator) of which *x~ccs,1~* is
the MSB:

*x~ccs,1~, x~ccs,2~, x~ccs,3~* = min(P-1,15-P)

for the last four bits (code offset indicator) of which *x~ccs,4~* is
the MSB:

*x~ccs,4~, x~ccs,5,~ x~ccs,6~, x~ccs,7~* = \|O-1-P/8 \*15\|

The definitions of P and O are given in \[3\].

If more than one transport blocks are transmitted on the associated
HS-PDSCH(s), the same set of channelization codes shall be used for all
transport blocks.

#### 4.6D.2.4 UE identity mapping

The UE identity is the HS-DSCH Radio Network Identifier (H-RNTI) defined
in \[13\]. This is mapped such that x~ue,1~ corresponds to the MSB and
x~ue,16~ to the LSB, cf. \[14\].

#### 4.6D.2.5 HARQ process identifier mapping

If four transport blocks are transmitted on the associated HS-PDSCH(s),
the mapping relationship between the hybrid-ARQ processes and the
transport blocks is such that when the HARQ-process with identifier
*HAP~pb~* is mapped to the primary and the fourth transport block, the
HARQ-process with the identifier given by
$\left( \text{HAP}_{\text{pb}} + N_{\text{proc}}/2 \right)\text{mod}\left( N_{\text{proc}} \right)$
shall be mapped to the second and the third transport block, where
*N~proc~* is the number of HARQ processes configured by higher layers.
The combination of HARQ-processes is indicated by the hybrid-ARQ process
information (4 bits) *x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~* which are
the unsigned binary representation of *HAP~pb~* where *x~hap,1~* is MSB.

If three transport blocks are transmitted on the associated HS-PDSCH(s),
the mapping relationship between the hybrid-ARQ processes and the
transport blocks is such that when the HARQ-process with identifier
*HAP~pb~* is mapped to the primary transport block, the HARQ-process
with the identifier given by
$\left( \text{HAP}_{\text{pb}} + N_{\text{proc}}/2 \right)\text{mod}\left( N_{\text{proc}} \right)$
shall be mapped to the second and the third transport block, where
*N~proc~* is the number of HARQ processes configured by higher layers.
The combination of HARQ-processes is indicated by the hybrid-ARQ process
information (4 bits) *x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~* which are
the unsigned binary representation of *HAP~pb~* where *x~hap,1~* is MSB.

If two transport blocks are transmitted on the associated HS-PDSCH(s),
the mapping relationship between the hybrid-ARQ processes and the
transport blocks is such that when the HARQ-process with identifier
*HAP~pb~* is mapped to the primary transport block, the HARQ-process
with the identifier given by
$\left( \text{HAP}_{\text{pb}} + N_{\text{proc}}/2 \right)\text{mod}\left( N_{\text{proc}} \right)$
shall be mapped to the second transport block, where *N~proc~* is the
number of HARQ processes configured by higher layers. The combination of
HARQ-processes is indicated by the hybrid-ARQ process information (4
bits) *x~hap,1~, x~hap,2~, x~hap,3~, x~hap,4~* which are the unsigned
binary representation of *HAP~pb~* where *x~hap,1~* is MSB.

If only one transport block is transmitted on the associated
HS-PDSCH(s), the above mapping is ignored and the hybrid-ARQ process
information *x~hap,\ 1~, x~hap,2~, x~hap,3~, x~hap,4~* is the unsigned
binary representation of the HARQ process identifier where *x~hap,1~* is
MSB.

#### 4.6D.2.6 Transport block size index mapping

The transport-block size information *x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6\ ~* is the unsigned binary representation of the transport
block size index for the primary transport block, where *x~tbspb,1~* is
the MSB.

If two transport blocks are transmitted on the associated HS-PDSCH(s),
the transport-block size information *x~tbssb,1~, x~tbssb,2~, ...,
x~tbssb,6\ ~* is the unsigned binary representation of the transport
block size index for the second transport block, where *x~tbssb,1~* is
the MSB. If the number of transport blocks indicated is equal to 2, if
X~rvpb~ = 0 and if the transport-block size information *x~tbspb,1~,
x~tbspb,2~, ..., x~tbspb,6\ ~* is set to \'\'111111', then the primary
transport block is not transmitted. If the number of transport blocks
indicated is equal to 2, if X~rvsb~ = 0 and if the transport-block size
information *x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6\ ~* is set to
\'\'111111', then the second transport block is not transmitted.

If three transport blocks are transmitted on the associated HS-PDSCH(s),
the transport-block size information *x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6\ ~* is the unsigned binary representation of the transport
block size index for the primary transport block, where *x~tbspb,1~* is
the MSB and the transport-block size information *x~tbssb,1~,
x~tbssb,2~, ..., x~tbssb,6\ ~* is the unsigned binary representation of
the transport block size index for the second and the third transport
blocks, where *x~tbssb,1~* is the MSB. If the number of transport blocks
indicated is equal to 3, if X~rvpb~ = 0 and if the transport-block size
information *x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6\ ~* is set to
\'\'111111', then the primary transport block is not transmitted. If the
number of transport blocks indicated is equal to 3, if X~rvsb~ = 0 and
if the transport-block size information *x~tbssb,1~, x~tbssb,2~, ...,
x~tbssb,6\ ~* is set to \'\'111111', then the second and the third
transport blocks are not transmitted.

If four transport blocks are transmitted on the associated HS-PDSCH(s),
the transport-block size information *x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6\ ~* is the unsigned binary representation of the transport
block size index for the primary and the fourth transport blocks, where
*x~tbspb,1~* is the MSB and the transport-block size information
*x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6\ ~* is the unsigned binary
representation of the transport block size index for the second and the
third transport blocks, where *x~tbssb,1~* is the MSB. If the number of
transport blocks indicated is equal to 4 if X~rvpb~ = 0 and if the
transport-block size information *x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6\ ~* is set to \'\'111111', then the primary and fourth
transport blocks are not transmitted. If the number of transport blocks
indicated is equal to 4 if X~rvsb~ = 0 and if the transport-block size
information *x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6\ ~* is set to
\'\'111111', then the second and the third transport blocks are not
transmitted.

#### 4.6D.2.7 Precoding Weight Information mapping 

The precoding weight information *x~pwipb,1~, x~pwipb,2,~ x~pwipb,3~,
x~pwipb,4~* is mapped according to Table 14B.7. The quantity
$W_{n}^{\left\{ s \right\}}$ denotes the matrix defined by the columns
given by the set $\left\{ s \right\}$ from the expression
$W_{n} = I - 2u_{n}u_{n}^{H}/u_{n}^{H}u_{n}$ where *I* is the
$4 \times 4$ identity matrix and the vector $u_{n}$ is given by Table
14B.7.

Table 14B.7: precoding weight information

  --------------------------------------------------- -- ---------------------------- --- --- ---
  *x~pwipb,1~, x~pwipb,2,~ x~pwipb,3~, x~pwipb,4,~*      Number of transport blocks           
                                                         1                            2   3   4
  0000                                                                                        
  0001                                                                                        
  0010                                                                                        
  0011                                                                                        
  0100                                                                                        
  0101                                                                                        
  0110                                                                                        
  0111                                                                                        
  1000                                                                                        
  1001                                                                                        
  1010                                                                                        
  1011                                                                                        
  1100                                                                                        
  1101                                                                                        
  1110                                                                                        
  1111                                                                                        
  --------------------------------------------------- -- ---------------------------- --- --- ---

### 4.6D.3 Multiplexing of HS-SCCH type 4 information 

The channelization-code-set information *x~ccs,1~, x~ccs,2~, ...,
x~ccs,7~,* modulation-scheme and number of transport blocks information
*x~ms,1~, x~ms,2~, x~ms,3,~ x~ms,4~, x~ms,5~* and precoding weight
information *x~pwipb,1~, x~pwipb,2,~ x~pwipb,3~, x~pwipb,4~* are
multiplexed together. This gives a sequence of bits *x~1,1~, x~1,2~,
..., x~1,16,~* where

*x~1,i~ = x~ccs,i~ i=1,2,...,7*

*x~1,i~ = x~ms,i-7~ i=8,9,10,11,12*

*x~1,i~ = x~pwipb,i-12~ i=13,14,15,16*

If one transport block is transmitted on the associated HS-PDSCH(s), the
transport-block-size information *x~tbspb,1~, x~tbspb,2~, ...,
x~tbspb,6~*, Hybrid-ARQ-process information *x~hap,1~,x~hap,2~, ...,
x~hap,4~* and redundancy-version information *x~rvpb,1~, x~rvpb,2~* are
multiplexed together. This gives a sequence of bits *x~2,1~, x~2,2~,
..., x~2,12~* where

*x~2,i~ = x~tbs,i~ i=1,2,...,6*

*x~2,i~ = x~hap,i-6~ i=7,8,...,10*

*x~2,i~ = x~rv,i-10~ i=11,12*

If two transport blocks are transmitted on the associated HS-PDSCHs, the
transport-block-size information for the primary transport block
*x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~*, transport-block-size
information for the second transport block *x~tbssb,1~, x~tbssb,2~, ...,
x~tbssb,6~*, Hybrid-ARQ-process information *x~hap,1~,x~hap,2~, ...,
x~hap,4~*, redundancy-version information for the primary transport
block *x~rvpb,1~, x~rvpb,2~*, and redundancy-version information for the
second transport block *x~rvsb,1~, x~rvsb,2~* are multiplexed together.
This gives a sequence of bits *x~2,1~, x~2,2~, ..., x~2,20~* where

*x~2,i~ = x~tbspb,i~ i=1,2,...,6*

*x~2,i~ = x~tbssb,i-6~ i=7,8,...,12*

*x~2,i~ = x~hap,i-12~ i=13,14,\...,16*

*x~2,i~ = x~rvpb,i-16~ i=17,18*

*x~2,i~ = x~rvsb,i-18~ i=19,20*

If three transport blocks are transmitted on the associated HS-PDSCHs,
the transport-block-size information for the primary transport block
*x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~*, transport-block-size
information for the second and the third transport blocks *x~tbssb,1~,
x~tbssb,2~, ..., x~tbssb,6~*, Hybrid-ARQ-process information
*x~hap,1~,x~hap,2~, ..., x~hap,4~*, redundancy-version information for
the primary transport block *x~rvpb,1~, x~rvpb,2~*, and
redundancy-version information for the second and the third transport
blocks *x~rvsb,1~, x~rvsb,2~* are multiplexed together. This gives a
sequence of bits *x~2,1~, x~2,2~, ..., x~2,20~* where

*x~2,i~ = x~tbspb,i~ i=1,2,...,6*

*x~2,i~ = x~tbssb,i-6~ i=7,8,...,12*

*x~2,i~ = x~hap,i-12~ i=13,14,\...,16*

*x~2,i~ = x~rvpb,i-16~ i=17,18*

*x~2,i~ = x~rvsb,i-18~ i=19,20*

If four transport blocks are transmitted on the associated HS-PDSCHs,
the transport-block-size information for the primary and the fourth
transport blocks *x~tbspb,1~, x~tbspb,2~, ..., x~tbspb,6~*,
transport-block-size information for the second and the third transport
blocks *x~tbssb,1~, x~tbssb,2~, ..., x~tbssb,6~*, Hybrid-ARQ-process
information *x~hap,1~,x~hap,2~, ..., x~hap,4~*, redundancy-version
information for the primary and the fourth transport blocks *x~rvpb,1~,
x~rvpb,2~*, and redundancy-version information for the second and the
third transport blocks *x~rvsb,1~, x~rvsb,2~* are multiplexed together.
This gives a sequence of bits *x~2,1~, x~2,2~, ..., x~2,20~* where

*x~2,i~ = x~tbspb,i~ i=1,2,...,6*

*x~2,i~ = x~tbssb,i-6~ i=7,8,...,12*

*x~2,i~ = x~hap,i-12~ i=13,14,\...,16*

*x~2,i~ = x~rvpb,i-16~ i=17,18*

*x~2,i~ = x~rvsb,i-18~ i=19,20*

### 4.6D.4 CRC attachment for HS-SCCH type 4 

If one transport block is transmitted on the associated HS-PDSCH(s),
from the sequence of bits *x~1,1~, x~1,2~, ..., x~1,16,,~ x~2,1~,
x~2,2~, ..., x~2,12~* a 16-bit CRC is calculated according to Clause
4.2.1.1. This gives a sequence of bits *c~1~, c~2~, ..., c~16\ ~*where

$c_{k} = p_{\text{im}(\text{17} - k)}$ *k=1,2,...,16*

This sequence of bits is then masked with the UE Identity *x~ue,1~,
x~ue,2~, ..., x~ue,16~* and then appended to the sequence of bits
*x~2,1~, x~2,2~, ..., x~2,12~* to form the sequence of bits *y~1~, y~2~,
..., y~28~*, where

*y~i~ = x~2,i~ i=1,2,...,12*

*y~i~ =* (*c~i-12~* + *x~ue~*,~i-12~ ) mod 2 *i=13,14,...,28*

If more than one transport blocks are transmitted on the associated
HS-PDSCHs, from the sequence of bits *x~1,1~, x~1,2~, ..., x~1,16,~
x~2,1~, x~2,2~, ..., x~2,20~* a 16-bit CRC is calculated according to
Clause 4.2.1.1. This gives a sequence of bits *c~1~, c~2~, ...,
c~16\ ~*where

$c_{k} = p_{\text{im}(\text{17} - k)}$ *k=1,2,...,16*

This sequence of bits is then masked with the UE Identity *x~ue,1~,
x~ue,2~, ..., x~ue,16~* and then appended to the sequence of bits
*x~2,1~, x~2,2~, ..., x~2,20~* to form the sequence of bits *y~1~, y~2~,
..., y~36~*, where

*y~i~ = x~2,i~ i=1,2,...,20*

*y~i~ =* (*c~i-20~* + *x~ue~*,~i-20~) mod 2 *i=21,22,...,36*

### 4.6D.5 Channel coding for HS-SCCH type 4

Rate 1/2 convolutional coding, as described in Clause 4.2.3.1, is
applied to the sequence of bits x*~1,1~,x~1,2~, ...,x~1,16~*~.~ This
gives a sequence of bits *z~1,1~, z~1,2~, ..., z~1,48~*~.~

If one transport block is transmitted on the associated HS-PDSCH(s),
rate 1/3 convolutional coding, as described in Clause 4.2.3.1, is
applied to the sequence of bits *y~1~, y~2~, ..., y~28~*~.~ This gives a
sequence of bits *z~2,1~, z~2,2~, ..., z~2,108~*~.~

If more than one transport blocks are transmitted on the associated
HS-PDSCHs, rate 1/3 convolutional coding, as described in Clause
4.2.3.1, is applied to the sequence of bits *y~1~, y~2~, ..., y~36~*~.~
This gives a sequence of bits *z~2,1~, z~2,2~, ..., z~2,132~*~.~

Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.

### 4.6D.6 Rate matching for HS-SCCH type 4

From the input sequence *z~1,1~, z~1,2~, ..., z~1,\ 48~* the bits
*z~1,1,~ z~1,2~, z~1,4~, z~1,8~, z~1,42~, z~1,45~, z~1,47~, z~1,48~* are
punctured to obtain the output sequence *r~1,1~,r~1,2~...r~1,40~.*

If one transport block is transmitted on the associated HS-PDSCH(s),
from the input sequence *z~2,1~, z~2,2~, ..., z~2,108~* the bits
*z~2,1~, z~2,2~, z~2,3~, z~2,4~, z~2,5~, z~2,6~, z~2,7~, z~2,8~,
z~2,12~, z~2,14~, z~2,15~, z~2,24~, z~2,42~, z~2,48~, z~2,63~, z~2,66~,
z~2,93~, z~2,96~, z~2,98~, z~2,99~, z~2,101~, z~2,102~, z~2,103~,
z~2,104~, z~2,105~, z~2,106~, z~2,107~, z~2,108~* are punctured to
obtain the output sequence *r~2,1~,r~2,2~...r~2,80~*.

If more than one transport blocks are transmitted on the associated
HS-PDSCHs, from the input sequence *z~2,1~, z~2,2~, ..., z~2,132~* the
bits *z~2,1~, z~2,2~, z~2,3~, z~2,4~, z~2,5~, z~2,6~, z~2,7~, z~2,8~,
z~2,10~, z~2,11~, z~2,13~, z~2,14~, z~2,16~, z~2,19~, z~2,22~, z~2,25~,
z~2,28~, z~2,31~, z~2,34~, z~2,37~, z~2,40~, z~2,43~, z~2,46~, z~2,49~,
z~2,55~, z~2,61~, z~2,72~, z~2,78~, z~2,84~, z~2,87~, z~2,90~, z~2,93~,
z~2,96~, z~2,99~, z~2,102~ , z~2,105~, z~2,108~, z~2,111~, z~2,114~,
z~2,117~, z~2,119~, z~2,120~, z~2,122~, z~2,123~, z~2,125~, z~2,126~,
z~2,127~, z~2,128~, z~2,129~, z~2,130~, z~2,131~, z~2,132~* are
punctured to obtain the output sequence *r~2,1~,r~2,2~...r~2,80~*.

### 4.6D.7 UE specific masking for HS-SCCH type 4

The output bits *s~1,1~,s~1,2~...s~1,40~* are calculated as described in
subclause 4.6.7.

### 4.6D.8 Physical channel mapping for HS-SCCH type 4

The HS-SCCH sub-frame is described in \[2\]. The physical channel
mapping is carried out as described in subclause 4.6.8.

4.7 Coding for HS-DPCCH
-----------------------

### 4.7.1 Overview

Data arrives to the coding unit in form of indicators for measurement
indication and HARQ acknowledgement.

The following coding/multiplexing steps can be identified:

\- channel coding (see subclauses 4.7.2, 4.7.3, 4.7.3A, 4.7.3B, 4.7.3C,
4.7.3D and 4.7.3E);

\- mapping to physical channels (see subclause 4.7.4).

The coding/multiplexing for HS-DPCCH is defined separately for the
following cases:

\- when the UE is not configured in MIMO mode and not configured in MIMO
mode with four transmit antennas in the serving HS-DSCH cell, and
Secondary\_Cell\_Enabled is 0 or 1 and Secondary\_Cell\_Active is 0 (see
subclause 4.7.2);

\- when the UE is configured in MIMO mode in the serving HS-DSCH cell
and Secondary\_Cell\_Enabled is 0 (see subclause 4.7.3);

\- when the UE is configured in MIMO mode in at least the serving
HS-DSCH cell, and Secondary\_Cell\_Enabled is 1 and
Secondary\_Cell\_Active is 0 (see subclause 4.7.3B);

\- when the UE is not configured in MIMO mode in any cell and
Secondary\_Cell\_Enabled is 1 and Secondary\_Cell\_Active is 1 (see
subclause 4.7.3A);

\- when the UE is configured in MIMO mode in at least one cell and
Secondary\_Cell\_Enabled is 1 and Secondary\_Cell\_Active is 1 (see
subclause 4.7.3B);

\- when Secondary\_Cell\_Enabled is equal to 2 or 3 (see applicable
subclauses in Table 14C and 14D)

\- when Secondary\_Cell\_Enabled is more than 3 (see applicable
subclauses in Table 14C.1 and 14D.1)

\- when the UE is configured in Multiflow mode, see subclause 4.7.3D

\- when the UE is configured in MIMO mode with four transmit antennas at
least in one cell, see subclause 4.7.3E

where Secondary\_Cell\_Enabled and Secondary\_Cell\_Active are defined
in \[4\].

Table 14C: Coding for HARQ-ACK when Secondary\_Cell\_Enabled is 2 or 3

  ----------------------------- --------------------------------------------------------------------------------------------- -------------------------- ------------------------------------------ ------------------------------------------ ------------------------------------------
                                **Secondary Cell Enabled is 2 UE is configured with two secondary serving HS-DSCH cells**                                                                                                                      
  **Secondary\_Cell\_Active**   **Condition**                                                                                 **Serving HS-DSCH cell**   **1^st^ Secondary Serving HS-DSCH cell**   **2^nd^ Secondary Serving HS-DSCH cell**   **3^rd^ Secondary Serving HS-DSCH cell**
  0, 1, 2                       MIMO mode and MIMO mode with four transmit antennas is not configured in any cell             4.7.3C.1 (Note 1)          N/A                                                                                   
  0                             MIMO mode is configured in at least one cell                                                  4.7.3B.1 (Note 3)          N/A                                                                                   
  1                             MIMO mode is configured in at least one cell                                                  4.7.3B.1 (Note 2)          N/A                                                                                   
  2                             MIMO mode is configured in at least one cell                                                  4.7.3B.1                   4.7.3B.1 (Note 4)                          N/A                                        
                                **Secondary Cell Enabled is 3 UE is configured with three secondary serving HS-DSCH cells**                                                                                                                    
  **Secondary\_Cell\_Active**   **Condition**                                                                                 **Serving HS-DSCH cell**   **1^st^ Secondary Serving HS-DSCH cell**   **2^nd^ Secondary Serving HS-DSCH cell**   **3^rd^ Secondary Serving HS-DSCH cell**
  0                             \-                                                                                            4.7.3B.1 (Note 3)                                                                                                
  1                             \-                                                                                            4.7.3B.1 (Note 2)                                                                                                
  2, 3                          \-                                                                                            4.7.3B.1 (Note 1)          4.7.3B.1 (Note 1)                                                                     
  ----------------------------- --------------------------------------------------------------------------------------------- -------------------------- ------------------------------------------ ------------------------------------------ ------------------------------------------

Note 1: When a cell is deactivated, DTX message is indicated for that
cell.

Note 2: HARQ-ACK information is jointly encoded for the pair of serving
HS-DSCH cell and the active secondary serving HS-DSCH cell and repeated
to fill the whole HARQ-ACK slot in the HS-DPCCH sub-frame as described
in subclause 4.7.4.1.

Note 3: HARQ-ACK information for the serving HS-DSCH cell is repeated to
fill the whole HARQ-ACK slot in the HS-DPCCH sub-frame as described in
subclause 4.7.4.1.

Note 4: HARQ-ACK information for the 2^nd^ secondary serving HS-DSCH
cell is jointly encoded with a DTX message in place of the 3^rd^
secondary serving HS-DSCH cell as described in subclause 4.7.3B.1.

Table 14C.1: Coding for HARQ-ACK of HS-DPCCH when
Secondary\_Cell\_Enabled is more than 3

  --------------------------------------------------- ------------------------------------------------------------------------------------------------------------- ------------------------------------------ ------------------------------------------ ------------------------------------------
                                                      **Secondary Cell Enabled is more than 3 UE is configured with more than 3 secondary serving HS-DSCH cells**                                                                                         
  **Number of active cells mapped to the HS-DPCCH**   **Serving HS-DSCH cell**                                                                                      **1^st^ Secondary Serving HS-DSCH cell**   **2^nd^ Secondary Serving HS-DSCH cell**   **3^rd^ Secondary Serving HS-DSCH cell**
  **1**                                               4.7.3B.1 (Note 1)                                                                                                                                                                                   
  **2**                                               4.7.3B.1 (Note 2)                                                                                                                                                                                   
  **3**                                               4.7.3B.1 (Note 3)                                                                                             4.7.3B.1 (Note 3)                                                                     
  **4**                                               4.7.3B.1                                                                                                      4.7.3B.1                                                                              
  --------------------------------------------------- ------------------------------------------------------------------------------------------------------------- ------------------------------------------ ------------------------------------------ ------------------------------------------

Note 1: The HARQ-ACK information is repeated to the fill the whole
HARQ-ACK slot of HS-DPCCH sub-frame as described in subclause 4.7.4.1.

Note 2: HARQ-ACK information is jointly encoded for the pair of serving
HS-DSCH cell and the active secondary serving HS-DSCH cell and repeated
to fill the whole HARQ-ACK slot in the HS-DPCCH sub-frame as described
in subclause 4.7.4.1.

Note 3: If one of the 1^st^, 2^nd^, or 3^rd^ secondary serving HS-DSCH
cells is deactivated a DTX message is indicated for the deactivated
cell.

Table 14C.2: Coding for HARQ-ACK transmitted on HS-DPCCH~2~ when
Secondary\_Cell\_Enabled is more than 3

  ------------------------------------------------------ ------------------------------------------------------------------------------------------------------------- ------------------------------------------ ------------------------------------------ ------------------------------------------
                                                         **Secondary Cell Enabled is more than 3 UE is configured with more than 3 secondary serving HS-DSCH cells**                                                                                         
  **Number of active cells mapped to the HS-DPCCH~2~**   **4^th^ secondary serving HS-DSCH cell**                                                                      **5^th^ Secondary Serving HS-DSCH cell**   **6^th^ Secondary Serving HS-DSCH cell**   **7^th^ Secondary Serving HS-DSCH cell**
  **1**                                                  4.7.3B.1 (Note 1)                                                                                                                                                                                   
  **2**                                                  4.7.3B.1 (Note 2)                                                                                                                                                                                   
  **3**                                                  4.7.3B.1 (Note 3)                                                                                             4.7.3B.1 (Note 3)                                                                     
  **4**                                                  4.7.3B.1                                                                                                      4.7.3B.1                                                                              
  ------------------------------------------------------ ------------------------------------------------------------------------------------------------------------- ------------------------------------------ ------------------------------------------ ------------------------------------------

Note 1: The HARQ-ACK information is repeated to the fill the whole
HARQ-ACK slot of HS-DPCCH~2~ sub-frame as described in subclause
4.7.4.1.

Note 2: The HARQ-ACK information for the two activated secondary serving
HS-DSCH cells are jointly encoded and repeated to fill the whole
HARQ-ACK slot in the HS-DPCCH~2~ sub-frame as described in subclause
4.7.4.1.

Note 3: If one of the 4^th^, 5^th^, 6^th^, and 7^th^ secondary serving
HS-DSCH cells is deactivated a DTX message is indicated for the
deactivated cell.

The order of the cells in HARQ-ACK joint encoding is specified in detail
in subclause 4.7.4.1.

Table 14D: Coding for PCI/CQI when Secondary\_Cell\_Enabled is 2 or 3

  -------------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------ ------------------------------------------
                                         **Secondary Cell Enabled is 2 UE is configured with two secondary serving HS-DSCH cells**                                                                                                                                                                                                                                                                                                                                                                                                                 
  **Secondary\_Cell\_Active**            **Serving HS-DSCH cell**                                                                                                                                                                                                                                                                            **1^st^ Secondary Serving HS-DSCH cell**                                                                                                                   **2^nd^ Secondary Serving HS-DSCH cell**   **3^rd^ Secondary Serving HS-DSCH cell**
  0, 1                                   The CQI information for a cell not configured in MIMO mode and not configured in MIMO mode with four transmit antennas is encoded according to subclause 4.7.2.2(Note 1)The composite PCI/CQI information for a cell configured with MIMO mode is encoded according to subclause 4.7.3.2 (Note 3)   N/A                                                                                                                                                                                                   
  2 MIMO is not configured in any cell   The CQI information for the serving HS-DSCH cell is encoded using subclause 4.7.2.2                                                                                                                                                                                                                 The CQI information for the 1^st^ secondary serving HS-DSCH cell and the 2^nd^ secondary serving HS-DSCH cell is encoded according to subclause 4.7.3A.2   N/A                                        
  2 (Otherwise) Note 4                   The CQI information for a cell not configured in MIMO mode and not configured in MIMO mode with four transmit antennas is encoded according to subclause 4.7.2.2. The composite PCI/CQI information for a cell configured with MIMO mode is encoded according to subclause 4.7.3.2                  N/A                                                                                                                                                                                                   
                                         **Secondary Cell Enabled is 3 UE is configured with three secondary serving HS-DSCH cells**                                                                                                                                                                                                                                                                                                                                                                                                               
  **Secondary\_Cell\_Active**            **Serving HS-DSCH cell**                                                                                                                                                                                                                                                                            **1^st^ Secondary Serving HS-DSCH cell**                                                                                                                   **2^nd^ Secondary Serving HS-DSCH cell**   **3^rd^ Secondary Serving HS-DSCH cell**
  0, 1 Note 3                            The CQI information for a cell not configured in MIMO mode and not configured in MIMO mode with four transmit antennas is encoded according to subclause 4.7.2.2. The composite PCI/CQI information for a cell configured with MIMO mode is encoded according to subclause 4.7.3.2                                                                                                                                                                                                                        
  2, 3 Note 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  -------------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------ ------------------------------------------

Note 1: If the UE is configured with MIMO mode in at least one cell, the
CQI field for each active cell is repeated to fill the two slot CQI
field in the HS-DPCCH sub-frame as described in subclause 4.7.4.2.

Note 2: In the deactivated cell, the PCI/CQI field is DTXed.

Note 3: The CQI or PCI/CQI for each active cell is repeated to fill the
two slot CQI or PCI/CQI field in the HS-DPCCH sub-frame as described in
subclause 4.7.4.2.

Note 4: The PCI/CQI field for the 3rd secondary serving HS-DSCH cell is
DTXed.

Table 14D.1: Coding for PCI/CQI transmitted on HS-DPCCH when
Secondary\_Cell\_Enabled is more than 3

+-------------+-------------+-------------+-------------+-------------+
|             | Secondary   |             |             |             |
|             | Cell        |             |             |             |
|             | Enabled     |             |             |             |
|             | more than 3 |             |             |             |
|             | UE is       |             |             |             |
|             | configured  |             |             |             |
|             | with more   |             |             |             |
|             | than 3      |             |             |             |
|             | secondary   |             |             |             |
|             | serving     |             |             |             |
|             | HS-DSCH     |             |             |             |
|             | cells       |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| Number of   | Serving     | 1^st^       | 2^nd^       | 3^rd^       |
| active      | HS-DSCH     | Secondary   | Secondary   | Secondary   |
| cells       | cell        | Serving     | Serving     | Serving     |
| mapped to   |             | HS-DSCH     | HS-DSCH     | HS-DSCH     |
| the         |             | cell        | cell        | cell        |
| HS-DPCCH    |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| 1, 2        | The CQI     |             |             |             |
|             | information |             |             |             |
| Note 1      | for a cell  |             |             |             |
|             | not         |             |             |             |
|             | configured  |             |             |             |
|             | in MIMO     |             |             |             |
|             | mode and    |             |             |             |
|             | not         |             |             |             |
|             | configured  |             |             |             |
|             | in MIMO     |             |             |             |
|             | mode with   |             |             |             |
|             | four        |             |             |             |
|             | transmit    |             |             |             |
|             | antennas is |             |             |             |
|             | encoded     |             |             |             |
|             | according   |             |             |             |
|             | to          |             |             |             |
|             | subclause   |             |             |             |
|             | 4.7.2.2.    |             |             |             |
|             | The         |             |             |             |
|             | composite   |             |             |             |
|             | PCI/CQI     |             |             |             |
|             | information |             |             |             |
|             | for a cell  |             |             |             |
|             | configured  |             |             |             |
|             | with MIMO   |             |             |             |
|             | mode is     |             |             |             |
|             | encoded     |             |             |             |
|             | according   |             |             |             |
|             | to          |             |             |             |
|             | subclause   |             |             |             |
|             | 4.7.3.2.    |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| 3, 4        |             |             |             |             |
|             |             |             |             |             |
| Note 2      |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+

Note 1: The CQI or PCI/CQI for each active cell is repeated to fill the
two slot CQI or PCI/CQI field in the corresponding HS-DPCCH sub-frame as
described in subclause 4.7.4.2.

Note 2: In the deactivated cell, the PCI/CQI field is DTXed.

Table 14D.2: Coding for PCI/CQI transmitted on HS-DPCCH~2~ when
Secondary\_Cell\_Enabled is more than 3

+-------------+-------------+-------------+-------------+-------------+
|             | Secondary   |             |             |             |
|             | Cell        |             |             |             |
|             | Enabled     |             |             |             |
|             | more than 3 |             |             |             |
|             | UE is       |             |             |             |
|             | configured  |             |             |             |
|             | with more   |             |             |             |
|             | than 3      |             |             |             |
|             | secondary   |             |             |             |
|             | serving     |             |             |             |
|             | HS-DSCH     |             |             |             |
|             | cells       |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| Number of   | 4^th^       | 5^th^       | 6^th^       | 7^th^       |
| active      | Secondary   | Secondary   | Secondary   | Secondary   |
| cells       | serving     | Serving     | Serving     | Serving     |
| mapped to   | HS-DSCH     | HS-DSCH     | HS-DSCH     | HS-DSCH     |
| the         | cell        | cell        | cell        | cell        |
| HS-DPCCH~2~ |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| 1, 2        | The CQI     |             |             |             |
|             | information |             |             |             |
| Note 1      | for a cell  |             |             |             |
|             | not         |             |             |             |
|             | configured  |             |             |             |
|             | in MIMO     |             |             |             |
|             | mode and    |             |             |             |
|             | not         |             |             |             |
|             | configured  |             |             |             |
|             | in MIMO     |             |             |             |
|             | mode with   |             |             |             |
|             | four        |             |             |             |
|             | transmit    |             |             |             |
|             | antennas is |             |             |             |
|             | encoded     |             |             |             |
|             | according   |             |             |             |
|             | to          |             |             |             |
|             | subclause   |             |             |             |
|             | 4.7.2.2.    |             |             |             |
|             | The         |             |             |             |
|             | composite   |             |             |             |
|             | PCI/CQI     |             |             |             |
|             | information |             |             |             |
|             | for a cell  |             |             |             |
|             | configured  |             |             |             |
|             | with MIMO   |             |             |             |
|             | mode is     |             |             |             |
|             | encoded     |             |             |             |
|             | according   |             |             |             |
|             | to          |             |             |             |
|             | subclause   |             |             |             |
|             | 4.7.3.2.    |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| 3, 4        |             |             |             |             |
|             |             |             |             |             |
| Note 2      |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+

Note 1: The CQI or PCI/CQI for each active cell is repeated to fill the
two slot CQI or PCI/CQI field in the corresponding HS-DPCCH sub-frame as
described in subclause 4.7.4.2.

Note 2: In the deactivated cell, the PCI/CQI field is DTXed.

For each HS-DPCCH the general coding flow when the UE is not configured
in MIMO mode and not configured in MIMO mode with four transmit antennas
is shown in the figure 20. This is done in parallel for the HARQ-ACK and
CQI as the flows are not directly multiplexed but are transmitted at
different times.

Figure 20: Coding for each HS-DPCCH when the UE is not configured in
MIMO mode and not configured in MIMO mode with four transmit antennas

In case the UE is configured in MIMO mode, the measurement indication
consists of precoding control indication (PCI) and channel quality
indication (CQI). For each HS-DPCCH the general coding flow when the UE
is configured in MIMO mode is shown in the figure 20A. This is done in
parallel for the flow of HARQ-ACK and for the flow of composite PCI/CQI
reports as the two flows are not directly multiplexed but are
transmitted at different times

Figure 20A: Coding for each HS-DPCCH when the UE is configured in MIMO
mode

In case the UE is configured in MIMO mode with four transmit antennas,
the measurement indication consists of number of transport blocks
preferred (NTBP), precoding control indication (PCI) and channel quality
indication (CQI). For each HS-DPCCH the general coding flow when the UE
is configured in MIMO mode with four transmit antennas is shown in the
figure 20A.1. This is done in parallel for the flow of HARQ-ACK and for
the flow of composite NTBP/PCI/CQI reports as the two flows are not
directly multiplexed but are transmitted at different times

Figure 20A.1: Coding for each HS-DPCCH when the UE is configured in MIMO
mode with four transmit antennas

### 4.7.2 Channel coding for HS-DPCCH when the UE is not configured in MIMO mode and not configured in MIMO mode with four transmit antennas in the serving HS-DSCH cell and Secondary\_Cell\_Enabled is 0 or 1 and Secondary\_Cell\_Active is 0

Two forms of channel coding are used, one for the channel quality
indication (CQI) and another for HARQ-ACK (acknowledgement).

#### 4.7.2.1 Channel coding for HS-DPCCH HARQ-ACK

The HARQ acknowledgement message to be transmitted, as defined in \[4\],
shall be coded to 10 bits as shown in Table 15. The output is denoted
w~0~, w~1~,...w~9~.

Table 15: Channel coding of HARQ-ACK when the UE is not configured in
MIMO mode and not configured in MIMO mode with four transmit antennas in
the serving HS-DSCH cell and Secondary\_Cell\_Enabled is 0 or 1 and
Secondary\_Cell\_Active is 0

  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------
  HARQ-ACK message to be transmitted   w~0~   w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~
  ACK                                  1      1      1      1      1      1      1      1      1      1
  NACK                                 0      0      0      0      0      0      0      0      0      0
  PRE                                  0      0      1      0      0      1      0      0      1      0
  POST                                 0      1      0      0      1      0      0      1      0      0
  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------

#### 4.7.2.2 Channel coding for HS-DPCCH channel quality indication

The channel quality indication is coded using a (20,5) code. The code
words of the (20,5) code are a linear combination of the 5 basis
sequences denoted M~i,n~ defined in the table below.

Table 15A: Basis sequences for (20,5) code

  ---- -------- -------- -------- -------- --------
  i    M~i,0~   M~i,1~   M~i,2~   M~i,3~   M~i,4~
  0    1        0        0        0        1
  1    0        1        0        0        1
  2    1        1        0        0        1
  3    0        0        1        0        1
  4    1        0        1        0        1
  5    0        1        1        0        1
  6    1        1        1        0        1
  7    0        0        0        1        1
  8    1        0        0        1        1
  9    0        1        0        1        1
  10   1        1        0        1        1
  11   0        0        1        1        1
  12   1        0        1        1        1
  13   0        1        1        1        1
  14   1        1        1        1        1
  15   0        0        0        0        1
  16   0        0        0        0        1
  17   0        0        0        0        1
  18   0        0        0        0        1
  19   0        0        0        0        1
  ---- -------- -------- -------- -------- --------

The CQI values 0 \... 30 as defined in \[4\] are converted from decimal
to binary to map them to the channel quality indication bits (1 0 0 0 0)
to (1 1 1 1 1) respectively. The information bit pattern (0 0 0 0 0)
shall not be used in this release. The channel quality indication bits
are a~0~ , a~1~ , a~2~ , a~3~ , a~4~ (where a~0~ is LSB and a~4~ is
MSB). The output code word bits b~i~ are given by:

where *i* = 0, ..., 19.

### 4.7.3 Channel coding for HS-DPCCH when the UE is configured in MIMO mode in the serving HS-DSCH cell and Secondary\_Cell\_Enabled is 0

Two forms of channel coding are used, one for the composite precoding
control indication (PCI) and channel quality indication (CQI) and
another for HARQ-ACK (acknowledgement).

#### 4.7.3.1 Channel coding for HS-DPCCH HARQ-ACK

The HARQ acknowledgement message to be transmitted, as defined in \[4\],
shall be coded to 10 bits as shown in Table 15B. The output is denoted
w~0~, w~1~,...w~9~.

Table 15B: Channel coding of HARQ-ACK when the UE is configured in MIMO
mode in the serving HS-DSCH cell and Secondary\_Cell\_Enabled is 0

  ------------------------------------------------------------ --------------------------------------- ------ ------ ------ ------ ------ ------ ------ ------ ------ ---
  HARQ-ACK\                                                    w~0~                                    w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~   
  message to be transmitted                                                                                                                                           

  HARQ-ACK in response to a single scheduled transport block                                                                                                          

  ACK                                                          1                                       1      1      1      1      1      1      1      1      1      

  NACK                                                         0                                       0      0      0      0      0      0      0      0      0      

  HARQ-ACK in response to two scheduled transport blocks                                                                                                              

  Response to primary transport block                          Response to secondary transport block                                                                  

  ACK                                                          ACK                                     1      0      1      0      1      1      1      1      0      1

  ACK                                                          NACK                                    1      1      0      1      0      1      0      1      1      1

  NACK                                                         ACK                                     0      1      1      1      1      0      1      0      1      1

  NACK                                                         NACK                                    1      0      0      1      0      0      1      0      0      0

  PRE/POST indication                                                                                                                                                 

  PRE                                                          0                                       0      1      0      0      1      0      0      1      0      

  POST                                                         0                                       1      0      0      1      0      0      1      0      0      
  ------------------------------------------------------------ --------------------------------------- ------ ------ ------ ------ ------ ------ ------ ------ ------ ---

#### 4.7.3.2 Channel coding for HS-DPCCH composite precoding control indication and channel quality indication

When the UE is configured in MIMO mode and single-stream restriction is
not configured, two types of CQI reports shall be supported by the UE.
According to the definition of the CQI reporting procedure in \[4\],
type A CQI reports use values 0 ... 255 and type B CQI reports use
values 0 ... 30, respectively. When the UE is configured in MIMO mode
and single-stream restriction is configured, only type B shall be
supported by the UE.

##### 4.7.3.2.1 Bit mapping of Type A channel quality indication

In case a type A CQI shall be reported, the CQI values 0 \... 255 as
defined in \[4\] are converted from decimal to binary to map them to the
channel quality indication bits (0 0 0 0 0 0 0 0) to (1 1 1 1 1 1 1 1),
respectively. The channel quality indication bits are cqi~0~ , cqi~1~ ,
cqi~2~ , cqi~3~ , cqi~4~, cqi~5~, cqi~6~, cqi~7~ (where cqi~0~ is LSB
and cqi~7~ is MSB).

##### 4.7.3.2.2 Bit mapping of Type B channel quality indication

In case a type B CQI shall be reported, the CQI values 0 \... 30 as
defined in \[4\] are converted from decimal to binary to map them to the
channel quality indication bits (1 0 0 0 0) to (1 1 1 1 1),
respectively. The information bit pattern (0 0 0 0 0) shall not be used
in this release. The channel quality indication bits are cqi~0,~ cqi~1,~
cqi~2,~ cqi~3,~ cqi~4~ (where cqi~0~ is LSB and cqi~4~ is MSB).

##### 4.7.3.2.3 Bit mapping of precoding control indication

According to the PCI definition in \[4\], the range of possible PCI
values is 0 \... 3. The PCI values 0 \... 3 as defined in \[4\] are
converted from decimal to binary to map them to the precoding control
indication bits (0 0) to (1 1) respectively. The precoding control
indication bits are pci~0~ , pci~1~ (where pci~0~ is LSB and pci~1~ is
MSB).

##### 4.7.3.2.4 Composite precoding control indication and channel quality indication bits 

Two formats for composite PCI/CQI information words are possible
depending on the type of the reported CQI value. The two formats shall
be constructed according to the scheme depicted in Figure 20B.

Figure 20B: Construction of composite PCI/CQI report

In case a type A CQI shall be reported, the precoding control indication
bits pci~0~ , pci~1~, and the channel quality indication bits cqi~0~ ,
cqi~1~ , cqi~2~ , cqi~3~ , cqi~4~, cqi~5~, cqi~6~, cqi~7~ are
concatenated to the composite precoding control indication and channel
quality indication bits according to the relation

In case a type B CQI shall be reported, the precoding control indication
bits pci~0~ , pci~1~, and the channel quality indication bits cqi~0~ ,
cqi~1~ , cqi~2~ , cqi~3~ , cqi~4~ are concatenated to the composite
precoding control indication and channel quality indication bits
according to the relation

##### 4.7.3.2.5 Block encoding of composite precoding control indication and channel quality indication bits 

In case a type A CQI needs to be reported, the composite precoding
control indication and channel quality indication is coded using a
(20,10) code. The code words of the (20,10) code are a linear
combination of the 10 basis sequences denoted M~i,n~ defined in the
table 15C below.

Table 15C: Basis sequences for channel encoding of composite PCI/CQI
reports

  ---- -------- -------- -------- -------- -------- -------- -------- -------- -------- -------- ---------
  i    M~i,0~   M~i,1~   M~i,2~   M~i,3~   M~i,4~   M~i,5~   M~i,6~   M~i,7~   M~i,8~   M~i,9~   M~i,10~
  0    1        0        0        0        0        0        0        0        0        0        0
  1    0        1        0        0        0        0        0        0        0        0        0
  2    0        0        0        1        0        0        0        0        0        0        0
  3    0        0        0        0        1        0        0        0        0        0        0
  4    0        0        0        0        0        1        0        0        0        0        0
  5    0        0        0        0        0        0        0        1        0        0        0
  6    0        0        0        0        0        0        0        0        1        0        1
  7    0        0        0        0        0        0        0        0        0        1        1
  8    1        0        1        0        0        0        1        1        1        0        1
  9    1        1        0        1        0        0        0        1        1        1        1
  10   0        1        1        0        1        0        0        0        1        1        1
  11   1        0        1        1        0        1        0        0        0        1        0
  12   1        1        0        1        1        0        1        0        0        0        0
  13   1        1        1        0        1        1        0        1        0        0        0
  14   0        1        1        1        0        1        1        0        1        0        1
  15   0        0        1        1        1        0        1        1        0        1        0
  16   0        0        0        1        1        1        0        1        1        0        1
  17   1        0        0        0        1        1        1        0        1        1        1
  18   0        1        0        0        0        1        1        1        0        1        0
  19   1        1        1        1        1        1        1        1        1        1        1
  ---- -------- -------- -------- -------- -------- -------- -------- -------- -------- -------- ---------

The output code word bits b~i~ are given by:

where *i* = 0, ..., 19.

In case a type B CQI needs to be reported, the composite precoding
control indication and channel quality indication is coded using a
(20,7) code. The code words of the (20,7) code are a linear combination
of the basis sequences denoted M~i,n~ defined in the table 15C
for$n \in \left\{ 0,1,3,4,5,7,\text{10} \right\}$.

The output code word bits b~i~ are given by:

where *i* = 0, ..., 19.

### 4.7.3A Channel coding for HS-DPCCH when the UE is not configured in MIMO mode in any cell and Secondary\_Cell\_Enabled is 1 and Secondary\_Cell\_Active is 1

Two forms of channel coding are used, one for the composite channel
quality indication (CQI) and another for the composite HARQ-ACK
(acknowledgement).

#### 4.7.3A.1 Channel coding for the composite HS-DPCCH HARQ-ACK

The composite HARQ acknowledgement message to be transmitted, as defined
in \[4\], shall be coded to 10 bits as shown in Table 15C.1. The output
is denoted w~0~, w~1~,...w~9~.

Table 15C.1: Channel coding of HARQ-ACK when the UE is not configured in
MIMO mode in a pair of serving HS-DSCH cells and
Secondary\_Cell\_Enabled is 1 and Secondary\_Cell\_Active is 1

  ------------------------------------------------------------------------------------------------------------------------ ----------------------------------------------------------------- ------ ------ ------ ------ ------ ------ ------ ------ ------ ---
  HARQ-ACK\                                                                                                                w~0~                                                              w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~   
  message to be transmitted                                                                                                                                                                                                                                 

  HARQ-ACK when UE detects a single scheduled transport block on the serving HS-DSCH cell                                                                                                                                                                   

  ACK                                                                                                                      1                                                                 1      1      1      1      1      1      1      1      1      

  NACK                                                                                                                     0                                                                 0      0      0      0      0      0      0      0      0      

  HARQ-ACK when UE detects a single scheduled transport block on the secondary serving HS-DSCH cell                                                                                                                                                         

  ACK                                                                                                                      *1*                                                               *1*    *1*    *1*    *1*    *0*    *0*    *0*    *0*    *0*    

  NACK                                                                                                                     *0*                                                               *0*    *0*    *0*    *0*    *1*    *1*    *1*    *1*    *1*    

  HARQ-ACK when UE detects a single scheduled transport block on each of the serving and secondary serving HS-DSCH cells                                                                                                                                    

  Response to transport block from serving HS-DSCH cell                                                                    Response to transport block from secondary serving HS-DSCH cell                                                                  

  ACK                                                                                                                      ACK                                                               1      0      1      0      1      0      1      0      1      0

  ACK                                                                                                                      NACK                                                              1      1      0      0      1      1      0      0      1      1

  NACK                                                                                                                     ACK                                                               0      0      1      1      0      0      1      1      0      0

  NACK                                                                                                                     NACK                                                              0      1      0      1      0      1      0      1      0      1

  PRE/POST indication                                                                                                                                                                                                                                       

  PRE                                                                                                                      0                                                                 0      1      0      0      1      0      0      1      0      

  POST                                                                                                                     0                                                                 1      0      0      1      0      0      1      0      0      
  ------------------------------------------------------------------------------------------------------------------------ ----------------------------------------------------------------- ------ ------ ------ ------ ------ ------ ------ ------ ------ ---

#### 4.7.3A.2 Channel coding for HS-DPCCH composite channel quality indication

##### 4.7.3A.2.1 Composite channel quality indication bits

The composite CQI report is constructed from two individual CQI reports
that are represented by CQI1 and CQI2. CQI1 corresponds to the serving
HS-DSCH cell and CQI2 corresponds to the secondary serving HS-DSCH cell.

Each constituent CQI report uses values 0 ... 30 in accordance with the
definition of the CQI reporting procedure in \[4\]. The individual CQI
values are converted from decimal to binary to map them to the channel
quality indication bits (1 0 0 0 0) to (1 1 1 1 1) respectively. The
information bit pattern (0 0 0 0 0) shall not be used in this release.

The channel quality indication bits corresponding to CQI1 are cqi1~0,~
cqi1~1,~ cqi1~2,~ cqi1~3,~ cqi1~4~ (where cqi1~0~ is LSB and cqi1~4~ is
MSB) and those corresponding to CQI2 are cqi2~0,~ cqi2~1,~ cqi2~2,~
cqi2~3,~ cqi2~4~ (where cqi2~0~ is LSB and cqi2~4~ is MSB).

The composite CQI report is constructed according to the scheme depicted
in Figure 20C

Figure 20C: Construction of composite CQI report

The two individual CQI reports are concatenated to form the composite
channel quality indication according to the relation

##### 4.7.3A.2.2 Block encoding of composite channel quality indication bits 

The composite channel quality indication is coded using a (20,10) code.
The code words of the (20,10) code are a linear combination of the 10
basis sequences denoted M~i,n~ defined in Table 15C.

The output code word bits b~i~ are given by:

where *i* = 0, ..., 19 and *a~0~,..., a~9~* are defined in the previous
subclause.

### 4.7.3B Channel coding for HS-DPCCH when Secondary\_Cell\_Enabled is at least 3 or when the UE is configured in MIMO mode in at least one cell and Secondary\_Cell\_Enabled is greater than 0

Two forms of channel coding are used, one for the composite precoding
control indication (PCI) and channel quality indication (CQI) and
another for the composite HARQ-ACK (acknowledgement).

#### 4.7.3B.1 Channel coding for the composite HS-DPCCH HARQ-ACK

The composite HARQ acknowledgement message to be transmitted, as defined
in \[4\], shall be coded to 10 bits as shown in Table 15C.2. The
feedback related to the first cell is given before the divider sign and
the feedback related to the second cell is given after the divider sign.
\'\'A' means \'\'ACK', \'\'N' means \'\'NACK' and \'\'D' means \'\'no
transmission' (\'\'DTX'). \'\'AA', \'\'AN', \'\'NA' and \'\'NN' refer to
feedback for dual-stream transmission in a cell. For example, \'\'AN'
means ACK on the primary stream and NACK on the secondary stream. The
output is denoted w~0~, w~1~,...w~9~.

When Secondary\_Cell\_Enabled is 2, and when Secondary\_Cell\_Active is
2, HARQ-ACK information for the 2^nd^ secondary serving HS-DSCH cell is
jointly encoded with a DTX message in place of the 3^rd^ secondary
serving HS-DSCH cell.

When Secondary\_Cell\_Enabled is 4, and when Secondary\_Cell\_Active is
4, HARQ-ACK information for the 4^th^ secondary serving HS-DSCH cell is
jointly encoded with a DTX message in place of the 5^th^ secondary
serving HS-DSCH cell.

When Secondary\_Cell\_Enabled is 6, and when Secondary\_Cell\_Active is
6, HARQ-ACK information for the 6^th^ secondary serving HS-DSCH cell is
jointly encoded with a DTX message in place of the 7^th^ secondary
serving HS-DSCH cell.

Table 15C.2: Channel coding of HARQ-ACK when Secondary\_Cell\_Enabled is
at least 3 or the UE is configured in MIMO mode in at least one cell and
Secondary\_Cell\_Enabled is greater than 0

  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------ -- ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------
  HARQ-ACK message to be transmitted   w~0~   w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~      HARQ-ACK message to be transmitted   w~0~   w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~
  A/D                                  1      1      1      1      1      1      1      1      1      1         AA/A                                 0      1      1      0      0      0      0      1      0      0
  N/D                                  0      0      0      0      0      0      0      0      0      0         AA/N                                 1      1      1      0      0      1      1      0      1      0
  AA/D                                 1      0      1      0      1      1      1      1      0      1         AN/A                                 1      0      1      1      1      0      0      1      1      0
  AN/D                                 1      1      0      1      0      1      0      1      1      1         AN/N                                 0      0      1      1      0      1      0      0      0      1
  NA/D                                 0      1      1      1      1      0      1      0      1      1         NA/A                                 0      1      0      1      1      1      1      1      0      0
  NN/D                                 1      0      0      1      0      0      1      0      0      0         NA/N                                 1      1      0      0      1      0      0      0      0      1
  D/A                                  0      0      0      0      0      0      1      1      1      1         NN/A                                 0      0      0      0      1      1      0      0      1      0
  D/N                                  1      1      1      1      1      1      0      0      0      0         NN/N                                 0      1      0      0      0      1      1      0      0      1
  D/AA                                 1      0      0      0      1      0      0      0      1      1         AA/AA                                0      1      1      0      1      1      0      1      1      1
  D/AN                                 0      1      0      0      0      0      1      1      0      1         AA/AN                                1      0      1      1      0      0      1      1      1      1
  D/NA                                 0      0      0      1      1      1      1      1      1      0         AA/NA                                1      1      0      1      1      1      1      0      0      1
  D/NN                                 1      1      1      1      1      0      0      1      0      0         AA/NN                                0      1      1      1      0      1      1      1      0      0
  A/A                                  1      1      0      1      0      0      0      0      1      1         AN/AA                                0      0      0      1      1      0      0      1      0      1
  A/N                                  0      0      1      1      1      0      1      0      0      1         AN/AN                                1      1      1      0      0      0      0      0      0      1
  N/A                                  1      0      0      1      0      1      1      1      0      0         AN/NA                                1      0      0      0      0      1      0      1      0      0
  N/N                                  0      1      1      0      0      1      0      1      0      1         AN/NN                                0      0      1      1      0      1      0      0      0      1
  A/AA                                 1      0      1      0      0      1      1      0      0      0         NA/AA                                1      1      0      0      1      0      1      1      1      0
  A/AN                                 1      0      0      1      0      1      0      1      0      1         NA/AN                                0      0      1      0      1      0      1      0      0      0
  A/NA                                 0      0      1      1      1      0      1      0      0      1         NA/NA                                1      0      1      1      1      1      0      0      1      0
  A/NN                                 0      1      1      1      0      1      0      0      1      1         NA/NN                                1      1      1      0      0      1      1      0      1      0
  N/AA                                 1      1      0      1      0      0      1      0      1      0         NN/AA                                0      1      0      1      0      0      0      0      1      0
  N/AN                                 1      1      0      0      0      1      0      1      1      0         NN/AN                                0      0      1      0      0      0      0      1      1      0
  N/NA                                 0      1      1      0      1      0      1      0      1      0         NN/NA                                0      1      0      0      1      1      0      0      0      0
  N/NN                                 0      0      1      0      1      1      0      1      0      1         NN/NN                                0      0      0      0      0      1      1      0      1      1
  PRE/POST                                                                                                                                                                                                          
  PRE                                  0      0      1      0      0      1      0      0      1      0         POST                                 0      1      0      0      1      0      0      1      0      0
  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------ -- ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------

When Secondary\_Cell\_Active is 2 or 3, and when DTX message is
indicated for a cell pair, whose HARQ-ACK information is jointly
encoded, the specific DTX code word as defined in Table 15C.2A is
transmitted for that cell pair except for the case when DTX message is
indicated for all active cells, in which case the HARQ-ACK slot is
DTXed. The slot containing HARQ-ACK information is either transmitted or
DTXed. If Secondary\_Cell\_Active is larger than 3 and when DTX message
is indicated for both cell pairs transmitted on one of the two HS-DPCCHs
and there is at least one HARQ-ACK message associated with the other
HS-DPCCH that does not correspond to DTX message, then the specific DTX
code word as defined in Table 15C.2A is transmitted for all cell pairs
for which a DTX message is indicated. If the DTX message is indicated
for all active cell pairs then the ­slot on each respective HS-DPCCH
containing the HARQ-ACK information is DTXed.

Table 15C.2A: Channel coding of HARQ-ACK for a pair of DTX messages when
Secondary\_Cell\_Active is greater than 2

  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------
  HARQ-ACK message to be transmitted   w~0~   w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~
  D/D                                  0      0      1      1      0      1      1      0      1      0
  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------

#### 4.7.3B.2 Channel coding for HS-DPCCH composite precoding control indication and channel quality indication

The channel coding for CQI associated with a cell for which the UE is
not configured in MIMO mode is specified in subclause 4.7.2.2.

The channel coding for PCI and CQI associated with a cell for which the
UE is configured in MIMO mode is specified in subclause 4.7.3.2.

### 4.7.3C Channel coding for HS-DPCCH when the UE is not configured in MIMO mode in any cell and Secondary\_Cell\_Enabled is 2

Two forms of channel coding are used, one for the composite channel
quality indication (CQI) and another for the composite HARQ-ACK
(acknowledgement).

#### 4.7.3C.1 Channel coding for the composite HS-DPCCH HARQ-ACK

Table 15C.3: Channel coding of HARQ-ACK when the UE is not configured in
MIMO mode in any cell and Secondary\_Cell\_Enabled is 2

  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------ -- ------ --- --- --- --- --- --- --- --- --- ---
  HARQ-ACK message to be transmitted   w~0~   w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~                                                 
  A/D/D                                1      1      1      1      1      1      1      1      1      1                                                    
  N/D/D                                0      0      0      0      0      0      0      0      0      0                                                    
  D/A/D                                1      1      1      1      1      0      0      0      0      0                                                    
  D/N/D                                0      0      0      0      0      1      1      1      1      1                                                    
  D/D/A                                1      1      0      0      0      1      1      0      0      0                                                    
  D/D/N                                0      0      1      1      1      0      0      1      1      1                                                    
  A/A/D                                1      0      1      0      1      0      1      0      1      0                                                    
  A/N/D                                1      1      0      0      1      1      0      0      1      1                                                    
  N/A/D                                0      0      1      1      0      0      1      1      0      0                                                    
  N/N/D                                0      1      0      1      0      1      0      1      0      1                                                    
  A/D/A                                1      0      1      1      0      1      1      0      0      1                                                    
  A/D/N                                0      1      0      1      1      0      1      0      0      1                                                    
  N/D/A                                0      0      0      1      1      1      1      0      1      0                                                    
  N/D/N                                1      0      0      1      1      1      0      1      0      0                                                    
  D/A/A                                0      1      1      1      0      1      0      0      1      0                                                    
  D/A/N                                1      0      1      0      0      1      0      1      1      0                                                    
  D/N/A                                0      1      1      0      0      0      1      0      1      1                                                    
  D/N/N                                0      0      0      0      1      0      1      0      1      1                                                    
  A/A/A                                1      1      0      1      0      0      1      1      1      0                                                    
  A/A/N                                0      1      1      0      1      1      1      1      0      0                                                    
  A/N/A                                1      0      0      1      0      0      0      0      1      1                                                    
  A/N/N                                0      0      1      0      1      1      0      0      0      1                                                    
  N/A/A                                1      1      1      0      0      0      0      1      0      1                                                    
  N/A/N                                0      1      0      0      1      0      0      1      1      0                                                    
  N/N/A                                1      0      0      0      1      0      1      1      0      1                                                    
  N/N/N                                1      1      1      1      0      1      0      1      0      0                                                    
  PRE/POST                                                                                                                                                 
  PRE                                  0      0      1      0      0      1      0      0      1      0         POST   0   1   0   0   1   0   0   1   0   0
  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------ -- ------ --- --- --- --- --- --- --- --- --- ---

#### 4.7.3C.2 Channel coding for HS-DPCCH channel quality indication

The channel coding for CQI is specified in subclause 4.7.2.2 for the
serving HS-DSCH cell, and in subclause 4.7.3A.2 for the 1^st^ and 2^nd^
secondary serving HS-DSCH cells.

### 4.7.3D Channel coding for HS-DPCCH when the UE is configured in Multiflow mode

#### 4.7.3D.1 Channel coding for the composite HS-DPCCH HARQ-ACK

Subclause 4.7.4.3 defines the applicable HARQ-ACK encoding to be used
with the following exception

\- When the UE is configured with one serving and one assisting HS-DSCH
cell and at least one of the two cells is configured in MIMO mode the
HARQ-ACK encoding is defined in Table 15C.3A.

Table 15C.3A: Channel coding of HARQ-ACK when the UE is configured with
one serving and one assisting HS-DSCH cell and at least one cell is
configured in MIMO mode

  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------ -- ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------
  HARQ-ACK message to be transmitted   w~0~   w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~      HARQ-ACK message to be transmitted   w~0~   w~1~   w~2~   w~3~   w~4~   w~5~   w~6~   w~7~   w~8~   w~9~
  A/D                                  1      1      1      0      0      0      0      1      0      1         AA/A                                 1      0      0      1      0      1      0      1      1      0
  N/D                                  1      1      0      0      1      0      1      0      0      1         AA/N                                 1      0      1      0      0      1      1      0      0      1
  AA/D                                 1      1      1      0      0      0      0      1      0      1         AN/A                                 1      1      0      1      0      0      1      0      1      0
  AN/D                                 1      0      1      1      0      0      0      0      0      0         AN/N                                 0      1      1      0      0      0      1      0      0      0
  NA/D                                 0      0      0      1      0      1      1      0      1      1         NA/A                                 0      0      1      0      1      0      1      1      1      0
  NN/D                                 1      1      0      0      1      0      1      0      0      1         NA/N                                 0      1      0      0      1      1      0      0      1      1
  D/A                                  0      1      1      1      1      0      1      0      1      1         NN/A                                 0      0      0      1      1      0      1      1      0      1
  D/N                                  0      0      1      0      1      0      0      0      0      1         NN/N                                 0      1      1      1      1      1      0      0      0      0
  D/AA                                 0      1      1      1      1      0      1      0      1      1         AA/AA                                1      0      0      1      0      1      0      1      1      0
  D/AN                                 1      1      1      1      1      0      1      1      0      0         AA/AN                                1      0      0      0      0      0      0      0      1      1
  D/NA                                 0      1      0      0      0      0      1      1      1      1         AA/NA                                1      1      1      0      0      1      1      1      1      0
  D/NN                                 0      0      1      0      1      0      0      0      0      1         AA/NN                                1      0      1      0      0      1      1      0      0      1
  A/A                                  1      0      0      1      0      1      0      1      1      0         AN/AA                                1      1      0      1      0      0      1      0      1      0
  A/N                                  1      0      1      0      0      1      1      0      0      1         AN/AN                                1      1      1      1      0      1      0      0      1      1
  N/A                                  0      0      0      1      1      0      1      1      0      1         AN/NA                                1      0      0      0      0      0      1      1      0      0
  N/N                                  0      1      1      1      1      1      0      0      0      0         AN/NN                                0      1      1      0      0      0      1      0      0      0
  A/AA                                 1      0      0      1      0      1      0      1      1      0         NA/AA                                0      0      1      0      1      0      1      1      1      0
  A/AN                                 1      0      0      0      0      0      0      0      1      1         NA/AN                                0      1      1      0      1      1      1      1      0      1
  A/NA                                 1      1      1      0      0      1      1      1      1      0         NA/NA                                0      0      0      1      1      0      0      0      1      0
  A/NN                                 1      0      1      0      0      1      1      0      0      1         NA/NN                                0      1      0      0      1      1      0      0      1      1
  N/AA                                 0      0      0      1      1      0      1      1      0      1         NN/AA                                0      0      0      1      1      0      1      1      0      1
  N/AN                                 0      1      0      1      0      0      0      0      0      1         NN/AN                                0      1      0      1      0      0      0      0      0      1
  N/NA                                 1      1      1      0      1      0      0      0      1      0         NN/NA                                1      1      1      0      1      0      0      0      1      0
  N/NN                                 0      1      1      1      1      1      0      0      0      0         NN/NN                                0      1      1      1      1      1      0      0      0      0
  PRE/POST                                                                                                                                                                                                          
  PRE                                  0      0      1      0      0      1      0      0      1      0         POST                                 0      1      0      0      1      0      0      1      0      0
  ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------ -- ------------------------------------ ------ ------ ------ ------ ------ ------ ------ ------ ------ ------

#### 4.7.3D.2 Channel coding for HS-DPCCH channel quality indication

Subclause 4.7.4.3 defines the applicable CQI encoding to be used with
different Multiflow configurations.

### 4.7.3E Channel coding for HS-DPCCH when the UE is configured in MIMO mode with 4 transmit antennas 

The coding for HS-DPCCH is defined separately for the following cases:

\- when the UE is configured in MIMO mode with four transmit antennas
and Secondary\_Cell\_Enabled is 0 (see subclause 4.7.3E.1);

\- when the UE is configured in MIMO mode with four transmit antennas in
any cell, and Secondary\_Cell\_Enabled is 1 (see subclause 4.7.3E.2);

\- when the UE is configured in MIMO mode with four transmit antennas in
any cell, and Secondary\_Cell\_Enabled is 2 (see subclause 4.7.3E.3);

\- when the UE is configured in MIMO mode with four transmit antennas in
any cell, and Secondary\_Cell\_Enabled is 3 (see subclause 4.7.3E.4);

#### 4.7.3E.1 Channel coding for HS-DPCCH when the UE is configured in MIMO mode with four transmit antennas and Secondary\_Cell\_Enabled is 0

Two forms of channel coding are used, one for the composite number of
transport blocks preferred (NTBP), precoding control indication (PCI)
and channel quality indication (CQI) and another for HARQ-ACK
(acknowledgement).

##### 4.7.3E.1.1 Channel coding for HS-DPCCH HARQ-ACK

The HARQ acknowledgement message to be transmitted, as defined in \[4\],
shall be coded to 10 bits as shown in Table 15C.3B. The output is
denoted g~0~, g~1~,...g~9~.

When three or four transport blocks are received, the second and the
third transport blocks are positively acknowledged (ACK) only if both
transport blocks are received correctly. Otherwise both the second and
the third transport blocks are negatively acknowledged (NACK).

When four transport blocks are received, the first and the fourth
transport blocks are positively acknowledged (ACK) only if both
transport blocks are received correctly. Otherwise both the first and
the fourth transport blocks are negatively acknowledged (NACK).

Table 15C.3B: Channel coding of HARQ-ACK when the UE is configured in
MIMO mode with four transmit antennas in the serving HS-DSCH cell and
Secondary\_Cell\_Enabled is 0

  ------------------------------------------------------------ ----------------------------------------------- ------ ------ ------ ------ ------ ------ ------ ------ ------ ---
  HARQ-ACK\                                                    g~0~                                            g~1~   g~2~   g~3~   g~4~   g~5~   g~6~   g~7~   g~8~   g~9~   
  message to be transmitted                                                                                                                                                   

  HARQ-ACK in response to a single scheduled transport block                                                                                                                  

  ACK                                                          1                                               1      1      1      1      1      1      1      1      1      

  NACK                                                         0                                               0      0      0      0      0      0      0      0      0      

  HARQ-ACK in response to two scheduled transport blocks                                                                                                                      

  Response to primary transport block                          Response to second transport block                                                                             

  ACK                                                          ACK                                             1      0      1      0      1      1      1      1      0      1

  ACK                                                          NACK                                            1      1      0      1      0      1      0      1      1      1

  NACK                                                         ACK                                             0      1      1      1      1      0      1      0      1      1

  NACK                                                         NACK                                            1      0      0      1      0      0      1      0      0      0

  HARQ-ACK in response to three scheduled transport blocks                                                                                                                    

  Response to primary transport block                          Response to second and third transport blocks                                                                  

  ACK                                                          ACK                                             1      0      1      0      1      1      1      1      0      1

  ACK                                                          NACK                                            1      1      0      1      0      1      0      1      1      1

  NACK                                                         ACK                                             0      1      1      1      1      0      1      0      1      1

  NACK                                                         NACK                                            1      0      0      1      0      0      1      0      0      0

  HARQ-ACK in response to four scheduled transport blocks                                                                                                                     

  Response to primary and fourth transport blocks              Response to second and third transport blocks                                                                  

  ACK                                                          ACK                                             1      0      1      0      1      1      1      1      0      1

  ACK                                                          NACK                                            1      1      0      1      0      1      0      1      1      1

  NACK                                                         ACK                                             0      1      1      1      1      0      1      0      1      1

  NACK                                                         NACK                                            1      0      0      1      0      0      1      0      0      0

  PRE/POST indication                                                                                                                                                         

  PRE                                                          0                                               0      1      0      0      1      0      0      1      0      

  POST                                                         0                                               1      0      0      1      0      0      1      0      0      
  ------------------------------------------------------------ ----------------------------------------------- ------ ------ ------ ------ ------ ------ ------ ------ ------ ---

The output bits g~0~, g~1~,...g~9~ are repeated as shown in Figure 20C.0

Figure 20C.0: Repetition of HARQ-ACK message

In Figure 20C.0, the repetition is according to the relation:

##### 4.7.3E.1.2 Channel coding for HS-DPCCH composite number of transport blocks preferred, precoding control indication and channel quality indication

When the UE is configured in MIMO mode with four transmit antennas two
types of CQI reports shall be supported by the UE. According to the
definition of the CQI reporting procedure in \[4\], in type A CQI
reporting the number of transport blocks preferred is up to four and in
type B CQI reporting the number of transport blocks preferred is one.

##### 4.7.3E.1.2.1 Bit mapping of Type A channel quality indication {#e.1.2.1-bit-mapping-of-type-a-channel-quality-indication .H6}

In case a type A CQI shall be reported, the CQI values 0 \... 255 as
defined in \[4\] are converted from decimal to binary to map them to the
channel quality indication bits (0 0 0 0 0 0 0 0) to (1 1 1 1 1 1 1 1),
respectively. The channel quality indication bits are cqi~0~ , cqi~1~ ,
cqi~2~ , cqi~3~ , cqi~4~, cqi~5~, cqi~6~, cqi~7~ (where cqi~0~ is LSB
and cqi~7~ is MSB).

In case the number of transport blocks preferred is one, the CQI values
0 \... 30 as defined in \[4\] are converted from decimal to binary to
map them to the channel quality indication bits (1 0 0 0 0) to (1 1 1 1
1), respectively. The information bit pattern (0 0 0 0 0) shall not be
used in this release. The channel quality indication bits are cqi~0,~
cqi~1,~ cqi~2,~ cqi~3,~ cqi~4~ (where cqi~0~ is LSB and cqi~4~ is MSB)
and (0 0 0) is used for indicating cqi~5~, cqi~6~, cqi~7~ (where cqi~5~
is LSB and cqi~7~ is MSB). .

##### 4.7.3E.1.2.2 Bit mapping of Type B channel quality indication {#e.1.2.2-bit-mapping-of-type-b-channel-quality-indication .H6}

In case a type B CQI shall be reported, the CQI values 0 \... 30 as
defined in \[4\] are converted from decimal to binary to map them to the
channel quality indication bits (1 0 0 0 0) to (1 1 1 1 1),
respectively. The information bit pattern (0 0 0 0 0) shall not be used
in this release. The channel quality indication bits are cqi~0,~ cqi~1,~
cqi~2,~ cqi~3,~ cqi~4~ (where cqi~0~ is LSB and cqi~4~ is MSB).

##### 4.7.3E.1.2.3 Bit mapping of number of transport blocks preferred {#e.1.2.3-bit-mapping-of-number-of-transport-blocks-preferred .H6}

According to the number of transport blocks preferred definition in
\[4\], the range of possible values is 0 \... 3. The number of transport
blocks preferred values 0 \... 3 as defined in \[4\] are converted from
decimal to binary to map them to the number of transport blocks
preferred bits (0 0) to (1 1) respectively. The number of transport
blocks preferred bits are ri~0~ ,ri~1~ (where ri~0~ is LSB and ri~1~ is
MSB).

##### 4.7.3E.1.2.4 Bit mapping of precoding control indication {#e.1.2.4-bit-mapping-of-precoding-control-indication .H6}

According to the PCI definition in \[4\], the range of possible PCI
values is 0 \... 15. The PCI values 0 \... 15 as defined in \[4\] are
converted from decimal to binary to map them to the precoding control
indication bits (0 0,0,0) to (1 1,1,1) respectively. The precoding
control indication bits are pci~0~ , pci~1,~, pci~2~, pci~3~ (where
pci~0~ is LSB and pci~3~ is MSB).

##### 4.7.3E.1.2.5 Composite number of transport blocks preferred , precoding control indication and channel quality indication bits  {#e.1.2.5-composite-number-of-transport-blocks-preferred-precoding-control-indication-and-channel-quality-indication-bits .H6}

For type A CQI report the composite NTBP/PCI/CQI shall be constructed
according to the scheme depicted in Figure 20C.1.

> Figure 20C.1: Construction of composite NTBP/PCI/CQI for Type A CQI
> report

In case a type A CQI shall be reported, the number of transport blocks
preferred bits ri~0~ ,ri~1~, precoding control indication bits pci~0~ ,
pci~1,~ pci~2,~ pci~3~, and the channel quality indication bits cqi~0~ ,
cqi~1~ , cqi~2~ , cqi~3~ , cqi~4~, cqi~5~, cqi~6~, cqi~7~ are
concatenated to the composite number of transport blocks preferred,
precoding control indication and channel quality indication bits
according to the relation

For type B CQI report the composite PCI/CQI shall be constructed
according to the scheme depicted in Figure 20C.2.

> Figure 20C.2: Construction of composite NTBP/PCI/CQI for Type B CQI
> report

In case a type B CQI shall be reported, the precoding control indication
bits pci~0~ , pci~1,~ pci~2,~ pci~3~, and the channel quality indication
bits cqi~0~ , cqi~1~ , cqi~2~ , cqi~3~ , cqi~4~ are concatenated to the
composite precoding control indication and channel quality indication
bits according to the relation

##### 4.7.3E.1.2.6 Channel coding for composite number of transport blocks preferred, precoding control indication and channel quality indication bits  {#e.1.2.6-channel-coding-for-composite-number-of-transport-blocks-preferred-precoding-control-indication-and-channel-quality-indication-bits .H6}

In case a type A CQI needs to be reported, rate 1/2 convolutional
coding, as described in Clause 4.2.3.1 is applied to the sequence of
bits *a~0~*, *a~1~*, ..., *a~13~*, resulting in the sequence of bits
*d~0~*, *d~1~*, ..., *d~43~*.

Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.

In case a type B CQI needs to be reported, rate 1/3 convolutional
coding, as described in Clause 4.2.3.1 is applied to the sequence of
bits *a~0~*, *a~1~*, ..., *a~8~*, resulting in the sequence of bits
*d~0~*, *d~1~*, ..., *d~50~*.

Note that the coded sequence lengths result from the termination of K=9
convolutional coding being fully applied.

##### 4.7.3E.1.2.7 Rate matching for composite number of transport blocks preferred, precoding control indication and channel quality indication bits  {#e.1.2.7-rate-matching-for-composite-number-of-transport-blocks-preferred-precoding-control-indication-and-channel-quality-indication-bits .H6}

In case a type A CQI needs to be reported, from the input sequence
*d~0~*, *d~1~*, ..., *d~43\ ~*the bits *d~0~*, *d~2~*, *d~41~*, *d~43~*
are punctured to obtain the output sequence b~0~, b~1~, ..., b~39~ .

In case a type B CQI needs to be reported, from the input sequence
*d~0~*, *d~1~*, ..., *d~50\ ~*the bits *d~0~*, *d~2~*, *d~3~*, *d~4~*,
*d~6~*, *d~44~*, *d~45~*, *d~46~*, *d~47~*, *d~48~*, *d~50~* are
punctured to obtain the output sequence b~0~, b~1~, ..., b~39~ .

#### 4.7.3E.2 Channel coding for HS-DPCCH when the UE is configured in MIMO mode with four transmit antennas in any cell and Secondary\_Cell\_Enabled is 1

Two forms of channel coding are used, one for the composite number of
transport blocks preferred (NTBP), precoding control indication (PCI)
and channel quality indication (CQI) and another for HARQ-ACK
(acknowledgement).

##### 4.7.3E.2.1 Channel coding for the composite HS-DPCCH HARQ-ACK

The HARQ acknowledgement message associated with a cell for which the UE
is configured in MIMO mode with four transmit antennas shall be coded to
10 bits as in Table 15C.3B in subclause 4.7.3E.1.1.

The HARQ acknowledgement message associated with a cell for which the UE
is configured in MIMO mode shall be coded to 10 bits as in Table 15B in
subclause 4.7.3.1.

The HARQ acknowledgement message associated with a cell for which the UE
is configured not in MIMO mode and not in MIMO mode with four transmit
antennas shall be coded to 10 bits as specified in Table 15 in subclause
4.7.2.

The HARQ acknowledgement messages corresponding to the serving HS-DSCH
cell and secondary serving HS-DSCH cell in that order are encoded and
concatenated into the same slot according to Figure 20D in clause
4.7.4.1.

##### 4.7.3E.2.2 Channel coding for HS-DPCCH composite number of transport blocks preferred, precoding control indication and channel quality indication

The channel coding for NTBP, PCI and CQI associated with a cell for
which the UE is configured in MIMO mode with four transmit antennas is
specified in subclause 4.7.3E.1.2.

The channel coding for PCI and CQI associated with a cell for which the
UE is configured in MIMO mode is specified in subclause 4.7.3.2.

The channel coding for CQI associated with a cell for which the UE is
configured not in MIMO mode and not in MIMO mode with four transmit
antennas is specified in subclause 4.7.2.2.

#### 4.7.3E.3 Channel coding for HS-DPCCH when the UE is configured in MIMO mode with four transmit antennas in any cell and Secondary\_Cell\_Enabled is 2

Two forms of channel coding are used, one for the composite number of
transport blocks preferred (NTBP), precoding control indication (PCI)
and channel quality indication (CQI) and another for HARQ-ACK
(acknowledgement).

##### 4.7.3E.3.1 Channel coding for the composite HS-DPCCH HARQ-ACK

The HARQ acknowledgement message associated with a cell for which the UE
is configured in MIMO mode with four transmit antennas shall be coded to
10 bits as in Table 15C.3B in subclause 4.7.3E.1.1.

The HARQ acknowledgement message associated with a cell for which the UE
is configured in MIMO mode shall be coded to 10 bits as in Table 15B in
subclause 4.7.3.1.

The HARQ acknowledgement message associated with a cell for which the UE
is not configured in MIMO mode and not configured in MIMO mode with four
transmit antennas shall be coded to 10 bits as specified in Table 15 in
subclause 4.7.2.

The HARQ acknowledgement messages corresponding to the serving HS-DSCH
cell and 1^st^ secondary serving HS-DSCH cell in that order are encoded
and concatenated into the same slot according to Figure 20D in clause
4.7.4.1.

##### 4.7.3E.3.2 Channel coding for HS-DPCCH composite number of transport blocks preferred, precoding control indication and channel quality indication

The channel coding for NTBP, PCI and CQI associated with a cell for
which the UE is configured in MIMO mode with four transmit antennas is
specified in subclause 4.7.3E.1.2.

The channel coding for PCI and CQI associated with a cell for which the
UE is configured in MIMO mode is specified in subclause 4.7.3.2.

The channel coding for PCI and CQI associated with a cell for which the
UE is configured not in MIMO mode and not in MIMO mode with four
transmit antennas is specified in subclause 4.7.2.2.

#### 4.7.3E.4 Channel coding for HS-DPCCH when the UE is configured in MIMO mode with four transmit antennas in any cell and Secondary\_Cell\_Enabled is 3

Two forms of channel coding are used, one for the composite number of
transport blocks preferred (NTBP), precoding control indication (PCI)
and channel quality indication (CQI) and another for HARQ-ACK
(acknowledgement).

##### 4.7.3E.4.1 Channel coding for the composite HS-DPCCH HARQ-ACK

The HARQ acknowledgement message associated with a cell for which the UE
is configured in MIMO mode with four transmit antennas shall be coded to
10 bits as in Table 15C.3B in subclause 4.7.3E.1.1.

The HARQ acknowledgement message associated with a cell for which the UE
is configured in MIMO mode shall be coded to 10 bits as in Table 15B in
subclause 4.7.3.1.

The HARQ acknowledgement message associated with a cell for which the UE
is configured not in MIMO mode and not in MIMO mode with four transmit
antennas shall be coded to 10 bits as specified in Table 15 in subclause
4.7.2.

The HARQ acknowledgement messages corresponding to the serving HS-DSCH
cell and 1^st^ secondary serving HS-DSCH cell in that order are encoded
and concatenated into the same slot according to Figure 20D in clause
4.7.4.1.

The HARQ acknowledgement messages corresponding to the 2^nd^ secondary
serving HS-DSCH cell and the 3^rd^ secondary serving HS-DSCH cell in
that order are encoded and concatenated into the same slot according to
Figure 20D.1 in clause 4.7.4.1.

##### 4.7.3E.4.2 Channel coding for HS-DPCCH composite number of transport blocks preferred, precoding control indication and channel quality indication

The channel coding for NTBP, PCI and CQI associated with a cell for
which the UE is configured in MIMO mode with four transmit antennas is
specified in subclause 4.7.3E.1.2.

The channel coding for PCI and CQI associated with a cell for which the
UE is configured in MIMO mode is specified in subclause 4.7.3.2.

The channel coding for PCI and CQI associated with a cell for which the
UE is configured not in MIMO mode and not in MIMO mode with four
transmit antennas is specified in subclause 4.7.2.2.

### 4.7.4 Physical channel mapping for HS-DPCCH

#### 4.7.4.1 Physical Channel mapping for HS-DPCCH HARQ-ACK 

This section is not applicable when the UE is configured in MIMO mode
with four transmit antennas in at least one cell.

If the HS-DPCCH slot format 0 as defined in \[2\] is used, the HS-DPCCH
physical channel mapping function shall map the input bits w~k~ directly
to physical channel so that bits are transmitted over the air in
ascending order with respect to k.

If the HS-DPCCH slot format 1 as defined in \[2\], is used, the HS-DPCCH
physical channel mapping function shall map the input bits w~k~ to the
physical channel so that bits are transmitted over the air in ascending
order with respect to k as follows:

\- If Secondary\_Cell\_Enabled is equal to 7 and Secondary\_Cell\_Active
is equal to 7

\- The following two HARQ-ACK messages are transmitted on HS-DPCCH
according to Figure 20D:

\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair
of serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order and

\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair
of the 2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary
serving HS-DSCH cell in that order

\- The following two HARQ-ACK messages are transmitted on HS-DPCCH~2~
according to Figure 20D.1:

\- HARQ-ACK3 comprising the HARQ acknowledgement messages for the pair
of the 4^th^ secondary serving HS-DSCH cell and the 5^th^ secondary
serving HS-DSCH cell in that order

\- HARQ-ACK4 comprising the HARQ acknowledgement messages for the pair
of the 6^th^ secondary serving HS-DSCH cell and the 7^th^ secondary
serving HS-DSCH cell in that order

\- If Secondary\_Cell\_Enabled is equal to 6 and Secondary\_Cell\_Active
is equal to 6

\- The following two HARQ-ACK messages are transmitted on HS-DPCCH
according to Figure 20D:

\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair
of serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order and

\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair
of the 2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary
serving HS-DSCH cell in that order

\- The following two HARQ-ACK messages are transmitted on HS-DPCCH~2~
according to Figure 20D.1:

\- HARQ-ACK3 comprising the HARQ acknowledgement messages for the pair
of the 4^th^ secondary serving HS-DSCH cell and the 5^th^ secondary
serving HS-DSCH cell in that order

\- HARQ-ACK4 comprising the HARQ acknowledgement messages for the 6^th^
secondary serving HS-DSCH cell and a DTX message in that order

\- If Secondary\_Cell\_Enabled is equal to 5 and Secondary\_Cell\_Active
is equal to 5

\- The following two HARQ-ACK messages are transmitted on HS-DPCCH
according to Figure 20D:

\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair
of serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order and

\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair
of the 2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary
serving HS-DSCH cell in that order

\- The following HARQ-ACK message is transmitted on HS-DPCCH~2~:

\- The HARQ acknowledgement messages for the pair of the 4^th^ secondary
serving HS-DSCH cell and the 5^th^ secondary serving HS-DSCH cell are
repeated according to Figure 20E.

\- If Secondary\_Cell\_Enabled is equal to 4 and Secondary\_Cell\_Active
is equal to 4

\- The following two HARQ-ACK messages are transmitted on HS-DPCCH
according to Figure 20D:

\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair
of serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order and

\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair
of the 2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary
serving HS-DSCH cell in that order

\- The following two HARQ-ACK messages are transmitted on HS-DPCCH~2~:

\- The HARQ-ACK comprising the HARQ acknowledgement the 4^th^ secondary
serving HS-DSCH cell and a DTX message in that order and it is repeated
according to Figure 20E.

\- If Secondary\_Cell\_Enabled is greater than 3 and
Secondary\_Cell\_Active is less than Secondary\_Cell\_Enabled:

\- If none of the 4^th^, 5^th^, 6^th^, or 7^th^ secondary serving
HS-DSCH cell is activated the HARQ-ACK transmissions on HS-DPCCH~2~ are
DTXed

\- If at most one of the 1^st^, 2^nd^, or 3^rd^ secondary serving
HS-DSCH cell is activated the HARQ-ACK message is repeated according to
Figure 20E

\- If one of the 4^th^, 5^th^, 6^th^, and 7^th^ secondary serving
HS-DSCH cell is activated the HARQ-ACK message is repeated according to
Figure 20E.

\- If two of the 4^th^, 5^th^, 6^th^ and 7^th^ secondary serving HS-DSCH
cell are active the HARQ-ACK comprises the HARQ acknowledgement messages
for the pair of the secondary serving HS-DSCH cell with lowest index as
indicated by higher layers and the other activated secondary serving
HS-DSCH cell in that order. The HARQ-ACK message is repeated according
to Figure 20E.

\- Otherwise the transmissions of the HARQ-ACK messages is the same as
if Secondary\_Cell\_Active was equal to Secondary\_Cell\_Enabled but
where DTX message(s) is transmitted in place of deactivated secondary
serving HS-DSCH cells.

\- If Secondary\_Cell\_Enabled is 3 and Secondary\_Cell\_Active is 2 or
3 then the following two HARQ-ACK messages are encoded and concatenated
into the same slot according to Figure 20D :

\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair
of serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order and

\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the pair
of 2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary serving
HS-DSCH cell in that order

\- If Secondary\_Cell\_Enabled is 2 with MIMO configured in at least one
of the cells and Secondary\_Cell\_Active is 2 then the following two
HARQ-ACK messages, are encoded and concatenated into the same slot
according to Figure 20D:

\- HARQ-ACK1 comprising the HARQ acknowledgement messages for the pair
of serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order and

\- HARQ-ACK2 comprising the HARQ acknowledgement messages for the 2^nd^
secondary serving HS-DSCH cell and a DTX message in that order

\- If Secondary\_Cell\_Enabled is more than 1 and
Secondary\_Cell\_Active is 0 or 1 then the transmission of the HARQ-ACK
message is repeated according to Figure 20E.

![](media/image274.wmf){width="6.5in" height="3.4583333333333335in"}

Figure 20D: Concatenation of 2 HARQ-ACK messages

In Figure 20D, the concatenation of the 2 HARQ-ACK messages is according
to the relation:

![](media/image275.wmf){width="6.5in" height="3.6979166666666665in"}

Figure 20D.1: Concatenation of 2 HARQ-ACK messages on HS-DPCCH~2~

![](media/image276.wmf){width="3.6319444444444446in"
height="3.140277777777778in"}

Figure 20E: Repetition of HARQ-ACK message

In Figure 20E, the repetition of the HARQ-ACK message is according to
the relation:

#### 4.7.4.2 Physical Channel mapping for HS-DPCCH PCI/CQI

Table 15C.4 lists the CQI and PCI/CQI report mapping scenarios when
Secondary\_Cell\_Enabled is less than 4. Tables 15C.5 and 15C.6 list the
CQI and PCI/CQI report mapping scenarios when Secondary\_Cell\_Enabled
is greater than 3. The transmission timing and repetition of the 1^st^
and the 2^nd^ CQI and PCI/CQI report is defined in \[4\].

Table 15C.4: The CQI and PCI/CQI report mapping scenarios when
Secondary\_Cell\_Enabled is less than 4

+------+-------+-------+-------+-------+-------+-------+-------+-------+
| Case | Se    | MIMO  | HS-   | Se    | 1^st^ | 2^nd^ |       |       |
|      | conda | confi | DPCCH | conda | CQI   | CQI   |       |       |
|      | ry\_\ | gured | slot  | ry\_\ | or    | or    |       |       |
|      | Ce    | in    | f     | Ce    | PC    | PC    |       |       |
|      | ll\_\ | any   | ormat | ll\_\ | I/CQI | I/CQI |       |       |
|      | En    | cell  |       | A     | r     | r     |       |       |
|      | abled |       |       | ctive | eport | eport |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
|      | CQI   | CQI   |       |       |       |       |       |       |
|      | or\   | or\   |       |       |       |       |       |       |
|      | PC    | PC    |       |       |       |       |       |       |
|      | I/CQI | I/CQI |       |       |       |       |       |       |
|      | Type  | Type  |       |       |       |       |       |       |
|      | A/B   | A/B   |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 1    | 0     | No    | 0     | 0     | CQI   | Not   |       |       |
|      |       |       |       |       |       | appli |       |       |
|      |       |       |       |       |       | cable |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 2    |       | Yes   | 0     | 0     | PC    | Not   |       |       |
|      |       |       |       |       | I/CQI | appli |       |       |
|      |       |       |       |       |       | cable |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 3    | 1     | No    | 0     | 1     | C     | Not   |       |       |
|      |       |       |       |       | QI~0~ | appli |       |       |
|      | Note  |       |       |       | &     | cable |       |       |
|      | 2     |       |       |       | C     |       |       |       |
|      |       |       |       |       | QI~1~ |       |       |       |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       | Note  |       |       |       |
|      |       |       |       |       | 5     |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 4    |       |       |       | 0     | C     | Not   |       |       |
|      |       |       |       |       | QI~0~ | appli |       |       |
|      |       |       |       |       |       | cable |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 5    |       | Yes   | 0     | 1     | PCI/C | PCI/C |       |       |
|      |       |       |       |       | QI~0~ | QI~1~ |       |       |
|      |       | Note  |       |       |       |       |       |       |
|      |       | 1     |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 6    |       |       |       | 0     | PCI/C | DTX   |       |       |
|      |       |       |       |       | QI~0~ |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 7    | 2     | No    | 0     | 2     | C     | C     |       |       |
|      |       |       |       |       | QI~0~ | QI~1~ |       |       |
|      | Note  |       |       |       |       | &     |       |       |
|      | 2     |       |       |       |       | C     |       |       |
|      |       |       |       |       |       | QI~2~ |       |       |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       | Note  |       |       |
|      |       |       |       |       |       | 5     |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 8    |       |       |       | 1     | C     | C     |       |       |
|      |       |       |       |       | QI~0~ | QI~n~ |       |       |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       | Note  |       |       |
|      |       |       |       |       |       | 4     |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 9    |       |       |       | 0     | C     | DTX   |       |       |
|      |       |       |       |       | QI~0~ |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
|      | CQI 1 | CQI 2 | CQI 1 | CQI 2 |       |       |       |       |
|      | or    | or    | or    | or    |       |       |       |       |
|      | PC    | PC    | PC    | PC    |       |       |       |       |
|      | I/CQI | I/CQI | I/CQI | I/CQI |       |       |       |       |
|      | 1     | 2\    | 1\    | 2\    |       |       |       |       |
|      | Type  | Type  | Type  | Type  |       |       |       |       |
|      | A/B   | A/B   | A/B   | A/B   |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 10   | 2     | Yes\  | 1     | 2     | PCI/C | PCI/C | PCI/C | DTX   |
|      |       | Note  |       |       | QI~0~ | QI~2~ | QI~1~ |       |
|      | Note  | 1     |       |       |       |       |       |       |
|      | 2     |       |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 11   |       |       |       | 1     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~0~ | QI~0~ | QI~n~ | QI~n~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       |       | Note  | Note  |
|      |       |       |       |       |       |       | 4     | 4     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 12   |       |       |       | 0     | PCI/C | PCI/C | DTX   |       |
|      |       |       |       |       | QI~0~ | QI~0~ |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 13   | 3     | No    | 1     | 3     | C     | C     | C     | C     |
|      |       |       |       |       | QI~0~ | QI~2~ | QI~1~ | QI~3~ |
|      | Note  |       |       |       |       |       |       |       |
|      | 2     |       |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 14   |       |       |       | 2     | C     | C     | C     | C     |
|      |       |       |       |       | QI~0~ | QI~2~ | QI~1~ | QI~3~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       | Note  | Note  | Note  |
|      |       |       |       |       |       | 3     | 3     | 3     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 15   |       |       |       | 1     | C     | C     | C     | C     |
|      |       |       |       |       | QI~0~ | QI~0~ | QI~n~ | QI~n~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       |       | Note  | Note  |
|      |       |       |       |       |       |       | 4     | 4     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 16   |       |       |       | 0     | C     | C     | DTX   |       |
|      |       |       |       |       | QI~0~ | QI~0~ |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 17   |       | Yes   | 1     | 3     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~0~ | QI~2~ | QI~1~ | QI~3~ |
|      |       | Note  |       |       |       |       |       |       |
|      |       | 1     |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 18   |       |       |       | 2     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~0~ | QI~2~ | QI~1~ | QI~3~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       | Note  | Note  | Note  |
|      |       |       |       |       |       | 3     | 3     | 3     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 19   |       |       |       | 1     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~0~ | QI~0~ | QI~n~ | QI~n~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       |       | Note  | Note  |
|      |       |       |       |       |       |       | 4     | 4     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 20   |       |       |       | 0     | PCI/C | PCI/C | DTX   |       |
|      |       |       |       |       | QI~0~ | QI~0~ |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+

Note 1: If the UE is configured in MIMO mode in at least one cell, but
not in all cells, a CQI value is reported instead of PCI/CQI value for
the non-MIMO cell(s).

Note 2: The CQI~0~ and PCI/CQI~0~ refer to the serving HS-DSCH cell's
CQI and PCI/CQI reports respectively, the CQI~n~ and PCI/CQI~n~ refer to
the n^th^ secondary serving HS-DSCH cell's reports.

Note 3: The deactivated secondary cell's CQI or PCI/CQI is not
transmitted (DTX'd).

Note 4: The CQI or the PCI/CQI of the single active secondary cell is
transmitted.

Note 5: The two CQI values are jointly encoded.

Table 15C.5: The CQI and PCI/CQI report mapping for HS-DPCCH when
Secondary\_Cell\_Enabled is greater than 3.

+------+-------+-------+-------+-------+-------+-------+-------+-------+
| Case | Se    | MIMO  | HS-   | A     | 1^st^ | 2^nd^ |       |       |
|      | conda | confi | DPCCH | ctive | CQI   | CQI   |       |       |
|      | ry\_\ | gured | slot  | seco  | or    | or    |       |       |
|      | Ce    | in    | f     | ndary | PC    | PC    |       |       |
|      | ll\_\ | any   | ormat | cells | I/CQI | I/CQI |       |       |
|      | En    | cell  |       | out   | r     | r     |       |       |
|      | abled |       |       | of    | eport | eport |       |       |
|      |       |       |       | 1     |       |       |       |       |
|      |       |       |       | ^st^, |       |       |       |       |
|      |       |       |       | 2     |       |       |       |       |
|      |       |       |       | ^nd^, |       |       |       |       |
|      |       |       |       | 3^rd^ |       |       |       |       |
|      |       |       |       | seco  |       |       |       |       |
|      |       |       |       | ndary |       |       |       |       |
|      |       |       |       | cell  |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
|      | CQI 1 | CQI 2 | CQI 1 | CQI 2 |       |       |       |       |
|      | or    | or    | or    | or    |       |       |       |       |
|      | PC    | PC    | PC    | PC    |       |       |       |       |
|      | I/CQI | I/CQI | I/CQI | I/CQI |       |       |       |       |
|      | 1     | 2\    | 1\    | 2\    |       |       |       |       |
|      | Type  | Type  | Type  | Type  |       |       |       |       |
|      | A/B   | A/B   | A/B   | A/B   |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 21a  | 4-7   | No    | 1     | 3     | C     | C     | C     | C     |
|      |       |       |       |       | QI~0~ | QI~2~ | QI~1~ | QI~3~ |
|      | Note  |       |       |       |       |       |       |       |
|      | 2     |       |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 22a  |       |       |       | 2     | C     | C     | C     | C     |
|      |       |       |       |       | QI~0~ | QI~2~ | QI~1~ | QI~3~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       | Note  | Note  | Note  |
|      |       |       |       |       |       | 3     | 3     | 3     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 23a  |       |       |       | 1     | C     | C     | C     | C     |
|      |       |       |       |       | QI~0~ | QI~0~ | QI~n~ | QI~n~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       |       | Note  | Note  |
|      |       |       |       |       |       |       | 4     | 4     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 24a  |       |       |       | 0     | C     | C     | DTX   |       |
|      |       |       |       |       | QI~0~ | QI~0~ |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 25a  |       | Yes   | 1     | 3     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~0~ | QI~2~ | QI~1~ | QI~3~ |
|      |       | Note  |       |       |       |       |       |       |
|      |       | 1     |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 26a  |       |       |       | 2     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~0~ | QI~2~ | QI~1~ | QI~3~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       | Note  | Note  | Note  |
|      |       |       |       |       |       | 3     | 3     | 3     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 27a  |       |       |       | 1     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~0~ | QI~0~ | QI~n~ | QI~n~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       |       |       | Note  | Note  |
|      |       |       |       |       |       |       | 4     | 4     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 28a  |       |       |       | 0     | PCI/C | PCI/C | DTX   |       |
|      |       |       |       |       | QI~0~ | QI~0~ |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+

Note 1: If the UE is configured in MIMO mode in at least one cell, but
not in all cells, a CQI value is reported instead of PCI/CQI value for
the non-MIMO cell(s).

Note 2: The CQI~0~ and PCI/CQI~0~ refer to the serving HS-DSCH cell's
CQI and PCI/CQI reports respectively, the CQI~n~ and PCI/CQI~n~ refer to
the n^th^ secondary serving HS-DSCH cell's reports, and n ⊂ {1,2,3}.

Note 3: The deactivated secondary cell's CQI or PCI/CQI is not
transmitted (DTX'd).

Note 4: The CQI or the PCI/CQI of the single active secondary cell is
transmitted.

Table 15C.6: The CQI and PCI/CQI report mapping for HS-DPCCH2 when
Secondary\_Cell\_Enabled is greater than 3.

+------+-------+-------+-------+-------+-------+-------+-------+-------+
| Case | Se    | MIMO  | HS-   | A     | 3^rd^ | 4^th^ |       |       |
|      | conda | confi | DPCCH | ctive | CQI   | CQI   |       |       |
|      | ry\_\ | gured | slot  | seco  | or    | or    |       |       |
|      | Ce    | in    | f     | ndary | PC    | PC    |       |       |
|      | ll\_\ | any   | ormat | cells | I/CQI | I/CQI |       |       |
|      | En    | cell  |       | out   | r     | r     |       |       |
|      | abled |       |       | of    | eport | eport |       |       |
|      |       |       |       | 4     |       |       |       |       |
|      |       |       |       | ^th^, |       |       |       |       |
|      |       |       |       | 5     |       |       |       |       |
|      |       |       |       | ^th^, |       |       |       |       |
|      |       |       |       | 6^th^ |       |       |       |       |
|      |       |       |       | and   |       |       |       |       |
|      |       |       |       | 7^th^ |       |       |       |       |
|      |       |       |       | seco  |       |       |       |       |
|      |       |       |       | ndary |       |       |       |       |
|      |       |       |       | cell  |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
|      | CQI 3 | CQI 4 | CQI 3 | CQI 4 |       |       |       |       |
|      | or    | or    | or    | or    |       |       |       |       |
|      | PC    | PC    | PC    | PC    |       |       |       |       |
|      | I/CQI | I/CQI | I/CQI | I/CQI |       |       |       |       |
|      | 3     | 4\    | 3\    | 4\    |       |       |       |       |
|      | Type  | Type  | Type  | Type  |       |       |       |       |
|      | A/B   | A/B   | A/B   | A/B   |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 21b  | 4-7   | No    | 1     | 4     | C     | C     | C     | C     |
|      |       |       |       |       | QI~4~ | QI~6~ | QI~5~ | QI~7~ |
|      | Note  |       |       |       |       |       |       |       |
|      | 2     |       |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 22b  |       |       |       | 3     | C     | C     | C     | C     |
|      |       |       |       |       | QI~4~ | QI~6~ | QI~5~ | QI~7~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       | Note  | Note  | Note  | Note  |
|      |       |       |       |       | 3     | 3     | 3     | 3     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 23b  |       |       |       | 2     | C     | C     | C     | C     |
|      |       |       |       |       | QI~n~ | QI~n~ | QI~m~ | QI~m~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       | Note  | Note  | Note  | Note  |
|      |       |       |       |       | 2     | 2     | 2     | 2     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 24b  |       |       |       | 1     | C     | C     | DTX   |       |
|      |       |       |       |       | QI~n~ | QI~n~ |       |       |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       | Note  | Note  |       |       |
|      |       |       |       |       | 4     | 4     |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 25b  |       |       |       | 0     | DTX   | DTX   |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 26b  |       | Yes   | 1     | 4     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~4~ | QI~6~ | QI~5~ | QI~7~ |
|      |       | Note  |       |       |       |       |       |       |
|      |       | 1     |       |       |       |       |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 27b  |       |       |       | 3     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~4~ | QI~6~ | QI~5~ | QI~7~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       | Note  | Note  | Note  | Note  |
|      |       |       |       |       | 3     | 3     | 3     | 3     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 28b  |       |       |       | 2     | PCI/C | PCI/C | PCI/C | PCI/C |
|      |       |       |       |       | QI~n~ | QI~n~ | QI~m~ | QI~m~ |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       | Note  | Note  | Note  | Note  |
|      |       |       |       |       | 2     | 2     | 2     | 2     |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 29b  |       |       |       | 1     | PCI/C | PCI/C | DTX   |       |
|      |       |       |       |       | QI~n~ | QI~n~ |       |       |
|      |       |       |       |       |       |       |       |       |
|      |       |       |       |       | Note  | Note  |       |       |
|      |       |       |       |       | 4     | 4     |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+
| 30b  |       |       |       | 0     | DTX   | DTX   |       |       |
+------+-------+-------+-------+-------+-------+-------+-------+-------+

Note 1: If the UE is configured in MIMO mode in at least one cell, but
not in all cells, a CQI value is reported instead of PCI/CQI value for
the non-MIMO cell(s).

Note 2: The CQI~n~ and PCI/CQI~n~ refer to the n^th^ secondary serving
HS-DSCH cell's reports, and the CQI~m~ and PCI/CQI~m~ refer to the m^th^
secondary serving HS-DSCH cell's reports, where n \< m and {n, m} ⊂
{4,5,6,7}.

Note 3: The deactivated secondary cells' CQI or PCI/CQI is not
transmitted (DTX'd).

Note 4: The CQI or the PCI/CQI of the single active secondary cell out
of the 4^th^, 5^th^, 6^th^ and 7^th^ secondary cells is transmitted.

If the HS-DPCCH slot format 0 as defined in \[2\] is used, the HS-DPCCH
physical channel mapping function shall map the input bits b~k~ directly
to physical channel so that bits are transmitted over the air in
ascending order with respect to k. When Secondary\_Cell\_Active is 2,
the CQI reports for each of the following groups are mapped to separate
subframes as specified in \[4\]:

\- The report for the serving HS-DSCH cell (CQI) is mapped according to
the physical channel mapping of CQI in Figure 20.

\- The report for the 1^st^ secondary serving HS-DSCH cell (CQI 1) and
the 2^nd^ secondary serving HS-DSCH cell (CQI 2) are mapped according to
Figure 20C and according to the physical channel mapping of CQI in
Figure 20.

If the HS-DPCCH slot format 1 as defined in \[2\] is used and
Secondary\_Cell\_Enabled is less than 4, the HS-DPCCH physical channel
mapping function shall map the input bits b~k~ to the physical channel
so that bits are transmitted over the air in ascending order with
respect to k as follows:

\- When Secondary\_Cell\_Active is 3, the CQI or PCI/CQI reports for
each of the following pairs are mapped to separate subframes as
specified in \[4\]:

\- The report for the serving HS-DSCH cell (CQI 1 or PCI/CQI 1) and the
2^nd^ secondary serving HS-DSCH cell (CQI 2 or PCI/CQI 2) are mapped
according to Figure 20F.

\- The report for the 1^st^ secondary serving HS-DSCH cell (CQI 1 or
PCI/CQI 1) and the 3^rd^ secondary serving HS-DSCH cell (CQI 2 or
PCI/CQI 2) are mapped according to Figure 20F.

\- When Secondary\_Cell\_Active is 2, the mapping of the CQI or PCI/CQI
reports is the same as the case when Secondary\_Cell\_Active is 3 with
the following exception: In the subframe in which only one active cell
is mapped, the HS-DPCCH physical channel mapping function shall map the
input bits b~k~ directly to the physical channel in the corresponding
slot of the CQI (or PCI/CQI) field of that subframe while the other slot
of the CQI (or PCI/CQI) field is DTXed.

\- When Secondary\_Cell\_Active is 0 or 1, the CQI or PCI/CQI report for
each active cell is mapped to a separate subframe as specified in \[4\].
In each subframe, the HS-DPCCH physical channel mapping function shall
map the input bits to the physical channel according to Figure 20G.

If the HS-DPCCH slot format 1 as defined in \[2\] is used and
Secondary\_Cell\_Enabled is greater than 3, the HS-PDCCH physical
channel mapping function shall map the input bits b~k~ to the physical
channel so that bits are transmitted over the air in ascending order
with respect to k as follows:

\- When Secondary\_Cell\_Active is 7, the CQI or PCI/CQI reports for
each of the following pairs are mapped to separate subframes as
specified in \[4\]:

\- The following is transmitted on HS-DPCCH:

\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1) and the
2^nd^ secondary serving HS-DSCH cell (CQI2 or PCI/CQI2) are mapped
according to Figure 20F.

\- The report for the 1^st^ secondary serving HS-DSCH cell (CQI1 or
PCI/CQI1) and the 3^rd^ secondary serving HS-DSCH cell (CQI2 or
PCI/CQI2) are mapped according to Figure 20F.

\- The following is transmitted on HS-DPCCH~2~:

\- The report for the 4^th^ secondary serving HS-DSCH cell (CQI3 or
PCI/CQI3) and the 6^th^ secondary serving HS-DSCH cell (CQI4 or
PCI/CQI4) are mapped according to Figure 20F.1.

\- The report for the 5^th^ secondary serving HS-DSCH cell (CQI3 or
PCI/CQI3) and the 7^th^ secondary serving HS-DSCH cell (CQI4 or
PCI/CQI4) are mapped according to Figure 20F.1.

\- When Secondary\_Cell\_Active is less than 7 the mapping of the CQI or
PCI/CQI reports is the same as the case when Secondary\_Cell\_Active is
7 with the following exceptions:

\- When one of the 1^st^, 2^nd^ or 3^rd^ secondary serving HS-DSCH cell
is deactivated the HS-DPCCH physical channel mapping function shall map
the input bits b~k~ directly to the physical channel in the
corresponding slot of the CQI (or PCI/CQI) field of that subframe while
the other slot of the CQI (or PCI/CQI) field is DTXed in the subframe in
which only one active cell is mapped.

\- When one of the 4^th^, 5^th^, 6^th^ or 7^th^ secondary serving
HS-DSCH cell is deactivated the HS-DPCCH physical channel mapping
function shall map the input bits b~k~ directly to the physical channel
in the corresponding slot of the CQI (or PCI/CQI) field of that subframe
while the other slot of the CQI (or PCI/CQI) field is DTXed in the
subframe in which only one active cell is mapped.

\- If at most one of the 1^st^, 2^nd^, or 3^rd^ secondary serving
HS-DSCH cell is activated the CQI or PCI/CQI report for each active cell
is mapped to a separate subframe as specified in \[4\]. In each
subframe, the HS-DPCCH physical channel mapping function shall map the
input bits to the physical channel according to Figure 20G.

\- If at most two of the 4^th^, 5^th^, 6^th^ or 7^th^ secondary serving
HS-DSCH cell is activated the CQI or PCI/CQI report for each active cell
is mapped to a separate subframe as specified in \[4\]. In each
subframe, the HS-DPCCH physical channel mapping function shall map the
input bits to the physical channel according to Figure 20G.

![](media/image277.wmf){width="4.444444444444445in"
height="3.8020833333333335in"}

Figure 20F: Concatenation of CQI (or PCI/CQI) reports in the CQI (or
PCI/CQI) field of a sub-frame

In Figure 20F, the two individual CQI (or PCI/CQI) reports are
concatenated to form the composite channel quality indication according
to the relation

![](media/image278.wmf){width="6.5in" height="4.251388888888889in"}

Figure 20F.1: Concatenation of CQI (or PCI/CQI) reports in the CQI (or
PCI/CQI) field of a sub-frame on HS-DPCCH~2~.

![](media/image279.wmf){width="3.298611111111111in"
height="3.2979166666666666in"}

Figure 20G: Repetition of CQI or PCI/CQI reports

In Figure 20G, the CQI (or PCI/CQI) report is repeated according to the
relation

#### 4.7.4.3 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI when the UE is configured in Multiflow mode

The notation used in the following subclauses is as defined below:

> Cell activation status \'\'A': Indicates a cell that is active (not
> deactivated by an HS-SCCH order).
>
> Cell activation status \'\'-': Indicates a cell that is inactive
> (deactivated by an HS-SCCH order).
>
> Cell group n: A group of (one, two, or three) Multiflow mode cells
> that have the same CPICH timing. The cells that belong to a cell group
> are indicated by higher layers.
>
> Ai & Aj: HARQ-ACK field for jointly encoded HARQ-ACK information of
> cell i and cell j.
>
> Ai & Aj & Ak: HARQ-ACK field for jointly encoded HARQ-ACK information
> of cell i, cell j and cell k.
>
> Ai & D: HARQ-ACK field for jointly encoded HARQ-ACK information of
> cell i and DTX indication.
>
> Ai & Aj & D: HARQ-ACK field for jointly encoded HARQ-ACK information
> of cell i, cell j and DTX indication.
>
> Ai & D & Aj: HARQ-ACK field for jointly encoded HARQ-ACK information
> of cell i, DTX indication, and HARQ-ACK information of cell j.
>
> CQIi: CQI field for CQI information of cell i.
>
> PCI/CQIi: PCI/CQI field for jointly encoded PCI and CQI information of
> cell i.
>
> CQIi & CQIj: Jointly encoded CQI field for CQI information of cell i
> and cell j.

##### 4.7.4.3.1 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI when the UE is configured with one serving and one assisting serving HS-DSCH cell

When MIMO is not configured in any cell;

\- The HS-DPCCH mapping follows the table 15C.8.

\- The HARQ-ACK and CQI encoding follow the definition in subclause
4.7.3A.

\- HS-DPCCH is transmitted using slot format \#0.

Table 15C.8: The UE is configured with one serving and one assisting
serving HS-DSCH cell and no cells are in MIMO mode

  ------------- ---------------------------- ----------------------- ------------ ------------- ------------
  **MF case**   **Cell activation status**   **HS-DPCCH subframe**                              
                **Cell group 1**             **Cell group 2**        **Slot 0**   **Slot 1**    **Slot 2**
                **Cell0**                    **Cell1**                                          
  1             A                            A                       A0 & A1      CQI0 & CQI1   
  ------------- ---------------------------- ----------------------- ------------ ------------- ------------

In this table cell 0 refers to the serving HS-DSCH cell, and cell 1
refers to the assisting serving HS-DSCH cell.

When MIMO is configured in at least one cell;

> \- The HS-DPCCH mapping follows the table 15C.9.
>
> \- The HARQ-ACK encoding follows the subclause 4.7.3D.1.
>
> \- The channel coding for CQI associated with a cell for which the UE
> is not configured in MIMO mode is specified in subclause 4.7.2.2.
>
> \- The channel coding for PCI and CQI associated with a cell for which
> the UE is configured in MIMO mode is specified in subclause 4.7.3.2.

\- HS-DPCCH is transmitted using slot format \#0.

Table 15C.9: The UE is configured with one serving and one assisting
serving HS-DSCH cell and at least one cell is configured in MIMO mode

  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------
  **MF case**   **Cell activation status**   **HS-DPCCH subframe \#1**   **HS-DPCCH subframe \#2**                                                       
                **Cell group 1**             **Cell group 2**            **Slot 0**                  **Slot 1**   **Slot 2**   **Slot 0**   **Slot 1**   **Slot 2**
                **Cell0**                    **Cell1**                                                                                                   
  2             A                            A                           A0 & A1                     PCI/CQI0     A0 & A1      PCI/CQI1                  
  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------

In this table cell 0 refers to the serving HS-DSCH cell, and cell 1
refers to the assisting serving HS-DSCH cell.

##### 4.7.4.3.2 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI when the UE is configured with two serving and one assisting serving or one serving and two assisting serving HS-DSCH cells

When MIMO is not configured in any cell;

> \- If the UE is configured with two serving and one assisting serving
> HS-DSCH cells the HS-DPCCH mapping follows the table 15C.10
>
> \- If the UE is configured with one serving and two assisting serving
> HS-DSCH cells the HS-DPCCH mapping follows the table 15C.11.
>
> \- The HARQ-ACK encoding follow the definition in subclause 4.7.3C.1.
>
> \- The CQI encoding for composite CQI reports containing channel
> quality indication for two cells follows the definition in subclause
> 4.7.3A.2
>
> \- The CQI encoding for the separately encoded CQI reports follows the
> definition in subclause 4.7.2.2.

\- HS-DPCCH is transmitted using slot format \#0.

Table 15C.10: The UE is configured with two serving and one assisting
serving HS-DSCH cells and no cells are in MIMO mode

  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------- ------------ ------------ ------------ --
  **MF case**   **Cell activation status**   **HS-DPCCH subframe \#1**   **HS-DPCCH subframe \#2**                                                                     
                **Cell group 1**             **Cell group 2**            **Slot 0**                  **Slot 1**   **Slot 2**    **Slot 0**   **Slot 1**   **Slot 2**   
                **Cell0**                    **Cell1**                   **Cell2**                                                                                     
  3             A                            A                           A                           A0&A1&A2     CQI0 & CQI1   A0&A1&A2     CQI2                      
  4             A                            \-                          A                           A0&D&A2      CQI0          A0&D&A2      CQI2                      
  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------- ------------ ------------ ------------ --

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the secondary serving HS-DSCH cell and cell 2 refers to the assisting
serving HS-DSCH cell.

Table 15C.11: The UE is configured with one serving and two assisting
serving HS-DSCH cells and no cells are in MIMO mode

  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------- ------------ --
  **MF case**   **Cell activation status**   **HS-DPCCH subframe \#1**   **HS-DPCCH subframe \#2**                                                                     
                **Cell group 1**             **Cell group 2**            **Slot 0**                  **Slot 1**   **Slot 2**   **Slot 0**   **Slot 1**    **Slot 2**   
                **Cell0**                    **Cell1**                   **Cell2**                                                                                     
  5             A                            A                           A                           A0&A1&A2     CQI0         A0&A1&A2     CQI1 & CQI2                
  6             A                            A                           \-                          A0&A1&D      CQI0         A0&A1&D      CQI1                       
  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------- ------------ --

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the assisting serving HS-DSCH cell and cell 2 refers to the assisting
secondary serving HS-DSCH cell.

When MIMO is configured in at least one cell;

> \- If the UE is configured with two serving and one assisting serving
> HS-DSCH cells the HS-DPCCH mapping follows the table 15C.12
>
> \- If the UE is configured with one serving and two assisting serving
> HS-DSCH cells the HS-DPCCH mapping follows the table 15C.13.
>
> \- The channel coding for HARQ-ACK for all cells is specified in
> subclause 4.7.3B.1.
>
> \- The channel coding for CQI associated with a cell for which the UE
> is not configured in MIMO mode is specified in subclause 4.7.2.2.
>
> \- The channel coding for PCI and CQI associated with a cell for which
> the UE is configured in MIMO mode is specified in subclause 4.7.3.2.
>
> \- HS-DPCCH is transmitted using slot format \#1.

Table 15C.12: The UE is configured with two serving and one assisting
serving HS-DSCH cells and at least one cell is configured in MIMO mode

  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------ ------ ---------- ----------
  **MF case**   **Cell activation status**   **HS-DPCCH subframe \#1**   **HS-DPCCH subframe \#2**                                                                                      
                **Cell group 1**             **Cell group 2**            **Slot 0**                  **Slot 1**   **Slot 2**   **Slot 0**   **Slot 1**   **Slot 2**                     
                **Cell0**                    **Cell1**                   **Cell2**                                                                                                      
  7             A                            A                           A                           A0&A1        A2&D         PCI/CQI0     PCI/CQI1     A0&A1        A2&D   PCI/CQI2   PCI/CQI2
  8             A                            \-                          A                           A0&D         A2&D         PCI/CQI0     PCI/CQI0     A0&D         A2&D   PCI/CQI2   PCI/CQI2
  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------ ------ ---------- ----------

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the secondary serving HS-DSCH cell and cell 2 refers to the assisting
serving HS-DSCH cell.

Table 15C.13: The UE is configured with one serving and two assisting
serving HS-DSCH cells and at least one cell is configured in MIMO mode

  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------ ------- ---------- ----------
  **MF case**   **Cell activation status**   **HS-DPCCH subframe \#1**   **HS-DPCCH subframe \#2**                                                                                       
                **Cell group 1**             **Cell group 2**            **Slot 0**                  **Slot 1**   **Slot 2**   **Slot 0**   **Slot 1**   **Slot 2**                      
                **Cell0**                    **Cell1**                   **Cell2**                                                                                                       
  9             A                            A                           A                           A0&D         A1&A2        PCI/CQI0     PCI/CQI0     A0&D         A1&A2   PCI/CQI1   PCI/CQI2
  10            A                            A                           \-                          A0&D         A1&D         PCI/CQI0     PCI/CQI0     A0&D         A1&D    PCI/CQI1   PCI/CQI1
  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------ ------- ---------- ----------

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the assisting serving HS-DSCH cell and cell 2 refers to the assisting
secondary serving HS-DSCH cell.

##### 4.7.4.3.3 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI when the UE is configured with two serving and two assisting serving HS-DSCH cells

When MIMO is not configured in any cell;

> \- The HS-DPCCH mapping follows the table 15C.14
>
> \- The channel coding for HARQ-ACK is specified in subclause 4.7.3B.1.
>
> \- The channel coding for CQI is specified in subclause 4.7.2.2.
>
> \- HS-DPCCH is transmitted using slot format \#1.

Table 15C.14: The UE is configured with two serving and two assisting
serving HS-DSCH cells and no cells are in MIMO mode

  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------ ------- ------- ------ ------
  **MF case**   **Cell activation status**   **HS-DPCCH subframe \#1**   **HS-DPCCH subframe \#2**                                                                                           
                **Cell group 1**             **Cell group 2**            **Slot 0**                  **Slot 1**   **Slot 2**   **Slot 0**   **Slot 1**   **Slot 2**                          
                **Cell0**                    **Cell1**                   **Cell2**                   **Cell3**                                                                               
  11            A                            A                           A                           A            A0&A1        A2&A3        CQI0         CQI1         A0&A1   A2&A3   CQI2   CQI3
  12            A                            A                           A                           \-           A0&A1        A2&D         CQI0         CQI1         A0&A1   A2&D    CQI2   CQI2
  13            A                            \-                          A                           A            A0&D         A2&A3        CQI0         CQI0         A0&D    A2&A3   CQI2   CQI3
  14            A                            \-                          A                           \-           A0&D         A2&D         CQI0         CQI0         A0&D    A2&D    CQI2   CQI2
  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------ ------- ------- ------ ------

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the secondary serving HS-DSCH cell, cell 2 refers to the assisting
serving HS-DSCH cell and cell 3 refers to the assisting secondary
serving HS-DSCH cell.

When MIMO is configured in at least one cell;

> \- The HS-DPCCH mapping follows the table 15C.15
>
> \- The channel coding for HARQ-ACK for all cells is specified in
> subclause 4.7.3B.1.
>
> \- The channel coding for CQI associated with a cell for which the UE
> is not configured in MIMO mode is specified in subclause 4.7.2.2.
>
> \- The channel coding for PCI and CQI associated with a cell for which
> the UE is configured in MIMO mode is specified in subclause 4.7.3.2.
>
> \- HS-DPCCH is transmitted using slot format \#1.

Table 15C.15: The UE is configured with two serving and two assisting
serving HS-DSCH cells and at least one cell is configured in MIMO mode

  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------ ------- ------- ---------- ----------
  **MF case**   **Cell activation status**   **HS-DPCCH subframe \#1**   **HS-DPCCH subframe \#2**                                                                                               
                **Cell group 1**             **Cell group 2**            **Slot 0**                  **Slot 1**   **Slot 2**   **Slot 0**   **Slot 1**   **Slot 2**                              
                **Cell0**                    **Cell1**                   **Cell2**                   **Cell3**                                                                                   
  15            A                            A                           A                           A            A0&A1        A2&A3        PCI/CQI0     PCI/CQI1     A0&A1   A2&A3   PCI/CQI2   PCI/CQI3
  16            A                            A                           A                           \-           A0&A1        A2&D         PCI/CQI0     PCI/CQI1     A0&A1   A2&D    PCI/CQI2   PCI/CQI2
  17            A                            \-                          A                           A            A0&D         A2&A3        PCI/CQI0     PCI/CQI0     A0&D    A2&A3   PCI/CQI2   PCI/CQI3
  18            A                            \-                          A                           \-           A0&D         A2&D         PCI/CQI0     PCI/CQI0     A0&D    A2&D    PCI/CQI2   PCI/CQI2
  ------------- ---------------------------- --------------------------- --------------------------- ------------ ------------ ------------ ------------ ------------ ------- ------- ---------- ----------

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the secondary serving HS-DSCH cell, cell 2 refers to the assisting
serving HS-DSCH cell and cell 3 refers to the assisting secondary
serving HS-DSCH cell.

##### 4.7.4.3.4 Physical Channel mapping for HS-DPCCH HARQ-ACK and PCI/CQI when the UE is configured with three serving and one assisting serving HS-DSCH cells or one serving and three assisting serving HS-DSCH cells

When MIMO is not configured in any cell;

\- If the UE is configured with three serving and one assisting serving
HS-DSCH cells, the HS-DPCCH mapping follows the table 15C.16.

\- If the UE is configured with one serving and three assisting serving
HS-DSCH cells, the HS-DPCCH mapping follows the table 15C.17.

\- The channel coding for HARQ-ACK is specified in subclause 4.7.3B.1.

\- The channel coding for CQI is specified in subclause 4.7.2.2.

\- HS-DPCCH is transmitted using slot format \#1.

Table 15C.16: The UE is configured with three serving and one assisting
serving HS-DSCH cells and no cells are in MIMO mode

  --------- ------------------------ ----------------------- ----------------------- -------- -------- -------- -------- -------- ------- ------- ------ ------
  MF case   Cell activation status   HS-DPCCH subframe \#1   HS-DPCCH subframe \#2                                                                       
            Cell group 1             CG2                     Slot 0                  Slot 1   Slot 2   Slot 0   Slot 1   Slot 2                          
            Cell0                    Cell1                   Cell2                   Cell3                                                               
  19        A                        A                       A                       A        A0&A1    A2&A3    CQI0     CQI1     A0&A1   A2&A3   CQI2   CQI3
  20        A                        \-                      A                       A        A0&D     A2&A3    CQI0     CQI0     A0&D    A2&A3   CQI2   CQI3
  21        A                        A                       \-                      A        A0&A1    D&A3     CQI0     CQI1     A0&A1   D&A3    DTX    CQI3
  22        A                        \-                      \-                      A        A0&D     D&A3     CQI0     CQI0     A0&D    D&A3    DTX    CQI3
  --------- ------------------------ ----------------------- ----------------------- -------- -------- -------- -------- -------- ------- ------- ------ ------

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the 1st secondary serving HS-DSCH cell, cell 2 refers to the 2nd
secondary serving HS-DSCH cell and cell 3 refers to the assisting
serving HS-DSCH cell.

Table 15C.17: The UE is configured with one serving and three assisting
serving HS-DSCH cells and no cells are in MIMO mode

  --------- ------------------------ ----------------------- ----------------------- ----------- -------- -------- -------- -------- ------- ------- ------ ------
  MF case   Cell activation status   HS-DPCCH subframe \#1   HS-DPCCH subframe \#2                                                                          
            CG1                      Cell group 2            Slot 0                  Slot 1      Slot 2   Slot 0   Slot 1   Slot 2                          
            **Cell0**                **Cell1**               **Cell2**               **Cell3**                                                              
  23        A                        A                       A                       A           A0&A1    A2&A3    CQI0     CQI1     A0&A1   A2&A3   CQI2   CQI3
  24        A                        A                       \-                      A           A0&A1    D&A3     CQI0     CQI1     A0&A1   D&A3    DTX    CQI3
  25        A                        A                       A                       \-          A0&A1    A2&D     CQI0     CQI1     A0&A1   A2&D    CQI2   DTX
  26        A                        A                       \-                      \-          A0&A1    D        CQI0     CQI1     A0&A1   D       DTX    DTX
  --------- ------------------------ ----------------------- ----------------------- ----------- -------- -------- -------- -------- ------- ------- ------ ------

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the assisting serving HS-DSCH cell, cell 2 refers to the 1st
assisting secondary serving HS-DSCH cell and cell 3 refers to the 2nd
assisting secondary serving HS-DSCH cell.

When MIMO is configured in at least one cell;

\- If the UE is configured with three serving and one assisting serving
HS-DSCH cells, the HS-DPCCH mapping follows the table 15C.18.

\- If the UE is configured with one serving and three assisting serving
HS-DSCH cells, the HS-DPCCH mapping follows the table 15C.19.

\- The channel coding for HARQ-ACK for all cells is specified in
subclause 4.7.3B.1, with the following exceptions:

\- The second half (last 10 bits) of the Slot0 in Table 15C.18, where
the channel coding is specified in subclause 4.7.3D.1.

\- The first half (first 10 bits) of the Slot0 in Table 15C.19, where
the channel coding is specified in subclause 4.7.3D.1

\- The channel coding for CQI associated with a cell for which the UE is
not configured in MIMO mode is specified in subclause 4.7.2.2.

\- The channel coding for PCI and CQI associated with a cell for which
the UE is configured in MIMO mode is specified in subclause 4.7.3.2.

\- HS-DPCCH is transmitted using slot format \#1.

Table 15C.18: The UE is configured with three serving and one assisting
serving HS-DSCH cells and at least one cell is configured in MIMO mode

  --------- ------------------------ ----------------------- ----------------------- -------- -------- -------- ---------- ---------- ------- ------- ---------- ----------
  MF case   Cell activation status   HS-DPCCH subframe \#1   HS-DPCCH subframe \#2                                                                               
            Cell group 1             CG2                     Slot 0                  Slot 1   Slot 2   Slot 0   Slot 1     Slot 2                                
            Cell0                    Cell1                   Cell2                   Cell3                                                                       
  27        A                        A                       A                       A        A0&A1    A2&A3    PCI/CQI0   PCI/CQI1   A0&A1   A2&A3   PCI/CQI2   PCI/CQI3
  28        A                        \-                      A                       A        A0&D     A2&A3    PCI/CQI0   PCI/CQI0   A0&D    A2&A3   PCI/CQI2   PCI/CQI3
  29        A                        A                       \-                      A        A0&A1    D&A3     PCI/CQI0   PCI/CQI1   A0&A1   D&A3    DTX        PCI/CQI3
  30        A                        \-                      \-                      A        A0&D     D&A3     PCI/CQI0   PCI/CQI0   A0&D    D&A3    DTX        PCI/CQI3
  --------- ------------------------ ----------------------- ----------------------- -------- -------- -------- ---------- ---------- ------- ------- ---------- ----------

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the 1st secondary serving HS-DSCH cell, cell 2 refers to the 2nd
secondary serving HS-DSCH cell and cell 3 refers to the assisting
serving HS-DSCH cell.

Table 15C.19: The UE is configured with one serving and three assisting
serving HS-DSCH cells and at least one cell is configured in MIMO mode

  --------- ------------------------ ----------------------- ----------------------- ----------- -------- -------- ---------- ---------- ------- ------- ---------- ----------
  MF case   Cell activation status   HS-DPCCH subframe \#1   HS-DPCCH subframe \#2                                                                                  
            CG1                      Cell group 2            Slot 0                  Slot 1      Slot 2   Slot 0   Slot 1     Slot 2                                
            **Cell0**                **Cell1**               **Cell2**               **Cell3**                                                                      
  31        A                        A                       A                       A           A0&A1    A2&A3    PCI/CQI0   PCI/CQI1   A0&A1   A2&A3   PCI/CQI2   PCI/CQI3
  32        A                        A                       \-                      A           A0&A1    A2&D     PCI/CQI0   PCI/CQI1   A0&A1   D&A3    DTX        PCI/CQI3
  33        A                        A                       A                       \-          A0&A1    D&A3     PCI/CQI0   PCI/CQI1   A0&A1   A2&D    PCI/CQI2   DTX
  34        A                        A                       \-                      \-          A0&A1    D        PCI/CQI0   PCI/CQI1   A0&A1   D       DTX        DTX
  --------- ------------------------ ----------------------- ----------------------- ----------- -------- -------- ---------- ---------- ------- ------- ---------- ----------

In this table cell 0 refers to the serving HS-DSCH cell, cell 1 refers
to the assisting serving HS-DSCH cell, cell 2 refers to the 1st
assisting secondary serving HS-DSCH cell and cell 3 refers to the 2nd
assisting secondary serving HS-DSCH cell.

#### 4.7.4.4 Physical Channel mapping for HS-DPCCH when the UE is configured in MIMO mode with four transmit antennas in at least one cell

##### 4.7.4.4.1 Physical Channel mapping for HS-DPCCH HARQ-ACK

If the HS-DPCCH slot format 0 as defined in \[2\], is used, the HS-DPCCH
physical channel mapping function shall map the input bits w~k~ directly
to physical channel so that bits are transmitted over the air in
ascending order with respect to k.

If the HS-DPCCH slot format 1 as defined in \[2\], is used, the HS-DPCCH
physical channel mapping function shall map the input bits w~k~ to the
physical channel so that bits are transmitted over the air in ascending
order with respect to k as follows:

\- If Secondary\_Cell\_Enabled is equal to 3 and Secondary\_Cell\_Active
is equal to 3

\- The following HARQ-ACK messages are transmitted on HS-DPCCH:

\- HARQ-ACK comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order

\- The following HARQ-ACK messages are transmitted on HS-DPCCH~2~ :

\- HARQ-ACK comprising the HARQ acknowledgement messages for the pair of
the 2^nd^ secondary serving HS-DSCH cell and the 3^rd^ secondary serving
HS-DSCH cell in that order

\- If Secondary\_Cell\_Enabled is equal to 2 and Secondary\_Cell\_Active
is equal to 2

\- The following HARQ-ACK messages are transmitted on HS-DPCCH:

\- HARQ-ACK comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order

\- The following HARQ-ACK messages are transmitted on HS-DPCCH~2~ :

\- HARQ-ACK comprising the HARQ acknowledgement message for the 2^nd^
secondary serving HS-DSCH cell

\- If Secondary\_Cell\_Enabled is equal to 1 and Secondary\_Cell\_Active
is equal to 1

\- The following two HARQ-ACK messages are transmitted on HS-DPCCH

\- HARQ-ACK comprising the HARQ acknowledgement messages for the pair of
serving HS-DSCH cell and 1^st^ secondary serving HS-DSCH cell in that
order

\- If Secondary\_Cell\_Enabled is equal to 3 and Secondary\_Cell\_Active
is less than Secondary\_Cell\_Enabled:

\- If none of the 2^nd^ or 3^rd^ secondary serving HS-DSCH cell is
activated HS-DPCCH~2~ is not transmitted

\- If only one of the 2^nd^ or 3^rd^ secondary serving HS-DSCH cell is
activated the HARQ-ACK is repeated according to the Figure 20E

\- If the 1^st^ secondary serving HS-DSCH cell is not activated the
HARQ-ACK is repeated according to the Figure 20E

\- Otherwise the transmissions of the HARQ-ACK messages are the same as
if Secondary\_Cell\_Active was equal to Secondary\_Cell\_Enabled.

\- If Secondary\_Cell\_Enabled is equal to 2 and Secondary\_Cell\_Active
is less than Secondary\_Cell\_Enabled:

\- If the 2^nd^ secondary serving HS-DSCH cell is not activated the
HARQ-ACK transmissions on HS-DPCCH~2~ are DTXed

\- If the 1^st^ secondary serving HS-DSCH cell is not activated the
HARQ-ACK is repeated according to the Figure 20E

\- Otherwise the transmissions of the HARQ-ACK messages are the same as
if Secondary\_Cell\_Active was equal to Secondary\_Cell\_Enabled.

\- If Secondary\_Cell\_Enabled is equal to 1 and Secondary\_Cell\_Active
is 0 then the transmission of the HARQ-ACK message is repeated according
to Figure 20E.

##### 4.7.4.4.2 Physical Channel mapping for HS-DPCCH NTBP/PCI/CQI

If the HS-DPCCH slot format 0 as defined in \[2\] is used, the HS-DPCCH
physical channel mapping function shall map the input bits b~k~ directly
to physical channel so that bits are transmitted over the air in
ascending order with respect to k.

If the HS-DPCCH slot format 1 as defined in \[2\] is used, the HS-DPCCH
physical channel mapping function shall map the input bits b~k~ directly
to physical channel so that bits are transmitted over the air in
ascending order with respect to k.

\- If Secondary\_Cell\_Enabled is equal to 3 and Secondary\_Cell\_Active
is equal to 3

\- The following is transmitted on HS-DPCCH:

\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or
NTBP/PCI/CQI1) and the 1st secondary serving HS-DSCH cell (CQI2 or
PCI/CQI2 or NTBP/PCI/CQI2) are mapped to a separate subframe as
specified in \[4\].

\- If the serving cell is configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is not configured in MIMO
mode with four transmit antennas, the CQI2 or PCI/CQI2 of the 1^st^
secondary serving cell is repeated.

\- If the serving cell is not configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is configured in MIMO mode
with four transmit antennas, the CQI1 or PCI/CQI1 of the serving cell is
repeated.

\- If both the serving cell and 1^st^ secondary serving cell are not
configured in MIMO mode with four transmit antennas the CQI1 or PCI/CQI1
and CQI2 or PCI/CQI2 are mapped to a separate subframe as specified in
\[4\].

\- The following is transmitted on HS-DPCCH~2~:

\- The report for the 2^nd^ secondary HS-DSCH cell (CQI3 or PCI/CQI3 or
NTBP/PCI/CQI3) and the 3^rd^ secondary HS-DSCH cell (CQI4 or PCI/CQI4 or
NTBP/PCI/CQI4) are mapped to a separate subframe as specified in \[4\].

\- If the 2^nd^ serving cell is configured in MIMO mode with four
transmit antennas and the 3^rd^ secondary serving cell is not configured
in MIMO mode with four transmit antennas, the CQI4 or PCI/CQI4 of the
3^rd^ secondary serving cell is repeated.

\- If the 2^nd^ serving cell is not configured in MIMO mode with four
transmit antennas and the 3^rd^ secondary serving cell is configured in
MIMO mode with four transmit antennas, the CQI3 or PCI/CQI3 of the 2^nd^
serving cell is repeated.

\- If both the 2^nd^ serving cell and 3^rd^ secondary serving cell are
not configured in MIMO mode with four transmit antennas the CQI3 or
PCI/CQI3 and CQI4 or PCI/CQI4 are mapped to a separate subframe as
specified in \[4\].

\- If Secondary\_Cell\_Enabled is equal to 2 and Secondary\_Cell\_Active
is equal to 2

\- The following is transmitted on HS-DPCCH:

\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or
NTBP/PCI/CQI1) and the 1st secondary serving HS-DSCH cell (CQI2 or
PCI/CQI2 or NTBP/PCI/CQI2) are mapped to a separate subframe as
specified in \[4\].

\- If the serving cell is configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is not configured in MIMO
mode with four transmit antennas, the CQI2 or PCI/CQI2 of the 1^st^
secondary serving cell is repeated.

\- If the serving cell is not configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is configured in MIMO mode
with four transmit antennas, the CQI1 or PCI/CQI1 of the serving cell is
repeated.

\- If both the serving cell and 1^st^ secondary serving cell are not
configured in MIMO mode with four transmit antennas the CQI1 or PCI/CQI1
and CQI2 or PCI/CQI2 are mapped to a separate subframe as specified in
\[4\].

\- The following is transmitted on HS-DPCCH~2~:

\- If the 2^nd^ serving cell is configured in MIMO mode with four
transmit antennas the HS-DPCCH~2~ physical channel mapping function
shall map NTBP/ PCI/CQI3 to the physical channel.

\- If the 2^nd^ serving cell is not configured in MIMO mode with four
transmit antennas the HS-DPCCH~2~ physical channel mapping function
shall map CQI3 or PCI/CQI3 to the physical channel.

\- If Secondary\_Cell\_Enabled is equal to 1 and Secondary\_Cell\_Active
is equal to 1

\- The following is transmitted on HS-DPCCH:

\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or
NTBP/PCI/CQI1) and the 1st secondary serving HS-DSCH cell (CQI2 or
PCI/CQI2 or NTBP/PCI/CQI2) are mapped to a separate subframe as
specified in \[4\].

\- If the serving cell is configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is not configured in MIMO
mode with four transmit antennas, the CQI2 or PCI/CQI2 of the 1^st^
secondary serving cell is repeated.

\- If the serving cell is not configured in MIMO mode with four transmit
antennas and the 1^st^ secondary serving cell is configured in MIMO mode
with four transmit antennas, the CQI1 or PCI/CQI1 of the serving cell is
repeated.

\- If Secondary\_Cell\_Enabled is equal to 1 and Secondary\_Cell\_Active
is less than Secondary\_Cell\_Enabled:

\- The following is transmitted on HS-DPCCH:

\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or
NTBP/PCI/CQI1) and the 1st secondary serving HS-DSCH cell (CQI2 or
PCI/CQI2 or NTBP/PCI/CQI2) are mapped to a separate subframe as
specified in \[4\]. The slots corresponding to the (CQI2 or PCI/CQI2 or
NTBP/PCI/CQI2) are DTXed.

\- If Secondary\_Cell\_Enabled is equal to 2 and Secondary\_Cell\_Active
is less than Secondary\_Cell\_Enabled:

\- If the 2^nd^ serving cell is not activated HS-DPCCH~2~ is not
transmitted.

\- The following is transmitted on HS-DPCCH:

\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or
NTBP/PCI/CQI1) and the 1st secondary serving HS-DSCH cell (CQI2 or
PCI/CQI2 or NTBP/PCI/CQI2) are mapped to a separate subframe as
specified in \[4\]. The slots corresponding to the (CQI2 or PCI/CQI2 or
NTBP/PCI/CQI2) are DTXed.

\- The following is transmitted on HS-DPCCH~2~:

\- If the 2^nd^ serving cell is configured in MIMO mode with four
transmit antennas the HS-DPCCH~2~ physical channel mapping function
shall map NTBP/ PCI/CQI3 to the physical channel

\- If the 2^nd^ serving cell is not configured in MIMO mode with four
transmit antennas the HS-DPCCH~2~ physical channel mapping function
shall map CQI3 or PCI/CQI3 to the physical channel.

\- If Secondary\_Cell\_Enabled is equal to 3 and Secondary\_Cell\_Active
is less than Secondary\_Cell\_Enabled:

\- If none of the 2^nd^ or 3^rd^ secondary serving HS-DSCH cell is
activated HS-DPCCH~2~ is not transmitted and the rules in case
Secondary\_Cell\_Enabled is equal to 1 and Secondary\_Cell\_Active is
equal to 1 are followed for HS-DPCCH

\- The following is transmitted on HS-DPCCH:

\- The report for the serving HS-DSCH cell (CQI1 or PCI/CQI1 or
NTBP/PCI/CQI1) and the 1st secondary serving HS-DSCH cell (CQI2 or
PCI/CQI2 or NTBP/PCI/CQI2) are mapped to a separate subframe as
specified in \[4\]. The slots corresponding to the (CQI2 or PCI/CQI2 or
NTBP/PCI/CQI2) are DTXed.

\- The following is transmitted on HS-DPCCH~2~:

\- If the 3^rd^ secondary serving HS-DSCH cell is not activated, the
report for the 2^nd^ secondary HS-DSCH cell (CQI3 or PCI/CQI3 or
NTBP/PCI/CQI3) and the 3^rd^ secondary serving HS-DSCH cell (CQI4 or
PCI/CQI4 or NTBP/PCI/CQI4) are mapped to a separate subframe as
specified in \[4\]. The slots corresponding to the (CQI4 or PCI/CQI4 or
NTBP/PCI/CQI4) are DTXed.

\- If the 2^rd^ secondary serving HS-DSCH cell is not activated, the
report for the 3^rd^ secondary HS-DSCH cell (CQI4 or PCI/CQI4 or
NTBP/PCI/CQI4) and the 2^nd^ secondary serving HS-DSCH cell (CQI3 or
PCI/CQI3 or NTBP/PCI/CQI3) are mapped to a separate subframe as
specified in \[4\]. The slots corresponding to the (CQI3 or PCI/CQI3 or
NTBP/PCI/CQI3) are DTXed.

\- If Secondary\_Cell\_Enabled is equal to 0

\- The following is transmitted on HS-DPCCH:

\- The physical channel mapping function shall map NTBP/ PCI/CQI1 to the
physical channel.

4.8 Coding for E‑DCH
--------------------

Figure 21 shows the processing structure for the E‑DCH transport channel
mapped onto a separate CCTrCH.

If UL\_MIMO\_Enabled is not set to TRUE, or UL\_MIMO\_Enabled is set to
TRUE and UL\_CLTD\_Active is not 1, data arrives to the coding unit in
form of a maximum of one transport block once every transmission time
interval (TTI).

If UL\_MIMO\_Enabled is set to TRUE and UL\_CLTD\_Active = 1, data
arrives to the coding unit in form of a maximum of two transport blocks
once every TTI.

> \- If a single transport block arrives to the coding unit in a TTI,
> the transport block is processed as when UL\_MIMO\_Enabled is not set
> to TRUE.
>
> \- If two transport blocks arrive to the coding unit in a TTI, each
> transport block is separately processed as when UL\_MIMO\_Enabled is
> not set to TRUE, with the exception of the rank-dependent
> determinations of SF, modulation, number of E-DPDCHs and S-E-DPDCHs,
> and the physical channel mapping.

The following coding steps can be identified:

\- Add CRC to the transport block

\- Code block segmentation

\- Channel coding

\- Physical layer hybrid ARQ and rate matching

\- Physical channel segmentation

\- Interleaving

\- Physical channel mapping

The coding steps for E-DCH transport channel are shown in the figure
below.

Figure 21: Transport channel processing for E-DCH

In the following the number of transport blocks per TTI and the number
of transport channels is always one i.e. *m*=1 and *i*=1. When
referencing non E-DCH formulae which are used in correspondence with
E-DCH formulae the convention is used that transport block subscripts
may be omitted (e.g. *X~1~* may be written *X*).

### 4.8.1 CRC attachment for E-DCH

CRC attachment for the E-DCH transport channel shall be performed
according to the general method described in 4.2.1 above with the
following specific parameters.

The CRC length shall always be *L~1~*=24 bits.

### 4.8.2 Code block segmentation for E-DCH

Code block segmentation for the E-DCH transport channel shall be
performed according to the general method described in 4.2.2.2 with the
following specific parameters.

There is a maximum of one transport block. The bits
$b_{\text{im}1},b_{\text{im}2},b_{\text{im}3},\text{.}\text{.}\text{.},b_{\text{imB}_{i}}$
input to the block are mapped to the bits
$x_{i1},x_{i2},x_{i3},\text{.}\text{.}\text{.},x_{\text{iX}_{i}}$
directly. It follows that *X~i~* = *B~i~*. Note that the bits *x*
referenced here refer only to the internals of the code block
segmentation function. The output bits from the code block segmentation
function are *o~ir1~*, *o~ir2~*, *o~ir3~*, ..., *o~irK~*.

The value of *Z* = 5114 for turbo coding shall be used.

### 4.8.3 Channel coding for E-DCH

Channel coding for the E-DCH transport channel shall be performed
according to the general method described in clause 4.2.3 above with the
following specific parameters.

There is a maximum of one transport block, *i*=1. The rate 1/3 turbo
coding shall be used.

### 4.8.4 Physical layer HARQ functionality and rate matching for E-DCH

The hybrid ARQ functionality matches the number of bits at the output of
the channel coder to the total number of bits of the E-DPDCH or
S-E-DPDCH set to which the E-DCH transport channel is mapped. The hybrid
ARQ functionality is controlled by the redundancy version (RV)
parameters.

Figure 22: E‑DCH hybrid ARQ functionality

#### 4.8.4.1 Determination of SF, modulation scheme and number of E-DPDCH PhCHs needed

The maximum amount of puncturing that can be applied is

\- 1-*PL~non-max~* if the modulation scheme or the number of code
channels is less than the maximum allowed by the UE capability and
restrictions imposed by UTRAN.

\- 1-*PL~mod~\_~switch~* if the modulation scheme is BPSK, the number of
E-DPDCH code channels equals to 4 and the usage of 4PAM is allowed by
the UE capability and restrictions imposed by UTRAN.

\- 1-*PL~mod~\_~switch\_2~* if the modulation scheme is 4PAM, the number
of E-DPDCH code channels equals to 4 and the usage of 8PAM is allowed by
the UE capability and restrictions imposed by UTRAN.

\- 1-*PL~max~* if the modulation scheme and the number of code channels
equals to the maximum allowed by the UE capability and restrictions
imposed by UTRAN.

The number of available bits per TTI of one E-DPDCH for all possible
spreading factors and modulation schemes is denoted by *N~256~, N~128~,
N~64~, N~32~, N~16~, N~8~, N~4~, N~2~,* *M~4~, M~2~, L~4~* and
*L~2\ ~*where the index refers to the spreading factor. *N refers to
BPSK modulation, M to 4PAM modulation and L to 8PAM modulation.*

The possible number of bits available to the CCTrCH of E-DCH type on all
E-DPDCHs, *N~e,data~*, then are {*N~256~, N~128~, N*~64~, *N*~32~,
*N*~16~, *N*~8~, *N*~4~, *2*×*N*~4~, 2×*N*~2~, 2×*N*~2~+2×*N*~4~,
2×*M*~2~+2×*M*~4~, 2×*L*~2~+2×*L*~4~}.

SET0 denotes the set of *N~e,data~* values allowed by the UTRAN and
supported by the UE, as part of the UE's capability. SET0 can be a
subset of {*N~256~, N~128~, N*~64~, *N*~32~, *N*~16~, *N*~8~, *N*~4~,
*2*×*N*~4~, 2×*N*~2~, 2×*N*~2~+2×*N*~4~, 2×*M*~2~+2×*M*~4~,
2×*L*~2~+2×*L*~4~}.

The total number of bits in a TTI on all E-DPDCHs before rate matching
with transport format j is *N~e,j~*. The total number of bits available
for the E‑DCH transmission per TTI on all E-DPDCHs with transport format
j, *N~e,data,j~*, is determined by executing the following algorithm,
where

*- PL~non-max~* is signalled from higher layers,

*- PL~mod~\_~,switch~* is equal to 0.468,

*- PL~mod~\_~switch\_2~* is equal to 0.4,

*- PL~max~* is equal to 0.44 , except when the *N~e,data~* =
2×*N*~2~+2×*N*~4~, 2×*M*~2~+2×*M*~4~ or 2×*L*~2~+2×*L*~4~ is allowed by
the UTRAN and supported by the UE, in which case *PL~max~* is equal to
0.33:

> If the UE transmits only one transport block:
>
> SET1 = { *N~e,data~* in SET0 such that *N~e,data~* -- *N~e,j~* is non
> negative }
>
> If SET1 is not empty and the smallest element of SET1 requires just
> one E-DPDCH then
>
> *N~e,data,j~* = min SET1
>
> Else
>
> SET2 = { *N~e,data~* in SET0 without 2×*N*~2~+2×*N*~4~,
> 2×*M*~2~+2×*M*~4~ and 2×*L*~2~+2×*L*~4~ such that *N~e,data~* --
> *PL~non-max~* × *N~e,j~* is non negative }
>
> If SET2 is not empty then
>
> Sort SET2 in ascending order
>
> *N~e,data\ ~*= min SET2
>
> While *N~e,data~* is not the max of SET2 and the follower of
> *N~e,data\ ~*requires only one E-DPDCH do
>
> *N~e,data\ ~*= follower of *N~e,data~* in SET2
>
> End while
>
> *N~e,data,j~* = *N~e,data~*
>
> Else
>
> If SET0 includes 2×*N*~2~+2×*N*~4~
>
> *N~e,data~* = 2×*N*~2~+2×*N*~4~
>
> *If N~e,data~ / N~e,j~ \< PL~mod\_switch~* and SET0 includes
> *2×M~2~+2×M~4~*
>
> *N~e,data~ = 2×M~2~+2×M~4~*
>
> *End if*
>
> *If N~e,data~ is equal to 2×M~2~+2×M~4~ and N~e,data~ / N~e,j~ \<
> PL~mod\_switch\_2~* and SET0 includes *2×L~2~+2×L~4~*
>
> *N~e,data~ = 2×L~2~+2×L~4~*
>
> *End if*
>
> *N~e,data,j~* = *N~e,data~* provided that *N~e,data,j~* - *PL~max~* ×
> *N~e,j~* is non negative
>
> Else
>
> *N~e,data,j~* = max SET0 provided that *N~e,data,j~* - *PL~max~* ×
> *N~e,j~* is non negative
>
> *End if*
>
> End if
>
> End if
>
> Else (when UE transmits two transport blocks)
>
> *N~e,data~* = 2×*N*~2~+2×*N*~4~
>
> *If N~e,data~ / N~e,j~ \< PL~mod\_switch\ ~*and SET0 includes
> *2×M~2~+2×M~4~*
>
> *N~e,data~ = 2×M~2~+2×M~4~*
>
> *End if*
>
> *If N~e,data~ is equal to 2×M~2~+2×M~4~, N~e,data~ / N~e,j~ \<
> PL~mod\_switch\_2~* and SET0 includes *2×L~2~+2×L~4~*
>
> *N~e,data~ = 2×L~2~+2×L~4~*
>
> *End if*
>
> *N~e,data,j~* = *N~e,data~* provided that *N~e,data~* - *PL~max~* ×
> *N~e,j~* is non negative
>
> End if

While E‑DCH TTI length is 10 ms, if an initial transmission occurs in a
compressed frame, or a retransmission occurs in a compressed frame, or a
retransmission occurs in a non‑compressed frame for which initial
transmission was compressed, the number of available bits per TTI of one
E‑DPDCH for all possible spreading factors denoted by *N~256~, N~128~,
N~64~, N~32~, N~16~, N~8~, N~4~* and *N~2~* used in the algorithm above
is replaced by *k*×*N~256~, k*×*N~128~, k*×*N~64~, k*×*N~32~, k*×*N~16~,
k*×*N~8~, k*×*N~4~* and *k*×*N~2~.* The parameter *k* is equal to
*n~tx1~*/15 and *n~tx1~* is defined in 4.4.5.1.

#### 4.8.4.1A Determination of SF, modulation scheme and number of S-E-DPDCH PhCHs needed

S-E-DPDCHs are only present when the UE transmits two transport blocks.
When present, the number of S-E-DPDCHs is always 4.

The maximum amount of puncturing that can be applied is

\- 1-*PL~non-max~* if the modulation scheme is less than the maximum
allowed by the UE capability and restrictions imposed by UTRAN.

\- 1-*PL~mod~\_~switch~* if the modulation scheme is BPSK and the usage
of 4PAM is allowed by the UE capability and restrictions imposed by
UTRAN.

\- 1-*PL~mod~\_~switch\_2~* if the modulation scheme is 4PAM and the
usage of 8PAM is allowed by the UE capability and restrictions imposed
by UTRAN.

\- 1-*PL~max~* if the modulation scheme equals to the maximum allowed by
the UE capability and restrictions imposed by UTRAN.

The number of available bits per TTI of one S-E-DPDCH for all possible
spreading factors and modulation schemes is denoted by *N~4~, N~2~,*
*M~4~, M~2~, L~4~* and *L~2~,* where the index refers to the spreading
factor. *N refers to BPSK modulation, M to 4PAM modulation and L to 8PAM
modulation.*

The possible number of bits available to the CCTrCH of E-DCH type on all
S-E-DPDCHs, *N~e,data~*, then are {2×*N*~2~+2×*N*~4~, 2×*M*~2~+2×*M*~4~,
2×*L*~2~+2×*L*~4~}.

SET0 denotes the set of *N~e,data~* values allowed by the UTRAN and
supported by the UE, as part of the UE's capability. SET0 can be a
subset of {2×*N*~2~+2×*N*~4~, 2×*M*~2~+2×*M*~4~, 2×*L*~2~+2×*L*~4~}.

The total number of bits in a TTI on all S-E-DPDCHs before rate matching
with transport format j is *N~e,j~*. The total number of bits available
for the E‑DCH transmission per TTI on all S-E-DPDCHs with transport
format j, *N~e,data,j~*, is determined by executing the following
algorithm, where

*- PL~mod\_switch~* is equal to 0.468,

*- PL~mod\_switch\_2~* is equal to 0.4,

*- PL~max~* is equal to 0.33:

> *N~e,data~* = 2×*N*~2~+2×*N*~4~

*If N~e,data~ / N~e,j~ \< PL~mod\_switch\ ~*and SET0 includes
*2×M~2~+2×M~4~*

> *N~e,data~ = 2×M~2~+2×M~4~*
>
> *End if*

*If N~e,data~ is equal to 2×M~2~+2×M~4~, N~e,data~ / N~e,j~ \<
PL~mod\_switch\_2~* and SET0 includes *2×L~2~+2×L~4~*

> *N~e,data~ = 2×L~2~+2×L~4~*
>
> *End if*
>
> *N~e,data,j~* = *N~e,data~* provided that *N~e,data~* - *PL~max~* ×
> *N~e,j~* is non negative

#### 4.8.4.2 HARQ bit separation

The HARQ bit separation function shall be performed in the same way as
bit separation for turbo encoded TrCHs with puncturing in 4.2.7.4.1
above.

#### 4.8.4.3 HARQ Rate Matching Stage

The hybrid ARQ rate matching for the E-DCH transport channel shall be
done with the general method described in 4.2.7.5 with the following
specific parameters.

The parameters of the rate matching stage depend on the value of the RV
parameters *s* and *r*. The *s* and *r* combinations corresponding to
each RV allowed for the E-DCH are listed in the table below.

Table 15D: RV for E-DCH

  ---------------- ----- -----
  E-DCH RV Index   *s*   *r*
  0                1     0
  1                0     0
  2                1     1
  3                0     1
  ---------------- ----- -----

The parameter *e~plus~*, *e~minus~* and *e~ini~* are calculated with the
general method for QPSK as described in 4.5.4.3 above. The following
parameters are used as input:

*N~sys~* = *N~p1~* = *N~p2~* = *N~e,j~*/3

*N~data~* = *N~e,data,j~*

*r~max~* = 2

During uplink compressed frames while E‑DCH TTI length is 10 ms and if
*N~data~*\>*N~e,j~*:

\- If *N~data~* mod 3 = 1, one *δ* bit is added to the *N~t,sys~* bits
as the last systematic bit and another δ bit is added to the *N~t,p1~*
bits as the last *N~t,p1~* bit.

\- If *N~data~* mod 3 = 2, one *δ* bit is added to the *N~t,sys~* bits
as the last systematic bit.

#### 4.8.4.4 HARQ bit collection

The HARQ bit collection shall be performed according to the general
method for bit collection for turbo encoded TrCHs with puncturing as
specified in 4.2.7.4.2 including the removal of the bits with value *δ*.

### 4.8.5 Physical channel segmentation for E‑DCH

When more than one E-DPDCH or S-E-DPDCH is used, physical channel
segmentation distributes the bits among the different physical channels.
The bits input to the physical channel segmentation are denoted by
*s~1~*, *s~2~*, *s~3~*, ...,*s~R~*, where *R* is the number of bits
input to the physical channel segmentation block. The number of PhCHs is
denoted by *P.*

The bits after physical channel segmentation are denoted *u~p,k~* where
*p* is the PhCH number. *U(p)* is the number of physical channel bits in
one E-DCH TTI for the p^th^ E-DPDCH or S-E-DPDCH. The relation between
s*~k~* and *u~p,k~* is given below.

Bits on first PhCH after physical channel segmentation:

$u_{1,k} = s_{k}$ *k* = 1, 2, \..., *U(1)*

Bits on p^th^ PhCH after physical channel segmentation:

> $u_{p,k} = s_{k + \sum_{q = 1}^{p - 1}{U(q)}}$ *k* = 1, 2, \...,
> *U*(p)

### 4.8.6 Interleaving for E‑DCH

The interleaving is done as shown in figure 22A below, separately for
each physical channel. The bits input to the block interleaver are
denoted by $u_{p,1},u_{p,2},u_{p,3},\text{.}\text{.}\text{.},u_{p,U}$,
where *p* is PhCH number and *U*=*U(p)* is the number of bits in one TTI
for one PhCH.

![](media/image282.wmf){width="6.5in" height="2.6347222222222224in"}

Figure 22A: Interleaver structure for E-DCH

The basic interleaver is as the 2^nd^ interleaver described in Clause
4.2.11.

For 4PAM, there are two identical interleavers of the same size R2×30,
where R2 is the minimum integer fulfilling
$\left\lceil \frac{U}{2} \right\rceil \leq R2 \times \text{30}$. The
output bits from the physical channel segmentation are divided one by
one between the interleavers: bit *u~p,k~* goes to the first interleaver
and bit *u~p,k+1~* goes to the second interleaver. Bits are collected
one by one from the interleavers: bit *v~p,k~* is obtained from the
first interleaver and bit *v~p,k+1~* is obtained from the second
interleaver, where k mod 2=1.

For 8PAM, there are three identical interleavers of the same size R2×30,
where R2 is the minimum integer fulfilling
$\left\lceil \frac{U}{3} \right\rceil \leq R2 \times \text{30}$. The
output bits from the physical channel segmentation are divided one by
one between the interleavers: bit *u~p,k~* goes to the first
interleaver, bit *u~p,k+1~* goes to the second interleaver and bit
*u~p,k+2~* goes to the third interleaver. Bits are collected one by one
from the interleavers: bit *v~p,k~* is obtained from the first
interleaver, bit *v~p,k+1~* is obtained from the second interleaver and
bit *v~p,k+2~* is obtained from the third interleaver, where k mod 3=1.

### 4.8.7 Physical channel mapping for E‑DCH

The E-DCH structure is described in \[2\]. The bits input to the
physical channel mapping are denoted ν*~p,1~*, ν*~p,2~*, \...,
ν*~p,U(p)~*. The bits ν*~p,k~* are mapped to the PhCHs such that the
bits for each PhCH are transmitted over the air in ascending order with
respect to *k*.

During compressed frames in the uplink and when E‑DCH TTI is 10 ms:

\- For the initial transmission the bits shall be consecutively mapped
to the non‑idle slots. The UE shall not map any bit to the E‑DPDCH idle
slots specified in 4.4.5.1.

\- In case a retransmission occurs in a compressed frame or a
retransmission occurs in a non‑compressed frame for which initial
transmission was compressed:

\- If *n~tx1~*\>*n~max~*: The bits shall be consecutively mapped to the
*n~max~* available slots. The remaining bits are not transmitted.

\- If *n~tx1~*≤*n~max~*: The bits shall be consecutively mapped to the
*n~tx1~* non‑idle slots, whilst no bits are mapped to the idle slots.

\- The transmission gap position and the parameters *n~tx1~* and
*n~max~* are specified in 4.4.5.2.

4.9 Coding for E‑DPCCH
----------------------

The following information is transmitted by means of the E-DPCCH:

\- Retransmission sequence number (RSN): *x~rsn,1~*, *x~rsn,2~*

\- E-TFCI: *x~tfci,1~*, *x~tfci,2~*, \..., *x~tfci,7~*

*- \"Happy\" bit*: *x~h,1~*

### 4.9.1 Overview

The figure below illustrates the overall coding chain for E-DPCCH.

Figure 23: Coding chain for E‑DPCCH

### 4.9.2 E‑DPCCH information field mapping

#### 4.9.2.1 Information field mapping of E‑TFCI

The E‑TFCI is mapped such that *x~tfci,1~ corresponds to the MSB.*

#### 4.9.2.2 Information field mapping of retransmission sequence number

To indicate the redundancy version (RV) of each HARQ transmission and to
assist the Node B soft buffer management a two bit retransmission
sequence number (RSN) is signalled from the UE to the Node B. The Node B
can avoid soft buffer corruption by flushing the soft buffer associated
to one HARQ process in case more than 3 consecutive E‑DPCCH
transmissions on that HARQ process can not be decoded or the last
received RSN is incompatible with the current one.

The RSN is set by higher layers as described in \[16\]. The RSN is
mapped such that *x~rsn,1~ corresponds to the MSB.*

The applied E-DCH RV index specifying the used RV (*s* and *r*
parameter) depends on the RSN, on *N~sys~* / *N~e,data,j~*, and if RSN=3
also on the TTIN (TTI number). For 10 ms TTI the TTI number is equal to
the CFN, for 2 ms TTI

TTIN = 5\*CFN + subframe number

where the subframe number counts the five TTIs which are within a given
CFN, starting from 0 for the first TTI to 4 for the last TTI. N~ARQ~ is
the number of Hybrid ARQ processes.

Table 16: Relation between RSN value and E-DCH RV Index

  --------------- ------------------------------------ ------------------------------------
  **RSN Value**   *N~sys~* / *N~e,data,j~* **\<1/2**   **1/2 ≤** *N~sys~* / *N~e,data,j~*
                  **E-DCH RV Index**                   **E-DCH RV Index**
  0               0                                    0
  1               2                                    3
  2               0                                    2
  3               \[ TTIN/N~ARQ~ **mod** 2 \] x 2    TTIN/N~ARQ~ **mod** 4
  --------------- ------------------------------------ ------------------------------------

The UE shall use either

\- an RV index as indicated in Table 16 and according to the RSN

\- or, if signalled by higher layers only E-DCH RV index 0 independently
of the RSN.

#### 4.9.2.3 Information field mapping of the \"Happy\" bit

The UE shall set *x~h,1~* as specified in Table 16A.

Table 16A: Mapping of \"Happy\" bit

  --------------- ----------
  \"Happy\" bit   *x~h,1~*
  Happy           1
  Not happy       0
  --------------- ----------

### 4.9.3 Multiplexing of E‑DPCCH information

The E‑TFCI *x~tfci,1~, x~tfci,2~, ..., x~tfci,7~*, the retransmission
sequence number *x~rsn,1~*, *x~rsn,2~* and the *\"happy\" bit x~h,1~*
are multiplexed together. This gives a sequence of bits *x~1~, x~2~,
..., x~10~* where

x~k~ = x~h,1~ k=1

x~k~ = x~rsn,4-k~ k=2,3

x~k~ = x~tfci,11-k~ k=4,5,...,10

### 4.9.4 Channel coding for E‑DPCCH

Channel coding of the E‑DPCCH is done using a sub-code of the second
order Reed-Muller code. Coding is applied to the output *x~1~*, *x~2~*,
\..., *x~10~* from the E-DPCCH multiplexing, resulting in:

$z_{i} = \sum_{n = 0}^{9}{(x_{n + 1} \times M_{i,n}})\text{mod}2$
*i*=*0, 1, \..., 29*

The basis sequences are as described in 4.3.3 for *i*=0, 1, \..., 29.

### 4.9.5 Physical channel mapping for E‑DPCCH

The E-DPCCH is described in \[2\]. The sequence of bits *z~0~*, *z~1~*,
\..., *z~29~* output from the E-DPCCH channel coding is mapped to the
corresponding E-DPCCH sub frame. The bits are mapped so that they are
transmitted over the air in ascending order with respect to *i*. If the
E‑DCH TTI is equal to 10 ms the sequence of bits is transmitted in all
the E‑DPCCH sub frames of the E‑DPCCH radio frame.

For compressed frames in the uplink and the case when E‑DCH TTI length
is 10 ms, the bits mapped to the E‑DPCCH idle slots specified in 4.4.5.3
shall *not be transmitted.*

4.9A Coding for S-E‑DPCCH
-------------------------

The following information related to the transport block transmitted on
the secondary stream is transmitted by means of the S-E-DPCCH:

\- Retransmission sequence number (RSN): *x~rsn,1~*, *x~rsn,2~*

\- E-TFCI: *x~tfci,1~*, *x~tfci,2~*, \..., *x~tfci,7~*

*- Spare*: *x~h,1~*

### 4.9A.1 Overview

Overall coding chain for S-E-DPCCH follows that of the E-DPCCH described
in clause 4.9.1.

### 4.9A.2 S-E‑DPCCH information field mapping

#### 4.9A.2.1 Information field mapping of E‑TFCI

The E‑TFCI mapping for S-E-DPCCH follows that of the E-DPCCH described
in clause 4.9.2.1.

#### 4.9A.2.2 Information field mapping of retransmission sequence number

The RSN mapping for S-E-DPCCH follows that of the E-DPCCH described in
clause 4.9.2.2.

#### 4.9A.2.3 Information field mapping of the Spare bit

This bit is fixed to \'\'0' in this release of the specifications.

### 4.9A.3 Multiplexing of S-E‑DPCCH information

The S-E-DPCCH multiplexing follows that of the E-DPCCH multiplexing
described in clause 4.9.3.

### 4.9A.4 Channel coding for S-E‑DPCCH

Channel coding for S-E-DPCCH follows the channel coding for E-DPCCH
described in clause 4.9.4.

### 4.9A.5 Physical channel mapping for S-E‑DPCCH

Physical channel mapping for S-E-DPCCH follows the physical channel
mapping for E-DPCCH described in clause 4.9.5.

4.10 Coding for E‑AGCH
----------------------

The following information is transmitted by means of the absolute grant
channel (E‑AGCH):

\- Absolute Grant Value: *x~agv,1~, x~agv,2~, ..., x~agv,5~*

> \- Absolute Grant Scope: *x~ags,1~*

### 4.10.1 Overview

Figure 24 below illustrates the overall coding chain for the E‑AGCH.

Figure 24: Coding for E‑AGCH

### 4.10.1A E-AGCH information field mapping

#### 4.10.1A.1 Information field mapping of **the** Absolute Grant Value

The Absolute Grant Value information is specified in Table 16B and Table
16.B.1. The values are mapped such that *x~agv,1~* corresponds to the
MSB of the index.

Based on higher layer signalling, either Table 16B or Table 16.B.1 is
selected.

Table 16B: Mapping of Absolute Grant Value

  ---------------------- -------
  Absolute Grant Value   Index
  (168/15)^2^x6          31
  (150/15)^2^x6          30
  (168/15)^2^x4          29
  (150/15)^2^x4          28
  (134/15)^2^x4          27
  (119/15)^2^x4          26
  (150/15)^2^x2          25
  (95/15)^2^x4           24
  (168/15)^2^            23
  (150/15)^2^            22
  (134/15)^2^            21
  (119/15)^2^            20
  (106/15)^2^            19
  (95/15)^2^             18
  (84/15)^2^             17
  (75/15)^2^             16
  (67/15)^2^             15
  (60/15)^2^             14
  (53/15)^2^             13
  (47/15)^2^             12
  (42/15)^2^             11
  (38/15)^2^             10
  (34/15)^2^             9
  (30/15)^2^             8
  (27/15)^2^             7
  (24/15)^2^             6
  (19/15)^2^             5
  (15/15)^2^             4
  (11/15)^2^             3
  (7/15)^2^              2
  ZERO\_GRANT\*          1
  INACTIVE\*             0
  ---------------------- -------

NOTE \*: These values are specified in \[16\].

Table 16B.1: Alternative Mapping of Absolute Grant Value

  ---------------------- -------
  Absolute Grant Value   Index
  (377/15)^2^x4          31
  (237/15)^2^x6          30
  (168/15)^2^\*6         29
  (150/15)^2^\*6         28
  (168/15)^2^\*4         27
  (150/15)^2^x4          26
  (134/15)^2^x4          25
  (119/15)^2^x4          24
  (150/15)^2^x2          23
  (95/15)^2^x4           22
  (168/15)^2^            21
  (150/15)^2^            20
  (134/15)^2^            19
  (119/15)^2^            18
  (106/15)^2^            17
  (95/15)^2^             16
  (84/15)^2^             15
  (75/15)^2^             14
  (67/15)^2^             13
  (60/15)^2^             12
  (53/15)^2^             11
  (47/15)^2^             10
  (42/15)^2^             9
  (38/15)^2^             8
  (34/15)^2^             7
  (30/15)^2^             6
  (27/15)^2^             5
  (24/15)^2^             4
  (19/15)^2^             3
  (15/15)^2^             2
  ZERO\_GRANT\*          1
  INACTIVE\*             0
  ---------------------- -------

NOTE \*: These values are specified in \[16\].

#### 4.10.1A.2 Information field mapping of the Absolute Grant Scope

The value of *x~ags,1\ ~*is set as specified in Table 16C.

Table 16C: Mapping of Absolute Grant Scope

  ------------------------ ------------
  Absolute Grant Scope     *x~ags,1~*
  \"Per HARQ process\"     1
  \"All HARQ processes\"   0
  ------------------------ ------------

### 4.10.1B Multiplexing of E-AGCH information

The Absolute Grant Value information *x~agv,1~, x~agv,2~, ..., x~agv,5~*
and the Absolute Grant Scope *information* *x~ags,1\ ~*are multiplexed
together. This gives a sequence of bits *x~ag,1~*, *x~ag,2~*, \...,
*x~ag,\ 6\ ~*where

*x~ag,k~ = x~agv,k~ k=1,2,...,5*

*x~ag,k~ = x~ags,7-k~ k=6*

### 4.10.2 CRC attachment for E‑AGCH

The E-RNTI is the E‑DCH Radio Network Identifier defined in \[13\]. It
is mapped such that *x~id,1\ ~*corresponds to the MSB.

From the sequence of bits *x~ag,1~*, *x~ag,2~*, \..., *x~ag,6~* a 16 bit
CRC is calculated according to clause 4.2.1.1. That gives the sequence
of bits *c~1~*, *c~2~*, \..., *c~16~* where

$c_{k} = p_{\text{im}(\text{17} - k)}$ *k=1,2,...,16*

This sequence of bits is then masked with *x~id,1~, x~id,2~, \...,
x~id,16~* and appended to the sequence of bits *x~ag,1~*, *x~ag,2~*,
\..., *x~ag,6~* to form the sequence of bits *y~1~*, *y~2~*, \...,
*y~22~ where*

*y~i~=x~ag,i~ i=1,2, \...,6*

*y~i~=(c~i-6~ + x~id~,~i-6~) mod 2 i= 7, \..., 22*

### 4.10.3 Channel coding for E‑AGCH

Rate 1/3 convolutional coding, as described in Clause 4.2.3.1 is applied
to the sequence of bits *y~1~*, *y~2~*, ..., *y~22~*, resulting in the
sequence of bits *z~1~*, *z~2~*, ..., *z~90~*.

### 4.10.4 Rate matching for E‑AGCH

From the input sequence z~1~, z~2~, ..., z~90~ the bits z~1~, z~2~,
z~5~, z~6~, z~7~, z~11~, z~12~, z~14~, z~15~, z~17~, z~23~, z~24~,
z~31~, z~37~, z~44~, z~47~, z~61~, z~63~, z~64~, z~71~, z~72~, z~75~,
z~77~, z~80~, z~83~, z~84~, z~85~, z~87~, z~88~, z~90~ are punctured to
obtain the output sequence r~1~, r~2~, ..., r~60~.

### 4.10.5 Physical channel mapping for E‑AGCH

The E‑AGCH sub frame is described in \[2\]. The sequence of bits *r~1~*,
*r~2~*, ..., *r~60\ ~* is mapped to the corresponding E‑AGCH sub frame.
The bits *r~k~* are mapped so that they are transmitted over the air in
ascending order with respect to k. If the E‑DCH TTI is equal to 10 ms
the same sequence of bits is transmitted in all the E‑AGCH sub frames of
the E‑AGCH radio frame.

4.10A Coding for E-ROCH
-----------------------

The following information is transmitted by means of the E-DCH rank and
offset channel (E-ROCH):

\- S-ETFC Offset: *x~seo,1~, x~seo,2~, ..., x~seo,5~*

> \- Rank Indication: *x~ri,1~*

### 4.10A.1 Overview

The E-ROCH coding chain uses the same coding chain as the E-AGCH. Figure
24B below illustrates the overall coding chain for the E-ROCH.

Figure 24B: Coding for E-ROCH

### 4.10A.2 E-ROCH information field mapping

#### 4.10A.2.1 Information field mapping of **the S-ETFC Offset**

The S-ETFC Offset information is specified in Table 16D. The values are
mapped such that *x~seo,1~* corresponds to the MSB of the index.

Table 16D: Mapping of S-ETFC Offset value

  ------------------------- -----------
  **S-ETFC Offset Value**   **Index**
  60/30                     31
  55/30                     30
  50/30                     29
  45/30                     28
  40/30                     27
  35/30                     26
  30/30                     25
  28/30                     24
  26/30                     23
  24/30                     22
  22/30                     21
  21/30                     20
  20/30                     19
  19/30                     18
  18/30                     17
  17/30                     16
  16/30                     15
  15/30                     14
  14/30                     13
  13/30                     12
  12/30                     11
  11/30                     10
  10/30                     9
  9/30                      8
  8/30                      7
  7/30                      6
  6/30                      5
  5/30                      4
  4/30                      3
  3/30                      2
  2/30                      1
  1/30                      0
  ------------------------- -----------

#### 4.10A.2.2 Information field mapping of the Rank Indication

The value of *x~ri,1\ ~*is set as specified in Table 16E.

Table 16E: Mapping of Rank Indication

  ------------------------ -----------
  Rank Indication          *x~ri,1~*
  \"Rank 2 allowed\"       1
  \"Rank 2 not allowed\"   0
  ------------------------ -----------

### 4.10A.3 Multiplexing of E-ROCH information

The S-ETFC Offset information *x~seo,1~, x~seo,2~, ..., x~seo,5~* and
the Rank Indication *information* *x~ri,1\ ~*are multiplexed together.
This gives a sequence of bits *x~ro,1~*, *x~ro,2~*, \...,
*x~ro,\ 6\ ~*where

*x~ro,k~ = x~seo,k~ k=1,2,...,5*

*x~ro,6~ = x~ri,1~*

### 4.10A.4 CRC attachment for E-ROCH

The S-E-RNTI is the E‑DCH Radio Network Identifier specific to E-ROCH
defined in \[13\]. It is mapped such that *x~id,1\ ~*corresponds to the
MSB.

From the sequence of bits *x~ro,1~*, *x~ro,2~*, \..., *x~ro,6~* a 16 bit
CRC is calculated according to clause 4.2.1.1. That gives the sequence
of bits *c~1~*, *c~2~*, \..., *c~16~* where

$c_{k} = p_{\text{im}(\text{17} - k)}$ *k=1,2,...,16*

This sequence of bits is then masked with *x~id,1~, x~id,2~, \...,
x~id,16~* and appended to the sequence of bits *x~ro,1~*, *x~ro,2~*,
\..., *x~ro,6~* to form the sequence of bits *y~1~*, *y~2~*, \...,
*y~22~ where*

*y~i~=x~ro,i~ i=1,2, \...,6*

*y~i~=(c~i-6~ + x~id~,~i-6~) mod 2 i= 7, \..., 22*

### 4.10A.5 Channel coding for E-ROCH

Rate 1/3 convolutional coding, as described in Clause 4.2.3.1 is applied
to the sequence of bits *y~1~*, *y~2~*, ..., *y~22~*, resulting in the
sequence of bits *z~1~*, *z~2~*, ..., *z~90~*.

### 4.10A.6 Rate matching for E-ROCH

From the input sequence z~1~, z~2~, ..., z~90~ the bits z~1~, z~2~,
z~5~, z~6~, z~7~, z~11~, z~12~, z~14~, z~15~, z~17~, z~23~, z~24~,
z~31~, z~37~, z~44~, z~47~, z~61~, z~63~, z~64~, z~71~, z~72~, z~75~,
z~77~, z~80~, z~83~, z~84~, z~85~, z~87~, z~88~, z~90~ are punctured to
obtain the output sequence r~1~, r~2~, ..., r~60~.

### 4.10A.7 Physical channel mapping for E-ROCH

The E-ROCH sub frame is described in \[2\]. The sequence of bits *r~1~*,
*r~2~*, ..., *r~60\ ~* is mapped to the corresponding E-ROCH sub frame.
The bits *r~k~* are mapped so that they are transmitted over the air in
ascending order with respect to k.

4.11 Mapping for E‑RGCH Relative Grant
--------------------------------------

### 4.11.1 Overview

The relative grant is transmitted on the E-RGCH as described in \[2\].

### 4.11.2 Relative Grant mapping

The relative grant (RG) command is mapped to the relative grant value as
described in the table below.

Table 17: Mapping of RG value

  --------- ------------------------------ ------------------------------
  Command   RG Value (serving E-DCH RLS)   RG Value (other radio links)
  UP        +1                             not allowed
  HOLD      0                              0
  DOWN      -1                             -1
  --------- ------------------------------ ------------------------------

4.12 Mapping for E-HICH ACK/NACK 
--------------------------------

### 4.12.1 Overview

The ACK/NACK is transmitted on the E‑HICH as described in \[2\].

### 4.12.2 ACK/NACK mapping

The ACK/NACK command is mapped to the HARQ acknowledgement indicator as
described in the table below.

Table 18: Mapping of HARQ Acknowledgement

  --------------------------------------------------- --------------------------------
  Command                                             HARQ acknowledgement indicator
  ACK                                                 +1
  NACK (RLSs not containing the serving E-DCH cell)   0
  NACK (RLS containing the serving E-DCH cell)        -1
  --------------------------------------------------- --------------------------------

######## Annex A (informative): Blind transport format detection

A.1 Blind transport format detection using fixed positions
==========================================================

A.1.1 Blind transport format detection using received power ratio
-----------------------------------------------------------------

For the dual transport format case (the possible data rates are 0 and
full rate, and CRC is only transmitted for full rate), blind transport
format detection using received power ratio can be used.

The transport format detection is then done using average received power
ratio of DPDCH to DPCCH. Define the following:

*- Pc:* Received power per bit of DPCCH calculated from all pilot and
TPC bits per slot over a radio frame;

*- Pd:* Received power per bit of DPDCH calculated from *X* bits per
slot over a radio frame;

*- X:* the number of DPDCH bits per slot when transport format
corresponds to full rate;

*- T:* Threshold of average received power ratio of DPDCH to DPCCH for
transport format detection.

The decision rule can then be formulated as:

If *Pd/Pc \>T* then:

\- full rate transport format detected;

else

\- zero rate transport format detected.

A.1.2 Blind transport format detection using CRC
------------------------------------------------

For the multiple transport format case (the possible data rates are 0,
..., (full rate)/r, ..., full rate, and CRC is transmitted for all
transport formats), blind transport format detection using CRC can be
used.

At the transmitter, the data stream with variable number of bits from
higher layers is block-encoded using a cyclic redundancy check (CRC) and
then convolutionally encoded. CRC parity bits are attached just after
the data stream with variable number of bits as shown in figure A.1.

The receiver knows only the possible transport formats (or the possible
end bit position {n~end~}) by Layer-3 negotiation. The receiver performs
Viterbi-decoding on the soft decision sample sequence. The correct
trellis path of the Viterbi-decoder ends at the zero state at the
correct end bit position.

The blind transport format detection method using CRC traces back the
surviving trellis path ending at the zero state (hypothetical trellis
path) at each possible end bit position to recover the data sequence.
For each recovered data sequence error-detection is performed by
checking the CRC, and if there is no error, the recovered sequence is
declared to be correct.

The following variable is defined:

s(n~end~) = - 10 log ( (a~0~(n~end~) -- a~min~(n~end~) ) /
(a~max~(n~end~)-a~min~(n~end~) ) ) \[dB\] (Eq. 1)

where a~max~(n~end~) and a~min~(n~end~) are the maximum and minimum
path-metric values among all survivors at end bit position n~end~, and
a~0~(n~end~) is the path-metric value at zero state.

In order to reduce the probability of false detection (this happens if
the selected path is wrong but the CRC misses the error detection), a
path selection threshold D is introduced. The threshold D determines
whether the hypothetical trellis path connected to the zero state should
be traced back or not at each end bit position n~end~. If the
hypothetical trellis path connected to the zero state that satisfies:

s(n~end~) ≤ D (Eq. 2)

is found, the path is traced back to recover the frame data, where D is
the path selection threshold and a design parameter.

If more than one end bit positions satisfying Eq. 2 is found, the end
bit position which has minimum value of s(n~end~) is declared to be
correct. If no path satisfying Eq. 2 is found even after all possible
end bit positions have been exhausted, the received frame data is
declared to be in error.

Figure A-2 shows the procedure of blind transport format detection using
CRC.

![](media/image286.wmf){width="5.198611111111111in"
height="1.0215277777777778in"}

Figure A.1: An example of data with variable number of bits.\
Four possible transport formats, and transmitted end bit position nend =
3

![](media/image287.wmf){width="5.634027777777778in"
height="7.147916666666666in"}

Figure A.2: Basic processing flow of blind transport format detection

A.2 Blind transport format detection using pseudo-flexible positions
====================================================================

The blind detection procedure for each TTI begins by assuming a
hypothesis for all values of *RM~i~* of Equation (1) of subclause 4.2.7,
based on a corresponding hypothesis regarding whether certain TrCHs are
delivering a transport block during that TTI. Based on this hypothesis,
the blind detection then proceeds similar to blind transport format
detection with fixed positions. If this hypothesis results in a
successful detection of at least one transport format based on a passing
CRC, the assumed hypothesis is considered to be validated to be correct.
If there is no passing CRC, this process is repeated with another
hypothesis, until all hypotheses are exhausted.

######## Annex B (informative): Compressed mode idle lengths

The tables B.1-B.3 show the resulting idle lengths for different
transmission gap lengths, UL/DL modes and DL frame types when
DPCCH/DPDCH are used in the uplink and DPCH in the downlink. The idle
lengths given are calculated purely from the slot and frame structures
and the UL/DL offset. They do not contain margins for e.g. synthesizer
switching.

B.1 Idle lengths for DL, UL and DL+UL compressed mode for DPCH
==============================================================

Table B.1: Parameters for DL compressed mode

+-----+-----------+-----------+-----------+-----------+-----------+
| TGL | DL Frame\ | Spreading | Idle      | Tra       | Idle      |
|     | Type      | Factor    | length    | nsmission | frame     |
|     |           |           | \[ms\]    | time      |           |
|     |           |           |           |           | Combining |
|     |           |           |           | Reduction |           |
|     |           |           |           | method    |           |
+-----+-----------+-----------+-----------+-----------+-----------+
| 3   | A         | 512 -- 4  | 1.73 --   | Spreading | \(S\)     |
|     |           |           | 1.99      | factor    |           |
|     |           |           |           | division  | \(D\)     |
|     |           |           |           | by 2 or   | =(1,2) or |
|     |           |           |           |           | (2,1)     |
|     |           |           |           | Higher    |           |
|     |           |           |           | layer     |           |
|     |           |           |           | s         |           |
|     |           |           |           | cheduling |           |
+-----+-----------+-----------+-----------+-----------+-----------+
|     | B         |           | 1.60 --   |           |           |
|     |           |           | 1.86      |           |           |
+-----+-----------+-----------+-----------+-----------+-----------+
| 4   | A         |           | 2.40 --   |           | \(S\)     |
|     |           |           | 2.66      |           |           |
|     |           |           |           |           | \(D\)     |
|     |           |           |           |           | =(1,3),   |
|     |           |           |           |           | (2,2) or  |
|     |           |           |           |           | (3,1)     |
+-----+-----------+-----------+-----------+-----------+-----------+
|     | B         |           | 2.27 --   |           |           |
|     |           |           | 2.53      |           |           |
+-----+-----------+-----------+-----------+-----------+-----------+
| 5   | A         |           | 3.07 --   |           | \(S\)     |
|     |           |           | 3.33      |           |           |
|     |           |           |           |           | \(D\) =   |
|     |           |           |           |           | (1,4),    |
|     |           |           |           |           | (2,3),    |
|     |           |           |           |           | (3, 2) or |
|     |           |           |           |           | (4,1)     |
+-----+-----------+-----------+-----------+-----------+-----------+
|     | B         |           | 2.93 --   |           |           |
|     |           |           | 3.19      |           |           |
+-----+-----------+-----------+-----------+-----------+-----------+
| 7   | A         |           | 4.40 --   |           | \(S\)     |
|     |           |           | 4.66      |           |           |
|     |           |           |           |           | (         |
|     |           |           |           |           | D)=(1,6), |
|     |           |           |           |           | (2,5),    |
|     |           |           |           |           | (3,4),    |
|     |           |           |           |           | (4,3),    |
|     |           |           |           |           | (5,2) or  |
|     |           |           |           |           | (6,1)     |
+-----+-----------+-----------+-----------+-----------+-----------+
|     | B         |           | 4.27 --   |           |           |
|     |           |           | 4.53      |           |           |
+-----+-----------+-----------+-----------+-----------+-----------+
| 10  | A         |           | 6.40 --   |           | (         |
|     |           |           | 6.66      |           | D)=(3,7), |
|     |           |           |           |           | (4,6),    |
|     |           |           |           |           | (5,5),    |
|     |           |           |           |           | (6,4) or  |
|     |           |           |           |           | (7,3)     |
+-----+-----------+-----------+-----------+-----------+-----------+
|     | B         |           | 6.27 --   |           |           |
|     |           |           | 6.53      |           |           |
+-----+-----------+-----------+-----------+-----------+-----------+
| 14  | A         |           | 9.07 --   |           | \(D\)     |
|     |           |           | 9.33      |           | =(7,7)    |
+-----+-----------+-----------+-----------+-----------+-----------+
|     | B         |           | 8.93 --   |           |           |
|     |           |           | 9.19      |           |           |
+-----+-----------+-----------+-----------+-----------+-----------+

Table B.2: Parameters for UL compressed mode

+-----+---------------+---------------+---------------+---------------+
| TGL | Spreading     | Idle length   | Transmission  | Idle frame    |
|     | Factor        | \[ms\]        | time          |               |
|     |               |               |               | Combining     |
|     |               |               | Reduction     |               |
|     |               |               | method        |               |
+-----+---------------+---------------+---------------+---------------+
| 3   | 256 -- 4      | 2.00          | Spreading     | \(S\)         |
|     |               |               | factor        |               |
|     |               |               | division by 2 | \(D\) =(1,2)  |
|     |               |               | or            | or (2,1)      |
|     |               |               |               |               |
|     |               |               | Higher layer  |               |
|     |               |               | scheduling    |               |
+-----+---------------+---------------+---------------+---------------+
| 4   |               | 2.67          |               | \(S\)         |
|     |               |               |               |               |
|     |               |               |               | \(D\) =(1,3), |
|     |               |               |               | (2,2) or      |
|     |               |               |               | (3,1)         |
+-----+---------------+---------------+---------------+---------------+
| 5   |               | 3.33          |               | \(S\)         |
|     |               |               |               |               |
|     |               |               |               | \(D\) =       |
|     |               |               |               | (1,4), (2,3), |
|     |               |               |               | (3, 2) or     |
|     |               |               |               | (4,1)         |
+-----+---------------+---------------+---------------+---------------+
| 7   |               | 4.67          |               | \(S\)         |
|     |               |               |               |               |
|     |               |               |               | (D)=(1,6),    |
|     |               |               |               | (2,5), (3,4), |
|     |               |               |               | (4,3), (5,2)  |
|     |               |               |               | or (6,1)      |
+-----+---------------+---------------+---------------+---------------+
| 10  |               | 6.67          |               | (D)=(3,7),    |
|     |               |               |               | (4,6), (5,5), |
|     |               |               |               | (6,4) or      |
|     |               |               |               | (7,3)         |
+-----+---------------+---------------+---------------+---------------+
| 14  |               | 9.33          |               | \(D\) =(7,7)  |
+-----+---------------+---------------+---------------+---------------+

Table B.3: Parameters for combined UL/DL compressed mode

+-----+-----------+-----------+-----------+-----------+-----------+
| TGL | DL Frame\ | Spreading | Idle      | Tra       | Idle      |
|     | Type      | Factor    | length    | nsmission | frame     |
|     |           |           | \[ms\]    | time      |           |
|     |           |           |           |           | Combining |
|     |           |           |           | Reduction |           |
|     |           |           |           | method    |           |
+-----+-----------+-----------+-----------+-----------+-----------+
| 3   | A or B    | DL:\      | 1.47 --   | Spreading | \(S\)     |
|     |           | 512 -- 4  | 1.73      | factor    |           |
|     |           |           |           | division  | \(D\)     |
|     |           | UL:       |           | by 2 or   | =(1,2) or |
|     |           |           |           |           | (2,1)     |
|     |           | 256 -- 4  |           | Higher    |           |
|     |           |           |           | layer     |           |
|     |           |           |           | s         |           |
|     |           |           |           | cheduling |           |
+-----+-----------+-----------+-----------+-----------+-----------+
| 4   |           |           | 2.13 --   |           | \(S\)     |
|     |           |           | 2.39      |           |           |
|     |           |           |           |           | \(D\)     |
|     |           |           |           |           | =(1,3),   |
|     |           |           |           |           | (2,2) or  |
|     |           |           |           |           | (3,1)     |
+-----+-----------+-----------+-----------+-----------+-----------+
| 5   |           |           | 2.80 --   |           | \(S\)     |
|     |           |           | 3.06      |           |           |
|     |           |           |           |           | \(D\) =   |
|     |           |           |           |           | (1,4),    |
|     |           |           |           |           | (2,3),    |
|     |           |           |           |           | (3, 2) or |
|     |           |           |           |           | (4,1)     |
+-----+-----------+-----------+-----------+-----------+-----------+
| 7   |           |           | 4.13 --   |           | \(S\)     |
|     |           |           | 4.39      |           |           |
|     |           |           |           |           | (         |
|     |           |           |           |           | D)=(1,6), |
|     |           |           |           |           | (2,5),    |
|     |           |           |           |           | (3,4),    |
|     |           |           |           |           | (4,3),    |
|     |           |           |           |           | (5,2) or  |
|     |           |           |           |           | (6,1)     |
+-----+-----------+-----------+-----------+-----------+-----------+
| 10  |           |           | 6.13 --   |           | (         |
|     |           |           | 6.39      |           | D)=(3,7), |
|     |           |           |           |           | (4,6),    |
|     |           |           |           |           | (5,5),    |
|     |           |           |           |           | (6,4) or  |
|     |           |           |           |           | (7,3)     |
+-----+-----------+-----------+-----------+-----------+-----------+
| 14  |           |           | 8.80 --   |           | \(D\)     |
|     |           |           | 9.06      |           | =(7,7)    |
+-----+-----------+-----------+-----------+-----------+-----------+

(S): Single-frame method as shown in figure 14 (1).

(D): Double-frame method as shown in figure 14 (2). (x,y) indicates x:
the number of idle slots in the first frame, y: the number of idle slots
in the second frame.

NOTE: Compressed mode by spreading factor reduction is not supported
when SF=4 is used in normal mode

######## Annex C (informative): Change history

  ---------------- ------------ -------------- -------- --------- ------------------------------------------------------------------------------------------------------------------------------------------------------ --------- ---------
  Change history                                                                                                                                                                                                                   
  **Date**         **TSG \#**   **TSG Doc.**   **CR**   **Rev**   **Subject/Comment**                                                                                                                                    **Old**   **New**
                   RP\_05       RP-99588       \-                 Approved at TSG RAN \#5 and placed under Change Control                                                                                                \-        3.0.0
  14/01/00         RP\_06       RP-99680       001      3         Correction of rate matching parameters for repetition after 1st unterleaving in 25.212                                                                 3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       004      \-        Changing the initial offset value for convolutional code rate matching                                                                                 3.0.0     3.1.0
  14/01/00         RP\_06       RP-99681       005      1         Introduction of compressed mode by higher layer scheduling                                                                                             3.0.0     3.1.0
  14/01/00         RP\_06       RP-99679       008      \-        Editorial corrections to TS 25.212                                                                                                                     3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       009      \-        Removal of SFN multiplexing                                                                                                                            3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       010      1         Clarification of bit separation and collection                                                                                                         3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       011      2         Connection between TTI and CFN                                                                                                                         3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       012      2         Zero length transport blocks                                                                                                                           3.0.0     3.1.0
  14/01/00         RP\_06       RP-99679       014      \-        Update of channel coding sections                                                                                                                      3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       016      \-        Removal of TrCH restriction in DSCH CCTrCH                                                                                                             3.0.0     3.1.0
  14/01/00         RP\_06       RP-99681       017      \-        20 ms RACH message length                                                                                                                              3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       018      \-        Minimum SF in UL                                                                                                                                       3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       024      \-        Rate matching parameter determination in DL and fixed positions                                                                                        3.0.0     3.1.0
  14/01/00         RP\_06       RP-99680       026      1         Corrections to TS 25.212                                                                                                                               3.0.0     3.1.0
  14/01/00         RP\_06       RP-99679       027      \-        Modification of BTFD description in 25.212 Annex                                                                                                       3.0.0     3.1.0
  14/01/00         RP\_06       RP-99681       028      \-        TFCI coding and mapping including compressed mode                                                                                                      3.0.0     3.1.0
  14/01/00         \-           \-             \-                 Change history was added by the editor                                                                                                                 3.1.0     3.1.1
  31/03/00         RP\_07       RP-000061      025      2         CR for parity bit attachment to 0 bit transport block                                                                                                  3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      029      1         Limitations of blind transport format detection                                                                                                        3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      034      1         Clarification of fixed position rate matching                                                                                                          3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      035      1         Clarification of DL compressed mode                                                                                                                    3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      036      \-        Reconfiguration of TFCS                                                                                                                                3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      037      1         Removal of fixed gap position in 25.212                                                                                                                3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      038      2         Definition clarification for TS 25.212                                                                                                                 3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      039      1         Clarification on TFCI coding input                                                                                                                     3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      041      2         Correction of UL compressed mode by higher layer scheduling                                                                                            3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      042      5         Downlink Compressed Mode by puncturing                                                                                                                 3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      044      \-        Modification of Turbo code internal interleaver                                                                                                        3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      045      \-        Editorial corrections                                                                                                                                  3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      046      \-        SF/2 method: DTX insertion after 2nd interleaver                                                                                                       3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      047      1         TFCI coding for FDD                                                                                                                                    3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      048      \-        Mapping of TFCI in downlink compressed mode                                                                                                            3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      049      \-        Editorial changes to Annex A                                                                                                                           3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      050      \-        Removal of rate matching attribute setting for RACH                                                                                                    3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      052      \-        Padding Function for Turbo coding of small blocks                                                                                                      3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      055      2         Clarifications relating to DSCH                                                                                                                        3.1.1     3.2.0
  31/03/00         RP\_07       RP-000061      056      \-        Editorial modification of uplink shifting parameter calculation for turbo code puncturing                                                              3.1.1     3.2.0
  31/03/00         RP\_07       RP-000062      059      1         Revision: Editorial correction to the calculation of Rate Matching parameters                                                                          3.1.1     3.2.0
  31/03/00         RP\_07       RP-000062      060      1         Editorial changes of channel coding section                                                                                                            3.1.1     3.2.0
  31/03/00         RP\_07       RP-000062      061      \-        Removal of DL compressed mode by higher layer scheduling with fixed positions                                                                          3.1.1     3.2.0
  26/06/00         RP\_08       RP-000266      066      1         Clause 4.4.5 and table 9 is moved to informative annex                                                                                                 3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      068      \-        Editorial modifications of 25.212                                                                                                                      3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      069      \-        Removal of BTFD for flexible positions in Release 99                                                                                                   3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      070      1         Editorial modifications                                                                                                                                3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      071      1         Corrections and editorial modifications of 25.212 for 2nd insertion of DTX bits for CM                                                                 3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      072      4         Corrections to 25.212 (Rate Matching, p-bit insertion, PhCH segmentation)                                                                              3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      073      \-        Editorial correction in 25.212 coding/multiplexing                                                                                                     3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      074      2         Bit separation of the Turbo encoded data                                                                                                               3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      076      1         Revision of code block segmentation description                                                                                                        3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      077      \-        Clarifications for TFCI coding                                                                                                                         3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      078      2         Clarifying the rate matching parameter setting for the RACH and BCH                                                                                    3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      080      \-        Clarification on BTFD utilisation (single CCTrCH)                                                                                                      3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      081      \-        Correction of order of checking TFC during flexible position RM parameter determination                                                                3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      082      \-        Editorial corrections in channel coding section                                                                                                        3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      083      \-        Correction for bit separation and bit collection                                                                                                       3.2.0     3.3.0
  26/06/00         RP\_08       RP-000266      084      1         Correction on the spreading factor selection for the RACH                                                                                              3.2.0     3.3.0
  23/09/00         RP\_09       RP-000341      079      \-        Clarification of compressed mode terminology                                                                                                           3.3.0     3.4.0
  23/09/00         RP\_09       RP-000341      085      1         Editorial corrections in Turbo code internal interleaver section                                                                                       3.3.0     3.4.0
  23/09/00         RP\_09       RP-000341      086      1         Clarification on DL slot format for compressed mode by SF/2                                                                                            3.3.0     3.4.0
  23/09/00         RP\_09       RP-000341      087      \-        Corrections                                                                                                                                            3.3.0     3.4.0
  23/09/00         RP\_09       RP-000341      088      1         Clarifications to TS 25.212                                                                                                                            3.3.0     3.4.0
  23/09/00         RP\_09       RP-000341      089      \-        Correction regarding DSCH                                                                                                                              3.3.0     3.4.0
  23/09/00         RP\_09       RP-000341      090      \-        Correction regarding CPCH                                                                                                                              3.3.0     3.4.0
  23/09/00         RP\_09       RP-000341      092      1         Bit separation and collection for rate matching                                                                                                        3.3.0     3.4.0
  23/09/00         RP\_09       RP-000341      093      \-        Puncturing Limit definition in WG1 specification                                                                                                       3.3.0     3.4.0
  15/12/00         RP\_10       RP-000538      094      2         Correction of BTFD limitations                                                                                                                         3.4.0     3.5.0
  15/12/00         RP\_10       RP-000538      096      \-        Compressed mode by puncturing                                                                                                                          3.4.0     3.5.0
  15/12/00         RP\_10       RP-000538      097      \-        Clarification on the Ci formula                                                                                                                        3.4.0     3.5.0
  15/12/00         RP\_10       RP-000538      099      \-        Editorial modification in RM section                                                                                                                   3.4.0     3.5.0
  15/12/00         RP\_10       RP-000538      100      1         Editorial corrections in TS 25.212                                                                                                                     3.4.0     3.5.0
  15/12/00         RP\_10       RP-000538      101      \-        Correction to code block segmentation                                                                                                                  3.4.0     3.5.0
  16/03/01         RP\_11       \-             \-       \-        Approved as Release 4 specification (v4.0.0) at TSG RAN \#11                                                                                           3.5.0     4.0.0
  15/06/01         RP\_12       RP-010332      106      \-        Correction of compressed mode by puncturing                                                                                                            4.0.0     4.1.0
  15/06/01         RP\_12       RP-010332      108      1         Dual transport format detection                                                                                                                        4.0.0     4.1.0
  15/06/01         RP\_12       RP-010332      112      1         Correction for downlink rate matching for the DSCH                                                                                                     4.0.0     4.1.0
  21/09/01         RP\_13       RP-010519      115      \-        Correction of PDSCH spreading factor signalling                                                                                                        4.1.0     4.2.0
  14/12/01         RP\_14       RP-010737      118      \-        Clarification of compressed mode                                                                                                                       4.2.0     4.3.0
  14/12/01         RP\_14       RP-010737      122      \-        Support of multiple CCTrChs of dedicated type                                                                                                          4.2.0     4.3.0
  08/03/02         RP\_15       RP-020231      128      2         Removal of channel coding option "no coding" for FDD                                                                                                   4.3.0     4.4.0
  08/03/02         RP\_15       RP-020054      123      4         Inclusion of flexible hard split mode TFCI operation                                                                                                   4.3.0     5.0.0
  08/03/02         RP\_15       RP-020058      126      1         Changes to 25.212 for HSDPA work item                                                                                                                  4.3.0     5.0.0
  07/06/02         RP\_16       RP-020308      136      \-        Downlink bit mapping                                                                                                                                   5.0.0     5.1.0
  07/06/02         RP\_16       RP-020316      130      5         Correction of Errata noted by RAN1 delegates                                                                                                           5.0.0     5.1.0
  07/06/02         RP\_16       RP-020316      131      2         Removal of inconsistencies and ambiguities in the HARQ description                                                                                     5.0.0     5.1.0
  07/06/02         RP\_16       RP-020316      132      \-        Rate Matching and Channel Coding for HS-SCCH                                                                                                           5.0.0     5.1.0
  07/06/02         RP\_16       RP-020316      137      \-        Basis sequences for HS-DPCCH Channel Quality information code                                                                                          5.0.0     5.1.0
  07/06/02         RP\_16       RP-020316      145      5         UE specific masking for HS-SCCH part1                                                                                                                  5.0.0     5.1.0
  14/09/02         RP\_17       RP-020582      141      1         Bit scrambling for HS-DSCH                                                                                                                             5.1.0     5.2.0
  15/09/02         RP\_17       RP-020582      148                Physical channel mapping for HS-DPCCH                                                                                                                  5.1.0     5.2.0
  15/09/02         RP\_17       RP-020582      149                HARQ bit collection                                                                                                                                    5.1.0     5.2.0
  15/09/02         RP\_17       RP-020582      150      1         Coding for HS-SCCH                                                                                                                                     5.1.0     5.2.0
  15/09/02         RP\_17       RP-020582      151                Correction to UE specific masking for HS-SCCH part1                                                                                                    5.1.0     5.2.0
  15/09/02         RP\_17       RP-020568      155      2         Clarification of the definition of layer 1 transport channel numbers                                                                                   5.1.0     5.2.0
  15/09/02         RP\_17       RP-020573      157                Numbering Corrections                                                                                                                                  5.1.0     5.2.0
  15/09/02         RP\_17       RP-020645      158      1         Specification of H-RNTI to UE identity mapping                                                                                                         5.1.0     5.2.0
  20/12/02         RP\_18       RP-020846      163      \-        Correction of CQI index to bit mapping                                                                                                                 5.2.0     5.3.0
  20/12/02         RP\_18       RP-020846      164      \-        Correction of mapping of HARQ-ACK                                                                                                                      5.2.0     5.3.0
  26/03/03         RP\_19       RP-030134      165      1         Correction of CQI index to bit mapping                                                                                                                 5.3.0     5.4.0
  26/03/03         RP\_19       RP-030134      166      3         Correction of bit scrambling of HS-DSCH                                                                                                                5.3.0     5.4.0
  26/03/03         RP\_19       RP-030134                         Correction of subscript for modulation scheme information                                                                                              5.3.0     5.4.0
  23/06/03         RP\_20       RP-030272      172      1         Clarification of TPC and Pilot transmission with STTD in compressed mode                                                                               5.4.0     5.5.0
  23/06/03         RP\_20       RP-030272      173      2         Correction on the flexible TFCI coding in the DSCH hard split mode for Rel5                                                                            5.4.0     5.5.0
  21/09/03         RP\_21       RP-030456      178      4         Clarification on Single Transport Format Detection                                                                                                     5.5.0     5.6.0
  21/09/03         RP\_21       RP-030456      179      \-        Correction on table number in first interleave description                                                                                             5.5.0     5.6.0
  21/09/03         RP\_21       RP-030456      180      3         Broadening the conditions that require UEs to perform BTFD for the case of HS-DSCH reception                                                           5.5.0     5.6.0
  06/01/04         RP\_22       RP-030647      183      \-        Clarification of the CRC attachment procedure for HS-SCCH                                                                                              5.6.0     5.7.0
  06/01/04         RP\_22       RP-030647      184      1         Correction of UE identity notation                                                                                                                     5.6.0     5.7.0
  06/01/04         RP\_22       RP-030644      185      \-        HARQ process identifier mapping                                                                                                                        5.6.0     5.7.0
  06/01/04         RP\_22       RP-030712      186                Alignment of terminology across 3GPP documentation                                                                                                     5.6.0     5.7.0
  13/01/04         RP\_22       \-             \-       \-        Created for M.1457 update                                                                                                                              5.7.0     6.0.0
  23/03/04         RP\_23       RP-040085      187      1         CCTrCH definition extension to HS-DSCH                                                                                                                 6.0.0     6.1.0
  09/06/04         RP\_24       RP-040230      191      1         Clarification of Channelization Code-Set Mapping                                                                                                       6.1.0     6.2.0
  13/12/04         RP\_26       RP-040446      192      2         Introduction of MBMS Soft Combining                                                                                                                    6.2.0     6.3.0
  13/12/04         RP\_26       RP-040527      195      \-        Preamble and Postamble to reduce HS-DPCCH transmit power                                                                                               6.2.0     6.3.0
  13/12/04         RP\_26       RP-040449      196      2         Introduction of E-DCH                                                                                                                                  6.2.0     6.3.0
  14/03/05         RP\_27       RP-050088      193      1         Introduction of F-DPCH                                                                                                                                 6.3.0     6.4.0
  14/03/05         RP\_27       RP-050044      198      1         PLnon-max and PLmax                                                                                                                                    6.3.0     6.4.0
  14/03/05         RP\_27       RP-050045      199      \-        HARQ bit collection for E-DCH                                                                                                                          6.3.0     6.4.0
  16/06/05         RP\_28       RP-050241      203      \-        Correction of HSDPA Bit Separation                                                                                                                     6.4.0     6.5.0
  16/06/05         RP\_28       RP-050252      204      2         E-DCH Corrections                                                                                                                                      6.4.0     6.5.0
  16/06/05         RP\_28       RP-050252      205      1         Compressed mode operation for the Enhanced Uplink                                                                                                      6.4.0     6.5.0
  16/06/05         RP\_28       RP-050357      206      1         E-HICH and E-RGCH serving/non-serving definition clarification                                                                                         6.4.0     6.5.0
  16/06/05         RP\_28       RP-050250      208      1         Feature Clean Up: Removal of "CPCH"                                                                                                                    6.4.0     6.5.0
  16/06/05         RP\_28       RP-050248      210      \-        Feature Clean Up: Removal of DSCH (FDD mode)                                                                                                           6.4.0     6.5.0
  16/06/05         RP\_28       RP-050243      212      1         Feature Clean-Up: Removal of 80 ms TTI for DCH for all other cases but when the UE supports SF512                                                      6.4.0     6.5.0
  16/06/05         RP\_28       RP-050252      215      \-        Clarification on E-AGCH bit mapping                                                                                                                    6.4.0     6.5.0
  16/06/05         RP\_28       RP-050252      216      \-        Determination of SF and number of PhCHs considering SF2                                                                                                6.4.0     6.5.0
  16/06/05         RP\_28       RP-050251      217      1         MBMS related corrections                                                                                                                               6.4.0     6.5.0
  16/06/05         RP\_28       RP-050249      218      1         Feature clean up: Removal of the \'compressed mode by puncturing\'                                                                                     6.4.0     6.5.0
  16/06/05         RP\_28       RP-050252      219      \-        Re-ordering of the E-DPCCH bit mapping                                                                                                                 6.4.0     6.5.0
  16/06/05         RP\_28       RP-050252      220      \-        Coding for E‑AGCH                                                                                                                                      6.4.0     6.5.0
  26/09/05         RP\_29       RP-050450      0222     \-        SF max for E-DPDCH                                                                                                                                     6.5.0     6.6.0
  26/09/05         RP\_29       RP-050450      0223     1         Compressed mode operation for the Enhanced Uplink                                                                                                      6.5.0     6.6.0
  26/09/05         RP\_29       RP-050450      0225     1         Absolute grant values                                                                                                                                  6.5.0     6.6.0
  26/09/05         RP\_29       RP-050450      0227     \-        Removal of description on RSN setting                                                                                                                  6.5.0     6.6.0
  12/12/05         RP\_30       RP-050727      0228     \-        PLmax alignment over all UE categories                                                                                                                 6.6.0     6.7.0
  12/12/05         RP\_30       RP-050727      0229     \-        Correction of SF when a CCTrCH is mapped onto four E-DPDCHs                                                                                            6.6.0     6.7.0
  12/12/05         RP\_30       RP-050727      0231     1         Usage of 2xSF4 with puncturing                                                                                                                         6.6.0     6.7.0
  20/03/06         RP\_31       \-             \-       \-        Creation of Release 7 specification (v.7.0.0) at RAN\#31                                                                                               6.7.0     7.0.0
  12/06/06         RP\_32       RP-060370      0236     \-        Clarification of E-TFCI terminology                                                                                                                    7.0.0     7.1.0
  29/09/06         RP\_33       RP-060490      0240     \-        Correction to the E-DCH HARQ rate matching for compressed mode                                                                                         7.1.0     7.2.0
  11/12/06         RP\_34       RP-060727      0244     1         Clarification on the number of physical channels, transmission gap positioning and physical channel mapping for E-DCH in relation to compressed mode   7.2.0     7.3.0
  07/03/07         RP\_35       RP-070115      0238     5         Support of CPC feature                                                                                                                                 7.3.0     7.4.0
  07/03/07         RP\_35       RP-070114      0241     4         Coding of HS-SCCH to support FDD MIMO                                                                                                                  7.3.0     7.4.0
  07/03/07         RP\_35       RP-070114      0242     7         Coding of HS-DPCCH to support operation of FDD MIMO                                                                                                    7.3.0     7.4.0
  07/03/07         RP\_35       RP-070116      0245     4         Introduction of 64QAM for HSDPA                                                                                                                        7.3.0     7.4.0
  30/05/07         RP\_36       RP-070387      0249     \-        MIMO HS-SCCH rate matching                                                                                                                             7.4.0     7.5.0
  30/05/07         RP\_36       RP-070387      0248     1         Correction to coding of HS-SCCH to support FDD MIMO                                                                                                    7.4.0     7.5.0
  30/05/07         RP\_36       RP-070387      0251     1         HS-SCCH orders in MIMO mode                                                                                                                            7.4.0     7.5.0
  30/05/07         RP\_36       RP-070388      0246     5         Introduction of 16QAM for HSUPA                                                                                                                        7.4.0     7.5.0
  30/05/07         RP\_36       RP-070384      0247     1         Support for DL only SFN operation for MBMS FDD                                                                                                         7.4.0     7.5.0
  11/09/07         RP\_37       RP-070644      0252     \-        16QAM modulation selection for HSUPA                                                                                                                   7.5.0     7.6.0
  11/09/07         RP\_37       RP-070642      0253     \-        Clarifications of MIMO                                                                                                                                 7.5.0     7.6.0
  11/09/07         RP\_37       RP-070641      0254     \-        Clarifications of CPC and MIMO                                                                                                                         7.5.0     7.6.0
  27/11/07         RP\_38       RP-070941      0257     \-        Correction of decimal to binary mapping in case of type B CQI                                                                                          7.6.0     7.7.0
  27/11/07         RP\_38       RP-070941      0259     \-        Correction of number of TBs in a TTI in case of MIMO                                                                                                   7.6.0     7.7.0
  28/11/07         RP\_38       RP-070950      0256     \-        HS-SCCH information field mapping for 64QAM MIMO                                                                                                       7.7.0     8.0.0
  05/04/08         RP\_39       RP-080146      0261     \-        Correction to RV-coding in case of simultaneous usage of 64QAM and MIMO                                                                                8.0.0     8.1.0
  28/05/08         RP\_40       RP-080440      0262     1         HS-SCCH orders for HS-SCCH-less operation                                                                                                              8.1.0     8.2.0
  28/05/08         RP\_40       RP-080349      0264     2         Clarification to number of HS-PDSCH codes in HS-SCCH less operations                                                                                   8.1.0     8.2.0
  09/09/08         RP\_41       RP-080673      270      2         Introduction of HS-PDSCH Serving Cell Change Enhancements                                                                                              8.2.0     8.3.0
  09/09/08         RP\_41       RP-080665      272      \-        Correction to the table name and the quoted name                                                                                                       8.2.0     8.3.0
  03/12/08         RP\_42       RP-080989      267      5         Introduction of Dual-Cell HSDPA Operation on Adjacent Carriers                                                                                         8.3.0     8.4.0
  03/12/08         RP\_42       RP-080988      270      3         Introduction of HS-PDSCH Serving Cell Change Enhancements                                                                                              8.3.0     8.4.0
  03/03/09         RP\_43       RP-090228      274      1         Correction to the puncturing limit allowed when UL 4PAM modulation is allowed                                                                          8.4.0     8.5.0
  15/09/09         RP\_45       RP-090885      278      1         Reservation of HS-SCCH order combination not used by CPC                                                                                               8.5.0     8.6.0
  15/09/09         RP\_45       RP-090889      280      1         Alignment with RAN2 decisions on HS-SCCH orders for activation and deactivation of DTX and DRX operation                                               8.5.0     8.6.0
  18/09/09         RP\_45       RP-090975      276      4         Introduction of TxAA extension for non-MIMO UEs                                                                                                        8.6.0     9.0.0
  18/09/09         RP\_45       RP-090974      282      1         Combination of DC-HSDPA with MIMO                                                                                                                      8.6.0     9.0.0
  01/12/09         RP\_46       RP-091170      281      2         Introduction of DC-HSUPA                                                                                                                               9.0.0     9.1.0
  01/12/09         RP\_46       RP-091171      283      3         MIMO configuration per downlink frequency in DC-MIMO operation                                                                                         9.0.0     9.1.0
  16/03/10         RP\_47       RP-100206      286      1         Clarification of MIMO configuration per downlink frequency in DC-MIMO operation                                                                        9.1.0     9.2.0
  14/09/10         RP\_49       RP-100897      287      1         Clarification of uplink frequencies                                                                                                                    9.2.0     9.3.0
  16/09/10         RP\_49       RP-100902      288      3         Release 10 created with the introduction of 4C-HSDPA                                                                                                   9.3.0     10.0.0
  07/12/10         RP\_50       RP-101318      290      3         Clarification of 4C-HSDPA                                                                                                                              10.0.0    10.1.0
  07/12/10         RP\_50       RP-101318      295      \-        4C-HSDPA summary of CQI reporting configurations                                                                                                       10.0.0    10.1.0
  05/12/11         RP\_54       RP-111671      296      8         Introduction of 8C-HSDPA                                                                                                                               10.1.0    11.0.0
  05/12/11         RP\_54       RP-111672      297      1         Introduction of Uplink Closed Loop Transmit Diversity for HSPA                                                                                         10.1.0    11.0.0
  28/02/12         RP\_55       RP-120280      301      \-        Clarification to Target cell HS-SCCH order type                                                                                                        11.0.0    11.1.0
  28/02/12         RP\_55       RP-120284      303      \-        Correction to 4C-HSDPA CQI report mapping scenarios table                                                                                              11.0.0    11.1.0
  28/02/12         RP\_55       RP-120287      304      1         Introduction of 8C-HSDPA CQI report mapping scenarios table                                                                                            11.0.0    11.1.0
  28/02/12         RP\_55       RP-120288      305      \-        Corrections to Uplink Closed Loop Transmit Diversity                                                                                                   11.0.0    11.1.0
  13/06/12         RP\_56       RP-120740      307      1         Addition of missing 8C-HSDPA CQI reporting case indices                                                                                                11.1.0    11.2.0
  13/06/12         RP\_56       RP-120741      306      \-        Clarification of CLTD Features                                                                                                                         11.1.0    11.2.0
  04/09/12         RP\_57       RP-121271      308      2         Introduction of Multiflow                                                                                                                              11.2.0    11.3.0
  04/09/12         RP\_57       RP-121267      310      1         Correction of the number of CQI information bits for MC-HSDPA                                                                                          11.2.0    11.3.0
  04/09/12         RP\_57       RP-121268      311      \-        Correction of HS-SCCH order information                                                                                                                11.2.0    11.3.0
  04/09/12         RP\_57       RP-121270      314      \-        Introduction of Further Enhancements to CELL\_FACH                                                                                                     11.2.0    11.3.0
  04/12/12         RP\_58       RP-121845      312      5         Introduction of uplink MIMO and 64QAM                                                                                                                  11.3.0    11.4.0
  04/12/12         RP\_58       RP-121843      313      5         Introduction of 4Tx\_HSDPA in 25.212                                                                                                                   11.3.0    11.4.0
  04/12/12         RP\_58       RP-121840      316      1         Clarification of HS-SCCH order for MC-HSPA                                                                                                             11.3.0    11.4.0
  04/12/12         RP\_58       RP-121844      317      1         Clarifications and corrections to HSDPA Multiflow                                                                                                      11.3.0    11.4.0
  04/12/12         RP\_58       RP-121842      318      1         Clarification of HS-SCCH order information                                                                                                             11.3.0    11.4.0
  11/06/13         RP\_60       RP-130745      319      2         Correction to the HS-SCCH Type 4 Structure                                                                                                             11.4.0    11.5.0
  11/06/13         RP\_60       RP-130748      320      1         Clarification of HS-SCCH orders with the UE is configured in Multiflow and CLTD                                                                        11.4.0    11.5.0
  03/09/13         RP\_61       RP-131245      321      \-        Correction of HS-SCCH type 4 order                                                                                                                     11.5.0    11.6.0
  03/03/14         RP\_63       RP-140285      326      \-        Correction of HS-SCCH type 4 orderCorrection to HS-SCCH special information mapping for HS-SCCH less HSDPA                                             11.6.0    11.7.0
  10/09/14         RP\_65       RP-141483      327      2         Introduction of Further EUL Enhancements                                                                                                               11.7.0    12.0.0
  10/09/14         RP\_65       RP-141482      328      2         Introduction of Enhanced Broadcast of System Information                                                                                               11.7.0    12.0.0
  10/09/14         RP\_65       RP-141480      329      4         Introduction of DCH Enhancements                                                                                                                       11.7.0    12.0.0
  10/09/14         RP\_65       RP-141481      330      1         Introduction of UMTS Heterogeneous Networks enhancements                                                                                               11.7.0    12.0.0
  08/12/14         RP\_66       RP-142101      332      1         Correction of DL FET                                                                                                                                   12.0.0    12.1.0
  08/12/14         RP\_66       RP-142101      333      \-        Correction to TFCI bit mapping index in Rel-12 DCH Enhancements                                                                                        12.0.0    12.1.0
  14/09/15         RP\_69       RP-151469      334      6         Introduction of the Multiflow 3F-4C configuration                                                                                                      12.1.0    13.0.0
  ---------------- ------------ -------------- -------- --------- ------------------------------------------------------------------------------------------------------------------------------------------------------ --------- ---------

  -------------------- ------------- ----------- -------- --------- --------- ---------------------------------------------------------------------------------------------------- -----------------
  **Change history**                                                                                                                                                               
  **Date**             **Meeting**   **TDoc**    **CR**   **Rev**   **Cat**   **Subject/Comment**                                                                                  **New version**
  2016-06              RP-72         RP-161144   0340               F         Clarifications on DCH enhancements feature                                                           13.1.0
  2016-06              RP-72         RP-161283   0338     2         F         Clarification on UL DPCH 10ms Mode                                                                   13.1.0
  2016-12              RP-74         RP-162354   0344     \-        B         Introduction of HS-SCCH Order for HS-SCCH DRx feature in enhanced Cell Fach                          14.0.0
  2016-12              RP-74         RP-162363   0345     1         B         Introduction of multi-carrier enhancements for UMTS                                                  14.0.0
  2017-09              RP-77         RP-171592   0347     \-        B         Introduction of the HS-SCCH orders for the additional triggering mechanism based on HS-SCCH orders   15.0.0
  2020-07              RP-88e        \-          \-       \-        \-        Upgrade to Rel-16 version without technical change                                                   16.0.0
  -------------------- ------------- ----------- -------- --------- --------- ---------------------------------------------------------------------------------------------------- -----------------
