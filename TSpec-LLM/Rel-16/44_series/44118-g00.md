![](media/image1.wmf){width="7.0875in" height="0.9722222222222222in"}

GSM® and the GSM logo are registered and owned by the GSM Association

Contents {#contents .TT}
========

[14](#foreword)

[15](#scope)

[15](#general)

[15](#scope-of-the-technical-specification)

[15](#application-to-the-interface-structures)

[15](#structure-of-layer-3-procedures)

[16](#test-procedures)

[16](#applicability-of-implementations)

[16](#references)

[18](#definitions-symbols-and-abbreviations)

[18](#definitions)

[19](#abbreviations)

[19](#random-values)

[20](#specification-notations)

[20](#rrc-functions-and-services-provided-to-upper-layers)

[20](#rrc-functions)

[21](#rrc-services-provided-to-upper-layers)

[21](#services-expected-from-lower-layers)

[21](#services-required-from-layer-2-and-physical-layers)

[21](#signalling-radio-bearers)

[21](#rrc-protocol-modes-and-states)

[21](#general-1)

[22](#relation-between-iu-mode-and-agb-mode)

[22](#handover-between-iu-and-agb-modes)

[22](#cell-reselection-between-iu-and-agb-mode)

[22](#a-relation-between-geran-iu-mode-rrc-and-utra-rrc)

[22](#a.1-handover-between-geran-iu-mode-and-utran)

[23](#a.2-cell-reselection-between-geran-iu-mode-and-utran)

[23](#rr-modes-of-operation)

[23](#rrc-modes-and-states)

[23](#rrc-idle-mode)

[23](#general-2)

[23](#transition-from-rrc-idle-mode-to-rrc-connected-mode)

[24](#rrc-connected-mode-rrc-cell_shared-state)

[24](#general-3)

[24](#transition-from-rrc-cell_shared-state-to-rrc-idle-mode)

[24](#transition-from-rrc-cell_shared-state-to-rrc-cell_dedicated-state)

[24](#transition-from-rrc-cell_shared-state-to-rrc-gra_pch-state)

[24](#radio-resource-allocation-tasks)

[24](#rrc-connection-mobility-tasks)

[25](#ms-measurements)

[25](#rrc-connected-mode-rrc-cell_dedicated-state)

[25](#general-4)

[25](#transition-from-rrc-cell_dedicated-state-to-rrc-cell_shared-state)

[25](#transition-from-rrc-cell_dedicated-state-to-rrc-idle-mode)

[25](#transition-from-rrc-cell_dedicated-state-to-rrc-gra_pch-state)

[25](#radio-resource-allocation-tasks-1)

[25](#rrc-connection-mobility-tasks-1)

[26](#ms-measurements-1)

[26](#rrc-connected-mode-rrc-gra_pch-state)

[26](#general-5)

[26](#transition-from-rrc-gra_pch-state-to-rrc-cell_shared-state)

[26](#transition-from-rrc-gra_pch-state-to-rrc-cell_dedicated-state)

[26](#radio-resource-allocation-tasks-2)

[26](#rrc-connection-mobility-tasks-2)

[27](#ms-measurements-2)

[27](#transfer-and-update-of-system-information)

[27](#radio-resource-control-procedures)

[27](#general-6)

[27](#change-of-channels-in-case-of-handover)

[27](#change-of-channel-serving-srb1)

[27](#change-of-channel-serving-srb2)

[28](#change-of-channel-serving-srb3)

[28](#change-of-channel-serving-srb4)

[28](#system-information-broadcasting)

[28](#general-7)

[28](#broadcast-of-iu-mode-specific-system-information)

[30](#paging-procedure)

[30](#general-8)

[30](#paging-initiation-in-rrc-idle-mode-rrc-cell_shared-or-rrc-gra_pch-state)

[30](#general-9)

[31](#initiation)

[32](#reception-of-a-paging-indication-service-primitive)

[33](#paging-initiation-in-rrc-cell_dedicated-state)

[33](#general-10)

[33](#initiation-1)

[33](#reception-of-a-dedicated-paging-request-message-by-the-ms)

[33](#abnormal-cases)

[34](#rrc-connection-management-procedures)

[34](#rrc-connection-establishment)

[34](#general-11)

[34](#initiation-2)

[35](#rrc-connection-request-message-contents-to-set)

[35](#reception-of-an-rrc-connection-request-message-by-the-geran)

[35](#cell-re-selection-or-t300-timeout)

[36](#abortion-of-rrc-connection-establishment)

[36](#reception-of-an-rrc-connection-setup-message-by-the-ms)

[37](#cell-re-selection)

[38](#invalid-rrc-connection-setup-message)

[39](#reception-of-an-rrc-connection-reject-message-by-the-ms)

[39](#invalid-rrc-connection-reject-message)

[40](#rrc-connection-release)

[40](#general-12)

[40](#initiation-3)

[40](#reception-of-an-rrc-connection-release-message-by-the-ms)

[41](#invalid-rrc-connection-release-message)

[42](#cell-re-selection-or-radio-link-failure)

[42](#reception-of-an-rrc-connection-release-complete-message-by-geran)

[42](#unsuccessful-transmission-of-the-rrc-connection-release-complete-message-acknowledged-mode-transmission)

[43](#detection-of-loss-of-dedicated-physical-channel-by-geran-in-rrc-cell_dedicated-state)

[43](#failure-to-receive-rrc-connection-release-complete-message-by-geran)

[43](#transmission-of-ms-capability-information)

[43](#general-13)

[43](#initiation-4)

[44](#reception-of-an-ms-capability-information-message-by-the-geran)

[44](#reception-of-the-ms-capability-information-confirm-message-by-the-ms)

[45](#invalid-ms-capability-information-confirm-message)

[45](#t304-timeout)

[46](#ms-capability-enquiry)

[46](#general-14)

[46](#initiation-5)

[46](#reception-of-an-ms-capability-enquiry-message-by-the-ms)

[46](#invalid-ms-capability-enquiry-message)

[47](#rrc-connection-mobility-procedures)

[47](#cell-and-gra-update-procedures)

[48](#general-15)

[49](#initiation-6)

[52](#cell-update-gra-update-message-contents-to-set)

[53](#reception-of-an-cell-updategra-update-message-by-the-geran)

[54](#reception-of-the-cell-update-confirmgra-update-confirm-message-by-the-ms)

[58](#transmission-of-a-response-message-to-geran)

[62](#physical-channel-failure)

[63](#unsupported-configuration-by-the-ms)

[64](#invalid-configuration)

[66](#incompatible-simultaneous-reconfiguration)

[67](#a-security-reconfiguration-during-cell-update-procedure)

[67](#confirmation-error-of-gra-id-list)

[69](#invalid-cell-update-confirmgra-update-confirm-message)

[70](#t302-expiry-or-cell-reselection)

[72](#t314-expiry)

[73](#t315-expiry)

[74](#reception-of-the-geran-mobility-information-confirm-message-by-the-geran)

[74](#inter-rat-cell-reselection-to-geran-iu-mode)

[74](#general-16)

[74](#initiation-7)

[74](#ms-fails-to-complete-an-inter-rat-cell-reselection)

[75](#inter-rat-cell-reselection-from-geran-iu-mode)

[75](#general-17)

[75](#initiation-8)

[75](#successful-cell-reselection)

[75](#ms-fails-to-complete-an-inter-rat-cell-reselection-1)

[75](#gra-update)

[76](#geran-mobility-information)

[76](#general-18)

[76](#initiation-9)

[76](#reception-of-geran-mobility-information-message-by-the-ms)

[79](#reception-of-an-geran-mobility-information-confirm-message-by-the-geran)

[79](#cell-re-selection-1)

[80](#incompatible-simultaneous-security-reconfiguration)

[80](#invalid-geran-mobility-information-message)

[81](#inter-mode-handover-from-geran-iu-mode)

[81](#general-19)

[81](#initiation-10)

[81](#reception-of-a-handover-from-geran-iu-command-message-by-the-ms)

[82](#successful-completion-of-the-inter-mode-handover)

[82](#unsuccesful-completion-of-the-inter-mode-handover-at-the-ms-side)

[82](#invalid-handover-from-geran-iu-command-message)

[83](#reception-of-an-handover-failure-message-by-geran-in-iu-mode)

[83](#unsupported-configuration-in-handover-from-geran-iu-command-message)

[84](#reception-of-handover-from-geran-iu-command-message-by-ms-in-rrc-cell_shared-state)

[84](#procedures-for-system-information-transmission-and-measurement-reporting-in-rrc-cell_dedicated-state)

[84](#general-20)

[85](#measurement-report-and-enhanced-measurement-report)

[85](#parameters-for-measurements-and-reporting)

[85](#general-21)

[85](#deriving-the-3g-neighbour-cell-list-from-the-3g-neighbour-cell-description)

[86](#deriving-the-gsm-neighbour-cell-list-from-the-bsics-and-the-bcch-allocation)

[86](#deriving-the-neighbour-cell-list-from-the-gsm-neighbour-cell-list-and-the-3g-neighbour-cell-list)

[86](#real-time-differences)

[86](#report-priority-description)

[87](#the-3g-cell-reselection-list)

[87](#ccn-support-description)

[87](#extended-measurement-report)

[87](#handover-to-utran-procedure)

[87](#general-22)

[88](#initiation-11)

[88](#reception-of-inter-system-to-utran-handover-command-message-by-the-ms)

[88](#successful-completion-of-the-inter-rat-handover)

[88](#unsuccesful-inter-rat-handover-at-the-ms-side)

[89](#reception-of-an-handover-failure-message-by-geran-in-iu-mode-1)

[89](#handover-to-cdma2000-procedure)

[89](#general-23)

[90](#initiation-12)

[90](#reception-of-intersystem-to-cdma2000-handover-command-message-by-the-ms)

[90](#successful-completion-of-the-inter-rat-handover-1)

[90](#unsuccesful-inter-rat-handover-at-the-ms-side-1)

[91](#reception-of-an-handover-failure-message-by-geran-in-iu-mode-2)

[91](#mapping-of-user-data-substreams-onto-timeslots-in-a-multislot-configuration)

[92](#application-procedures)

[92](#lcs-transfer)

[92](#general-24)

[92](#intiation-of-lcs-transfer-procedure-in-the-geran)

[92](#reception-of-lcs-downlink-information-message-by-the-ms)

[93](#transmission-of-a-response-message-by-the-ms)

[93](#reception-of-a-response-message-by-the-geran)

[93](#invalid-lcs-downlink-information-message)

[94](#radio-bearer-control-procedures)

[94](#reconfiguration-procedures)

[95](#general-25)

[95](#initiation-13)

[96](#reception-of-radio-bearer-setup-or-radio-bearer-reconfiguration-or-radio-bearer-release-message-by-the-ms)

[102](#transmission-of-a-response-message-by-the-ms-normal-case)

[104](#reception-of-a-response-message-by-the-geran-normal-case)

[105](#unsupported-configuration-in-the-ms)

[106](#physical-channel-failure-1)

[107](#cell-re-selection-2)

[107](#transmission-of-a-response-message-by-the-ms-failure-case)

[107](#reception-of-a-response-message-by-the-geran-failure-case)

[107](#invalid-configuration-1)

[108](#incompatible-simultaneous-reconfiguration-1)

[108](#incompatible-simultaneous-security-reconfiguration-1)

[109](#cell-update-procedure-during-security-reconfiguration)

[109](#invalid-received-message)

[110](#abnormal-cases-1)

[112](#ms-initiated-dtm-procedures-while-in-rrc-cell_dedicated-mac-dedicated-state)

[112](#general-26)

[113](#initiation-of-the-dtm-request-procedure-by-the-ms)

[113](#reception-of-a-geran-iu-mode-dtm-request-message-by-the-geran)

[113](#general-27)

[113](#sbpsch-assignment)

[113](#dtm-request-rejection)

[114](#reception-of-a-geran-iu-mode-dtm-reject-message-by-the-ms-normal-case)

[114](#invalid-geran-iu-mode-dtm-reject-message)

[114](#abnormal-cases-2)

[115](#t3148-expiry)

[115](#signalling-flow-procedures)

[115](#signalling-connection-release-procedure)

[115](#general-28)

[115](#initiation-of-signalling-connection-release-by-the-geran)

[115](#reception-of-signalling-connection-release-by-the-ms)

[116](#invalid-signalling-connection-release-message)

[116](#invalid-configuration-2)

[117](#signalling-connection-release-indication-procedure)

[117](#general-29)

[117](#initiation-14)

[117](#a-rlc-re-establishment-inter-mode-handover-or-inter-rat-change)

[118](#reception-of-signalling-connection-release-indication-by-the-geran)

[118](#security-mode-control)

[118](#security-mode-control-1)

[118](#general-30)

[118](#initiation-15)

[118](#ciphering-configuration-change)

[119](#integrity-protection-configuration-change)

[121](#reception-of-security-mode-command-message-by-the-ms)

[125](#new-ciphering-and-integrity-protection-keys)

[126](#incompatible-simultaneous-security-reconfiguration-2)

[127](#cell-update-procedure-during-security-reconfiguration-1)

[128](#invalid-configuration-3)

[128](#reception-of-security-mode-complete-message-by-the-geran)

[130](#invalid-security-mode-command-message)

[131](#delivery-of-non-access-stratum-messages)

[131](#initial-direct-transfer)

[131](#general-31)

[131](#initiation-of-initial-direct-transfer-procedure-in-the-ms)

[132](#rlc-re-establishment-inter-mode-handover-or-inter-rat-change)

[132](#abortion-of-signalling-connection-establishment)

[133](#reception-of-initial-direct-transfer-message-by-the-geran)

[133](#downlink-direct-transfer)

[133](#general-32)

[133](#initiation-of-downlink-direct-transfer-procedure-in-the-geran)

[134](#reception-of-a-downlink-direct-transfer-message-by-the-ms)

[134](#no-signalling-connection-exists)

[134](#invalid-downlink-direct-transfer-message)

[135](#uplink-direct-transfer)

[135](#general-33)

[135](#initiation-of-uplink-direct-transfer-procedure-in-the-ms)

[135](#rlc-re-establishment-inter-mode-handover-or-inter-rat-change-1)

[136](#reception-of-uplink-direct-transfer-message-by-the-geran)

[136](#general-procedures)

[136](#selection-of-initial-ms-identity)

[136](#actions-when-entering-rrc-idle-mode-from-rrc-connected-mode)

[137](#a-actions-when-entering-geran-agb-mode-or-cdma2000-from-geran-iu-mode-rrc--connected-mode)

[138](#maintenance-of-hyper-frame-numbers)

[139](#start-value-calculation)

[139](#integrity-protection)

[139](#general-34)

[140](#integrity-protection-in-downlink)

[141](#integrity-protection-in-uplink)

[142](#calculation-of-message-authentication-code)

[142](#physical-channel-establishment)

[142](#general-35)

[143](#finely-synchronized-cell-case)

[143](#non-synchronized-cell-case)

[144](#pseudo-synchronized-cell-case)

[144](#pre-synchronized-cell-case)

[145](#void)

[145](#link-failure-and-radio-link-failure-criteria-and-actions-upon-link-or-radio-link-failure)

[145](#unsupported-configuration)

[145](#invalid-rlcmac-control-message-notification)

[145](#actions-related-to-radio-bearer-mapping)

[146](#network-response-times-for-dbpsch-allocation)

[146](#generic-actions-on-receipt-and-absence-of-an-information-element)

[146](#cn-information-info)

[146](#signalling-connection-release-indication)

[147](#geran-mobility-information-elements)

[147](#gra-identity)

[148](#mapping-info)

[148](#ms-information-elements)

[148](#activation-time)

[148](#drx-parameters)

[148](#cn-domain-specific-drx-cycle-length-coefficients)

[148](#geran-drx-cycle-length-coefficient)

[149](#paging-group)

[149](#generic-state-transition-rules-depending-on-received-information-elements)

[150](#ciphering-mode-info)

[153](#integrity-protection-mode-info)

[153](#general-36)

[153](#initialization-of-integrity-protectionthe-ms-shall)

[154](#integrity-protection-re-configuration-for-sbss-relocation)

[155](#integrity-protection-modification-in-case-of-new-keys-or-initialisation-of-signalling-connection)

[156](#integrity-check-info)

[156](#new-g-rnti)

[156](#rrc-transaction-identifier)

[159](#capability-update-requirement)

[160](#radio-bearer-information-elements)

[160](#signalling-rb-information-to-setup-list)

[160](#rab-information-for-setup)

[161](#rab-information-to-reconfigure)

[161](#rb-information-to-setup)

[163](#rb-information-to-be-affected)

[163](#rb-information-to-reconfigure)

[164](#rb-information-to-release)

[164](#rb-with-pdcp-information)

[164](#void-1)

[164](#a-rb-mapping-info)

[165](#rlc-info)

[165](#pdcp-info)

[166](#a-pdcp-context-relocation-info)

[166](#pdcp-sn-info)

[166](#nas-synchronisation-indicator)

[166](#physical-channel-configuration)

[167](#physical-channel-parameters)

[167](#dbpsch-description)

[172](#sbpsch-parameters)

[173](#transport-channel-information-elements)

[173](#transport-format-set)

[174](#transport-format-combination-set)

[175](#void-2)

[175](#added-or-reconfigured-ul-trch-information)

[175](#added-or-reconfigured-dl-trch-information)

[175](#deleted-ul-trch-information)

[175](#deleted-dl-trch-information)

[175](#ul-trch-information-common-for-all-transport-channels)

[175](#dl-trch-information-common-for-all-transport-channels)

[176](#tfcs-reconfigurationaddition-information)

[176](#tfcs-removal-information)

[177](#tfcs-explicit-configuration)

[177](#handling-of-unknown-unforeseen-and-erroneous-protocol-data)

[177](#general-37)

[177](#csn.1-violation-or-encoding-error)

[178](#unknown-or-unforeseen-message-type)

[178](#if-the-ms-receives-an-rrc-message-on-srb2-with-message-type-not-defined-for-that-srb-and-if-the-rrc-message-is-coded-in-asn1-then-ms-shall-follow-the-rules-defined-in-3gpp-ts-25.331-for-the-dl-messages-sent-on-the-dcch.8.4-unsolicited-received-message)

[179](#unexpected-critical-message-extension)

[179](#message-with-error-label-content-part-error)

[180](#unknown-or-unforeseen-information-element-value-mandatory-information-element)

[180](#unexpected-non-critical-message-extension)

[181](#message-with-error-label-message-escape)

[181](#handling-of-errors-in-nested-information-elements)

[182](#unknown-or-unforeseen-information-element-value-optional-information-element-coded-in-asn1)

[182](#message-functional-definitions-and-contents)

[182](#general-38)

[182](#introduction)

[183](#repetitions-of-structure-ie-or-field)

[183](#message-format-and-error-labels)

[183](#general-39)

[184](#message-extension-for-new-protocol-version-in-rrc)

[184](#non-critical-extension)

[185](#critical-extension)

[186](#extension-of-ies)

[186](#message-escape-error-label)

[186](#messages-for-radio-resources-management)

[186](#general-40)

[187](#references-1)

[189](#downlink-rrc-messages)

[190](#uplink-rrc-messages)

[190](#message-definitions)

[197](#pdu-definitions)

[198](#cell-update)

[199](#cell-update-confirm)

[203](#dedicated-paging-request)

[203](#downlink-direct-transfer-1)

[204](#extended-measurement-order)

[204](#extended-measurement-report-1)

[205](#a-enhanced-measurement-report)

[205](#geran-mobility-information-1)

[206](#geran-mobility-information-confirm)

[207](#geran-mobility-information-failure)

[208](#gra-update-1)

[208](#gra-update-confirm)

[209](#void-3)

[209](#handover-complete)

[210](#handover-failure)

[210](#handover-from-geran-iu-command)

[211](#initial-direct-transfer-1)

[212](#inter-system-to-cdma2000-handover-command)

[214](#inter-system-to-utran-handover-command)

[215](#lcs-downlink-information)

[215](#lcs-uplink-information)

[216](#measurement-information)

[216](#measurement-report)

[216](#ms-capability-enquiry-1)

[217](#ms-capability-information)

[218](#ms-capability-information-confirm)

[219](#void-4)

[219](#radio-bearer-reconfiguration)

[222](#radio-bearer-reconfiguration-complete)

[224](#radio-bearer-reconfiguration-failure)

[224](#radio-bearer-release)

[227](#radio-bearer-release-complete)

[229](#radio-bearer-release-failure)

[229](#radio-bearer-setup)

[232](#radio-bearer-setup-complete)

[233](#radio-bearer-setup-failure)

[234](#rrc-connection-reject)

[235](#rrc-connection-release-1)

[236](#rrc-connection-release-complete)

[236](#rrc-connection-request)

[237](#rrc-connection-setup)

[238](#rrc-connection-setup-complete)

[239](#rrc-status)

[239](#rrc-failure-info)

[240](#security-mode-command)

[241](#security-mode-complete)

[241](#security-mode-failure)

[242](#signalling-connection-release)

[242](#signalling-connection-release-indication-1)

[243](#void-5)

[243](#system-information-5)

[243](#system-information-5bis)

[243](#system-information-5ter)

[244](#system-information-6)

[244](#void-6)

[244](#uplink-direct-transfer-1)

[245](#geran-iu-mode-dtm-request)

[245](#geran-iu-mode-dtm-reject)

[246](#information-elements)

[246](#activation-time-1)

[246](#ba-list-pref)

[246](#ba-range)

[247](#capability-update-requirement-1)

[247](#cdma2000-ms-security-capability)

[247](#cell-channel-description)

[248](#cell-description)

[248](#cell-update-cause)

[248](#channel-description)

[249](#channel-description-2)

[249](#channel-mode)

[249](#channel-mode-2)

[250](#ciphering-algorithm)

[250](#ciphering-mode-info-1)

[251](#cn-domain-identity)

[251](#cn-domain-specific-drx-cycle-length-coefficient)

[251](#cn-information-info-1)

[252](#cn-information-info-full)

[253](#dbpsch-description-1)

[257](#dynamic-arfcn-mapping)

[257](#establishment-cause)

[258](#expiration-time-factor)

[258](#extension)

[258](#failure-cause)

[259](#failure-cause-and-error-information)

[259](#frequency-channel-sequence)

[260](#frequency-list)

[260](#frequency-short-list)

[260](#geran-drx-cycle-length-coefficient-1)

[261](#gra-identity-1)

[261](#gra-update-cause)

[261](#g-rnti)

[262](#gsm-ms-security-capability)

[262](#handover-reference)

[262](#initial-ms-identity)

[263](#integrity-check-info-1)

[264](#integrity-protection-activation-info)

[264](#integrity-protection-algorithm)

[265](#integrity-protection-mode-info-1)

[265](#void-7)

[265](#intra-domain-nas-node-selector)

[266](#mobile-allocation)

[266](#mobile-time-difference)

[266](#ms-geran-agb-mode-radio-access-capability)

[267](#ms-geran-iu-mode-radio-access-capability)

[268](#ms-geran-iu-mode-rlc-capability)

[269](#ms-rf-capability-gsm)

[272](#ms-multi-mode-and-multi-rat-capability)

[273](#ms-measurement-capability)

[273](#ms-positioning-capability)

[274](#ms-timers-and-constants-in-rrc-connected-mode)

[275](#multirate-configuration)

[275](#multislot-allocation)

[276](#nas-message)

[276](#nas-synchronization-info)

[276](#nas-system-information-gsm-map)

[277](#paging-cause)

[277](#paging-record-type-identifier)

[278](#pdcp-capability)

[279](#pdcp-info-1)

[282](#pdcp-sn-info-1)

[283](#physical-channel-configuration-1)

[283](#plmn-identity)

[284](#power-command)

[284](#power-command-and-access-type)

[284](#void-8)

[284](#void-9)

[284](#void-10)

[284](#protocol-error-cause)

[285](#protocol-error-indicator)

[285](#protocol-error-information)

[285](#rab-identity)

[286](#rab-info)

[286](#rab-info-post)

[287](#rab-information-for-setup-1)

[287](#rab-information-to-reconfigure-1)

[287](#rb-activation-time-info)

[288](#rb-count-c-information)

[289](#rb-count-c-msb-information)

[289](#rb-identity)

[289](#rb-information-to-be-affected-1)

[290](#rb-information-to-reconfigure-1)

[290](#rb-information-to-release-1)

[291](#rb-information-to-setup-1)

[291](#rb-timer-indicator)

[292](#rb-with-pdcp-information-1)

[292](#void-11)

[292](#re-establishment-timer)

[292](#rejection-cause)

[293](#release-cause)

[293](#rlc-info-1)

[294](#rlc-hfn-ie)

[295](#rplmn-information)

[295](#rrc-cause)

[296](#rrc-packet-downlink-assignment)

[298](#a-rrc-packet-downlink-assignment-2)

[298](#rrc-packet-uplink-assignment)

[301](#a-rrc-packet-uplink-assignment-2)

[303](#rrc-state-indicator)

[303](#rrc-transaction-identifier-1)

[303](#sbpsch-description)

[304](#security-capability)

[305](#signalling-rb-information-to-setup)

[306](#start)

[306](#starting-time)

[306](#synchronization-indication)

[306](#time-difference)

[307](#timing-advance)

[307](#transmission-rlc-discard)

[307](#ue-utran-radio-access-capability)

[308](#a-ue-utran-predefined-configuration-status-information)

[308](#ue-utran-radio-access-capability-extension)

[309](#ue-cdma2000-radio-access-capability)

[309](#utran-freq-list)

[309](#wait-time)

[310](#iu-mode-channel-request-description)

[310](#wait-indication)

[310](#void-12)

[310](#pdcp-context-relocation-info)

[311](#rb-mapping-info)

[312](#interleaving)

[313](#mode)

[313](#modulation)

[313](#added-or-reconfigured-dl-trch-information-1)

[314](#added-or-reconfigured-ul-trch-information-1)

[314](#deleted-dl-trch-information-1)

[315](#deleted-ul-trch-information-1)

[315](#dl-trch-information-common-for-all-transport-channels-1)

[316](#semi-static-transport-format-information)

[316](#tfcs-explicit-configuration-1)

[317](#tfcs-reconfigurationaddition-information-1)

[318](#tfcs-removal-information-1)

[318](#transport-channel-identity)

[318](#tfc)

[318](#transport-format-combination-set-1)

[319](#transport-format-set-1)

[319](#ul-trch-information-common-for-all-transport-channels-1)

[319](#a-information-element-definitions)

[323](#multiplicity-values-and-type-constraint-values)

[324](#a-constant-definitions)

[325](#protocol-timers-counters-other-parameters-and-default-configurations)

[325](#timers-for-ms)

[325](#a-timers-on-the-network-side)

[326](#counters-for-ms)

[326](#ms-constants-and-parameters)

[326](#a-network-constants-and-parameters)

[326](#ms-variables)

[326](#general-41)

[328](#cell_update_started)

[328](#ciphering_status)

[329](#established_signalling_connections)

[329](#establishment_cause)

[330](#established_rabs)

[331](#failure_cause)

[331](#failure_indicator)

[331](#gra_identity)

[332](#g_rnti)

[332](#initial_ms_identity)

[332](#incompatible_security_reconfiguration)

[332](#integrity_protection_activation_info)

[333](#integrity_protection_info)

[334](#invalid_configuration)

[334](#a-latest_configured_cn_domain)

[335](#ms_capability_requested)

[335](#ms_capability_transferred)

[336](#ordered_reconfiguration)

[336](#pdcp_sn_info)

[336](#protocol_error_indicator)

[337](#protocol_error_information)

[337](#protocol_error_reject)

[337](#rb_timer_indicator)

[338](#rb_uplink_ciphering_activation_time_info)

[338](#start_threshold)

[338](#start_value_to_transmit)

[339](#transactions)

[339](#timers_and_constants)

[339](#unsupported_configuration)

[340](#security_modification)

[341](#specific-functions)

[341](#provision-and-reception-of-rrc-information-between-network-nodes)

[341](#general-42)

[341](#general-error-handling-for-rrc-messages-exchanged-between-network-nodes)

[342](#rrc-information-to-target-geran-iu-mode-bss)

[343](#rrc-information-target-bss-to-source-bss)

[343](#rrc-messages-exchanged-between-network-nodes)

[343](#radio-bearer-reconfiguration-1)

[343](#inter-rat-or-mode-handover-info-with-ms-capabilities)

[344](#sbss-relocation-info)

[348](#rfc-3095-context-info)

[349](#provision-and-reception-of-rrc-security-information-between-network-nodes)

[349](#general-43)

[349](#rrc-security-information-from-geran-agb-to-geran-iu)

[350](#rrc-security-information-from-geran-iu-modeutran-to-geran-iu-mode)

[352](#rrc-security-information-from-geran-iu-to-utran)

[352](#hfn-mapping-rules-for-radio-bearer-using-non-transparent-mode-rlc)

[352](#calculated-transport-format-combination)

[353](#signalling-tfc)

[354](#annex-a-informative-change-history)Foreword 1 Scope 1.1 General
1.2 Scope of the Technical Specification 1.3 Application to the
interface structures 1.4 Structure of layer 3 procedures 1.5 Test
procedures 1.6 Applicability of implementations 2 References 3
Definitions, symbols and abbreviations 3.1 Definitions 3.2 Abbreviations
3.3 Random values 3.4 Specification Notations 4 RRC Functions and
Services provided to upper layers 4.1 RRC Functions 4.2 RRC Services
provided to upper layers 5 Services expected from lower layers 5.1
Services required from layer 2 and physical layers 5.2 Signalling Radio
Bearers 6 RRC Protocol modes and states 6.1 General 6.2 Relation between
Iu mode and A/Gb mode 6.2.1 Handover between Iu and A/Gb modes 6.2.2
Cell reselection between Iu and A/Gb mode 6.2a Relation between GERAN Iu
mode RRC and UTRA RRC 6.2a.1 Handover between GERAN Iu mode and UTRAN
6.2a.2 Cell reselection between GERAN Iu mode and UTRAN 6.3 RR modes of
operation 6.4 RRC modes and states 6.4.1 RRC-Idle Mode 6.4.1.1 General
6.4.1.2 Transition from RRC-Idle Mode to RRC-Connected mode 6.4.2
RRC-Connected mode: RRC-Cell\_Shared state 6.4.2.1 General 6.4.2.2
Transition from RRC-Cell\_Shared state to RRC-Idle Mode 6.4.2.3
Transition from RRC-Cell\_Shared state to RRC-Cell\_Dedicated state
6.4.2.4 Transition from RRC-Cell\_Shared state to RRC-GRA\_PCH state
6.4.2.5 Radio resource allocation tasks 6.4.2.6 RRC connection mobility
tasks 6.4.2.7 MS measurements 6.4.3 RRC-Connected mode:
RRC-Cell\_Dedicated state 6.4.3.1 General 6.4.3.2 Transition from
RRC-Cell\_Dedicated state to RRC-Cell\_Shared state 6.4.3.3 Transition
from RRC-Cell\_Dedicated state to RRC-Idle Mode 6.4.3.4 Transition from
RRC-Cell\_Dedicated state to RRC-GRA\_PCH state 6.4.3.5 Radio resource
allocation tasks 6.4.3.6 RRC connection mobility tasks 6.4.3.7 MS
measurements 6.4.4 RRC-Connected mode: RRC-GRA\_PCH state 6.4.4.1
General 6.4.4.2 Transition from RRC-GRA\_PCH state to RRC-Cell\_Shared
state 6.4.4.3 Transition from RRC-GRA\_PCH state to RRC-Cell\_Dedicated
state 6.4.4.4 Radio resource allocation tasks 6.4.4.5 RRC connection
mobility tasks 6.4.4.6 MS measurements 6.4.4.7 Transfer and update of
system information 7 Radio Resource Control procedures 7.1 General 7.2
Change of channels in case of handover 7.2.1 Change of channel serving
SRB1 7.2.2 Change of channel serving SRB2 7.2.3 Change of channel
serving SRB3 7.2.4 Change of channel serving SRB4 7.3 System information
broadcasting 7.3.1 General 7.3.2 Broadcast of Iu mode specific System
Information 7.4 Paging procedure 7.4.1 General 7.4.2 Paging initiation
in RRC-Idle mode, RRC-Cell\_Shared or RRC-GRA\_PCH state 7.4.2.1 General
7.4.2.2 Initiation 7.4.2.3 Reception of a PAGING INDICATION service
primitive 7.4.3 Paging initiation in RRC-Cell\_Dedicated state 7.4.3.1
General 7.4.3.2 Initiation 7.4.3.3 Reception of a DEDICATED PAGING
REQUEST message by the MS 7.4.4 Abnormal cases 7.5 RRC Connection
management procedures 7.5.1 RRC connection establishment 7.5.1.1 General
7.5.1.2 Initiation 7.5.1.3 RRC CONNECTION REQUEST message contents to
set 7.5.1.4 Reception of an RRC CONNECTION REQUEST message by the GERAN
7.5.1.5 Cell re-selection or T300 timeout 7.5.1.6 Abortion of RRC
connection establishment 7.5.1.7 Reception of an RRC CONNECTION SETUP
message by the MS 7.5.1.8 Cell re-selection 7.5.1.9 Invalid RRC
CONNECTION SETUP message 7.5.1.10 Reception of an RRC CONNECTION REJECT
message by the MS 7.5.1.11 Invalid RRC CONNECTION REJECT message 7.5.2
RRC connection release 7.5.2.1 General 7.5.2.2 Initiation 7.5.2.3
Reception of an RRC CONNECTION RELEASE message by the MS 7.5.2.4 Invalid
RRC CONNECTION RELEASE message 7.5.2.5 Cell re-selection or radio link
failure 7.5.2.6 Reception of an RRC CONNECTION RELEASE COMPLETE message
by GERAN 7.5.2.7 Unsuccessful transmission of the RRC CONNECTION RELEASE
COMPLETE message, acknowledged mode transmission 7.5.2.8 Detection of
loss of dedicated physical channel by GERAN in RRC-Cell\_Dedicated state
7.5.2.9 Failure to receive RRC CONNECTION RELEASE COMPLETE message by
GERAN 7.6 Transmission of MS capability information 7.6.1 General 7.6.2
Initiation 7.6.3 Reception of an MS CAPABILITY INFORMATION message by
the GERAN 7.6.4 Reception of the MS CAPABILITY INFORMATION CONFIRM
message by the MS 7.6.5 Invalid MS CAPABILITY INFORMATION CONFIRM
message 7.6.6 T304 timeout 7.7 MS capability enquiry 7.7.1 General 7.7.2
Initiation 7.7.3 Reception of an MS CAPABILITY ENQUIRY message by the MS
7.7.4 Invalid MS CAPABILITY ENQUIRY message 7.8 RRC Connection mobility
procedures 7.8.1 Cell and GRA Update procedures 7.8.1.1 General 7.8.1.2
Initiation 7.8.1.3 CELL UPDATE / GRA UPDATE message contents to set
7.8.1.4 Reception of an CELL UPDATE/GRA UPDATE message by the GERAN
7.8.1.5 Reception of the CELL UPDATE CONFIRM/GRA UPDATE CONFIRM message
by the MS 7.8.1.6 Transmission of a response message to GERAN 7.8.1.7
Physical channel failure 7.8.1.8 Unsupported configuration by the MS
7.8.1.9 Invalid configuration 7.8.1.10 Incompatible simultaneous
reconfiguration 7.8.1.10a Security reconfiguration during Cell update
procedure 7.8.1.11 Confirmation error of GRA ID list 7.8.1.12 Invalid
CELL UPDATE CONFIRM/GRA UPDATE CONFIRM message 7.8.1.13 T302 expiry or
cell reselection 7.8.1.14 T314 expiry 7.8.1.15 T315 expiry 7.8.1.16
Reception of the GERAN MOBILITY INFORMATION CONFIRM message by the GERAN
7.8.1.17 Inter-RAT cell reselection to GERAN *Iu mode* 7.8.1.17.1
General 7.8.1.17.2 Initiation 7.8.1.17.3 MS fails to complete an
inter-RAT cell reselection 7.8.1.18 Inter-RAT cell reselection from
GERAN Iu mode 7.8.1.18.1 General 7.8.1.18.2 Initiation 7.8.1.18.3
Successful cell reselection 7.8.1.18.4 MS fails to complete an inter-RAT
cell reselection 7.8.2 GRA update 7.8.3 GERAN mobility information
7.8.3.1 General 7.8.3.2 Initiation 7.8.3.3 Reception of GERAN MOBILITY
INFORMATION message by the MS 7.8.3.4 Reception of an GERAN MOBILITY
INFORMATION CONFIRM message by the GERAN 7.8.3.5 Cell re-selection
7.8.3.6 Incompatible simultaneous security reconfiguration 7.8.3.7
Invalid GERAN MOBILITY INFORMATION message 7.8.4 Inter-mode handover
from GERAN Iu mode 7.8.4.1 General 7.8.4.2 Initiation 7.8.4.3 Reception
of a HANDOVER FROM GERAN Iu COMMAND message by the MS 7.8.4.4 Successful
completion of the inter-mode handover 7.8.4.5 Unsuccesful completion of
the inter-mode handover at the MS side 7.8.4.6 Invalid HANDOVER FROM
GERAN Iu COMMAND message 7.8.4.7 Reception of an HANDOVER FAILURE
message by GERAN in Iu mode 7.8.4.8 Unsupported configuration in
HANDOVER FROM GERAN Iu COMMAND message 7.8.4.9 Reception of HANDOVER
FROM GERAN Iu COMMAND message by MS in RRC-Cell\_Shared state 7.9
Procedures for System Information transmission and Measurement reporting
in RRC-Cell\_Dedicated state 7.9.1 General 7.9.2 Measurement Report and
Enhanced Measurement Report 7.9.2.2 Parameters for Measurements and
Reporting 7.9.2.2.1 General 7.9.2.2.2 Deriving the 3G Neighbour Cell
list from the 3G Neighbour Cell Description 7.9.2.2.3 Deriving the GSM
Neighbour Cell list from the BSICs and the BCCH Allocation 7.9.2.2.4
Deriving the Neighbour Cell list from the GSM Neighbour Cell list and
the 3G Neighbour Cell list 7.9.2.2.5 Real Time Differences 7.9.2.2.6
Report Priority Description 7.9.2.2.7 The 3G Cell Reselection list
7.9.2.2.8 CCN Support description 7.9.3 Extended measurement report 7.10
Handover to UTRAN procedure 7.10.1 General 7.10.2 Initiation 7.10.3
Reception of INTER SYSTEM TO UTRAN HANDOVER COMMAND message by the MS
7.10.4 Successful completion of the inter-RAT handover 7.10.5
Unsuccesful inter-rat handover at the MS side 7.10.6 Reception of an
HANDOVER FAILURE message by GERAN in Iu mode 7.11 Handover to CDMA2000
procedure 7.11.1 General 7.11.2 Initiation 7.11.3 Reception of
INTERSYSTEM TO CDMA2000 HANDOVER COMMAND message by the MS 7.11.4
Successful completion of the inter-RAT handover 7.11.5 Unsuccesful
inter-rat handover at the MS side 7.11.6 Reception of an HANDOVER
FAILURE message by GERAN in Iu mode 7.12 Mapping of user data substreams
onto timeslots in a multislot configuration 7.13 Application Procedures
7.13.1 LCS transfer 7.13.1.1 General 7.13.1.2 Intiation of LCS transfer
procedure in the GERAN 7.13.1.3 Reception of LCS DOWNLINK INFORMATION
message by the MS 7.13.1.4 Transmission of a response message by the MS
7.13.1.5 Reception of a response message by the GERAN 7.13.1.6 Invalid
LCS DOWNLINK INFORMATION message 7.14 Radio Bearer control procedures
7.14.1 Reconfiguration procedures 7.14.1.1 General 7.14.1.2 Initiation
7.14.1.3 Reception of RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION
or RADIO BEARER RELEASE message by the MS 7.14.1.4 Transmission of a
response message by the MS, normal case 7.14.1.5 Reception of a response
message by the GERAN, normal case 7.14.1.6 Unsupported configuration in
the MS 7.14.1.7 Physical channel failure 7.14.1.8 Cell re-selection
7.14.1.9 Transmission of a response message by the MS, failure case
7.14.1.10 Reception of a response message by the GERAN, failure case
7.14.1.11 Invalid configuration 7.14.1.12 Incompatible simultaneous
reconfiguration 7.14.1.12.1 Incompatible simultaneous security
reconfiguration 7.14.1.12.2 Cell Update procedure during security
reconfiguration 7.14.1.13 Invalid received message 7.14.1.14 Abnormal
cases 7.14.2 MS initiated DTM procedures while in
RRC-Cell\_Dedicated-MAC-Dedicated state 7.14.2.1 General 7.14.2.2
Initiation of the DTM Request procedure by the MS 7.14.2.3 Reception of
a GERAN Iu mode DTM REQUEST message by the GERAN 7.14.2.3.1 General
7.14.2.3.2 SBPSCH assignment 7.14.2.3.3 DTM Request rejection 7.14.2.3.4
Reception of a GERAN Iu mode DTM REJECT message by the MS, normal case
7.14.2.3.5 Invalid GERAN Iu mode DTM REJECT message 7.14.2.4 Abnormal
cases 7.14.2.5 T3148 expiry 7.15 Signalling flow procedures 7.15.1
Signalling connection release procedure 7.15.1.1 General 7.15.1.2
Initiation of SIGNALLING CONNECTION RELEASE by the GERAN 7.15.1.3
Reception of SIGNALLING CONNECTION RELEASE by the MS 7.15.1.4 Invalid
SIGNALLING CONNECTION RELEASE message 7.15.1.5 Invalid configuration
7.15.2 Signalling connection release indication procedure 7.15.2.1
General 7.15.2.2 Initiation 7.15.2.2a RLC re-establishment, inter-mode
handover or inter-RAT change 7.15.2.3 Reception of SIGNALLING CONNECTION
RELEASE INDICATION by the GERAN 7.16 Security mode control 7.16.1
Security mode control 7.16.1.1 General 7.16.1.2 Initiation 7.16.1.2.1
Ciphering configuration change 7.16.1.2.2 Integrity protection
configuration change 7.16.1.2.3 Reception of SECURITY MODE COMMAND
message by the MS 7.16.1.2.3.1 New ciphering and integrity protection
keys 7.16.1.2.4 Incompatible simultaneous security reconfiguration
7.16.1.2.5 Cell Update procedure during security reconfiguration
7.16.1.2.6 Invalid configuration 7.16.1.2.7 Reception of SECURITY MODE
COMPLETE message by the GERAN 7.16.1.2.8 Invalid SECURITY MODE COMMAND
message 7.17 Delivery of Non-Access stratum messages 7.17.1 Initial
Direct transfer 7.17.1.1 General 7.17.1.2 Initiation of Initial direct
transfer procedure in the MS 7.17.1.3 RLC re-establishment, inter-mode
handover or inter-RAT change 7.17.1.4 Abortion of signalling connection
establishment 7.17.1.5 Reception of INITIAL DIRECT TRANSFER message by
the GERAN 7.17.2 Downlink Direct transfer 7.17.2.1 General 7.17.2.2
Initiation of downlink direct transfer procedure in the GERAN 7.17.2.3
Reception of a DOWNLINK DIRECT TRANSFER message by the MS 7.17.2.4 No
signalling connection exists 7.17.2.5 Invalid DOWNLINK DIRECT TRANSFER
message 7.17.3 Uplink Direct transfer 7.17.3.1 General 7.17.3.2
Initiation of uplink direct transfer procedure in the MS 7.17.3.3 RLC
re-establishment, inter-mode handover or inter-RAT change 7.17.3.4
Reception of UPLINK DIRECT TRANSFER message by the GERAN 7.18 General
procedures 7.18.1 Selection of initial MS identity 7.18.2 Actions when
entering RRC-Idle mode from RRC-Connected mode 7.18.2a Actions when
entering GERAN *A/Gb mode* or CDMA2000 from GERAN *Iu mode*, RRC-
Connected mode 7.18.3 Maintenance of Hyper Frame Numbers 7.18.4 START
value calculation 7.18.5 Integrity protection 7.18.5.0 General 7.18.5.1
Integrity protection in downlink 7.18.5.2 Integrity protection in uplink
7.18.5.3 Calculation of message authentication code 7.18.6 Physical
channel establishment 7.18.6.0 General 7.18.6.1 Finely synchronized cell
case 7.18.6.2 Non synchronized cell case 7.18.6.3 Pseudo-synchronized
cell case 7.18.6.4 Pre-synchronized cell case 7.18.7 (void) 7.18.8 Link
failure and Radio link failure criteria and actions upon link or radio
link failure 7.18.9 Unsupported configuration 7.18.10 Invalid RLC/MAC
control message notification 7.18.11 Actions related to Radio Bearer
mapping 7.18.12 Network response times for DBPSCH allocation 7.19
Generic actions on receipt and absence of an information element 7.19.1
CN information info 7.19.2 Signalling connection release indication
7.19.3 GERAN mobility information elements 7.19.3.1 GRA identity
7.19.3.2 Mapping info 7.19.4 MS information elements 7.19.4.1 Activation
time 7.19.4.2 DRX parameters 7.19.4.2.1 CN domain specific DRX cycle
length coefficients 7.19.4.2.2 GERAN DRX cycle length coefficient
7.19.4.2.3 Paging Group 7.19.4.3 Generic state transition rules
depending on received information elements 7.19.4.4 Ciphering mode info
7.19.4.5 Integrity protection mode info 7.19.4.5.1 General 7.19.4.5.2
Initialization of Integrity ProtectionThe MS shall: 7.19.4.5.3 Integrity
Protection Re-configuration for SBSS Relocation 7.19.4.5.4 Integrity
Protection modification in case of new keys or initialisation of
signalling connection 7.19.4.6 Integrity check info 7.19.4.7 New G-RNTI
7.19.4.8 RRC Transaction Identifier 7.19.4.9 Capability Update
Requirement 7.19.5 Radio bearer information elements 7.19.5.1 Signalling
RB information to setup list 7.19.5.2 RAB Information for Setup 7.19.5.3
RAB Information to Reconfigure 7.19.5.4 RB information to setup 7.19.5.5
RB information to be affected 7.19.5.6 RB information to reconfigure
7.19.5.7 RB Information to Release 7.19.5.8 RB with PDCP Information
7.19.5.9 (void) 7.19.5.9a RB Mapping Info 7.19.5.10 RLC Info 7.19.5.11
PDCP Info 7.19.5.11a PDCP context relocation info 7.19.5.12 PDCP SN Info
7.19.5.13 NAS Synchronisation Indicator 7.19.5.14 Physical Channel
Configuration 7.19.6 Physical channel parameters 7.19.6.1 DBPSCH
Description 7.19.6.2 SBPSCH parameters 7.19.7 Transport channel
information elements 7.19.7.1 Transport Format Set 7.19.7.2 Transport
format combination set 7.19.7.3 (void) 7.19.7.4 Added or Reconfigured UL
TrCH information 7.19.7.5 Added or Reconfigured DL TrCH information
7.19.7.6 Deleted UL TrCH information 7.19.7.7 Deleted DL TrCH
information 7.19.7.8 UL TrCH information common for all transport
channels 7.19.7.9 DL TrCH information common for all transport channels
7.19.7.10 TFCS Reconfiguration/Addition Information 7.19.7.11 TFCS
Removal Information 7.19.7.12 TFCS Explicit Configuration 8 Handling of
unknown, unforeseen, and erroneous protocol data 8.1 General 8.2 CSN.1
violation or encoding error 8.3 Unknown or unforeseen message type If
the MS receives an RRC message on SRB2 with message type not defined for
that SRB and if the RRC message is coded in ASN1 then MS shall follow
the rules defined in 3GPP TS 25.331 for the DL messages sent on the
DCCH.8.4 Unsolicited received message 8.5 Unexpected critical message
extension 8.6 Message with error label: \'Content part error\' 8.7
Unknown or unforeseen information element value, mandatory information
element 8.8 Unexpected non-critical message extension 8.9 Message with
error label: \'Message escape\' 8.10 Handling of errors in nested
information elements 8.11 Unknown or unforeseen information element
value, optional information element coded in ASN1 9 Message functional
definitions and contents 9.1 General 9.1.1 Introduction 9.1.2
Repetitions of Structure, IE or field: 9.1.3 Message format and error
labels 9.1.3.1 General 9.1.3.2 Message extension for new protocol
version in RRC 9.1.3.2.1 Non-Critical extension 9.1.3.2.2 Critical
extension 9.1.3.2.3 Extension of IE\'s 9.1.3.2.4 \'Message escape\'
error label 9.2 Messages for Radio Resources management 9.2.1 General
9.2.1.1 References 9.2.1.2 Downlink RRC messages 9.2.1.3 Uplink RRC
messages 9.2.1.3.1 Message definitions 9.2.1.3.1.1 PDU definitions 9.2.2
CELL UPDATE 9.2.3 CELL UPDATE CONFIRM 9.2.4 DEDICATED PAGING REQUEST
9.2.5 DOWNLINK DIRECT TRANSFER 9.2.6 EXTENDED MEASUREMENT ORDER 9.2.7
EXTENDED MEASUREMENT REPORT 9.2.7a ENHANCED MEASUREMENT REPORT 9.2.8
GERAN MOBILITY INFORMATION 9.2.9 GERAN MOBILITY INFORMATION CONFIRM
9.2.10 GERAN MOBILITY INFORMATION FAILURE 9.2.11 **GRA UPDATE** 9.2.12
GRA UPDATE CONFIRM 9.2.13 (void) 9.2.14 HANDOVER COMPLETE 9.2.15
HANDOVER FAILURE 9.2.16 HANDOVER FROM GERAN Iu COMMAND 9.2.17 INITIAL
DIRECT TRANSFER 9.2.18 INTER SYSTEM TO CDMA2000 HANDOVER COMMAND 9.2.19
INTER SYSTEM TO UTRAN HANDOVER COMMAND 9.2.20 LCS DOWNLINK INFORMATION
9.2.21 LCS UPLINK INFORMATION 9.2.22 MEASUREMENT INFORMATION 9.2.23
MEASUREMENT REPORT 9.2.24 MS CAPABILITY ENQUIRY 9.2.25 MS CAPABILITY
INFORMATION 9.2.26 MS CAPABILITY INFORMATION CONFIRM 9.2.27 (void)
9.2.28 RADIO BEARER RECONFIGURATION 9.2.29 RADIO BEARER RECONFIGURATION
COMPLETE 9.2.30 RADIO BEARER RECONFIGURATION FAILURE 9.2.31 RADIO BEARER
RELEASE 9.2.32 RADIO BEARER RELEASE COMPLETE 9.2.33 RADIO BEARER RELEASE
FAILURE 9.2.34 RADIO BEARER SETUP 9.2.35 RADIO BEARER SETUP COMPLETE
9.2.36 RADIO BEARER SETUP FAILURE 9.2.37 RRC CONNECTION REJECT 9.2.38
RRC CONNECTION RELEASE 9.2.39 RRC CONNECTION RELEASE COMPLETE 9.2.40 RRC
CONNECTION REQUEST 9.2.41 RRC CONNECTION SETUP 9.2.42 RRC CONNECTION
SETUP COMPLETE 9.2.43 RRC STATUS 9.2.44 RRC FAILURE INFO 9.2.45 SECURITY
MODE COMMAND 9.2.46 SECURITY MODE COMPLETE 9.2.47 SECURITY MODE FAILURE
9.2.48 SIGNALLING CONNECTION RELEASE 9.2.49 SIGNALLING CONNECTION
RELEASE INDICATION 9.2.50 (void) 9.2.51 SYSTEM INFORMATION 5 9.2.52
SYSTEM INFORMATION 5bis 9.2.53 SYSTEM INFORMATION 5ter 9.2.54 SYSTEM
INFORMATION 6 9.2.55 (void) 9.2.56 UPLINK DIRECT TRANSFER 9.2.57 **GERAN
Iu mode DTM REQUEST** 9.2.58 **GERAN Iu mode DTM REJECT** 9.3
Information Elements 9.3.1 Activation Time 9.3.2 BA List Pref 9.3.3 BA
Range 9.3.4 Capability Update Requirement 9.3.5 CDMA2000 MS security
capability 9.3.6 Cell Channel Description 9.3.7 Cell Description 9.3.8
Cell Update Cause 9.3.9 Channel Description 9.3.10 Channel Description 2
9.3.11 Channel Mode 9.3.12 Channel Mode 2 9.3.13 Ciphering Algorithm
9.3.14 Ciphering Mode Info 9.3.15 CN Domain Identity 9.3.16 CN Domain
Specific DRX Cycle Length Coefficient 9.3.17 CN Information Info 9.3.18
CN Information Info Full 9.3.19 DBPSCH Description 9.3.20 Dynamic ARFCN
Mapping 9.3.21 Establishment Cause 9.3.22 Expiration Time Factor 9.3.23
Extension 9.3.24 Failure Cause 9.3.25 Failure Cause and Error
Information 9.3.26 Frequency Channel Sequence 9.3.27 Frequency List
9.3.28 Frequency Short List 9.3.29 GERAN DRX Cycle Length Coefficient
9.3.30 GRA Identity 9.3.31 GRA Update Cause 9.3.32 G-RNTI 9.3.33 GSM MS
Security Capability 9.3.34 Handover Reference 9.3.35 Initial MS Identity
9.3.36 Integrity Check Info 9.3.37 Integrity Protection Activation Info
9.3.38 Integrity Protection Algorithm 9.3.39 Integrity Protection Mode
Info 9.3.40 (void) 9.3.41 Intra Domain NAS Node Selector 9.3.42 Mobile
Allocation 9.3.43 Mobile Time Difference 9.3.44 MS GERAN A/Gb mode Radio
Access Capability 9.3.45 MS GERAN Iu mode Radio Access Capability 9.3.46
MS GERAN Iu mode RLC Capability 9.3.47 MS RF Capability GSM 9.3.48 MS
Multi-Mode and Multi-RAT Capability 9.3.49 MS Measurement Capability
9.3.50 MS Positioning Capability 9.3.51 MS Timers and Constants in
RRC-Connected mode 9.3.52 MultiRate Configuration 9.3.53 Multislot
Allocation 9.3.54 NAS Message 9.3.55 NAS Synchronization Info 9.3.56 NAS
System Information GSM-MAP 9.3.57 Paging Cause 9.3.58 Paging Record Type
Identifier 9.3.59 PDCP Capability 9.3.60 PDCP Info 9.3.61 PDCP SN Info
9.3.62 Physical Channel Configuration 9.3.63 PLMN Identity 9.3.64 Power
Command 9.3.65 Power Command and Access Type 9.3.66 (void) 9.3.67 (void)
9.3.68 (void) 9.3.69 Protocol Error Cause 9.3.70 Protocol Error
Indicator 9.3.71 Protocol Error Information 9.3.72 RAB Identity 9.3.73
RAB Info 9.3.74 RAB Info Post 9.3.75 RAB Information for Setup 9.3.76
RAB Information to Reconfigure 9.3.77 RB Activation Time Info 9.3.78 RB
COUNT-C Information 9.3.79 RB COUNT-C MSB Information 9.3.80 RB Identity
9.3.81 RB Information to Be Affected 9.3.82 RB Information to
Reconfigure 9.3.83 RB Information to Release 9.3.84 RB Information to
Setup 9.3.85 RB Timer Indicator 9.3.86 RB with PDCP Information 9.3.87
(void) 9.3.88 Re-Establishment timer 9.3.89 Rejection Cause 9.3.90
Release Cause 9.3.91 RLC Info 9.3.92 RLC HFN IE 9.3.93 RPLMN Information
9.3.94 RRC Cause 9.3.95 RRC Packet Downlink Assignment 9.3.95a RRC
Packet Downlink Assignment 2 9.3.96 RRC Packet Uplink Assignment 9.3.96a
RRC Packet Uplink Assignment 2 9.3.97 RRC State Indicator 9.3.98 RRC
Transaction Identifier 9.3.99 SBPSCH Description 9.3.100 Security
Capability 9.3.101 Signalling RB Information To Setup 9.3.102 START
9.3.103 Starting Time 9.3.104 Synchronization Indication 9.3.105 Time
Difference 9.3.106 Timing Advance 9.3.107 Transmission RLC Discard
9.3.108 UE UTRAN Radio Access Capability 9.3.108a **UE UTRAN Predefined
Configuration Status Information** 9.3.109 UE UTRAN Radio Access
Capability Extension 9.3.110 UE CDMA2000 Radio Access Capability 9.3.111
UTRAN Freq List 9.3.112 Wait Time 9.3.113 Iu mode Channel Request
Description 9.3.114 Wait Indication 9.3.115 (void) 9.3.116 PDCP Context
Relocation Info 9.3.117 RB mapping info 9.3.118 Interleaving 9.3.119
Mode 9.3.120 Modulation 9.3.121 Added or Reconfigured DL TrCH
information 9.3.122 Added or Reconfigured UL TrCH information 9.3.123
Deleted DL TrCH information 9.3.124 Deleted UL TrCH information 9.3.125
DL TrCH Information Common For All Transport Channels 9.3.126
Semi-static Transport Format Information 9.3.127 TFCS Explicit
Configuration 9.3.128 TFCS Reconfiguration/Addition Information 9.3.129
TFCS Removal Information 9.3.130 Transport Channel Identity 9.3.131 TFC
9.3.132 Transport Format Combination Set 9.3.133 Transport Format Set
9.3.134 UL TrCH Information Common For All Transport Channels 9.3a
Information element definitions 9.4 Multiplicity values and type
constraint values 9.4a Constant definitions 10 Protocol timers,
counters, other parameters and default configurations 10.1 Timers for MS
10.1a Timers on the network side 10.2 Counters for MS 10.3 MS constants
and parameters 10.3a Network constants and parameters 10.4 MS variables
10.4.0 General 10.4.1 CELL\_UPDATE\_STARTED 10.4.2 CIPHERING\_STATUS
10.4.3 ESTABLISHED\_SIGNALLING\_CONNECTIONS 10.4.4 ESTABLISHMENT\_CAUSE
10.4.5 ESTABLISHED\_RABS 10.4.6 FAILURE\_CAUSE 10.4.7 FAILURE\_INDICATOR
10.4.8 GRA\_IDENTITY 10.4.9 G\_RNTI 10.4.10 INITIAL\_MS\_IDENTITY
10.4.11 INCOMPATIBLE\_SECURITY\_RECONFIGURATION 10.4.12
INTEGRITY\_PROTECTION\_ACTIVATION\_INFO 10.4.13
INTEGRITY\_PROTECTION\_INFO 10.4.14 INVALID\_CONFIGURATION 10.4.14a
LATEST\_CONFIGURED\_CN\_DOMAIN 10.4.15 MS\_CAPABILITY\_REQUESTED 10.4.16
MS\_CAPABILITY\_TRANSFERRED 10.4.17 ORDERED\_RECONFIGURATION 10.4.18
PDCP\_SN\_INFO 10.4.19 PROTOCOL\_ERROR\_INDICATOR 10.4.20
PROTOCOL\_ERROR\_INFORMATION 10.4.21 PROTOCOL\_ERROR\_REJECT 10.4.22
RB\_TIMER\_INDICATOR 10.4.23
RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO 10.4.24 START\_THRESHOLD
10.4.25 START\_VALUE\_TO\_TRANSMIT 10.4.26 TRANSACTIONS 10.4.27
TIMERS\_AND\_CONSTANTS 10.4.28 UNSUPPORTED\_CONFIGURATION 10.4.29
SECURITY\_MODIFICATION 11 Specific functions 11.1 Provision and
reception of RRC information between network nodes 11.1.1 General 11.1.2
General error handling for RRC messages exchanged between network nodes
11.1.3 RRC Information to target GERAN Iu mode BSS 11.1.4 RRC
information, target BSS to source BSS 11.1.5 RRC messages exchanged
between network nodes 11.1.5.0 RADIO BEARER RECONFIGURATION 11.1.5.1
INTER RAT or MODE HANDOVER INFO WITH MS CAPABILITIES 11.1.5.2 SBSS
RELOCATION INFO 11.1.5.3 RFC 3095 CONTEXT INFO 11.2 Provision and
reception of RRC security information between network nodes 11.2.1
General 11.2.2 RRC Security Information, from GERAN-A/Gb to GERAN-Iu
11.2.3 RRC Security Information, from GERAN Iu mode/UTRAN to GERAN Iu
mode 11.2.4 RRC Security Information, from GERAN Iu to UTRAN 11.3 HFN
mapping rules for radio bearer using non-transparent mode RLC 11.4
Calculated Transport Format Combination 11.5 Signalling TFC Annex A
(informative): Change History

Foreword
========

This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).

The contents of the present document are subject to continuing work
within the TSG and may change following formal TSG approval. Should the
TSG modify the contents of the present document, it will be re-released
by the TSG with an identifying change of release date and an increase in
version number as follows:

Version x.y.z

where:

x the first digit:

1 presented to TSG for information;

2 presented to TSG for approval;

3 or greater indicates TSG approved document under change control.

y the second digit is incremented for all changes of substance, i.e.
technical enhancements, corrections, updates, etc.

z the third digit is incremented when editorial only changes have been
incorporated in the document.

1 Scope
=======

1.1 General
-----------

The present document specifies the procedures used at the radio
interface (Reference Point Um, see 3GPP TS 24.002) for Radio Resource
management. The Radio Resource Control Protocol (RRC) is specified. RRC
is the Radio Resource control plane protocol for Radio Resource
management that is used when a mobile station is operating in Iu mode.

Notation \"Reserved sub-clause number\" is used to indicate which
sub-clauses of the specification were moved from this part of the
standard to the other part when this standard was split between RAN and
CN parts.

When the notations for \"further study\" or \"FS\" or \"FFS\" are
present in this specification they mean that the indicated text is not a
normative portion of this standard.

These procedures are defined in terms of messages exchanged over the
control channels of the radio interface. The control channels are
described in 3GPP TS 44.003.

The structured functions and procedures of this protocol and the
relationship with other layers and entities are described in general
terms in 3GPP TS 24.007.

1.2 Scope of the Technical Specification
----------------------------------------

The procedures currently described in the present document are for radio
resource management for circuit switched and GPRS services.

3GPP TS 24.010 contains functional procedures for support of
supplementary services.

3GPP TS 24.011 contains functional procedures for support of
point-to-point short message services.

3GPP TS 44.012 contains functional description of short message cell
broadcast.

3GPP TS 44.060 contains procedures for radio link control and medium
access control (RLC/MAC) of packet data physical channels.

3GPP TS 44.071 contains functional descriptions and procedures for
support of location services.

3GPP TS 24.008 contains the procedures for CN protocols.

NOTE: \"layer 3\" includes the functions and protocols described in this
Technical Specification. The terms \"data link layer\" and \"layer 2\"
are used interchangeably to refer to the layer immediately below layer
3.

1.3 Application to the interface structures
-------------------------------------------

The layer 3 procedures apply to the interface structures defined in
3GPP TS 44.003. They use the functions and services provided by layer 2
defined in 3GPP TS 44.005 and 3GPP TS 44.006. 3GPP TS 24.007 gives the
general description of layer 3 including procedures, messages format and
error handling.

1.4 Structure of layer 3 procedures
-----------------------------------

A building block method is used to describe the layer 3 procedures.

The basic building blocks are \"elementary procedures\" provided by the
protocol control entities of the three sublayers, i.e. radio resource
management, mobility management and connection management sublayer.

Complete layer 3 transactions consist of specific sequences of
elementary procedures. The term \"structured procedure\" is used for
these sequences.

1.5 Test procedures
-------------------

Test procedures of the GSM radio interface signalling are described in
3GPP TS 51.010 and 3GPP TS 51.02x series.

1.6 Applicability of implementations
------------------------------------

NOTE: This sub-clause is FFS.

2 References
============

The following documents contain provisions which, through reference in
this text, constitute provisions of the present document.

\- References are either specific (identified by date of publication,
edition number, version number, etc.) or non‑specific.

\- For a specific reference, subsequent revisions do not apply.

\- For a non-specific reference, the latest version applies. In the case
of a reference to a 3GPP document (including a GSM document), a
non-specific reference implicitly refers to the latest version of that
document *in the same Release as the present document*.

\[1\] 3GPP TS 21.905: \"Vocabulary for 3GPP Specifications\".

\[2\] 3GPP TS 22.011: \"Service accessibility\".

\[3\] 3GPP TS 23.003: \"Numbering, addressing and identification\".

\[4\] 3GPP TS 23.022: \"Functions related to Mobile Station (MS) in idle
mode\".

\[5\] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
Description; Stage 2\".

\[6\] 3GPP TS 23.101: \"General UMTS Architecture\".

\[7\] 3GPP TS 23.110: \" UMTS Access Stratum; Services and Functions\".

\[8\] 3GPP TS 23.221: \"Architectural requirements\".

\[9\] 3GPP TS 24.002: \"GSM Public Land Mobile Network (PLMN) access
reference configuration\".

\[10\] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3;
General aspects\".

\[11\] 3GPP TS 24.008: \"Mobile radio interface layer 3
specification;Core Network Protocols - Stage 3\"

\[12\] 3GPP TS 24.010: \"Mobile radio interface layer 3 Supplementary
services specification; General aspects\".

\[13\] 3GPP TS 24.011: \"Point-to-point (PP) Short Message Service (SMS)
support on mobile radio interface\".

\[14\] 3GPP TS 24.080: \"Mobile radio interface layer 3 supplementary
services specification Formats and coding\".

\[15\] 3GPP TS 25.323: \"Packet Data Convergence Protocol (PDCP)
Specification\".

\[16\] 3GPP TS 25.331: \"Radio Access Network; RRC Protocol
Specification\".

\[17\] 3GPP TS 31.102: \"Characteristics of the USIM Application\".

\[18\] 3GPP TS 33.102: \"3G Security; Security Architecture\".

\[19\] 3GPP TS 43.013: \"Discontinuous Reception (DRX) in the
GSM system\".

\[20\] 3GPP TS 43.051: \"Radio Access Network; Overall description Stage
2\".

\[21\] 3GPP TS 43.059: \"Functional Stage 2 Description of Location
Services in GERAN\".

\[22\] 3GPP TS 44.004: \"Layer 1 General requirements\".

\[23\] 3GPP TS 44.005: \"Data Link (DL) layer General aspects\".

\[24\] 3GPP TS 44.006: \"Mobile Station - Base Station System (MS - BSS)
interface Data Link (DL) layer specification\".

\[25\] 3GPP TS 44.003: \"Mobile Station Base Station System (MS - BSS)
interface Channel structures and access capabilities\".

\[26\] 3GPP TS 44.012: \"Short Message Service Cell Broadcast (SMSCB)
support on the mobile radio interface\".

\[27\] 3GPP TS 44.018:\" GSM EDGE Radio Access Network, Mobile radio
interface layer 3 specification, Radio Resource Control Protocol\"

\[28\] 3GPP TS 44.031: \"Location Services;Mobile Station (MS) --
Serving Mobile Location Centre (SMLC); Radio Resource LCS Protocol
(RRLP)\".

\[29\] 3GPP TS 44.071: \"Mobile radio interface layer 3 location
services specification.

\[30\] 3GPP TS 44.060: \"General Packet Radio Service (GPRS); Mobile
Station - Base Station System (MS-BSS) interface; Radio Link Control and
Medium Access Control (RLC/MAC) layer specification\".

\[31\] 3GPP TS 44.160: \"General Packet Radio Service (GPRS); Mobile
Station - Base Station System (MS-BSS) interface; Radio Link Control and
Medium Access Control (RLC/MAC) layer specification, Iu mode\".

\[32\] 3GPP TS 45.002: \"Multiplexing and multiple access on the radio
path\".

\[33\] 3GPP TS 45.005: \"Radio transmission and reception\".

\[34\] 3GPP TS 45.008: \"Radio subsystem link control\".

\[35\] 3GPP TS 45.010: \"Radio subsystem synchronization\".

\[36\] 3GPP TS 51.010: \"Mobile Station (MS) conformity specification\".

\[37\] ITU-T Recommendation Q.931: ISDN user-network interface layer 3
specification for basic control\".

\[38\] TIA/EIA/IS-2000-5-A: \"Upper Layer (Layer 3) Signaling Standard
for cdma2000 Spread Spectrum Systems\".

\[39\] TIA/EIA/IS-833: \"Multi-Carrier Specification for Spread Spectrum
Systems on GSM MAP (MC-MAP) (Lower Layers Air Interface)\".

\[40\] TIA/EIA/IS-2000-4-A: \"Signaling Link Access Control (LAC)
Standard for cdma2000 Spread Spectrum Systems\".

\[41\] Michel MOULY, \"CSN.1 Specification, Version 2.0\", Cell & Sys,
ISBN: 2‑9510062‑0‑9.\
Web: <http://perso.wanadoo.fr/cell.sys/>.

\[42\] IANA ROHC profile identifier definition
(<http://www.iana.org/assignments/rohc-pro-ids>).

\[43\] 3GPP TR 45.902: \"Flexible Layer One\".

3 Definitions, symbols and abbreviations
========================================

3.1 Definitions
---------------

The following terms are used in this Technical Specification:

***A/Gb mode*:** mode of operation of the MS when connected to the Core
Network via GERAN and the A and/or Gb interfaces.

***Access Stratum (AS)***: defined in 3GPP TS 23.101.

***Active Transport Channel***: a transport channel is active during a
TTI if it carries a transport block.

***\"channel set\"***: is used to identify TCHs that carry related user
information flows, e.g., in a multislot configuration used to support
circuit switched connection(s), which therefore need to be handled
together.

***Dynamic attributes***: for one transport channel, the values of the
dynamic attributes are different among transport formats. They are
configured by Layer 3 and can change on a TTI basis under the control of
the MAC sublayer.

***Empty Transport Format***: a transport format such that no transport
block is carried over the transport channel (i.e. the transport channel
is inactive).

***Empty Transport Format Combination***: a transport format combination
that is made up only of empty transport formats.

***Inactive Transport Channel***: a transport channel is inactive during
a TTI if it does not carry a transport block (i.e. the transport block
size is zero).

***Iu mode***: mode of operation of the MS when connected to the Core
Network via GERAN or UTRAN and the Iu interface.

***Non Access Stratum (NAS)***: defined in 3GPP TS 21.905.

***RR idle***: defined in 3GPP TS 44.018.

***RR***: Radio Resource control plane protocol for radio resource
management that is used when a mobile station is operating in *A/Gb
mode*.

***RRC***: Radio Resource control plane protocol for radio resource
management that is used when a mobile station is operating in Iu mode.

***RRC Connection***: A point-to-point bi-directional connection between
RRC peer entities in the MS and the GERAN characterised by the
allocation of a G-RNTI. An MS has either zero or one RRC connection.

***RRC-Idle mode***: In RRC-Idle mode, the MS has no established RRC
connection.

***RRC-Connected mode***: In RRC-Connected mode, the MS has an
established RRC connection.

***Inter-RAT handover***: indicates the transfer of the connection,
under the control of the network, between the MS and two different radio
access technologies (e.g. UMTS to GERAN Iu mode).

***Inter-mode handover***: indicates the transfer of the connection,
under the control of the network, between the MS and GERAN *Iu mode*
to/from GERAN *A/Gb mode*.

***R:*** Retransmission number (*R* = 0 for first transmission, *R* = 1
for first retransmission, ..., *R* = *n* for the *n*^th^
retransmission). When there is no retransmission, *R* = 0 always.

***RR group receive mode***: defined in 3GPP TS 44.018.

***RR dedicated mode***: defined in 3GPP TS 44.018.

***RR group transmit mode***: defined in 3GPP TS 44.018.

***RR packet idle mode***: defined in 3GPP TS 44.018.

***RR packet transfer mode***: defined in 3GPP TS 44.018.

***RR dual transfer mode***: defined in 3GPP TS 44.018.

***RLC/MAC block***: A RLC/MAC block is the protocol data unit exchanged
between RLC/MAC entities, see 3GPP TS 44.060.

***Semi-static attributes***: for one transport channel, the values of
the semi-static attributes are common to all transport formats. They are
configured by Layer 3 and can only be changed by Layer 3 signalling.

***Transport Block (TB)***: block exchanged on a transport channel
between the physical layer and the MAC sublayer.

***Temporary block flow (TBF)***: is defined in 3GPP TS 44.060.

***Transport Channel (TrCH)***: a transport channel is offered by the
physical layer to the MAC sublayer for exchange of transport blocks. A
transport channel is used to carry with a certain quality of service, a
data flow over the radio interface.

***Transport Format (TF)***: configuration of a transport channel,
including for instance channel coding, CRC size, etc.

***Transport Format Combination (TFC)***: allowed combination of
transport format(s) of the different transport channels that are
multiplexed together on a basic physical subchannel.

***Transport Format Combination Indicator (TFCI)***: layer one header
that indicates the transport channel combination that has been selected
for each radio packet.

***Transport Format Combination Set (TFCS)***: set of allowed transport
format combinations on a basic physical subchannel.

***Transport Format Indicator (TFIN)***: index identifying a particular
transport format within the transport format set.

***Transport Format Set (TFS)***: set of all transport formats defined
for a particular transport channel.

***Transmission Time Interval (TTI)***: rate at which transport blocks
are exchanged between the physical layer and the MAC sublayer on a
transport channel.

The network modes of operation for GERAN *Iu mode* are:

NMO I: the network has a Gs interface. The network sends CS paging and
PS paging messages for an attached MS via the SGSN and the Iu-ps
interface to GERAN Iu. Paging co-ordination is achieved at the SGSN
thanks to the Gs interface. GERAN Iu pages the MS on PACCH if available,
else PCCCH. MS can initiate combined procedures according to its
capabilities.

NMO II: the network has no Gs interface. For an attached MS, the network
sends CS paging messages, via the MSC plus the Iu-cs interface, and
sends PS paging messages, via the SGSN plus the Iu-ps interface to GERAN
Iu. GERAN Iu performs paging co-ordination and pages the MS on PACCH if
available, else PCCCH. MSs cannot initiate combined procedures.

3.2 Abbreviations
-----------------

Abbreviations used in this specification are listed in 3GPP TS 21.905.

NOTE: 3GPP TS 21.905 may need to be updated.

3.3 Random values
-----------------

In a number of places in this Technical Specification, it is mentioned
that some value must take a \"random\" value, in a given range, or more
generally with some statistical distribution. Such cases interest only
the Mobile Station.

It is required that there is a low probability that two MSs in the same
conditions (including the case of two MSs of the same type from the same
manufacturer) will choose the same value. Moreover, it is required that,
if it happens that two MSs in similar conditions choose the same value,
the probability of their choices being identical at the next occasion is
the same as if their first choices had been different.

The meaning of such a specification is that any statistical test for
these values, done on a series of similar events, will obtain a result
statistically compatible with the specified distribution. This shall
hold even in the cases where the tests are conducted with a subset of
possible events, with some common parameters. Moreover, basic tests of
independence of the values within the series shall pass.

Data against which correlation with the values shall not be found are
the protocol state, or the IMSI, or identities or other unrelated
information broadcast by the network, or the current TDMA frame number.

3.4 Specification Notations
---------------------------

For the purposes of the present document, the following notations apply:

Procedure When referring to an elementary procedure in the specification
the Procedure Name is written with the first letters in each word in
upper case characters followed by the word \"procedure\", e.g. RRC
Estabilshment procedure.

Message When referring to a message in the specification the MESSAGE
NAME is written with all letters in upper case characters followed by
the word \"message\", e.g. CELL UPDATE message.

IE When referring to an information element (IE) in the specification
the *Information Element Name* is written with the first letters in each
word in upper case characters and all letters in Italic font precedeed
by the abbreviation \"IE\", e.g. IE \"*Initial MS Identity\"*.

Value of an IE When referring to the value of an information element
(IE) in the specification the \"Value\" is written as it is specified in
sub-clause 9.2 enclosed by quotation marks, e.g. \"Abstract Syntax Error
(Reject)\" or \"Geographical Coordinates\"

4 RRC Functions and Services provided to upper layers
=====================================================

4.1 RRC Functions
-----------------

RRC performs following functions. A more detailed description of the
functions can be found in 3GPP TS 43.051.

\- Broadcast of information provided by the Non-Access stratum (Core
Network)

\- Broadcast of information related to the access stratum

\- Establishment, re-establishment, maintenance and release of an RRC
connection between the MS and GERAN

\- Establishment, reconfiguration and release of Radio Bearers

\- Assignment, reconfiguration and release of radio resources for the
RRC connection

\- RRC connection mobility functions

\- Release of signalling connections

\- Paging/notification

\- Listening to BCCH

\- Routing of higher layer PDUs

\- Control of requested QoS

\- MS measurement reporting and control of the reporting

\- Power control

\- Control of ciphering

\- Integrity protection

\- Support for Location Services

\- Timing advance control

4.2 RRC Services provided to upper layers
-----------------------------------------

The RRC offers the following services to upper layers (NAS), a
description and primitives of these services are provided in
3GPP TS 43.051 and 3GPP TS 23.110.

\- General Control;

\- Notification;

\- Dedicated control.

The RRC layer provides the MS GERAN portion of signalling connections to
the upper layers to support the exchange of upper layer\'s information
flow. The signalling connection is used between the mobile station and
the core network to transfer upper layer information. For each core
network domain, at most one signalling connection may exist at the same
time. The RRC layer maps the signalling connections for one MS on a
single RRC connection. For the upper layer data transfer on signalling
connections, the RRC layer supports the discrimination between two
different classes, named \"High priority\" (corresponding to \"SAPI 0\"
when using RR) realised using SRB3 and \"Low priority\" (corresponding
to \"SAPI 3\" when using RR) realised using SRB4.

5 Services expected from lower layers
=====================================

5.1 Services required from layer 2 and physical layers
------------------------------------------------------

RRC uses RLC/MAC as layer 2 in the control plane, except for operation
on the BCCH, where the data link layer as specified in 3GPP TS 44.006 is
used (see 3GPP TS 43.051).

5.2 Signalling Radio Bearers
----------------------------

The Radio Bearers used for transferring signalling messages are called
Signalling Radio Bearers (SRBs). The SRBs are defined as:

\- SRB1 is used to carry RRC signaling performed in support of Access
Stratum specific needs (RLC operates in unacknowledged mode).

\- SRB2 is used to carry RRC signaling performed in support of Access
Stratum specific needs (RLC operates in acknowledged mode).

\- SRB3 is used to carry RRC signaling performed in support of
Non-Access Stratum specific needs (RLC operates in acknowledged mode).

\- SRB4 is used to carry RRC signaling performed in support of
Non-Access Stratum specific needs (RLC operates in acknowledged mode).

6 RRC Protocol modes and states
===============================

6.1 General
-----------

An overall picture of the transitions between RR modes of operation and
RRC states and modes is in Figure 6.1.1. The RRC modes are RRC-Idle mode
and RRC-Connected mode. RRC-Connected mode consists of three different
RRC states RRC-Cell\_Shared, RRC-Cell\_Dedicated and RRC-GRA\_PCH. The
RR modes of operation are RR Dedicated mode, RR Group receive mode, RR
Group transmit mode, RR Packet Idle mode, RR Packet Transfer mode and RR
DTM (see 3GPP TS 43.064).

RR Group receive mode and RR Group transmit Mode are not described in
Figure 6.1.1.

Figure 6.1.1: Transitions between RR modes of operation and RRC states
and modes.

6.2 Relation between Iu mode and A/Gb mode
------------------------------------------

### 6.2.1 Handover between Iu and A/Gb modes

When a handover which results in change from *Iu mode* (i.e. from the
RRC-Cell\_Dedicated state) to *A/Gb mode* is performed, the RR dedicated
mode of operation shall be entered.

When a handover which results in change from *A/Gb mode* (i.e. from the
RR dedicated mode of operation) to *Iu mode* is performed, the
RRC-Cell\_Dedicated state shall be entered. If handover to *Iu mode* is
triggered in RR dual transfer mode of operation, the RR dedicated mode
of operation shall be entered before the handover is initiated.

### 6.2.2 Cell reselection between Iu and A/Gb mode

Cell reselection in this sub-clause refers to aborting the operation in
the old cell and switching to the new selected cell.

When a cell reselection which results in change from *Iu mode* (i.e from
the RRC-Idle Mode) to *A/Gb mode* is performed, the RR Idle/ RR Packet
Idle mode of operation shall be entered. If cell reselection is
triggered in RRC-Cell\_Shared or RRC-GRA\_PCH state, the RRC-Idle mode
shall be entered before the cell reselection is initiated.

When a cell reselection which result in change from *A/Gb mode* (i.e.
from the RR Idle/RR packet Idle mode of operation) to *Iu mode*, is
performed the RRC-Idle mode shall be entered. If cell reselection is
triggered in RR Packet Transfer mode of operation, the RR packet Idle
mode of operation shall be entered before the cell reselection is
initiated.

6.2a Relation between GERAN Iu mode RRC and UTRA RRC
----------------------------------------------------

### 6.2a.1 Handover between GERAN Iu mode and UTRAN

When a handover which results in change from GERAN *Iu mode* (i.e.
RRC-Cell\_Dedicated state) to UTRAN is performed, the UTRAN RRC
connected mode of operation shall be entered.

When a handover which results in change from UTRAN (i.e. from the UTRA
RRC Cell\_DCH state) to GERAN *Iu mode* is performed, the
RRC-Cell\_Dedicated state shall be entered.

### 6.2a.2 Cell reselection between GERAN Iu mode and UTRAN

Cell reselection in this sub-clause refers to aborting the operation in
the old cell and switching to the new selected cell.

When a cell reselection which results in change from GERAN *Iu mode* to
UTRAN is performed, when the MS is in RRC-Idle mode, the Idle mode of
operation shall be entered.

When a cell reselection which results in change from GERAN *Iu mode* to
UTRAN is performed, when the MS is in GERAN RRC-Cell\_Shared state, the
MS shall initiate the cell update procedure and enter the UTRAN RRC
CELL\_FACH state. If the cell update is rejected by UTRAN, the MS shall
release the RRC connection according to the cell update failure case and
enter Idle mode.

When a cell reselection which results in change from GERAN *Iu mode* to
UTRAN is performed, when the MS is in GERAN RRC-GRA\_PCH state, the MS
shall enter the UTRAN RRC URA\_PCH state. If the GRA identity which the
MS had been assigned to in GERAN is not present in the list of URA
identities broadcast in the UTRAN cell, the MS shall initiate the UTRAN
URA update procedure. If the URA update is rejected by UTRAN, the MS
shall release the RRC connection according to the URA update failure
case and enter Idle mode.

When a cell reselection which results in change from UTRAN to GERAN *Iu
mode* is performed, when the MS is in UTRAN RRC-Cell\_FACH or Cell\_PCH
state, the MS shall initiate the cell update procedure and enter the
GERAN RRC Cell Shared state. If the cell update is rejected by GERAN,
the MS shall release the RRC connection according to the cell update
failure case and enter RRC Idle mode in GERAN *Iu mode*.

When a cell reselection which results in change from UTRAN to GERAN *Iu
mode* is performed, when the MS is in UTRAN RRC-URA\_PCH state, the MS
shall enter the GERAN RRC GRA\_PCH state. . If the URA identity which
the MS had been assigned to in UTRAN is not present in the list of GRA
identities broadcast in the GERAN cell, the MS shall initiate the GERAN
GRA update procedure. If the GRA update is rejected by GERAN, the MS
shall release the RRC connection according to the GRA update failure
case and enter RRC Idle mode in GERAN *Iu mode*.

6.3 RR modes of operation
-------------------------

The RR modes of operation are described in 3GPP TS 43.064.

6.4 RRC modes and states
------------------------

### 6.4.1 RRC-Idle Mode

#### 6.4.1.1 General

After power on having selected the *Iu mode*, the MS enters RRC-Idle
mode. The MS stays in RRC-Idle mode until a successful establishment of
a RRC Connection. In RRC-Idle mode the connection of the MS is closed on
all layers of the access stratum. In RRC-Idle mode the MS is identified
by Non-Access stratum identities such as IMSI, TMSI and P-TMSI. In
addition, the GERAN has no own information about the individual MS\'s in
RRC-Idle mode, and it can only address e.g. all MS\'s in a cell
(broadcasting) or all MS\'s monitoring a paging occasion.

#### 6.4.1.2 Transition from RRC-Idle Mode to RRC-Connected mode

The transition to the RRC-Connected mode from the RRC-Idle mode can only
be initiated by the MS by transmitting a request for an RRC Connection.
The event is triggered by a request from upper layers in the MS.

At RRC connection establishment the MS is assigned a GERAN radio network
temporary identity (G-RNTI) to be used as MS identity on both common
control channels and traffic channels.

When the MS receives a message from the network that confirms the RRC
connection establishment, the MS enters the RRC-Connected mode. The
RRC-Connected mode is characterised by three states: RRC-Cell\_Shared,
RRC-Cell\_Dedicated and RRC-GRA\_PCH.

### 6.4.2 RRC-Connected mode: RRC-Cell\_Shared state

#### 6.4.2.1 General

RRC-Cell\_Shared state is characterized by:

\- no dedicated basic physical subchannel (DBPSCH) is allocated to the
MS.

\- the position of the MS is known by GERAN on cell level according to
the cell where the MS last made a cell update.

In RRC-Cell\_Shared state the MS shall perform the following actions:

1\> initiate a Cell Update procedure on cell change to *Iu mode* in
another GERAN or UTRAN cell;

1\> transmit signalling messages and user data in the uplink and/or the
downlink using PDTCH when the MS is assigned use of those resources;

1\> the management of radio resources within the cell is handled at MAC
level;

1\> listen to the PBCCH control channel of the serving cell for the
decoding of system information messages;

1\> listen to neighbouring cells for neighbour cell measurements (see
3GPP TS 45.008);

1\> use G-RNTI assigned in the current cell as the MS identity on common
control channels.

NOTE: In that state, if the network wants to initiate any activity, no
paging request is required to be sent. The network can directly allocate
radio resources to the MS.

#### 6.4.2.2 Transition from RRC-Cell\_Shared state to RRC-Idle Mode

The transition to RRC-Idle Mode is realised through the release of the
RRC connection.

#### 6.4.2.3 Transition from RRC-Cell\_Shared state to RRC-Cell\_Dedicated state

The transition from RRC-Cell\_Shared state to RRC-Cell\_Dedicated state
occurs when a DBPSCH is allocated to the MS.

#### 6.4.2.4 Transition from RRC-Cell\_Shared state to RRC-GRA\_PCH state

The transition occurs when GERAN orders the MS to move to RRC-GRA\_PCH
state via explicit signaling.

When such a transition occurs, the mobile station shall abort any TBF in
progress by immediately ceasing to decode the downlink, ceasing to
transmit on the uplink, stopping all RLC/MAC timers except for timers
related to measurement reporting, prior to moving to RRC-GRA\_PCH state.

#### 6.4.2.5 Radio resource allocation tasks

RRC is in this state responsible for allocating dedicated basic physical
subchannels, which causes the MS to enter the RRC-Cell\_Dedicated state.
MAC is responsible for allocating / reallocating / releasing shared
basic physical subchannels (SBPSCH) (see 3GPP TS 44.160). This
allocation of the PDTCHs by MAC is done according to the QoS class of
the radio bearer and multislot capability of the MS. The RRC provides
the MAC with QoS class and indication of the MS multislot capability.

#### 6.4.2.6 RRC connection mobility tasks

In RRC-Cell\_Shared state the MS shall initiate a Cell Update procedure
when:

1\> a new GERAN cell has been selected and the MS operates in *Iu mode*,
or

1\> a UTRAN cell has been selected.

1\> when T305 in the MS expires and the MS is operating in *Iu mode*.

When the GERAN cell has been selected that would require the MS to
operate in the *A/Gb mode* then the MS shall enter the RRC-Idle Mode,
enter RR Idle or RR Packet Idle Mode of operation. Access in the cell
will then be made according to the *A/Gb* *mode* procedures.

#### 6.4.2.7 MS measurements

MAC is responsible for measurement reporting, using the procedures
defined in 3GPP TS 44.060.

### 6.4.3 RRC-Connected mode: RRC-Cell\_Dedicated state

#### 6.4.3.1 General

RRC-Cell\_Dedicated state is characterized by:

\- the MS is assigned one or more dedicated basic physical subchannels
(see 3GPP TS 43.051) in the uplink and downlink, which it can use
anytime. Furthermore, the MS may be assigned one or more shared basic
physical subchannels.

\- the position of the MS is known by GERAN on cell level.

In RRC-Cell\_Dedicated state the MS shall perform the following actions:

1\> perform necessary procedures for measurement reporting;

1\> listen to neighbouring cells for neighbouring cell measurements (see
3GPP TS 45.008);

1\> perform a handover procedure of the dedicated basic physical
subchannels on cell change of another GERAN or UTRAN cell;

1\> transmit signalling message in the uplink using available signalling
radio bearers.

#### 6.4.3.2 Transition from RRC-Cell\_Dedicated state to RRC-Cell\_Shared state

The transition occurs when all the dedicated basic physical subchannels
are released and

1\> shared basic physical subchannels exist; or

1\> no shared basic physical subchannels exist and the network indicates
transition to the RRC-Cell\_Shared state.

#### 6.4.3.3 Transition from RRC-Cell\_Dedicated state to RRC-Idle Mode

The transition to RRC-Idle mode is realised through the release of the
RRC connection.

#### 6.4.3.4 Transition from RRC-Cell\_Dedicated state to RRC-GRA\_PCH state

The transition occurs when GERAN orders the MS to move to the
RRC-GRA\_PCH state via explicit signalling.

When such a signalling is received, the mobile station shall release all
the allocated dedicated basic physical suchannel(s) and, if any, all the
shared basic physical subchannels, prior to moving to RRC-GRA\_PCH
state.

#### 6.4.3.5 Radio resource allocation tasks

RRC is responsible for allocating new dedicated basic physical
subchannels, while MAC or RRC are responsible for allocation of new
shared basic physical subchannels depending on the MAC control state.
RRC is also responsible for intra-cell handovers of dedicated basic
physical sub-channels.

#### 6.4.3.6 RRC connection mobility tasks

RRC connection mobility tasks are realised in RRC-Cell\_Dedicated state
using RRC handover procedures.

#### 6.4.3.7 MS measurements

MS measurement results are signaled using RRC measurement procedures.

### 6.4.4 RRC-Connected mode: RRC-GRA\_PCH state

#### 6.4.4.1 General

The RRC-GRA\_PCH state is characterized by:

\- no physical subchannel is allocated to the MS.

\- the MS may use DRX for monitoring a PCCCH.

\- no uplink activity is possible.

\- the location of the MS is known on GERAN Registration area level.

In this state the MS performs the following actions:

1\> monitor the paging occasions according to the DRX cycle and receive
paging information on the PCCCH;

1\> listen to the PBCCH control channel of the serving cell for the
decoding of system information messages;

1\> initiate a GRA Update procedure upon GRA change.

If the network wants to initiate any activity, it shall make a paging
request on the PCCCH logical channel within the GRA where the MS is.

GRA updating is initiated by the MS, which, upon the detection of the
new GERAN registration area, sends the network the registration area
update information to the new cell. Any activity causes a transition to
either the RRC-Cell\_Shared state or the RRC-Cell\_Dedicated state,
depending on the activity.

#### 6.4.4.2 Transition from RRC-GRA\_PCH state to RRC-Cell\_Shared state

The transition can occur due to GRA update, cell update or answer to
paging. If there has been a cell change since last GRA update, the MS
has to do immediately a cell update except when GRA update is initiated.

#### 6.4.4.3 Transition from RRC-GRA\_PCH state to RRC-Cell\_Dedicated state

When the MS is in RRC-GRA\_PCH state, the MS may request a radio
resource to answer to a paging message or to perform a GRA/Cell Update
procedure. The network may choose to allocate a dedicated resource in
which case the MS enters RRC-Cell\_Dedicated state.

#### 6.4.4.4 Radio resource allocation tasks

No radio resource allocation tasks are executed within this state. In
case of transition to RRC-Cell\_Shared state is needed, the MAC is
responsible for allocating the shared physical subchannels. In case of
transition to RRC-Cell\_Dedicated state is needed, the RRC is
responsible for allocating the physical subdedicated channel.

#### 6.4.4.5 RRC connection mobility tasks

In the RRC-GRA\_PCH state the location of a MS is known on GERAN
Registration area level.

In this state, the MS mobility is performed through Cell Reselection
procedures. The MS shall perform cell reselection and upon selecting a
new GERAN cell belonging to a GRA which does not match the GRA used by
the MS, the MS shall move to RRC-Cell\_Shared state and initiate a GRA
update towards the network. After the GRA Update procedure has been
performed, the MS shall change its state back to RRC-GRA PCH state if
neither the MS nor the network has any more data to transmit.

In RRC-GRA\_PCH state the MS shall initiate:

1\> a GRA Update procedure when a new GERAN cell has been selected that
does not belong to the current registration area and the MS operates in
Iu mode, or

1\> a GRA Update procedure when T305 in the MS expires and the MS is
operating in Iu mode, or

1\> a URA Update procedure when a UTRAN cell has been selected that does
not belong to the current registration area (see 3GPP TS 25.331).

When the GERAN cell has been selected that would require the MS to
operate in the *A/Gb mode* then the MS shall enter the RRC-Idle mode,
then enter RR Idle or RR Packet Idle Mode of operation. Access in the
cell will then be made according to the *A/Gb mode* procedures.

#### 6.4.4.6 MS measurements

The MS monitors the broadcast channels on its own and neighbouring cells
and identifies the need for GRA updating. No measurement reports are
sent to the network in this state.

#### 6.4.4.7 Transfer and update of system information

The MS shall listen to the PBCCH to acquire a valid system information.

7 Radio Resource Control procedures
===================================

7.1 General
-----------

The mobile station can operate either in *A/Gb mode* or in *Iu mode*.
How mobile station selects the operation mode is specified in
3GPP TS 23.221. The behaviour of mobile stations operating in *A/Gb
mode* is specified in 3GPP TS 44.018.

After the reception of a message which invoked a procedure, the MS shall
be prepared to receive and act on another message which invokes the
second procedure. Whether this second invocation of a procedure
(transaction) is accepted or rejected by the MS is specified in the
sub-clauses that specifies the procedure. On receiving a message the MS
shall first apply integrity check as appropriate and then proceed with
error handling as specified in clause 8 and 9 before continuing on with
the procedure as specified in the relevant sub-clause. The RRC entity in
the MS shall consider PDUs to have been transmitted when they are
submitted to the lower layers. If the RRC entity in the MS submits a
message for transmission using AM RLC, it shall consider the message
successfully transmitted when GERAN reception of all relevant PDUs is
acknowledged by RLC.

7.2 Change of channels in case of handover
------------------------------------------

### 7.2.1 Change of channel serving SRB1

The RLC procedures for unacknowledged mode, described in 3GPP TS 44.160,
do not provide protection against message loss or duplication. No
functionality for handling SRB1 during change of channels is defined, as
SRB1 is used by RRC procedures that are not very sensitive to message
loss or duplication.

### 7.2.2 Change of channel serving SRB2

The RLC procedures for acknowledged mode, described in 3GPP TS 44.160,
provide delivery of received messages to the upper layers in the order
they were originally transmitted, provide protection against message
loss, but do not provide protection against message duplication. SRB2 is
used by RRC procedures that need reliable transport service and are
sensitive to message duplication.

When changing channel, the RRC layer will request the RLC layer to
suspend operation on SRB2 before the mobile station leaves the old
channel. When the channel change has been completed, the RRC layer
station will request the RLC layer to resume operation on SRB2. The RLC
layer suspend/resume procedures are described in 3GPP TS 44.160.

It may happen that the RLC layer duplicates a message, if it has been
transmitted but not yet completely acknowledged within the RLC layer,
before the mobile station leaves the old channel. However, the RRC layer
controls the channels change in such a way that duplication of RRC
messages does not occur.

### 7.2.3 Change of channel serving SRB3

The RLC procedures for acknowledged mode, described in 3GPP TS 44.160,
provide delivery of received messages to the upper layers in the order
they were originally transmitted, provide protection against message
loss, but do not provide protection against message duplication. SRB3 is
used for RRC messages carrying upper layer (NAS) signalling. If these
messages are sensitive to message duplication, the upper layer protocol
should define its own protection mechanism.

### 7.2.4 Change of channel serving SRB4

The RLC procedures for acknowledged mode, described in 3GPP TS 44.160,
provide delivery of received messages to the upper layers in the order
they were originally transmitted, provide protection against message
loss, but do not provide protection against message duplication. SRB4 is
used for RRC messages carrying upper layer (NAS) signalling. If these
messages are sensitive to message duplication, the upper layer protocol
should define its own protection mechanism.

7.3 System information broadcasting
-----------------------------------

### 7.3.1 General

The purpose of this procedure is to broadcast SYSTEM INFORMATION (SI)
messages from the GERAN to MSs in a cell.

GERAN is required to broadcast SI messages on BCCH as specified in
3GPP TS 44.018.

### 7.3.2 Broadcast of Iu mode specific System Information

The support of *Iu mode* shall be indicated in SYSTEM INFORMATION TYPE 3
message sent on BCCH. In addition, the support of *Iu mode* shall be
indicated in either SYSTEM INFORMATION TYPE 4 or SYSTEM INFORMATION
TYPE 7 and 8 messages. The SI3, SI4, SI7 and SI8 messages contain the
CBQ3 parameter that indicates if *Iu mode* is supported in the cell (see
3GPP TS 44.018).

If *Iu mode* is supported and Gb mode is not supported in the cell,
SYSTEM INFORMATION TYPE 13alt message shall be sent and the mobile
station shall read SI13alt message. SI 13 message is not sent in this
case. SI13alt message shall not be sent if *Iu mode* is not supported.

If Gb mode is supported, SYSTEM INFORMATION TYPE 13 message shall be
sent and the mobile station shall read SI 13 message in this case.
SI13alt message is not sent in this case. Additional requirements for
the broadcast of system information in a cell supporting *Iu mode* and
*Gb mode* are specified in 3GPP TSs 44.060 and 44.160.

Figure 7.3.2.1 presents the behaviour of *Iu mode* only capable mobile
station and figure 7.3.2.2 presents the behaviour of *A/Gb mode* and *Iu
mode* capable mobile station on BCCH (see 3GPP TS 44.018).

![](media/image4.wmf){width="5.354861111111111in"
height="4.738194444444445in"}

Figure 7.3.2.1: Behaviour of *Iu mode* only capable MS on BCCH.

![](media/image5.wmf){width="5.354861111111111in"
height="4.738194444444445in"}

Figure 7.3.2.2: Behaviour of *A/Gb* and *Iu mode*s capable MS on BCCH.

7.4 Paging procedure
--------------------

### 7.4.1 General

The GERAN will start a Paging Request procedure to trigger:

1\> an Initial Direct Transfer procedure for CN originated paging; or

1\> a Cell Update procedure for GERAN initiated paging.

Paging is done by the GERAN on the PCCCH or PACCH (when available) when
the MS is in RRC-Idle mode, RRC-Cell\_Shared state or RRC-GRA\_PCH state
and on SRB2 when the MS is in RRC-Cell\_Dedicated state.

### 7.4.2 Paging initiation in RRC-Idle mode, RRC-Cell\_Shared or RRC-GRA\_PCH state

#### 7.4.2.1 General

The paging initiation in RRC-Idle mode, RRC-Cell\_Shared state or
RRC-GRA\_PCH state is done by sending a PAGING REQUEST service primitive
to the GERAN MAC layer.

![](media/image6.wmf){width="4.977777777777778in"
height="1.5652777777777778in"}

Figure 7.4.2.1.1: Paging Request procedure

This procedure is used to initiate transmission of paging information by
the GERAN MAC to an MS in RRC-Idle mode, RRC-Cell\_Shared state, or
RRC-GRA\_PCH state. Upper layers in the network may request paging, to
e.g. establish a signalling connection between a mobile station and the
CN. The GERAN may initiate paging of an MS in RRC-GRA\_PCH state or
{RRC-Cell\_Shared, MAC-Idle state} to trigger a Cell Update procedure in
order to establish a signalling connection between the network and this
MS.

An MS may use Discontinuous Reception (DRX) to reduce its power
consumption. An MS in non-DRX mode monitors all paging blocks on the
monitored PCCCH. An MS in DRX mode needs only to monitor the blocks
corresponding to its paging group in order to reduce its battery
consumption, see 3GPP TS 44.160.

#### 7.4.2.2 Initiation

GERAN RRC initiates the Paging procedure by transmitting a PAGING
REQUEST service primitive to the GERAN MAC sublayer.

The GERAN shall set the IEs in the PAGING service primitive as follows:

1\> if the Paging procedure was initiated by the CN

2\> if the MS is in RRC-Cell\_Shared or RRC-GRA\_PCH state, then

3\> the *MS Identity* IE shall be set to G-RNTI;

3\> the *Paging Record Type Identifier* IE shall be set to the value
determined by the MS identity received in the CN paging request;

3\> the *CN Domain identity* IE shall be set to the value received in
the CN paging request;

3\> if a value for Paging Cause is received from the CN, then the GERAN
RRC shall:

4\> set the *Paging Cause* IE in the PAGING service primitive to the
value received in the CN paging request; .

3\> if no value for Paging Cause is received from the CN then the GERAN
RRC shall:

4\> set the *Paging Cause* IE in the PAGING service primitive to the
value \"Terminating -- cause unknown\".

2\> if the MS is in RRC-Idle mode then:

3\> the *MS Identity* IE shall be set to the value received from the CN;

3\> the *CN Domain Identity* IE shall be set to the value received in
the CN paging request;

3\> if a value for Paging Cause is received from the CN then the GERAN
RRC shall:

4\> set the *Paging Cause* IE in the PAGING service primitive to the
value received in the CN paging request;

3\> if no value for Paging Cause is received from the CN then the GERAN
RRC shall:

4\> set the *Paging Cause* IE in the PAGING service primitive to the
value \"Terminating -- cause unknown\".

1\> if the Paging procedure was initiated by the GERAN, the GERAN RRC
shall:

2\> set the *MS Identity* IE to G-RNTI; and

2\> the procedure ends.

NOTE: If the Paging procedure is initiated by the GERAN, the GERAN shall
indicate this to the MS by the absence of any information in the PAGING
message other than the G-RNTI IE.

#### 7.4.2.3 Reception of a PAGING INDICATION service primitive

The MS RRC in RRC-Idle mode, RRC-GRA\_PCH state or RRC-Cell\_Shared
state shall receive the paging information in a PAGING INDICATION
service primitive from the MS MAC layer.

If the MS is in RRC-Idle mode, for each MS paged in the PAGING
INDICATION service primitive, the MS shall:

1\> if the *MS Identity* IE is present in the message and it is a CN
identity

2\> compare the *MS Identity* IE with all of its allocated CN MS
identities;

2\> if one match is found:

3\> forward the *MS Identity* IE, the *CN Domain Identity* IE and the
*Paging cause* IE to upper layers; and

3\> ignore any other paging information that may be present in the
PAGING service primitive;

1\> otherwise:

2\> ignore the PAGING service primitive.

If the MS is in RRC-Cell\_Shared or RRC-GRA\_PCH state, for each MS
paged in the PAGING INDICATION service primitive, the GERAN RRC shall:

1\> if the *MS Identity* IE is a GERAN identity; and

2\> if this G-RNTI is the same as the G-RNTI allocated to the MS:

3\> if paging request contains page info with CN domain identity

4\>forward the *MS identity* IE, the *CN Domain Identity* IE and the
*Paging Cause IE* to upper layers;

3\>otherwise

4\> initiate the Cell Update procedure with the cause \'paging
response\' as defined in sub-clause 7.8; and

4\> forward the *CN Domain Identity* IE if present, the *Paging Record
Type Identifier* IE if present and the *Paging cause* IE if present to
upper layers; and

3\> ignore any other paging information that may be present in the
primitive;

1\> otherwise

2\> ignore the Paging primitive.

### 7.4.3 Paging initiation in RRC-Cell\_Dedicated state

Figure 7.4.3.1.1: Dedicated Paging Request procedure

#### 7.4.3.1 General

This procedure is used to transmit dedicated paging information to one
MS in RRC-Cell\_Dedicated state.

#### 7.4.3.2 Initiation

For an MS in RRC-Cell\_Dedicated state the GERAN initiates the procedure
by transmitting a DEDICATED PAGING REQUEST message on the SRB2 assigned
to the MS. If not stated otherwise, the GERAN may initiate the Dedicated
Paging Request when another RRC procedure is ongoing, and in this case
the state of the latter procedure shall not be affected.

In the DEDICATED PAGING REQUEST message, the GERAN RRC shall set the IE
\"*Paging Cause*\", the IE \"*CN Domain Identity*\", the IE \"*Paging
Record Type Identifier*\" respectively to the Paging Cause, the CN
domain Indicator and the Paging Record Type Identifier received from
upper layers.

If no cause for pagingis received from upper layers, GERAN RRC shall set
the IE \"*Paging Cause*\" to the value \"Terminating -- cause unknown\".

#### 7.4.3.3 Reception of a DEDICATED PAGING REQUEST message by the MS

When the MS receives a DEDICATED PAGING REQUEST message on SRB 2, it
shall not affect the state of any other ongoing RRC procedures, if not
stated otherwise.

Upon receipt of a DEDICATED PAGING REQUEST message the MS shall:

1\> forward the *Paging Cause* IE, the *CN Domain Identity* IE and the
*Paging Record Type Identifier* IE to upper layers;

1\> the procedure ends.

### 7.4.4 Abnormal cases

If the MS receives a DEDICATED PAGING REQUEST message, which contains a
protocol error causing the variable PROTOCOL\_ERROR\_REJECT to be set to
TRUE, the MS shall perform procedure specific error handling as follows:

1\> transmit an RRC STATUS message on the uplink SRB2;

1\> include the IE \"*Identification of Received Message*\";

1\> set the IE \"*Received Message Type*\" to DEDICATED PAGING REQUEST;

1\> include the *Protocol Error Information* IE and set the content to
the value of the variable PROTOCOL\_ERROR\_INFORMATION.

1\> if the RRC STATUS message has been submitted to lower layers for
transmission:

2\> continue with any ongoing processes and procedures as if the invalid
DEDICATED PAGING REQUEST message was not received.

7.5 RRC Connection management procedures
----------------------------------------

### 7.5.1 RRC connection establishment

Figure 7.5.1.1: RRC Connection Establishment, network accepts RRC
connection

Figure 7.5.1.2: RRC Connection Establishment, network rejects RRC
connection

##### 7.5.1.1 General

The purpose of this procedure is to establish an RRC connection.

##### 7.5.1.2 Initiation

The MS shall initiate the procedure when upper layers in the MS requests
the establishment of a signalling connection and the MS is in RRC-Idle
mode (no RRC connection exists), as specified in sub-clause 7.17.

Upon initiation of the procedure, the MS shall:

1\> set the variable PROTOCOL\_ERROR\_INDICATOR to FALSE;

1\> if the USIM is present:

2\> set the value of \"THRESHOLD\" in the variable \"START\_THRESHOLD\"
by the 20 MSBs of the value stored in the USIM (see 3GPP TS 31.102) for
the maximum value of START for each CN Domain;

1\> if the SIM is present:

2\> set the value of \"THRESHOLD\" in the variable \"START\_THRESHOLD\"
to the default value in 3GPP TS 33.102 for each CN Domain.

1\> set the IE \"*Initial MS Identity*\" in the variable
INITIAL\_MS\_IDENTITY according to sub-clause 7.18;

1\> set the contents of the RRC CONNECTION REQUEST message according to
sub-clause 7.5.1.3;

1\> submit the RRC CONNECTION REQUEST message for transmission on the
uplink SRB2;

1\> set counter V300 to 1; and

> 1\> if the RLC sub-layer indicates to the RRC layer a successful
> transmission of the message:

2\> start timer T300;

> 1\> if the RLC sub-layer indicates a link failure to the RRC layer:

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

2\> consider the RRC Connection Establishment procedure to be
unsuccessful;

2\> the procedure ends.

##### 7.5.1.3 RRC CONNECTION REQUEST message contents to set

The MS shall, in the transmitted RRC CONNECTION REQUEST message:

1\> set the IE \"*Establishment Cause*\" to the value of the variable
ESTABLISHMENT\_CAUSE;

1\> set the IE \"*Initial MS Identity*\" to the value of the variable
INITIAL\_MS\_IDENTITY;

1\> set the IE \"*Protocol Error Indicator*\" to the value of the
variable PROTOCOL\_ERROR\_INDICATOR.

##### 7.5.1.4 Reception of an RRC CONNECTION REQUEST message by the GERAN

Upon receiving an RRC CONNECTION REQUEST message, the GERAN shall
either:

1\> submit an RRC CONNECTION SETUP message to the lower layers for
transmission on the downlink SRB2; or

1\> submit an RRC CONNECTION REJECT message on the downlink SRB2. In the
RRC CONNECTION REJECT message, the GERAN may direct the MS to another
GERAN cell. After the RRC CONNECTION REJECT message has been sent, all
context information for the MS may be deleted in GERAN.

##### 7.5.1.5 Cell re-selection or T300 timeout

If the MS has not yet received an RRC CONNECTION SETUP message with the
value of the IE \"*Initial MS Identity*\" equal to the value of the
variable INITIAL\_MS\_IDENTITY and if cell re-selection or expiry of
timer T300 occurs the MS shall:

1\> check the value of V300; and

2\> if V300 is equal to or smaller than N300:

3\> set the IEs in the RRC CONNECTION REQUEST message according to
sub-clause 7.5.1.3;

3\> submit a new RRC CONNECTION REQUEST message to lower layers for
transmission on the uplink SRB2;

3\> increment counter V300;

3\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the RRC CONNECTION REQUEST message:

4\> restart timer T300;

3\> if the RLC sub-layer indicates a link failure to the RRC layer:

4\> enter RRC-Idle mode;

4\> perform the actions specified in clause 6 and in sub sub-clause
7.18;

4\> consider the RRC Connection Establishment procedure to be
unsuccessful;

4\> the procedure ends.

2\> if V300 is greater than N300:

3\> enter RRC-Idle mode.

3\> consider the procedure to be unsuccessful;

3\> other actions the MS shall perform when MS is in RRC-Idle mode are
specified in sub-clause 6;

3\> the procedure ends.

##### 7.5.1.6 Abortion of RRC connection establishment

If the MS has not yet entered GERAN RRC-Connected mode and the RRC
Connection Establishment is to be aborted as specified in sub-clause
7.17.1.4, the MS shall:

1\> consider the procedure to be unsuccessful;

1\> perform the actions when MS is in RRC-Idle mode as specified in
clause 6 and sub-clause 7.18.

The procedure ends.

##### 7.5.1.7 Reception of an RRC CONNECTION SETUP message by the MS

On receipt of an RRC CONNECTION SETUP message with the value of the IE
\"*Initial MS Identity*\" equal to the value of the variable
INITIAL\_MS\_IDENTITY, the MS shall:

1\> stop timer T300, and act upon all received information elements as
specified in sub-clause 7.19, unless specified otherwise in the
following;

2\> if the MS will be in the RRC-Cell\_Shared state at the conclusion of
this procedure:

3\> set the GERAN DRX cycle length coeffcient as specified in sub-clause
7.19;

1\> enter in RRC-Connected mode according to sub-clause 7.19;

1\> submit an RRC CONNECTION SETUP COMPLETE message to the lower layers
on the uplink SRB2 after successful state transition, with the contents
set as specified below:

2\> set the IE \"*RRC Transaction Identifier*\" to

3\> the value of \"RRC transaction identifier\" in the entry for the RRC
CONNECTION SETUP message in the table \"Accepted transactions\" in the
variable TRANSACTIONS; and

3\> clear that entry.

2\> if the USIM or SIM is present:

3\> set the \"START\" for each CN domain in the IE \"*START List*\" in
the RRC CONNECTION SETUP COMPLETE message with the corresponding START
value that is stored in the USIM (see 3GPP TS 31.102) if present, or as
stored in the MS if the SIM is present; and then

3\> set the START value stored in the USIM (see 3GPP TS 31.102) if
present, and as stored in the MS if the SIM is present, for any CN
domain to the value \"THRESHOLD\" of the variable START\_THRESHOLD;

2\> if neither the USIM nor SIM is present:

3\> set the \"START\" for each CN domain in the IE \"*START List*\" in
the RRC CONNECTION SETUP message to zero;

3\> set the value of \"THRESHOLD\" in the variable \"START\_THRESHOLD\"
to the default value as specified in 3GPP TS 33.102.

2\> retrieve its GERAN *Iu mode* MS radio access capability information
elements from variable the MS\_CAPABILITY\_REQUESTED; and then

2\> include this in IE \"*MS* *GERAN Iu mode Radio Access Capability*\",
in the RRC CONNECTION SETUP COMPLETE message;

2\> retrieve its inter-RAT specific MS and UE radio access capability
information elements from the variable MS\_CAPABILITY\_REQUESTED; and
then

2\> include this in structure \"*Inter-RAT MS Radio Access
Capability*\".

The RRC CONNECTION SETUP COMPLETE message is submitted to lower layers
for transmission:

1\> If the RLC sub-layer indicates to the RRC layer a successful
transmission of the RRC CONNECTION SETUP COMPLETE message the MS shall:

2\> if the MS has entered RRC-Cell\_Shared state:

3\> start timer T305 using its initial value if periodical update has
been configured by T305 in the IE \"*MS Timers and Constants in
Connected mode*\" set to any other value than \"infinity\" the variable
TIMERS\_AND\_CONSTANTS ;

2\> store the contents of the variable MS\_CAPABILITY\_REQUESTED into
the variable MS\_CAPABILITY\_TRANSFERRED

2\> initialise variables upon entering RRC-Connected mode as specified
in sub-clause 10.4;

2\> consider the procedure to be successful;

2\> and the procedure ends.

1\> Else, the RLC sub-layer indicates to the RRC layer a link failure
condition. The MS shall:

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 and in sub sub-clause
7.18;

2\> consider the RRC Connection Establishment procedure to be
unsuccessful;

2\> the procedure ends.

##### 7.5.1.8 Cell re-selection

1\> If the MS performs cell re-selection; or

1\> if the MS will be in the RRC-Cell\_Shared state at the conclusion of
this procedure; and

1\> if the contents of the variable G\_RNTI is empty;

1\> after having received an RRC CONNECTION SETUP message; and

1\> before the RRC CONNECTION SETUP COMPLETE message is delivered to
lower layers for transmission:

the MS shall:

1\> clear the entry for the RRC CONNECTION SETUP message in the table
\"Accepted transactions\" in the variable TRANSACTIONS;

1\> check the value of V300, and:

2\> if V300 is equal to or smaller than N300:

3\> set the IEs in the RRC CONNECTION REQUEST message according to
sub-clause 7.5.1.3;

3\> submit a new RRC CONNECTION REQUEST message to the lower layers for
transmission on the uplink SRB2;

3\> increment counter V300; and

3\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

4\> restart timer T300;

3\> if the RLC sub-layer indicates a link failure to the RRC layer:

4\> enter RRC-Idle mode;

4\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

4\> consider the RRC Connection Establishment procedure to be
unsuccessful;

4\> the procedure ends.

2\> if V300 is greater than N300:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 MS is in RRC-Idle mode;

3\> consider the RRC Establishment procedure to be unsuccessful;

3\> the procedure ends.

##### 7.5.1.9 Invalid RRC CONNECTION SETUP message

If the MS receives an RRC CONNECTION SETUP message and the RRC
CONNECTION SETUP message contains a protocol error causing the variable
PROTOCOL\_ERROR\_REJECT to be set to TRUE according to sub-clause 8, the
MS shall perform procedure specific error handling as follows:

1\> clear the entry for the RRC CONNECTION SETUP message in the table
\"Rejected transactions\" in the variable TRANSACTIONS and proceed as
below;

1\> if V300 is equal to or smaller than N300:

2\> set the variable PROTOCOL\_ERROR\_INDICATOR to TRUE;

2\> set the IEs in the RRC CONNECTION REQUEST message according to
sub-clause 7.5.1.3;

2\> submit a new RRC CONNECTION REQUEST message to the lower layers for
transmission on the uplink SRB2;

2\> increment counter V300; and

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T300;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the RRC Connection Establishment procedure to be
unsuccessful;

3\> the procedure ends.

1\> if V300 is greater than N300:

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

2\> consider the RRC Establishment procedure to be unsuccessful;

2\> the procedure ends.

##### 7.5.1.10 Reception of an RRC CONNECTION REJECT message by the MS

When the MS receives an RRC CONNECTION REJECT message on the downlink
SRB2 with the value of the IE \"*Initial MS Identity*\" equal to the
value of the variable INITIAL\_MS\_IDENTITY, the MS shall stop timer
T300 and:

1\> clear the entry for the RRC CONNECTION REJECT message in the table
\"Accepted transactions\" in the variable TRANSACTIONS;

1\> if the IE \"*Wait Time*\" is not equal to \'0\';

2\> if V300 is equal to or smaller than N300:

3\> set the IEs in the RRC CONNECTION REQUEST message according to
7.5.1.3;

3\> then submit a new RRC CONNECTION REQUEST message to the lower layers
for transmission on the uplink SRB2.

3\> increment counter V300; and

3\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

4\> restart timer T300;

3\> if the RLC sub-layer indicates a link failure to the RRC layer:

4\> enter RRC-Idle mode;

4\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

4\> consider the RRC Connection Establishment procedure to be
unsuccessful;

4\> the procedure ends.

2\> if V300 is greater than N300:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when entering RRC-Idle
mode;

mode;

3\> consider the RRC Establishment procedure to be unsuccessful;

3\> the procedure ends.

1\> if the IE \"*Wait Time*\" is equal to \'0\':

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

2\> consider the RRC Establishment procedure to be unsuccessful;

2\> the procedure ends.

##### 7.5.1.11 Invalid RRC CONNECTION REJECT message

If the MS receives an RRC CONNECTION REJECT message which contains a
protocol error causing the variable PROTOCOL\_ERROR\_REJECT to be set to
TRUE according to sub-clause 8, the MS shall perform procedure specific
error handling as follows.

The MS shall:

1\> clear the entry for the RRC CONNECTION REJECT message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

1\> if V300 is equal to or smaller than N300:

2\> set the variable PROTOCOL\_ERROR\_INDICATOR to TRUE;

2\> set the IEs in the RRC CONNECTION REQUEST message according to
sub-clause 7.5.1.3;

2\> submit a new RRC CONNECTION REQUEST message to the lower layers for
transmission on the uplink SRB2;

2\> increment counter V300; and

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T300;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the RRC Connection Establishment procedure to be
unsuccessful;

3\> procedure ends.

1\> if V300 is greater than N300:

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

2\> consider the RRC Establishment procedure to be unsuccessful;

2\> the procedure ends.

### 7.5.2 RRC connection release

Figure 7.5.2.1: RRC Connection Release procedure

#### 7.5.2.1 General

The purpose of this procedure is to release the RRC connection and all
radio bearers between the MS and the GERAN. By doing so, all established
signalling connections will be released.

#### 7.5.2.2 Initiation

When the MS is in state RRC-Cell\_Dedicated state or RRC-Cell\_Shared
state, the GERAN may at anytime initiate an RRC connection release by
transmitting an RRC CONNECTION RELEASE message using SRB2.

#### 7.5.2.3 Reception of an RRC CONNECTION RELEASE message by the MS

The MS shall receive and act on an RRC CONNECTION RELEASE message in
states RRC-Cell\_Dedicated state and RRC-Cell\_Shared state. Furthermore
this procedure can interrupt any ongoing procedures with the MS in the
above listed states.

When the MS receives the RRC CONNECTION RELEASE message, it shall:

1\> in state RRC-Cell\_Dedicated state:

2\> set the IE \"*RRC Transaction Identifier*\" in the RRC CONNECTION
RELEASE COMPLETE message to the value of \"RRC transaction identifier\"
in the entry for the RRC CONNECTION RELEASE message in the table
\"Accepted transactions\" in the variable TRANSACTIONS; and

2\> if the IE \"*RPLMN Information*\" is present:

3\> the MS may:

4\> store the IE on the ME together with the PLMN id for which it
applies;

3\> the MS may then:

4\> utilise this information, typically indicating where a number of
BCCH frequency ranges of a RAT may be expected to be found, during
subsequent RPLMN selections of the indicated PLMN.

2\> submit an RRC CONNECTION RELEASE COMPLETE message to the lower
layers for transmission the SRB2 to the GERAN;

1\> in state RRC-Cell\_Shared state:

2\> set the IE \"RRC *Transaction Identifier* \" in the RRC CONNECTION
RELEASE COMPLETE message to the value of \"RRC transaction identifier\"
in the entry for the RRC CONNECTION RELEASE message in the table
\"Accepted transactions\" in the variable TRANSACTIONS; and

2\> submit an RRC CONNECTION RELEASE COMPLETE message to the lower
layers for transmission using the SRB2;

1\> when the successful transmission of the RRC CONNECTION RELEASE
COMPLETE message has been confirmed by the lower layers:

2\> release all its radio resources; and

2\> indicate the release of the established signalling connections (as
stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers; and

2\> clear any entry for the RRC CONNECTION RELEASE message in the tables
\"Accepted transactions\" and \"Rejected transactions\" in the variable
TRANSACTIONS;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> pass the value of the IE \"*Release Cause*\" received in the RRC
CONNECTION RELEASE message to upper layers;

2\> enter RRC-Idle mode;

2\> perform the actions specified in sub-clause 7.18 and clause 6 when
entering RRC-Idle mode from RRC-Connected mode;

2\> and the procedure ends.

#### 7.5.2.4 Invalid RRC CONNECTION RELEASE message

If the RRC CONNECTION RELEASE message contains a protocol error causing
the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE according to
sub-clause 8, and if the \"protocol error cause\" in
PROTOCOL\_ERROR\_INFORMATION is set to any cause value except \"CSN.1
violation or encoding error\", the MS shall perform procedure specific
error handling as follows.

The MS shall:

1\> ignore any IE(s) causing the error but treat the rest of the RRC
CONNECTION RELEASE message as normal according to sub-clause 7.5.2.3,
with an addition of the following actions;

1\> set the IE \"*RRC Transaction Identifier*\" in the RRC CONNECTION
RELEASE COMPLETE message to the value of \"RRC transaction identifier\"
in the entry for the RRC CONNECTION RELEASE message in the table
\"Rejected transactions\" in the variable TRANSACTIONS; and

1\> include the IE \"*Error Indication*\" in the RRC CONNECTION RELEASE
COMPLETE message with:

2\> the IE \"*Failure Cause*\" set to the cause value \"Protocol
error\"; and

2\> the IE \"*Protocol Error Information*\" set to the value of the
variable PROTOCOL\_ERROR\_INFORMATION.

#### 7.5.2.5 Cell re-selection or radio link failure

If the MS performs cell re-selection or the radio link failure criteria
in sub-clause 7.18 is met at any time during the RRC connection release
procedure and the MS has not yet entered idle mode, the MS shall:

1\> if cell re-selection occurred (RRC-Cell\_Shared state):

2\> perform a Cell Update procedure according to sub-clause 7.8 using
the cause \"cell reselection\";

1\> if radio link failure occurred (RRC-Cell\_Dedicated state):

2\> release all its radio resources;

2\> indicate the release of the established signalling connections (as
stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 and sub-clause 7.18 when
entering RRC-Idle mode from RRC-Connected mode;

2\> and the procedure ends.

#### 7.5.2.6 Reception of an RRC CONNECTION RELEASE COMPLETE message by GERAN

When GERAN receives an RRC CONNECTION RELEASE COMPLETE message from the
MS, it shall:

1\> release all MS dedicated resources and the procedure ends on the
GERAN side.

#### 7.5.2.7 Unsuccessful transmission of the RRC CONNECTION RELEASE COMPLETE message, acknowledged mode transmission

When RLC does not succeed in transmitting the RRC CONNECTION RELEASE
COMPLETE message, the MS shall:

1\> release all its radio resources;

1\> indicate the release of the established signalling connections (as
stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

1\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

1\> clear the variable ESTABLISHED\_RABS;

1\> enter RRC-Idle mode;

1\> perform the actions specified in clause 6 and sub-clause 7.18 when
entering RRC-Idle mode from RRC-Connected mode;

1\> and the procedure ends.

#### 7.5.2.8 Detection of loss of dedicated physical channel by GERAN in RRC-Cell\_Dedicated state

If the release is performed from the state RRC-Cell\_Dedicated state,
and GERAN detects loss of the dedicated basic physical channel according
to sub-clause 7.18, GERAN may release all MS dedicated resources, even
if no RRC CONNECTION RELEASE COMPLETE message has been received.

#### 7.5.2.9 Failure to receive RRC CONNECTION RELEASE COMPLETE message by GERAN

If GERAN does not receive any RRC CONNECTION RELEASE COMPLETE message,
it shall release all MS dedicated resources.

7.6 Transmission of MS capability information
---------------------------------------------

### 7.6.1 General

Figure 7.6.1.1 : Transmission of MS capability information, normal flow

The MS Capability Update procedure is used by the MS to convey MS
specific capability information to the GERAN.

### 7.6.2 Initiation

The MS shall initiate the MS Capability Update procedure in the
following situations:

1\> the MS receives a MS CAPABILITY ENQUIRY message from the GERAN;

1\> while in RRC-Connected mode the MS capabilities change compared to
those stored in the variable MS\_CAPABILITY\_TRANSFERRED.

If the MS CAPABILITY INFORMATION message is sent in response to a MS
CAPABILITY ENQUIRY message, the MS shall:

1\> include the IE \"*RRC Transaction Identifier*\"; and

1\> set it to the value of \"RRC Transaction Identifier\" in the entry
for the MS CAPABILITY ENQUIRY message in the table \"Accepted
transactions\" in the variable TRANSACTIONS;

1\> retrieve the GERAN *Iu mode* radio access capability information
elements from variable MS\_CAPABILITY\_REQUESTED; and

1\> include this in IE \" *MS* *GERAN Iu mode Radio Access
Capability*\", provided this IE is included in variable
MS\_CAPABILITY\_REQUESTED.

1\> retrieve its inter-RAT and inter-mode specific MS radio access
capability information elements from variable MS\_CAPABILITY\_REQUESTED;
and

1\> include this in IE \"*MS GERAN A/Gb mode Radio Access Capability*\",
IE \" *UE UTRAN Radio Access Capability*\", IE \"***UE UTRAN Predefined
Configuration Status Information***\" and in IE \"*UE* *CDMA2000 Radio
Access Capability*\", provided this IE is included in variable
MS\_CAPABILITY\_REQUESTED.

If the MS CAPABILITY INFORMATION message is sent because one or more of
the MS capabilities change compared to those stored in the variable
MS\_CAPABILITY\_TRANSFERRED while in RRC-Connected mode, the MS shall
include the information elements associated with the capabilities that
have changed in the MS CAPABILITY INFORMATION message.

If the MS is in RRC-GRA\_PCH state, it shall first perform a Cell Update
procedure using the cause \"Uplink Data Transmission\", see sub-clause
7.8.

The MS RRC shall submit the MS CAPABILITY INFORMATION message to the
lower layers for transmission on the uplink using SRB2. The MS RRC
shall:

1\> set counter V304 to 1;

1\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

2\> start timer T304;

1\> if the RLC sub-layer indicates a link failure to the RRC layer:

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

2\> consider the MS Capability Update procedure to be unsuccessful;

2\> the procedure ends.

### 7.6.3 Reception of an MS CAPABILITY INFORMATION message by the GERAN

Upon reception of a MS CAPABILITY INFORMATION message, the GERAN should
transmit a MS CAPABILITY INFORMATION CONFIRM message on the downlink
SRB2. After the MS CAPABILITY INFORMATION CONFIRM message has been
submitted to the lower layers for transmission, the procedure is
complete.

### 7.6.4 Reception of the MS CAPABILITY INFORMATION CONFIRM message by the MS

Upon reception of a MS CAPABILITY INFORMATION CONFIRM message, the MS
shall:

1\> stop timer T304;

1\> if there is an entry for the MS CAPABILITY ENQUIRY message present
in the table \"Accepted transactions\" in the variable TRANSACTIONS:

2\> clear that entry.

1\> update its variable MS\_CAPABILITY\_TRANSFERRED with the MS
capabilities it has last transmitted to the GERAN during the current RRC
connection;

1\> clear the variable MS\_CAPABILITY\_REQUESTED;

1\> and the procedure ends.

### 7.6.5 Invalid MS CAPABILITY INFORMATION CONFIRM message

If the MS receives a MS CAPABILITY INFORMATION CONFIRM message, which
contains a protocol error causing the variable PROTOCOL\_ERROR\_REJECT
to be set to TRUE according to sub-clause 8, the MS shall perform
procedure specific error handling as follows:

1\> stop timer T304;

1\> transmit an RRC STATUS message on the uplink using SRB2;

1\> include the IE \"*Identification of Received Message\";* and

1\> set the IE \"*Received Message Type*\" to MS CAPABILITY INFORMATION
CONFIRM; and

1\> set the IE \"*RRC Transaction Identifier*\" to the value of \"RRC
transaction identifier\" in the entry for the MS CAPABILITY INFORMATION
CONFIRM message in the table \"Rejected transactions\" in the variable
TRANSACTIONS; and

1\> clear that entry;

1\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION;

1\> when the RRC STATUS message has been submitted to lower layers for
transmission:

2\> restart timer T304 and continue with any ongoing procedures or
processes as if the invalid MS CAPABILITY INFORMATION CONFIRM message
has not been received.

### 7.6.6 T304 timeout

Upon expiry of timer T304, the MS shall check the value of V304 and:

1\> if V304 is smaller than or equal to N304:

2\> prior to retransmitting the MS CAPABILITY INFORMATION message:

3\> if the IE \"*Status*\" in the variable INTEGRITY\_PROTECTION\_INFO
has the value \"Started\":

4\> include the same IEs as in the last unsuccessful attempt of this
message, except for the IE \"*Integrity Check Info*\", which is modified
as follows:

5\> increment the \"Uplink RRC Message sequence number\" for signalling
radio bearer RB2 in the variable INTEGRITY\_PROTECTION\_INFO by one;

5\> set the IE \"*RRC Message Sequence Number*\" in the IE \"*Integrity
Check Info*\" by the value of the \"Uplink RRC Message sequence number\"
for signalling radio bearer RB2 in the variable
INTEGRITY\_PROTECTION\_INFO in this message;

5\> recalculate the IE \"*Message Authentication Code*\" in the IE
\"*Integrity Check Info*\" in this message, in accordance with
sub-clause 7.18;

3\> else:

4\> include the same IEs as in the last unsuccessful attempt of this
message.

2\> send the MS CAPABILITY INFORMATION message on SRB2;

2\> restart timer T304;

2\> increment counter V304.

1\> if V304 is greater than N304:

2\> initiate the Cell Update procedure as specified in sub-clause 7.8
using the cause \"radio link failure\".

7.7 MS capability enquiry
-------------------------

### 7.7.1 General

Figure 7.7.1.1: MS Capability Enquiry procedure, normal flow

The MS Capability Enquiry procedure can be used to request the MS to
transmit its capability information related to any radio access network
that is supported by the MS. For a multi-RAT MS this procedure allows in
addition to request UTRAN predefined configuration status informatio.

### 7.7.2 Initiation

The MS Capability Enquiry procedure is initiated by the GERAN by
transmitting a MS CAPABILITY ENQUIRY message using SRB2.

### 7.7.3 Reception of an MS CAPABILITY ENQUIRY message by the MS

Upon reception of an MS CAPABILITY ENQUIRY message, the MS shall act on
the received information elements as specified in sub-clause 7.19 and
7.18 and initiate the transmission of MS Capability Information
procedure, which is specified in sub-clause 7.6.

### 7.7.4 Invalid MS CAPABILITY ENQUIRY message

If the MS receives a MS CAPABILITY ENQUIRY message, which contains a
protocol error causing the variable PROTOCOL\_ERROR\_REJECT to be set to
TRUE according to sub-clause 8, the MS shall perform procedure specific
error handling as follows:

1\> transmit an RRC STATUS message on the uplink using SRB2;

1\> include the IE \"*Identification of Received Message\";* and

1\> set the IE \"*Received Message Type*\" to MS CAPABILITY ENQUIRY; and

1\> set the IE \"*RRC Transaction Identifier*\" to the value of \"RRC
transaction identifier\" in the entry for the MS CAPABILITY ENQUIRY
message in the table \"Rejected transactions\" in the variable
TRANSACTIONS; and

1\> clear that entry;

1\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION;

1\> when the RRC STATUS message has been submitted to lower layers for
transmission:

2\> continue with the ongoing processes and procedures as if the invalid
MS CAPABILITY ENQUIRY message has not been received.

7.8 RRC Connection mobility procedures
--------------------------------------

### 7.8.1 Cell and GRA Update procedures

Figure 7.8.1.1: Cell Update procedure, basic flow

Figure 7.8.1.2: Cell Update procedure with update of GERAN mobility
information

Figure 7.8.1.3: Cell Update procedure with radio bearer release

Figure 7.8.1.4: Cell Update procedure with radio bearer reconfiguration

Figure 7.8.1.5: Cell Update procedure, failure case

Figure 7.8.1.6: GRA Update procedure, basic flow

Figure 7.8.1.7: GRA Update procedure with update of GERAN mobility
information

Figure 7.8.1.8: GRA Update procedure, failure case

#### 7.8.1.1 General

The GRA Update and Cell Update procedures serve several main purposes:

\- to notify GERAN of an RLC unrecoverable error (see 3GPP TS 44.160) on
an AM RLC entity;

\- to be used as a supervision mechanism in the RRC-Cell\_Shared state
or RRC-GRA\_PCH state by means of periodical update;

In addition, the GRA Update procedure also serves the following purpose:

\- to retrieve a new GRA identity after cell re-selection to a cell not
belonging to the current GRA assigned to the MS in RRC-GRA\_PCH state;

In addition, the Cell Update procedure also serves the following
purposes:

\- to update GERAN with the current cell the MS is camping on after cell
reselection;

\- to act on a radio link failure or notification of invalid RLC/MAC
control message in the RRC-Cell\_Dedicated state;

\- to act on the transmission failure of the MS CAPABILITY INFORMATION
message;

\- when triggered in the RRC-GRA\_PCH state, to notify GERAN of a
transition to the RRC-Cell\_Shared state due to the reception of GERAN
originated paging or due to a request to transmit uplink data.

The GRA Update and Cell Update procedures may:

\- include an update of mobility related information in the MS;

\- cause a state transition from the RRC-Cell\_Shared state to the
RRC-Cell\_Dedicated state, or from RRC-GRA\_PCH state to RRC-Idle mode.

The Cell Update procedure may also include:

\- a re-establish of layer 2, AM RLC entities;

\- a radio bearer release,or radio bearer reconfiguration;

\- a DBPSCH assignment.

#### 7.8.1.2 Initiation

A MS shall initiate the Cell Update procedure in the following cases:

1\> Uplink data transmission:

2\> if the MS is in RRC-GRA\_PCH state; and

2\> if the MS has uplink signalling or data to transmit except a GRA
UPDATE message;

3\> perform cell update using the cause \"uplink data transmission\".

1\> Paging response:

2\> if the criteria for performing cell update with the cause specified
above in the current sub-clause is not met; and

2\> if the MS in RRC-GRA\_PCH state or RRC-Cell\_Shared state, receives
paging information from the lower layers fulfilling the conditions for
initiating a Cell Update procedure specified in 7.4:

3\> perform cell update using the cause \"paging response\".

1\> Radio link failure:

2\> if none of the criteria for performing cell update with the causes
specified above in the current sub-clause is met; and

3\> if the MS is in RRC-Cell\_Dedicated state; and the criteria for
radio link failure is met as specified in sub-clause 7.18; or

3\> if the criteria for radio link failure is met as specified in
sub-clause 7.18 the transmission of the MS CAPABILITY INFORMATION
message fails as specified in sub-clause 7.6.6:

4\> perform cell update using the cause \"radio link failure\".

1\> Invalid RLC/MAC control message:

2\> if none of the criteria for performing cell update with the causes
specified above in the current sub-clause is met; and

2\> if the MS is in RRC-Cell\_Dedicated state; and

2\> if notification is received of the reception of an invalid RLC/MAC
control message on DBPSCH:

3\> act as specified in sub-clause 7.18.10:

4\> perform cell update using the cause \"invalid RLC/MAC control
message\".

1\> RLC unrecoverable error:

2\> if none of the criteria for performing cell update with the causes
specified above in the current sub-clause is met; and

2\> if the MS detects an RLC unrecoverable error (see 3GPP TS 44.160) in
an AM RLC entity:

3\> perform cell update using the cause \"RLC unrecoverable error\".

1\> Cell reselection:

2\> if none of the criteria for performing cell update with the causes
specified above in the current sub-clause is met; and

2\> if the MS is in RRC-Cell\_Shared state; and

2\> if the MS performs cell re-selection:

3\> perform cell update using the cause \"cell reselection\".

1\> Periodical cell update:

2\> if none of the criteria for performing cell update with the causes
specified above in the current sub-clause is met; and

2\> if the MS is in RRC-Cell\_Shared state; and

2\> if the timer T305 expires;

3\> perform cell update using the cause \"periodical cell update\".

A MS in RRC-GRA\_PCH state shall initiate the GRA Update procedure in
the following cases:

1\> GRA reselection:

2\> if the MS detects that the current GRA assigned to the MS, stored in
the variable GRA\_IDENTITY, is not present in the list of GRA identities
in packet system information 16; or

2\> if the list of GRA identities in packet system information 16 is
empty; or

2\> if the packet system information 16 can not be found:

3\> perform GRA update using the cause \"change of GRA\".

1\> Periodic GRA update:

2\> if the criteria for performing GRA update with the causes as
specified above in the current sub-clause are not met; and

2\> if the timer T305 expires while the MS is in RRC-GRA\_PCH;

3\> perform GRA update using the cause \"periodic GRA update\".

When initiating the GRA Update or Cell Update procedure, the MS shall:

1\> stop timer T305;

1\> if the MS is in RRC-Cell\_Dedicated state:

2\> in the variable RB\_TIMER\_INDICATOR, set the IE \"*T314 Expired*\"
and the IE \"*T315 Expired*\" to FALSE;

2\> if the stored values of the timer T314 and timer T315 are both equal
to zero, or if the stored value of the timer T314 is equal to zero and
there are no radio bearers associated with any radio access bearers for
which in the variable ESTABLISHED\_RABS the value of the IE
\"*Re-establishment timer*\" is set to \"useT315\":

3\> release all its radio resources;

3\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

3\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

3\> clear the variable ESTABLISHED\_RABS;

3\> enter RRC-Idle mode;

3\> perform other actions when entering RRC-Idle mode from RRC-Connected
mode as specified in clause 6 and sub-clause 7.18;

3\> and the procedure ends.

2\> if the stored value of the timer T314 is equal to zero:

3\> release all radio bearers, associated with any radio access bearers
for which in the variable ESTABLISHED\_RABS the value of the IE
\"*Re-establishment Timer*\" is set to \"useT314\";

3\> in the variable RB\_TIMER\_INDICATOR set the IE \"T314 expired\" to
TRUE;

2\> if the stored value of the timer T315 is equal to zero:

3\> release all radio bearers associated with any radio access bearers
for which in the variable ESTABLISHED\_RABS the value of the IE
\"*Re-establishment Timer*\" is set to \"useT315\";

3\> in the variable RB\_TIMER\_INDICATOR set the IE \"T315 expired\" to
TRUE;

2\> if the stored value of the timer T314 is greater than zero:

3\> if there are radio bearers associated with any radio access bearers
for which in the variable ESTABLISHED\_RABS the value of the IE
\"*Re-establishment Timer*\" is set to \"useT314\":

4\> start timer T314.

2\> if the stored value of the timer T315 is greater than zero:

3\> if there are radio bearers associated with any radio access bearers
for which in the variable ESTABLISHED\_RABS the value of the IE
\"*Re-establishment timer*\" is set to \"useT315\":

4\> start timer T315.

2\> for the released radio bearer(s):

3\> delete the information about the radio bearer from the variable
ESTABLISHED\_RABS;

3\> when all radio bearers belonging to the same radio access bearer
have been released:

4\> indicate local end release of the radio access bearer to upper
layers using the CN domain identity together with the RAB identity
stored in the variable ESTABLISHED\_RABS;

4\> delete all information about the radio access bearer from the
variable ESTABLISHED\_RABS;

2\> set the variable ORDERED\_RECONFIGURATION to FALSE;

1\> set the variables PROTOCOL\_ERROR\_INDICATOR, FAILURE\_INDICATOR,
UNSUPPORTED\_CONFIGURATION and INVALID\_CONFIGURATION to FALSE;

1\> set the variable CELL\_UPDATE\_STARTED to TRUE;

1\> in case of a Cell Update procedure:

2\> set the contents of the CELL UPDATE message according to sub-clause
7.8.1.3;

2\> submit the CELL UPDATE message for transmission on the SRB2;

1\> in case of a GRA Update procedure:

2\> set the contents of the GRA UPDATE message according to sub-clause
7.8.1.3;

2\> submit the GRA UPDATE message for transmission on the SRB2;

1\> set counter V302 to 1;

1\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

2\> start timer T302;

> 1\> if the RLC sub-layer indicates a link failure to the RRC layer:

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

2\> consider the GRA Update procedure or Cell Update procedure to be
unsuccessful;

2\> the procedure ends.

#### 7.8.1.3 CELL UPDATE / GRA UPDATE message contents to set

In case of Cell Update procedure the MS shall transmit a CELL UPDATE
message.

In case of GRA Update procedure the MS shall transmit a GRA UPDATE
message.

The MS shall set the IEs in the CELL UPDATE message as follows:

1\> set the IE \"*Cell Update Cause*\" corresponding to the cause
specified in sub-clause 7.8.1.2 that is valid when the CELL UPDATE
message is submitted to lower layers for transmission;

NOTE: During the time period starting from when a cell update procedure
is initiated by the MS until when the procedure ends, additional CELL
UPDATE messages may be transmitted by the MS with different causes.

1\> set the IE \"*G-RNTI*\" to the value of the variable G-RNTI;

1\> if the value of the variable PROTOCOL\_ERROR\_INDICATOR is TRUE:

2\> include the IE \"*RRC Transaction Identifier*\"; and

3\> set it to the value of \"RRC Transaction Identifier\" in the entry
for the CELL UPDATE CONFIRM message in the table \"Rejected
transactions\" in the variable TRANSACTIONS;

2\> include and set the IE \"*Failure Cause*\" to the cause value
\"protocol error\";

2\> set the IE \"*Protocol Error Information*\" set to the value of the
variable PROTOCOL\_ERROR\_INFORMATION;

1\> if the value of the variable FAILURE\_INDICATOR is TRUE:

2\> include the IE \"*RRC Transaction Identifier*\"; and

3\> set it to the value of \"RRC Transaction Identifier\" in the entry
for the CELL UPDATE CONFIRM message in the table \"Accepted
transactions\" in the variable TRANSACTIONS;

2\> include and set the IE \"*Failure Cause*\" to the value of the
variable FAILURE\_CAUSE;

1\> include the START values for each CN domain, calculated according to
sub-clause 7.18;

1\> if an unrecoverable error (see 3GPP TS 44.160) in any of the AM RLC
entities for the signalling radio bearers SRB2, SRB3 or SRB4 is
detected:

2\> set the IE \"*AM\_RLC error indication for c-plane*\" to TRUE;

1\> otherwise:

2\> set the IE \"*AM\_RLC error indication for c-plane\"* to FALSE;

1\> if an unrecoverable error (see 3GPP TS 44.160) in any of the AM RLC
entities for the RB5 or upward is detected:

2\> set the IE \"*AM\_RLC error indication for u-plane*\" to TRUE;

1\> otherwise:

2\> set the IE \"*AM\_RLC error indication for u-plane*\" to FALSE;

1\> set the IE \"*RB Timer Indicator*\" to the value of the variable
RB\_TIMER\_INDICATOR;

The MS shall set the IEs in the GRA UPDATE message as follows:

1\> set the IE \"*G-RNTI*\" to the value of the variable G-RNTI;

1\> set the IE \"*GRA* *Update Cause*\" corresponding to which cause as
specified in sub-clause 7.8.1.2 that is valid when the GRA UPDATE
message is submitted to lower layers for transmission;

2\> if the value of the variable PROTOCOL\_ERROR\_INDICATOR is TRUE:

3\> include the IE \"*RRC Transaction Identifier*\"; and

4\> set it to the value of \"RRC Transaction Identifier\" in the entry
for the GRA UPDATE CONFIRM message in the table \"Rejected
transactions\" in the variable TRANSACTIONS;

3\> set the IE \"*Protocol Error Indicator*\" to TRUE;

3\> include the IE \"*Protocol Error Information*\" set to the value of
the variable PROTOCOL\_ERROR\_INFORMATION.

2\> if the value of the variable PROTOCOL\_ERROR\_INDICATOR is FALSE:

3\> if the value of the variable INVALID\_CONFIGURATION is TRUE:

4\> include the IE \"*RRC Transaction Identifier*\"; and

5\> set it to the value of \"RRC transaction identifier\" in the entry
for the GRA UPDATE CONFIRM message in the table \"Accepted
transactions\" in the variable TRANSACTIONS;

4\> set the IE \" *Protocol Error Indicator* \" to TRUE;

4\> include the IE \"*Protocol Error Information*\" set to \"Information
element value not comprehended\";

3\> if the value of the variable INVALID\_CONFIGURATION is FALSE:

4\> set the IE \"*Protocol Error Indicator*\" to FALSE.

#### 7.8.1.4 Reception of an CELL UPDATE/GRA UPDATE message by the GERAN

When the GERAN receives a CELL UPDATE/GRA UPDATE message, the GERAN
shall:

1\> in case the procedure was triggered by reception of a CELL UPDATE:

2\> if SBSS relocation was performed:

3\> transmit a CELL UPDATE CONFIRM message on the downlink SRB2.

2\> if SBSS relocation was not performed:

3\> update the START value for each CN domain as maintained in GERAN
sub-clause 7.18 with \"START\" in the IE \"*START List*\" for the CN
domain as indicated by \"*CN Domain Identity*\" IE in the IE \"*START
List*\";

3\> transmit a CELL UPDATE CONFIRM message on the SRB2;

3\> optionally set the IE \"*RLC re-establish indicator (RB2, RB3 and
RB4)*\" and/or the IE \"*RLC re-establish indicator (RB5 and upwards*)\"
to TRUE to request a RLC re-establishment in the MS, in which case the
corresponding RLC entities shall also be re-established in GERAN; or

1\> in case the procedure was triggered by reception of a GRA UPDATE:

2\> if SBSS relocation was performed:

3\> transmit a GRA UPDATE CONFIRM message on the downlink SRB2;

2\> if SBSS relocation was not performed:

3\> transmit a GRA UPDATE CONFIRM message to the lower layers for
transmission on SRB2 in which case the GERAN should include the IE
\"*GRA Identity*\" in the GRA UPDATE CONFIRM message in a cell where
multiple GRA identifiers are broadcast; or

1\> initiate an RRC Connection Release procedure (see sub-clause 7.5.2)
by transmitting an RRC CONNECTION RELEASE message on the SRB2. In
particular GERAN shall:

2\> if the CELL UPDATE message was sent because of an unrecoverable
error in SRB2, SRB3 or SRB4:

3\> initiate an RRC Connection Release procedure (sub-clause 7.5.2) by
transmitting an RRC CONNECTION RELEASE message on the SRB2.

#### 7.8.1.5 Reception of the CELL UPDATE CONFIRM/GRA UPDATE CONFIRM message by the MS

When the MS receives a CELL UPDATE CONFIRM/GRA UPDATE CONFIRM message
the MS shall:

1\> stop timer T302;

1\> in case of a Cell Update procedure and the CELL UPDATE CONFIRM
message:

2\> include one of the RB information elements (*RB Information to
Release list, RB Information to Reconfigure list, RB Information to Be
Affected list*); and/or

2\> include one of the following Transport Channel information elements
(IE \"*Added or Reconfigured UL TrCH Information*\", IE \"*Added or
Reconfigured DL TrCH Information*\", IE \"*Deleted DL TrCH
Information*\", IE \"*Deleted DL TrCH Information*\"); and/or

2\> include the IE \"*DBPSCH Description*\" and structure \"Network
Response Times\"; and

2\> if the variable ORDERED\_RECONFIGURATION is set to FALSE:

3\> set the variable ORDERED\_RECONFIGURATION to TRUE;

1\> act upon all received information elements as specified in
sub-clause 7.19 unless specified otherwise in the following;

2\> if the field \"*RLC Re-establish indicator SRB2-4*\" in the CELL
UPDATE CONFIRM message is set to one:

3\> if the struct \"Downlink counter synchronisation info\" is not
included in the CELL UPDATE CONFIRM message:

4\> re-establish the RLC entities for signalling radio bearer SRB2,
signalling radio bearer SRB3 and signalling radio bearer SRB4 (if
established);

3\> if the value of the IE \"*Status*\" in the variable
CIPHERING\_STATUS of the CN domain stored in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN is set to \"Started\":

4\> set the HFN component of the respective COUNT-C values for AM RLC
entities SRB2, SRB3 and SRB4 (if established) equal to the START value
included in the latest transmitted CELL UPDATE message for the CN domain
stored in the variable LATEST\_CONFIGURED\_CN\_DOMAIN.

2\> if the field \"*RLC re-establish indicator RB5+*\" \" in the CELL
UPDATE CONFIRM message is set to one:

3\> for radio bearers with RB identity larger than 4:

4\> if the struct \"Downlink counter synchronisation info\" is not
included in the CELL UPDATE CONFIRM message:

5\> re-establish the AM RLC entities;

4\> if the value of the IE \"*Status*\" in the variable
CIPHERING\_STATUS of the CN domain as indicated in the IE \"*CN Domain
Identity*\" in the IE \"*RAB Info*\" in the variable ESTABLISHED\_RABS
is set to \"Started\":

5\> set the HFN component of the respective COUNT-C values for AM RLC
entities equal to the START value included in the latest transmitted
CELL UPDATE message for the CN domain as indicated in the IE \"CN domain
identity\" in the IE \"RAB info\" in the variable ESTABLISHED\_RABS.

1\> if the CELL UPDATE CONFIRM / GRA UPDATE CONFIRM message contained
the IE \"*Ciphering Mode Info*\" or contained the IE \"*Integrity
Protection Mode Info*\":

2\> set the IE \"*Status*\" in the variable SECURITY\_MODIFICATION for
all the CN domains in the variable SECURITY\_MODIFICATION to
\"Affected\";

1\> enter a state according to sub-clause 7.19 applied on the CELL
UPDATE CONFIRM / GRA UPDATE CONFIRM message.

If the MS after state transition remains in RRC-Cell\_Shared state, it
shall

1\> start the timer T305 using its initial value if timer T305 is not
running and periodical cell update has been configured by T305 in the IE
\"*MS Timers and Constants in Connected mode*\" set to any other value
than \"infinity\";

1\> if the CELL UPDATE CONFIRM / GRA UPDATE CONFIRM message contained
the IE \"*GERAN DRX Cycle Length Coefficient*\":

2\> use the value in the IE \"*GERAN DRX Cycle Length Coefficient*\" for
calculating Paging occasion as specified in sub-clause 7.19;

If the MS after state transition enters RRC-GRA\_PCH state, it shall

1\> start the timer T305 using its initial value if timer T305 is not
running and periodical update has been configured by T305 in the IE
\"*MS Timers and Constants in Connected mode*\" set to any other value
than \"infinity\";

The MS after state transition shall:

1\> if the CELL UPDATE CONFIRM / GRA UPDATE CONFIRM message contained
the IE \"*Ciphering Mode Info*\":

2\> include and set the IE \"*Radio Bearer Uplink Ciphering Activation
Time Info*\" in any response message transmitted below to the value of
the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO.

1\> in case cell reselection interrupted an ongoing cell update
procedure and a CELL UPDATE CONFIRM/GRA UPDATE CONFIRM was received with
the IE \"*Downlink counter synchronisation info*\" present and the
response to which was not submitted to the lower layers due to the cell
re-selection:

2\> include the IE \"*START list*\" in the response message transmitted
according to sub-clause 7.8.1.6;

2\> if the CELL UPDATE CONFIRM/GRA UPDATE CONFIRM, the response to which
was not delivered to the lower layers, due to the cell re-selection,
included the IE \"*RB with PDCP information list*\":

3\> include the IE \"*RB with PDCP information list*\" in the response
message transmitted according to sub-clause 7.8.1.6;

1\> in case of a Cell Update procedure:

2\> set the IE \"*RRC Transaction Identifier*\" in any response message
transmitted below to the value of \"RRC transaction identifier\" in the
entry for the CELL UPDATE CONFIRM message in the table \"Accepted
transactions\" in the variable TRANSACTIONS; and

2\> clear that entry.

1\> in case of a GRA Update procedure:

2\> set the IE \"*RRC Transaction Identifier*\" in any response message
transmitted below to the value of \"RRC transaction identifier\" in the
entry for the GRA UPDATE CONFIRM message in the table \"Accepted
transactions\" in the variable TRANSACTIONS; and

2\> clear that entry;

1\> if the variable PDCP\_SN\_INFO is non-empty:

2\> include the IE \"*RB with PDCP Information List*\" in any response
message transmitted below and set it to the value of the variable
PDCP\_SN\_INFO;

1\> if the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message
included the structure \"*Downlink Counter Synchronisation Info*\":

2\> if the variable PDCP\_SN\_INFO is empty:

3\> configure the corresponding RLC entity for all AM and UM radio
bearers and AM and UM signalling radio bearers except SRB2 to \"stop\";

2\> else:

3\> configure the RLC entity for signalling radio bearers SRB1, SRB3 and
SRB4 to \"stop\";

3\> configure the RLC entity for UM and AM radio bearers for which the
IE \"*PDCP SN Info*\" is not included to \"stop\";

2\> re-establish SRB2;

2\> for the downlink and the uplink, apply the ciphering configuration
as follows:

3\> if the received re-configuation message included the IE \"*Ciphering
Mode Info*\":

4\> use the ciphering configuration in the received message when
transmitting the response message;

3\> if the ciphering configuration for SRB2 from a previously received
SECURITY MODE COMMAND has not yet been applied because of the activation
times not having been reached:

4\> if the previous SECURITY MODE COMMAND was received due to new keys
being received:

5\> consider the new ciphering configuration to include the received new
keys;

5\> initialise the HFN component of the uplink COUNT-C and downlink
COUNT-C of SRB2 as indicated in subclause 7.16.1.2.3.1.

4\> if the ciphering configuration for SRB2 from a previously received
SECURITY MODE COMMAND has not yet been applied because of the
corresponding activation times not having been reached and the previous
SECURITY MODE COMMAND caused a change in LATEST\_CONFIGURED\_CN\_DOMAIN:

5\> consider the new ciphering configuration to include the keys
associated with the LATEST\_CONFIGURED\_CN\_DOMAIN;

5\> initialise the HFN component of the uplink COUNT-C and downlink
COUNT-C of SRB2 to the most recently transmitted IE \"*START List*\" or
IE \"*START*\" for the LATEST\_CONFIGURED\_CN\_DOMAIN at the reception
of the previous SECURITY MODE COMMAND message.

4\> apply the new ciphering configuration immediately following RLC
re-establishment.

3\> else:

4\> continue using the current ciphering configuration;

2\> set the new uplink and downlink HFN of SRB2 to MAX(uplink HFN of
SRB2, downlink HFN of SRB2);

2\> increment by one the downlink and uplink HFN values for SRB2;

2\> calculate the START value according to sub-clause 7.18;

2\> include the calculated START values for each CN domain in the IE
\"*START List*\" in the structure \"*Uplink Counter Synchronisation
Info*\" in any response message transmitted below;

2\> if the cell reselection from UTRAN is performed :

3\> set the 20 most significant bits of the uplink and downlink HFN
component of COUNT-C of SRB2 to MAX(uplink HFN~U~, downlink HFN~U~)
where HFN~U~ is the HFN component of COUNT-C of SRB2 in UTRAN;

3\> set the remaining bits of the uplink and downlink HFN component of
COUNT-C of SRB2 equal to zero;

3\> calculate the START value according to sub-clause 7.18;

3\> include the calculated START values for each CN domain in the IE
\"*START list*\" in the GERAN MOBILITY INFORMATION CONFIRM message;

3\> set the variable LATEST\_CONFIGURED\_CN\_DOMAIN equal to the
corresponding UTRAN variable *;*

3\> set the variable MS\_CAPABILITY\_TRANSFERRED equal to the
corresponding UTRAN variable *;*

3.  set the variable ESTABLISHED\_RABS equal to the corresponding UTRAN
    variable *;*

3\> set the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS equal to the
corresponding UTRAN variable *;*

> 3\> set the variable CIPHERING\_STATUS equal to the corresponding
> UTRAN variable*;*

3.  set the variable START\_THRESHOLD equal to the corresponding UTRAN
    variable *;*

3\> set the variable START\_VALUE\_TO\_TRANSMIT equal to the
corresponding UTRAN variable*;*

3\> set IE \"*Status*\" for the ciphering status in the the variable
SECURITY\_MODIFICATION equal to the corresponding UTRAN variable;

3\> set IE \"*Status*\" for the integrity protection in the variable
INTEGRITY\_PROTECTION\_INFO equal to the corresponding UTRAN variable;

1\> transmit a response message as specified in sub-clause 7.8.1.6;

1\> if the IE \"*Integrity Protection Mode Info*\" was present in the
CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message:

2\> start applying the new integrity protection configuration in the
uplink for signalling radio bearer SRB2 from and including the
transmitted response message;

1\> if the variable ORDERED\_RECONFIGURATION is set to TRUE caused by
the received CELL UPDATE CONFIRM message in case of a cell update
procedure:

2\> set the variable ORDERED\_RECONFIGURATION to FALSE;

1\> clear the variable PDCP\_SN\_INFO;

1\> when the response message transmitted per sub-clause 7.8.1.6 to the
GERAN has been confirmed by RLC:

2\> if the CELL UPDATE CONFIRM / GRA UPDATE CONFIRM message contained
the IE \"*Ciphering Mode Info*\":

3\> resume data transmission on any suspended radio bearer and
signalling radio bearer mapped on RLC-AM or RLC-UM;

3\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

3\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> if the CELL UPDATE CONFIRM / GRA UPDATE CONFIRM message contained
the IE \"*Integrity Protection Mode Info*\":

3\> allow the transmission of RRC messages on all signalling radio
bearers with any RRC SN;

3\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

1\> in case of a Cell Update procedure:

2\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

1\> in case of a GRA update procedure:

2\> clear the entry for the GRA UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

1\> set the variable CELL\_UPDATE\_STARTED to FALSE;

1\> clear the variable SECURITY\_MODIFICATION.

The procedure ends.

#### 7.8.1.6 Transmission of a response message to GERAN

If the CELL UPDATE CONFIRM message

\- includes the IE \"*RB Information to Release List*\":

the MS shall:

1\> transmit a RADIO BEARER RELEASE COMPLETE as response message using
SRB2.

If the CELL UPDATE CONFIRM message

\- does not include the IE \"*RB Information to Release List*\"; and

\- includes the IE \"*RB Information to Reconfigure List*\"; or

\- includes the IE \"*RB Information to Be Affected List*\"; and

\- does not include Transport channel information elements (IE \"*Added
or Reconfigured UL TrCH Information\"*, IE \"*Added or Reconfigured DL
TrCH Information\"*, IE \"*Deleted DL TrCH Information\",* IE \"*Deleted
UL TrCH Information\"*); and

\- does not include the IE \"*DBPSCH Description\"*:

the MS shall:

1\> transmit a RADIO BEARER RECONFIGURATION COMPLETE as response message
using SRB2.

If the CELL UPDATE CONFIRM message:

\- does not includethe IE \"*RB Information to Release list\"*; and

\- does not include the IE \"*RB Information to Be Affected list\"*; and

\- includes the IE \"*RB Information to Reconfigure list\"*; and

\- does not include Transport channel information elements (IE \"*Added
or Reconfigured UL TrCH Information\"*, IE \"*Added or Reconfigured DL
TrCH Information\"*, IE \"*Deleted DL TrCH Information\",* IE \"*Deleted
UL TrCH Information\"*); and

\- includes the IE \"*DBPSCH description*\":

the MS shall:

1\> transmit a RADIO BEARER SETUP COMPLETE as response message on SRB2.

If the CELL UPDATE CONFIRM message

\- does not include RB Information Elements (*RB Information to Release
list, RB Information to Reconfigure list, RB Information to Be Affected
list)*; and

\- does not include Transport channel information elements (IE \"*Added
or Reconfigured UL TrCH Information\"*, IE \"*Added or Reconfigured DL
TrCH Information\"*, IE \"*Deleted DL TrCH Information\",* IE \"*Deleted
UL TrCH Information\"*); and- includes the IE \"*CN Information Info*\";
or

\- includes the IE \"*Ciphering Mode Info*\"; or

\- includes the IE \"*Integrity Protection Mode Info*\"; or

\- includes the IE \"*New G-RNTI*\", or

\- includes the struct \"Downlink Counter Synchronisation Info\" and the
IE \"*New G-RNTI*\":

the MS shall:

1\> transmit a GERAN MOBILITY INFORMATION CONFIRM as response message on
the SRB2.

If the CELL UPDATE CONFIRM message:

\- does not include RB Information Elements (*RB Information to Release
list, RB Information to Reconfigure list, RB Information to Be Affected
list*); and

\- includes at least one of the following Transport channel information
(IE \"*Added or Reconfigured UL TrCH Information\"*, IE \"*Added or
Reconfigured DL TrCH Information\"*, IE \"*Deleted DL TrCH
Information\",* IE \"*Deleted UL TrCH Information\"*):

the MS shall:

1\> transmit a RADIO BEARER RECONFIGURATION COMPLETE as response message
using SRB2.

If the CELL UPDATE CONFIRM message:

\- does not include RB Information Elements (*RB Information to Release
list, RB Information to Reconfigure list, RB Information to Be Affected
list*); and

\- does not include \"*CN Information Info*\"; and

\- does not include the IE \"*Ciphering Mode Info*\"; and

\- does not include Transport channel information elements (IE \"*Added
or Reconfigured UL TrCH Information\"*, IE \"*Added or Reconfigured DL
TrCH Information\"*, IE \"*Deleted DL TrCH Information\",* IE \"*Deleted
UL TrCH Information\"*); and

\- does not include the IE \"*Integrity Protection Mode Info*\"; and

\- does not include the IE \"*New G-RNTI*\":

the MS shall:

1\> transmit no response message.

If the GRA UPDATE CONFIRM message:

\- includes the IEs \"*CN Information Info*\"; or

\- includes the IE \"*Ciphering Mode Info*\"; or

\- includes the IE \"*Integrity Protection Mode Info*\"; or

\- includes the IE \"*New G-RNTI*\", or

\- includes the struct \"Downlink Counter Synchronisation Info\" and the
IE \"*New G-RNTI*\"

the MS shall:

1\> transmit a GERAN MOBILITY INFORMATION CONFIRM as response message on
SRB2.

If the GRA UPDATE CONFIRM message:

\- does not include \"*CN Information Info*\" ; and

\- does not include the IE \" *Ciphering Mode Info* \"; and

\- does not include the IE \" *Integrity Protection Mode Info* \"; and

\- does not include the IE \"*New G-RNTI*\"; and

the MS shall:

1\> transmit no response message.

If the new state is RRC-Cell\_Dedicated or RRC-Cell\_Shared state, the
response message shall be transmitted using the new configuration after
the state transition, and the MS shall:

1\> if the structure \"*Downlink Counter Synchronisation Info*\" was
included in the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM
message:

2\> when RLC has confirmed the successful transmission of the response
message:

3\> if the variable PDCP\_SN\_INFO is empty:

4\> configure the RLC entity for all AM and UM radio bearers and AM and
UM signalling radio bearers except SRB2 to \"continue\";

3\> else:

4\> configure the RLC entity for signalling radio bearers SRB1, SRB3 and
SRB4 to \"continue\";

4\> configure the RLC entity for UM and AM radio bearers for which the
IE \"*PDCP SN Info*\" is not included to \"continue\";

3\> re-establish all AM and UM RLC entities with RB identities larger
than 4 and set the first 20 bits of all the HFN component of the
respective COUNT-C values to the START value included in the response
message for the corresponding CN domain;

3\> re-establish the RLC entities with RB identities 1, 3 and 4 and set
the first 20 bits of all the HFN component of the respective COUNT-C
values to the START value included in the response message for the CN
domain stored in the variable LATEST\_CONFIGURED\_CN\_DOMAIN;

3\> set the remaining bits of the HFN component of the COUNT-C values of
all UM RLC entities to zero;

3\> set the remaining bits of the HFN component of the COUNT-C values of
all AM RLC entities to zero, for those bearers to which RLC entitie
where re-established;

3\> if the IE \"*PDCP Context Relocation Info*\" is not present:

4\> re-initialise the PDCP header compression entities of each radio
bearer in the variable ESTABLISHED\_RABS as specified in
3GPP TS 25.323;.

3\> if the IE \"*PDCP Context Relocation Info\"* is present:

4\> perform the actions as specified in 7.19.

1\> if the variable PDCP\_SN\_INFO is empty:

2\> if the CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message contained
the IE \"*Ciphering Mode Info*\":

3\> when RLC has confirmed the successful transmission of the response
message:

4\> continue with the remainder of the procedure;

2\> if the CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message did not
contain the IE \"*Ciphering Mode Info*\":

3\> when RLC has been requested to transmit the response message,

4\> continue with the remainder of the procedure;

1\> if the variable PDCP\_SN\_INFO non-empty:

2\> when RLC has confirmed the successful transmission of the response
message:

3\> for each radio bearer in the variable PDCP\_SN\_INFO:

4\> if the IE \"*RB Started*\" in the variable ESTABLISHED\_RABS is set
to \"started\":

5\> configure the RLC entity for that radio bearer to \"continue\";

3\> continue with the remainder of the procedure.

If the new RRC state is RRC-GRA\_PCH state, the response message shall
be transmitted in RRC-Cell\_Shared state, and the MS shall:

1\> when RLC has confirmed the successful transmission of the response
message:

2\> if the IE \"*Downlink Counter Synchronisation Info*\" was included
in the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message:

3\> re-establish all AM and UM RLC entities with RB identities larger
than 4 and set the first 20 bits of all the HFN component of the
respective COUNT-C values to the START value included in the response
message for the corresponding CN domain;

3\> re-establish the RLC entities with RB identities 1, 3 and 4 and set
the first 20 bits of all the HFN component of the respective COUNT-C
values to the START value included in the response message for the CN
domain stored in the variable LATEST\_CONFIGURED\_CN\_DOMAIN;

3\> set the remaining bits of the HFN component of the COUNT-C values of
all UM RLC entities to zero;

3\> set the remaining bits of the HFN component of the COUNT-C values of
all AM RLC entities to zero, for those bearers to which RLC entitie
where re-established;

3\> re-initialise the PDCP header compression entities of each radio
bearer in the variable ESTABLISHED\_RABS as specified in 3GPP TS 25.323.

2\> for each radio bearer in the variable PDCP\_SN\_INFO:

3\> if the IE \"*RB Started*\" in the variable ESTABLISHED\_RABS is set
to \"started\":

4\> configure the RLC entity for that radio bearer to \"continue\";

2\> enter the RRC-GRA\_PCH state;

1\> continue with the remainder of the procedure.

#### 7.8.1.7 Physical channel failure

If the received CELL UPDATE CONFIRM message would cause the MS to
transit to RRC-Cell\_Dedicated state; and

1\> if the MS failed to establish the physical channel(s) indicated in
the received CELL UPDATE CONFIRM message according to the criteria
defined in sub-clause 7.8.1.6 are not fulfilled; or

1\> the received CELL UPDATE CONFIRM message does not contain the IE
\"*DBPSCH Description*\";

the MS shall:

1\> the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS is
set to TRUE; and/or

1\> the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO is set to TRUE:

2\> abort the ongoing integrity and/or ciphering reconfiguration;

2\> if the received CELL UPDATE CONFIRM message contained the IE
\"*Ciphering Mode Info*\":

3\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

3\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> if the received CELL UPDATE CONFIRM message contained the IE
\"*Integrity Protection Mode Info*\":

3\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

3\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

1\> if the variable ORDERED\_RECONFIGURATION is set to TRUE caused by
the received CELL UPDATE CONFIRM message:

2\> set the variable ORDERED\_RECONFIGURATION to FALSE;

1\> if V302 is equal to or smaller than N302:

2\> select a suitable GERAN cell according to 3GPP TS 45.008;

2\> set the contents of the CELL UPDATE message according to sub-clause
7.8.1.3, except for the IE \"*Cell Update Cause*\" which shall be set to
\"radio link failure\";

2\> submit the CELL UPDATE message for transmission on the uplink SRB2;

2\> increment counter V302; and

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T302;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the Cell Update procedure to be unsuccessful;

3\> the procedure ends.

1\> if V302 is greater than N302:

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> in case of a cell update procedure:

3\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> release all its radio resources;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> enter RRC-Idle mode.

#### 7.8.1.8 Unsupported configuration by the MS

If the MS does not support the configuration in the CELL UPDATE CONFIRM
message and/or the variable UNSUPPORTED\_CONFIGURATION is set to TRUE,
the MS shall:

1\> if V302 is equal to or smaller than N302, the MS shall:

2\> if, caused by the received CELL UPDATE CONFIRM message

3\> the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS is
set to TRUE; and/or

3\> the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO is set to TRUE:

4\> abort the ongoing integrity and/or ciphering reconfiguration;

4\> if the received CELL UPDATE CONFIRM message contained the IE
\"*Ciphering Mode Info*\":

5\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

5\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

4\> if the received CELL UPDATE CONFIRM message contained the IE
\"*Integrity Protection Mode Info*\":

5\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

5\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> if the variable ORDERED\_RECONFIGURATION is set to TRUE caused by
the received CELL UPDATE CONFIRM message in case of a cell update
procedure:

3\> set the variable ORDERED\_RECONFIGURATION to FALSE;

2\> set the variable FAILURE\_INDICATOR to TRUE;

2\> set the variable FAILURE\_CAUSE to \"configuration unsupported\";

2\> set the content of the CELL UPDATE message according to 7.8.1.3;

2\> submit the CELL UPDATE message for transmission on the uplink SRB2;

2\> increment counter V302; and

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T302;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the Cell Update procedure to be unsuccessful;

3\> the procedure ends.

1\> if V302 is greater than N302, the MS shall:

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> clear the variable PDCP\_SN\_INFO;

2\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> release all its radio resources;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> enter RRC-Idle mode;

2\> other actions the MS shall perform when entering RRC-Idle mode from
RRC-Connected mode are specified in sub-clause 7.18;

2\> and the procedure ends.

#### 7.8.1.9 Invalid configuration

If the variable INVALID\_CONFIGURATION is set to TRUE, the MS shall:

1\> if V302 is equal to or smaller than N302:

2\> if, caused by the received CELL UPDATE CONFIRM message

3\> the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS is
set to TRUE; and/or

3\> the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO is set to TRUE:

4\> abort the ongoing integrity and/or ciphering reconfiguration;

4\> if the received CELL UPDATE CONFIRM message contained the IE
\"*Ciphering Mode Info*\":

5\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

5\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

4\> if the received CELL UPDATE CONFIRM message contained the IE
\"*Integrity Protection Mode Info*\";

5\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

5\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> if the variable ORDERED\_RECONFIGURATION is set to TRUE caused by
the received CELL UPDATE CONFIRM message in case of a cell update
procedure:

3\> set the variable ORDERED\_RECONFIGURATION to FALSE;

2\> in case of a Cell Update procedure:

3\> set the variable FAILURE\_INDICATOR to TRUE;

3\> set the variable FAILURE\_CAUSE to \"Invalid configuration\";

3\> set the contents of the CELL UPDATE message according to sub-clause
7.8.1.3;

3\> submit the CELL UPDATE message for transmission on the uplink SRB2;

2\> in case of a GRA Update procedure:

3\> set the contents of the GRA UPDATE message according to sub-clause
7.8.1.3;

3\> submit the GRA UPDATE message for transmission on the uplink SRB2;

2\> increment counter V302; and

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T302;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the Cell Update procedure or GRA Update procedure to be
unsuccessful;

3\> the procedure ends.

1\> if V302 is greater than N302:

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> clear the variable PDCP\_SN\_INFO;

2\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> release all its radio resources;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> enter RRC-Idle mode;

2\> other actions the MS shall perform when entering RRC-Idle mode from
RRC-Connected mode are specified in sub-clause 7.18;

1\> the procedure ends.

#### 7.8.1.10 Incompatible simultaneous reconfiguration

In case of a cell update procedure and if the received CELL UPDATE
CONFIRM message:

\- includes RB information elements (*RB Information to Release list, RB
Information to Reconfigure list, RB Information to Be Affected list)* ;
and

\- if the variable ORDERED\_RECONFIGURATION is set to TRUE because of an
ongoing Reconfiguration procedure;

or

\- includes RB information elements (*RB Information to Release list, RB
Information to Reconfigure list, RB Information to Be Affected list)*
and Transport channel information elements (IE \"*Added or Reconfigured
UL TrCH Information*\", IE \"*Added or Reconfigured DL TrCH
Information*\", IE \"*Deleted DL TrCH Information*\", IE \"*Deleted UL
TrCH Information*\"); and

\- if the variable ORDERED\_RECONFIGURATION is set to TRUE because of an
ongoing Reconfiguration procedure;

or

\- if the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION is set to
TRUE due to the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM
message:

the MS shall:

1\> if V302 is equal to or smaller than N302:

2\> if, caused by the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM
message

3\> the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS is
set to TRUE; and/or

3\> the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO is set to TRUE:

4\> abort the ongoing integrity and/or ciphering reconfiguration;

4\> if the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message
contained the IE \"*Ciphering Mode Info*\":

5\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

5\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

4\> if the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message
contained the IE \"*Integrity Protection Mode Info*\":

5\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

5\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> if the variable ORDERED\_RECONFIGURATION is set to TRUE caused by
the received CELL UPDATE CONFIRM message in case of a Cell Update
procedure:

3\> set the variable ORDERED\_RECONFIGURATION to FALSE;

2\> set the variable FAILURE\_INDICATOR to TRUE;

2\> set the variable FAILURE\_CAUSE to \"Incompatible simultaneous
reconfiguration\";

2\> set the content of the CELL UPDATE message according to sub-clause
7.8.1.3;

2\> submit the CELL UPDATE message for transmission on the uplink SRB2;

2\> increment counter V302; and

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T302;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the Cell Update procedure to be unsuccessful;

3\> the procedure ends.

1\> if V302 is greater than N302:

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> clear the variable PDCP\_SN\_INFO;

2\> set the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION to FALSE;

2\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> release all its radio resources;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> enter RRC-Idle mode;

2\> other actions the MS shall perform when entering RRC-Idle mode from
RRC-Connected mode are specified in clause 6 and sub-clause 7.18;

1\> the procedure ends.

#### 7.8.1.10a Security reconfiguration during Cell update procedure

If:

\- the variable CELL\_UPDATE\_STARTED is set to TRUE; and

\- the MS receives a SECURITY MODE COMMAND message:

the MS shall:

1\> ignore the received SECURITY MODE COMMAND message and continue with
any ongoing processes and procedures as if the SECURITY MODE COMMAND
message had not been received.

#### 7.8.1.11 Confirmation error of GRA ID list

If the GRA UPDATE CONFIRM message causes a confirmation error of GRA
identity list as specified in sub-clause 7.19.3 the MS shall:

1\> check the value of V302; and

1\> if V302 is smaller or equal than N302:

2\> if, caused by the received GRA UPDATE CONFIRM message

3\> the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS is
set to TRUE; and/or

3\> the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO is set to TRUE:

4\> abort the ongoing integrity and/or ciphering reconfiguration;

4\> if the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message
contained the IE \"*Ciphering Mode Info*\":

5\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

5\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

4\> if the received GRA UPDATE CONFIRM message contained the IE
\"*Integrity Protection Mode Info*\"

5\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

5\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> set the IEs in the GRA UPDATE message according to sub-clause
7.8.1.3;

2\> submit the GRA UPDATE message for transmission on the uplink SRB2;

2\> increment counter V302; and

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T302;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the GRA Update procedure to be unsuccessful;

3\> the procedure ends.

1\> if V302 is greater than N302:

2\> release all its radio resources;

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> clear the variable PDCP\_SN\_INFO;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> enter RRC-Idle mode;

2\> perform the actions specified in clause 6 and sub-clause 7.18 when
entering RRC-Idle mode from RRC-Connected mode;

2\> the procedure ends.

#### 7.8.1.12 Invalid CELL UPDATE CONFIRM/GRA UPDATE CONFIRM message

If the MS receives an CELL UPDATE CONFIRM/GRA UPDATE CONFIRM message,
which contains a protocol error causing the variable
PROTOCOL\_ERROR\_REJECT to be set to TRUE according to sub-clause 8, the
MSshall perform procedure specific error handling as follows:

1\> if V302 is equal to or smaller than N302, the MS shall:

2\> set the variable PROTOCOL\_ERROR\_INDICATOR to TRUE;

2\> in case of a Cell Update procedure:

3\> set the contents of the CELL UPDATE message according to sub-clause
7.8.1.3;

3\> submit the CELL UPDATE message for transmission on the uplink SRB2;

2\> in case of a GRA Update procedure:

3\> set the contents of the GRA UPDATE message according to sub-clause
7.8.1.3;

3\> submit the GRA UPDATE message for transmission on the uplink SRB2;

2\> increment counter V302; and

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T302;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the Cell Update procedure or GRA update procedure to be
unsuccessful;

3\> the procedure ends.

1\> if V302 is greater than N302, the MS shall:

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> in case of a Cell Update procedure:

3\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> in case of a GRA Update procedure:

3\> clear the entry for the GRA UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> release all its radio resources;

2\> enter RRC-Idle mode;

2\> other actions the MS shall perform when entering RRC-Idle mode from
RRC-Connected mode are specified in clause 6 and sub-clause 7.18;

2\> the procedure ends.

#### 7.8.1.13 T302 expiry or cell reselection

If any or several of the following conditions are true:

\- expiry of timer T302;

\- reselection to another GERAN cell (including the previously serving
cell) before completion of the Cell Update or GRA Update procedure;

the MS shall:

1\> stop T302 if it is running;

1\> if the MS was in RRC-Cell\_Dedicated state prior to the initiation
of the procedure; and

2\> if timers T314 and T315 have elapsed while T302 was running:

3\> enter RRC-Idle mode.

3\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers. Other actions the MS shall perform
when entering RRC-Idle mode from RRC-Connected mode are specified in
clause 6 and sub-clause 7.18.

3\> and the procedure ends.

2\> if timer T314 has elapsed while T302 was running and,

3\> if \"*T314 Expired*\" in the variable RB\_TIMER\_INDICATOR is set to
FALSE and

3\> if T315 is still running:

4\> release locally all radio bearers which are associated with any
radio access bearers for which in the variable ESTABLISHED\_RABS the
value of the IE \"*Re-establishment Timer*\" is set to \"useT314\";

4\> indicate release of those radio access bearers to upper layers;

4\> delete all information about those radio access bearers from the
variable ESTABLISHED\_RABS;

4\> set \"*T314 Expired*\" in the variable RB\_TIMER\_INDICATOR to TRUE;

2\> if timer T315 has elapsed while T302 was running and,

3\> if \"*T315 Expired*\" in the variable RB\_TIMER\_INDICATOR is set to
FALSE and,

3\> if T314 is still running:

4\> release locally all radio bearers which are associated with any
radio access bearers for which in the variable ESTABLISHED\_RABS the
value of the IE \"*Re-establishment Timer*\" is set to \"useT315\";

4\> indicate release of those radio access bearers to upper layers;

4\> delete all information about those radio access bearers from the
variable ESTABLISHED\_RABS;

4\> set \"*T315 Expired*\" in the variable RB\_TIMER\_INDICATOR to TRUE;

1\> if, caused by the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM
message the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
is set to TRUE and/or the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO is set to TRUE:

2\> abort the ongoing integrity and/or ciphering reconfiguration;

2\> if the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message
contained the IE \"*Ciphering Mode Info*\":

3\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

3\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> if the received CELL UPDATE CONFIRM or GRA UPDATE CONFIRM message
contained the IE \"*Integrity Protection Mode Info*\":

3\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

3\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

1\> if the variable ORDERED\_RECONFIGURATION is set to TRUE caused by
the received CELL UPDATE CONFIRM message in case of a cell update
procedure:

2\> set the variable ORDERED\_RECONFIGURATION to FALSE;

1\> in case of a Cell Update procedure:

2\> clear any entry for the CELL UPDATE CONFIRM message in the table
\"Accepted transactions\" in the variable TRANSACTIONS;

1\> in case of a GRA Update procedure:

2\> clear any entry for the GRA UPDATE CONFIRM message in the table
\"Accepted transactions\" in the variable TRANSACTIONS;

If the MS has not entered RRC-Idle mode, and:

1\> if V302 is equal to or smaller than N302, the MS shall:

2\> in case of a Cell Update procedure:

3\> set the contents of the CELL UPDATE message according to sub-clause
7.8.1.3;

3\> if a CELL UPDATE CONFIRM message was received and caused the IE
\"Reconfiguration\" in the variable CIPHERING\_STATUS to be set to TRUE
and/or the IE \"Reconfiguration\" in the variable
INTEGRITY\_PROTECTION\_INFO to be set to TRUE:

4\> if the IE \"Downlink counter sychnronization info\" was included in
the received CELL UPDATE CONFIRM message:

5\> apply the new security (integrity protection) configuration received
in the CELL UPDATE CONFIRM on the CELL UPDATE message.

3\> submit the CELL UPDATE message for transmission on the uplink SRB2;

2\> in case of a GRA Update procedure:

3\> set the contents of the GRA UPDATE message according to sub-clause
7.8.1.3;

3\> if a GRA UPDATE CONFIRM message was received and caused the IE
\"Reconfiguration\" in the variable CIPHERING\_STATUS to be set to TRUE
and/or the IE \"Reconfiguration\" in the variable
INTEGRITY\_PROTECTION\_INFO to be set to TRUE:

4\> if the IE \"Downlink counter sychnronization info\" was included in
the received GRA UPDATE CONFIRM message:

5\> apply the new security (integrity protection) configuration received
in the GRA UPDATE CONFIRM on the GRA UPDATE message.

3\> submit the GRA UPDATE message for transmission on the uplink SRB2.;

2\> increment counter V302;

2\> if the RLC sub-layer indicates to the RRC layer a successful
transmission of the message:

3\> restart timer T302;

2\> if the RLC sub-layer indicates a link failure to the RRC layer:

3\> enter RRC-Idle mode;

3\> perform the actions specified in clause 6 when MS is in RRC-Idle
mode;

3\> consider the Cell Update procedure or GRA Update procedure to be
unsuccessful;

3\> the procedure ends.

1\> if V302 is greater than N302, the MS shall:

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> clear the variable PDCP\_SN\_INFO;

2\> in case of a Cell Update procedure:

3\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> in case of a GRA Update procedure:

3\> clear the entry for the GRA UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> release all its radio resources;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> enter RRC-Idle mode;

2\> other actions the MS shall perform when entering RRC-Idle mode from
RRC-Connected mode are specified in clause 6 and sub-clause 7.18;

2\> and the procedure ends.

#### 7.8.1.14 T314 expiry

Upon expiry of timer T314 the MS shall:

1\> if timer T302 is running:

2\> continue awaiting response message from GERAN;

1\> if timer T302 is not running and timer T315 is running:

2\> set IE \"*T314 Expired*\" in variable RB\_TIMER\_INDICATOR to TRUE;

2\> release locally all radio bearers which are associated with any
radio access bearers for which in the variable ESTABLISHED\_RABS the
value of the IE \"*Re-establishment Timer*\" is set to \"use T314\";

2\> indicate release of those radio access bearers to upper layers;

2\> delete all information about those radio access bearers from the
variable ESTABLISHED\_RABS;

1\> if timers T302 and T315 are not running:

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> clear the variable PDCP\_SN\_INFO;

2\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> release all its radio resources;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> enter RRC-Idle mode;

2\> other actions the MS shall perform when entering RRC-Idle mode from
RRC-Connected mode are specified in clause 6 and sub-clause 7.18;

2\> and the procedure ends.

#### 7.8.1.15 T315 expiry

Upon expiry of timer T315 the MS shall:

1\> if timer T302 is running:

2\> continue awaiting response message from GERAN;

1\> if timer T302 is not running and timer T314 is running:

2\> set IE \"*T315 Expired*\" in variable RB\_TIMER\_INDICATOR to TRUE;

2\> release locally all radio bearers which are associated with any
radio access bearers for which in the variable ESTABLISHED\_RABS the
value of the IE \"*Re-establishment Timer*\" is set to \"use T315\";

2\> indicate release of those radio access bearers to upper layers;

2\> delete all information about those radio access bearers from the
variable ESTABLISHED\_RABS;

1\> if timers T302 and T314 are not running:

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> clear the variable PDCP\_SN\_INFO;

2\> clear the entry for the CELL UPDATE CONFIRM message in the table
\"Rejected transactions\" in the variable TRANSACTIONS;

2\> release all its radio resources;

2\> indicate release (abort) of the established signalling connections
(as stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> set the variable CELL\_UPDATE\_STARTED to FALSE;

2\> enter RRC-Idle mode;

2\> other actions the MS shall perform when entering RRC-Idle mode from
RRC-Connected mode are specified in clause 6 and sub-clause 7.18;

2\> and the procedure ends.

#### 7.8.1.16 Reception of the GERAN MOBILITY INFORMATION CONFIRM message by the GERAN

See sub-clause 7.8.1.6.

#### 7.8.1.17 Inter-RAT cell reselection to GERAN *Iu mode*

##### 7.8.1.17.1 General

The purpose of the inter-RAT cell reselection procedure to GERAN *Iu
mode* is to transfer, under the control of the MS and to some extent the
source radio access technology, a connection between the MS and another
radio access technology (e.g. UTRAN) to GERAN *Iu mode*.

##### 7.8.1.17.2 Initiation

When the MS makes an inter-RAT cell reselection to GERAN *Iu mode*
according to the criteria specified in 3GPP TS 44.160, it shall initiate
this procedure. The inter-RAT cell reselection made by the MS may use
system information broadcast from the source radio access technology or
MS dedicated information.

When the MS performs an inter-RAT cell reselection from a RAT other than
UTRAN, the MS shall:

1\> set the variable ESTABLISHMENT\_CAUSE to \"Inter-RAT cell
reselection\";

1\> initiate an RRC connection establishment procedure as specified in
sub-clause 7.5;

1\> after initiating an RRC connection establishment:

2\> release all resources specific to the other radio access technology.

When the MS performs an inter-RAT cell reselection from UTRAN Cell\_FACH
or Cell\_PCH state to GERAN *Iu mode*, the MS shall:

1\> initiate the cell update procedure as specified in sub-clause 7.8,
using the cause \"cell reselection\"and setting the U-RNTI in the IE
\"*G-RNTI*\".

When the MS performs an inter-RAT cell reselection from UTRAN URA\_PCH,
the MS shall:

1\> compare the URA identity which the MS had been assigned to in UTRAN
against the GRA identities which are broadcast in the GERAN cell.

2\> If the assigned URA identity is not present in the list of GRA
identities that are broadcast in the GERAN cell:

3\> initiate the GRA update procedure as specified for the GRA
reselection case in sub-clause 7.8, using the cause \"change of GRA\"
and setting the U-RNTI in the IE \"*G-RNTI*\".

##### 7.8.1.17.3 MS fails to complete an inter-RAT cell reselection

When the MS performs an inter-RAT cell reselection from a RAT other than
UTRAN, and if the inter-RAT cell reselection fails before the MS has
initiated the RRC connection establishment, the MS may return back to
the other radio access technology.

When the MS performs an inter-RAT cell reselection from a RAT other than
UTRAN, and if the RRC connection establishment fails, the MS shall enter
RRC-Idle mode.

When the MS performs an inter-RAT cell reselection from UTRAN to GERAN
*Iu mode*, and the cell reselection fails, the MS may return back to the
UTRAN RRC Connected state, from which it initiated the inter-RAT cell
reselection.

#### 7.8.1.18 Inter-RAT cell reselection from GERAN Iu mode

##### 7.8.1.18.1 General

The purpose of the inter-RAT cell reselection procedure from GERAN *Iu
mode* is to transfer, under the control of the MS and to some extent the
GERAN, a connection between the MS and GERAN *Iu mode* to another radio
access technology (e.g. UTRAN).

##### 7.8.1.18.2 Initiation

This procedure is applicable in states RRC-Cell\_Shared or RRC GRA\_PCH.

When the MS based on received system information makes a inter-RAT cell
reselection to a radio access technology other than UTRAN, according to
the criteria specified in 3GPP TS 44.160, the MS shall:

1\> initiate the establishment of a connection to the target radio
access technology according to its specifications.

When the MS in RRC-Cell\_Shared state performs an inter-RAT cell
reselection to UTRAN, according to the criteria specified in
3GPP TS 44.160, the MS shall:

1\> initiate the cell update procedure according to 3GPP TS 25.331,
using the cause \"cell reselection\"and setting the G-RNTI in the IE
\"*U-RNTI*\". When the MS in RRC-GRA\_PCH state performs an inter-RAT
cell reselection to UTRAN, according to the criteria specified in
3GPP TS 44.160, the MS shall:

1\> compare the GRA identity which the MS had been assigned to in GERAN
against the URA identities which are broadcast in the UTRAN cell.

2\> If the assigned GRA identity is not present in the list of URA
identities that are broadcast in the UTRAN cell:

3\> initiate the URA update procedure as specified in 3GPP TS 25.331,
using the cause \"change of URA\"and setting the G-RNTI in the IE
\"*U-RNTI*\".

##### 7.8.1.18.3 Successful cell reselection

When the MS has succeeded in reselecting a cell in the target radio
access technology other than UTRAN and has initiated the establishment
of a connection, it shall release all GERAN specific resources.

When the MS has succeeded in reselecting to a UTRAN cell, it shall
release all GERAN specific radio resources.

##### 7.8.1.18.4 MS fails to complete an inter-RAT cell reselection

If the inter-RAT cell reselection to another radio access technology
fails, the MS shall resume the connection to GERAN *Iu mode* using the
resources used before initiating the inter-RAT cell reselection
procedure.

### 7.8.2 GRA update

See sub-clause 7.8.1.

### 7.8.3 GERAN mobility information

Figure 7.8.3.1: GERAN Mobility Information procedure, normal flow

Figure 7.8.3.2: GERAN Mobility Information procedure, failure case

#### 7.8.3.1 General

The purpose of this procedure is to allocate any one or a combination of
the following to a MS in Connected Mode:

\- a new G-RNTI;

\- other mobility related information.

#### 7.8.3.2 Initiation

To initiate the procedure GERAN transmits a GERAN MOBILITY INFORMATION
message to the MS on the downlink SRB2.

#### 7.8.3.3 Reception of GERAN MOBILITY INFORMATION message by the MS

When the MS receives a GERAN MOBILITY INFORMATION message, it shall:

1\> act on received information elements as specified in sub-clause
7.19;

1\> if the IE \"*MS Timers and Constants in Connected Mode*\" is
present:

2\> store the values of the IE \"*MS Timers and Constants in Connected
Mode*\" in the variable TIMERS\_AND\_CONSTANTS, replacing any previously
stored value; and

2\> for each updated timer value:

3\> start using the new value next time the timer is started;

NOTE: If a new value of timer T305 is included in the IE \"*MS Timers
and constants in connected mode*\", and the old value of timer T305 is
\"infinity\", the MS will not use the new value of the timer T305 until
the next cell reselection.

1\> set the IE \"RRC Transaction Identifier\" in the GERAN MOBILITY
INFORMATION CONFIRM message to the value of \"RRC transaction
identifier\" in the entry for the GERAN MOBILITY INFORMATION message in
the table \"Accepted transactions\" in the variable TRANSACTIONS; and

1\> clear that entry;

1\> if the GERAN MOBILITY INFORMATION message contained the IE
\"*Ciphering Mode Info*\" or contained the IE \"*Integrity Protection
Mode Info*\":

2\> set the IE \"*Status*\" in the variable SECURITY\_MODIFICATION for
all the CN domains in the variable SECURITY\_MODIFICATION to
\"Affected\";

1\> if the GERAN MOBILITY INFORMATION message contained the IE
\"Ciphering Mode Info\":

2\> include the IE \"*Radio Bearer Uplink Ciphering Activation Time
Info*\" in the GERAN MOBILITY INFORMATION CONFIRM message and set to the
value of the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

1\> if the variable PDCP\_SN\_INFO is non-empty:

2\> include the IE \"*RB with PDCP Information List*\" in the GERAN
MOBILITY INFORMATION CONFIRM message and set it to the value of the
variable PDCP\_SN\_INFO;

1\> if the received GERAN MOBILITY INFORMATION message included the
structure \"Downlink Counter Synchronisation Info\":

2\> if the variable PDCP\_SN\_INFO is empty:

3\> configure the corresponding RLC entity for all AM and UM radio
bearers and AM and UM signalling radio bearers except SRB2 to \"stop\";

2\> else:

3\> configure the RLC entity for signalling radio bearers SRB1, SRB3 and
SRB4 to \"stop\";

3\> configure the RLC entity for UM and AM radio bearers for which the
IE \"*PDCP SN Info*\" is not included to \"stop\";

2\> re-establish SRB2;

2\> for the downlink and the uplink, apply the ciphering configuration
as follows:

3\> if the received re-configuation message included the IE \"*Ciphering
Mode Info*\":

4\> use the ciphering configuration in the received message when
transmitting the response message;

3\> if the ciphering configuration for SRB2 from a previously received
SECURITY MODE COMMAND has not yet been applied because of the activation
times not having been reached:

4\> if the previous SECURITY MODE COMMAND was received due to new keys
being received:

5\> consider the new ciphering configuration to include the received new
keys;

5\> initialise the HFN component of the uplink COUNT-C and downlink
COUNT-C of SRB2 as indicated in subclause 7.16.1.2.3.1.

4\> if the ciphering configuration for SRB2 from a previously received
SECURITY MODE COMMAND has not yet been applied because of the
corresponding activation times not having been reached and the previous
SECURITY MODE COMMAND caused a change in LATEST\_CONFIGURED\_CN\_DOMAIN:

5\> initialise the HFN component of the uplink COUNT-C and downlink
COUNT-C of SRB2 to the most recently transmitted IE \"*START List*\" or
IE \"*START*\" for the LATEST\_CONFIGURED\_CN\_DOMAIN at the reception
of the previous SECURITY MODE COMMAND message.

5\> consider the new ciphering configuration to include the keys
associated with the LATEST\_CONFIGURED\_CN\_DOMAIN;

4\> apply the new ciphering configuration immediately following RLC
re-establishment.

3\> else:

4\> continue using the current ciphering configuration;

2\> set the new uplink and downlink HFN of SRB2 to MAX (uplink HFN of
SRB2, downlink HFN of SRB2) + 1;

2\> increment by one the downlink and uplink HFN values for SRB2;

2\> calculate the START value according to sub-clause 7.18;

2\> include the calculated START values for each CN domain in the IE
\"START List\" in the structure \"Uplink Counter Synchronisation Info\"
in the GERAN MOBILITY INFORMATION CONFIRM message;

1\> transmit a GERAN MOBILITY INFORMATION CONFIRM message on the uplink
SRB2;

1\> if the IE \"*Integrity Protection Mode Info*\" was present in the
GERAN MOBILITY INFORMATION message:

2\> start applying the new integrity protection configuration in the
uplink for signalling radio bearer SRB2 from and including the
transmitted GERAN MOBILITY INFORMATION CONFIRM message;

1\> if the structure \"*Downlink Counter Synchronisation Info*\" was
included in the received GERAN MOBILITY INFORMATION message:

2\> when RLC has confirmed the successful transmission of the response
message:

3\> if the variable PDCP\_SN\_INFO is empty:

4\> configure the RLC entity for all AM and UM radio bearers and AM and
UM signalling radio bearers except SRB2 to \"continue\";

3\> else:

4\> configure the RLC entity for signalling radio bearers SRB1, SRB3 and
SRB4 to \"continue\";

4\> configure the RLC entity for UM and AM radio bearers for which the
IE \"*PDCP SN Info*\" is not included to \"continue\";

3\> re-establish all AM and UM RLC entities with RB identities larger
than 4 and set the first 20 bits of all the HFN component of the
respective COUNT-C values to the START value included in the response
message for the corresponding CN domain;

3\> re-establish the RLC entities with RB identities 1, 3 and 4 and set
the first 20 bits of all the HFN component of the respective COUNT-C
values to the START value included in the response message for the CN
domain stored in the variable LATEST\_CONFIGURED\_CN\_DOMAIN;

3\> set the remaining bits of the HFN component of the COUNT-C values of
all UM RLC entities to zero;

3\> set the remaining bits of the HFN component of the COUNT-C values of
all AM RLC entities to zero, for those bearers to which RLC entitie
where re-established;

3\> if the IE \"*PDCP Context Relocation Info*\" is not present:

4\> re-initialise the PDCP header compression entities of each radio
bearer in the variable ESTABLISHED\_RABS as specified in 3GPP TS 25.323;

3\> if the IE \"*PDCP Context Relocation Info\"* is present:

4\> perform the actions as specified in 7.19.

1\> if the variable PDCP\_SN\_INFO is empty; and

2\> if the GERAN MOBILITY INFORMATION message contained the IE
\"*Ciphering Mode Info*\":

3\> when RLC has confirmed the successful transmission of the GERAN
MOBILITY INFORMATION CONFIRM message, perform the actions below;

2\> if the GERAN MOBILITY INFORMATION message did not contain the IE \"
*Ciphering Mode Info* \":

3\> when RLC has been requested to transmit the GERAN MOBILITY
INFORMATION CONFIRM message, perform the actions below;

1\> if the variable PDCP\_SN\_INFO is non-empty:

2\> when RLC has confirmed the successful transmission of the GERAN
MOBILITY INFORMATION CONFIRM message:

3\> for each radio bearer in the variable PDCP\_SN\_INFO:

4\> if the IE \"*RB Started*\" in the variable ESTABLISHED\_RABS is set
to \"started\":

4\> configure the RLC entity for that radio bearer to \"continue\";

3\> clear the variable PDCP\_SN\_INFO;

1\> if the GERAN MOBILITY INFORMATION message contained the IE \"
*Ciphering Mode Info* \":

2\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

1\> if the GERAN MOBILITY INFORMATION message contained the IE
\"*Integrity Protection Mode Info*\":

2\> allow the transmission of RRC messages on all signalling radio
bearers with any RRC SN;

2\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> clear the variable SECURITY\_MODIFICATION.

The procedure ends.

#### 7.8.3.4 Reception of an GERAN MOBILITY INFORMATION CONFIRM message by the GERAN

When the network receives GERAN MOBILITY INFORMATION CONFIRM message,
GERAN may delete any old G-RNTI. The procedure ends.

#### 7.8.3.5 Cell re-selection

If the MS performs cell re-selection, the MS shall:

1\> initiate a Cell Update procedure according to sub-clause 7.8.1;

1\> if the MS has not yet submitted the GERAN MOBILITY INFORMATION
CONFIRM message to lower layers for transmission;

2\> transmit a GERAN MOBILITY INFORMATION FAILURE message on the uplink
SRB2;

2\> set the IE \"*RRC Transaction Identifier*\" in the GERAN MOBILITY
INFORMATION FAILURE message to the value of \"RRC transaction
identifier\" in the entry for the GERAN MOBILITY INFORMATION message in
the table \"Accepted transactions\" in the variable TRANSACTIONS; and

2\> clear that entry.

2\> set the IE \"*Failure Cause*\" to the cause value \"cell
reselection\";

2\> when the GERAN MOBILITY INFORMATION FAILURE message has been
submitted to lower layers for transmission:

3\> continue with any ongoing processes and procedures as if the invalid
GERAN MOBILITY INFORMATION message has not been received and the
procedure ends.

1\> otherwise:

2\> continue the procedure normally.

#### 7.8.3.6 Incompatible simultaneous security reconfiguration

If the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION becomes set to
TRUE because of the received GERAN MOBILITY INFORMATION message, the MS
shall:

1\> transmit a GERAN MOBILITY INFORMATION FAILURE message on the uplink
SRB2;

1\> set the IE \"*RRC Transaction Identifier*\" in the GERAN MOBILITY
INFORMATION FAILURE message to the value of \"RRC transaction
identifier\" in the entry for the GERAN MOBILITY INFORMATION message in
the table \"Accepted transactions\" in the variable TRANSACTIONS; and

1\> clear that entry;

1\> set the IE \"*Failure Cause*\" to the cause value \"incompatible
simultaneous reconfiguration\";

1\> when the GERAN MOBILITY INFORMATION FAILURE message has been
delivered to lower layers for transmission:

2\> set the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION to FALSE;

2\> continue with any ongoing processes and procedures as if the GERAN
MOBILITY INFORMATION message has not been received;

2\> and the procedure ends.

#### 7.8.3.7 Invalid GERAN MOBILITY INFORMATION message

If the GERAN MOBILITY INFORMATION message contains a protocol error
causing the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE according
to sub-clause 8, the MS shall perform procedure specific error handling
as follows. The MS shall:

1\> transmit a GERAN MOBILITY INFORMATION FAILURE message on the uplink
SRB2;

1\> set the IE \"*RRC Transaction Identifier* RRC\" in the GERAN
MOBILITY INFORMATION FAILURE message to the value of \"RRC transaction
identifier\" in the entry for the GERAN MOBILITY INFORMATION message in
the table \"Rejected transactions\" in the variable TRANSACTIONS, and;

1\> clear that entry.

1\> set the IE \"*Failure Cause*\" to the cause value \"protocol
error\";

1\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION;

1\> when the GERAN MOBILITY INFORMATION FAILURE message has been
submitted to lower layers for transmission:

2\> continue with any ongoing processes and procedures as if the invalid
GERAN MOBILITY INFORMATION message has not been received;

1\> and the procedure ends.

### 7.8.4 Inter-mode handover from GERAN Iu mode

#### 7.8.4.1 General

Figure 7.8.4.1.1: Inter-mode handover from GERAN, successful case

Figure 7.8.4.1.2: Inter-mode handover from GERAN Iu mode, failure case

The purpose of the Inter-Mode Handover from GERAN Iu procedure is to,
under the control of the network, transfer a connection between the MS
and GERAN *Iu mode* to GERAN *A/Gb mode*.This procedure may be used to
request an intercell or intracell change of channel(s) by the network,
in RRC-Cell\_Dedicated state.

NOTE: This procedure is applicable to CS domain service.

#### 7.8.4.2 Initiation

The procedure is initiated when GERAN *Iu mode* orders a MS in
RRC-Cell\_Dedicated state, to make a handover to GERAN *A/Gb mode*.

To initiate the procedure, GERAN sends a HANDOVER FROM GERAN Iu COMMAND
message.

Upon the receipt of HANDOVER FROM GERAN Iu COMMAND message, the mobile
station shall:

1\> initiate reconfiguration of the layer 2 and disconnection of the
DBPSCHs;

1\> switch to the assigned cell(s) and establish the physical channels
as described in 3GPP TS 44.018.

#### 7.8.4.3 Reception of a HANDOVER FROM GERAN Iu COMMAND message by the MS

The MS shall be able to receive a HANDOVER FROM GERAN Iu COMMAND message
and perform an inter-mode handover, even if no prior MS measurements
have been performed on the target cell. The connection is established in
GERAN *A/Gb mode* by using the contents of encapsulated message HANDOVER
COMMAND message (see 3GPP TS 44.018)

If the IE \"*RAB information List*\" is included in the HANDOVER FROM
GERAN Iu COMMAND message:

1\> if the IE \"RAB information List\" includes one IE \"RAB Info\" with
the IE \"*CN domain Identity*\" set to \"CS domain\":

2\> connect upper layer entities corresponding to the indicated CS
domain RAB to the radio resources indicated in the encapsulated HANDOVER
COMMAND message.

2\> and act upon received information element as specified
3GPP TS 44.018.

NOTE: In this version of the specification the maximum number of CS
domain RABs which may be included in the IE \"RAB information List\" is
limited to 1.

#### 7.8.4.4 Successful completion of the inter-mode handover

Upon successfully completing the handover, GERAN shall:

1\> release the radio connection;

Upon successfully completing the handover, the MS shall:

1\> if inter-mode handover is performed and if there are any NAS
messages with the IE \"*CN domain identity*\" set to \"CS domain\" for
which the successful delivery of the INITIAL DIRECT TRANSFER message or
UPLINK DIRECT TRANSFER message on signalling radio bearer SRB3 or
signalling radio bearer SRB4 has not yet been confirmed by RLC:

2\> retransmit those NAS messages to the network on the newly
established radio connection to the system.

3\> clear or set variables upon leaving GERAN RRC-Connected mode as
specified in sub-clauses 7.19 and 10.4.

#### 7.8.4.5 Unsuccesful completion of the inter-mode handover at the MS side

If the MS does not succeed in establishing the connection to the target,
it shall:

1\> revert back to the GERAN configuration;

1\> establish the GERAN physical channel(s) used at the time for
reception of HANDOVER FROM GERAN Iu COMMAND;

1\> if the MS does not succeed to establish the GERAN physical
channel(s):

2\> select a suitable GERAN cell according to 3GPP TS 45.008.

2\> perform a Cell Update procedure according to sub-clause 7.8 with
cause \"radio link failure\";

2\> when the Cell Update procedure has completed successfully:

3\> proceed as below;

1\> transmit the HANDOVER FAILURE message setting the information
elements as specified below:

2\> include the IE \"RRC Transaction Identifier\"; and

2\> set it to the value of \"RRC Transaction Identifier\" in the entry
for the HANDOVER FROM GERAN Iu COMMAND message in the table \"Accepted
transactions\" in the variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"Failure Cause\" to \"physical channel failure\";

1\> when the HANDOVER FAILURE message has been submitted to lower layer
for transmission:

2\> the procedure ends.

#### 7.8.4.6 Invalid HANDOVER FROM GERAN Iu COMMAND message

If the received HANDOVER FROM GERAN Iu COMMAND message does not include
a valid encapsulated HANDOVER COMMAND message (see 3GPP TS 44.018), the
MS shall perform procedure specific error handling as follows. The MS
shall:

1\> set the IE \"*Failure Cause*\" to the cause value \"Inter-mode
Protocol Error\";

1\> transmit a HANDOVER FAILURE message on the uplink SRB2;

1\> when the transmission of the HANDOVER FAILURE message has been
confirmed by RLC:

2\> continue with any ongoing processes and procedures as if the invalid
HANDOVER FROM GERAN Iu COMMAND message has not been received;

2\> and the procedure ends.

If the HANDOVER FROM GERAN Iu COMMAND message contains a protocol error
causing the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE according
to sub-clause 8, the MS shall perform procedure specific error handling
as follows. The MS shall:

1\> set the IE \"*RRC Transaction Identifier*\" in the HANDOVER FAILURE
message to the value of \"RRC transaction identifier\" in the entry for
the HANDOVER FROM GERAN Iu COMMAND message in the table \"Rejected
transactions\" in the variable TRANSACTIONS; and

1\> clear that entry;

1\> set the IE \"Failure Cause\" to the cause value \"protocol error\";

1\> include the IE \"Protocol Error Information\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION;

1\> transmit a HANDOVER FAILURE message on the uplink SRB2;

1\> when the HANDOVER FAILURE message has been submitted to lower layers
for transmission:

2\> continue with any ongoing processes and procedures as if the invalid
HANDOVER FROM GERAN Iu COMMAND message has not been received;

2\> and the procedure ends.

#### 7.8.4.7 Reception of an HANDOVER FAILURE message by GERAN in Iu mode

Upon receiving an HANDOVER FAILURE message, GERAN may initiate the
release of the resources in the GERAN A/Gb mode (see 3GPP TS 44.018 and
3GPP TS 25.413).

#### 7.8.4.8 Unsupported configuration in HANDOVER FROM GERAN Iu COMMAND message

If:

\- the GERAN instructs the MS to perform a non-supported handover
scenario; or

\- the GERAN instructs the MS to use a non-supported configuration; or

\- the IE \"*RAB Information List*\" is included in the HANDOVER FROM
GERAN Iu mode COMMAND message and this IE does not include any IE \"RAB
Info\" with the IE \"CN domain Identity\" set to \"CS domain\":

the MS shall:

1\> transmit a HANDOVER FAILURE message, setting the information
elements as specified below:

2\> include the IE \"RRC Transaction Identifier\"; and

2\> set it to the value of \"RRC Transaction Identifier\" in the entry
for the HANDOVER FROM GERAN Iu COMMAND message in the table \"Accepted
transactions\" in the variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"Failure Cause\" to \"configuration unsupported\";

2\> when the HANDOVER FAILURE message has been submitted to lower layers
for transmission:

3\> resume normal operation as if the invalid HANDOVER FROM GERAN Iu
COMMAND message has not been received;

3\> and the procedure ends.

#### 7.8.4.9 Reception of HANDOVER FROM GERAN Iu COMMAND message by MS in RRC-Cell\_Shared state

If the MS receives HANDOVER FROM GERAN Iu COMMAND while in
RRC-Cell\_Shared state, the MS shall:

1\> transmit a HANDOVER FAILURE message, setting the information
elements as specified below:

2\> include the IE \"RRC Transaction Identifier\"; and

2\> set it to the value of \"RRC Transaction Identifier\" in the entry
for the HANDOVER FROM GERAN Iu COMMAND message in the table \"Accepted
transactions\" in the variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"Failure Cause\" to \"protocol error\";

3\> include IE \"Protocol Error Information\";

3\> set the value of IE \"Protocol Error Cause\" to \"Message not
compatible with receiver state\"; and

2\> when the HANDOVER FAILURE message has been submitted to lower layers
for transmission:

3\> resume normal operation as if the invalid HANDOVER FROM GERAN Iu
COMMAND message has not been received;

3\> and the procedure ends.

7.9 Procedures for System Information transmission and Measurement reporting in RRC-Cell\_Dedicated state
---------------------------------------------------------------------------------------------------------

NOTE: Any modification to this sub-clause may have impact on
3GPP TS 44.018.

### 7.9.1 General

In RRC-Cell\_Dedicated state, the mobile station sends measurement
report messages and receives system information on SRB1.

In the uplink direction, measurement report messages are sent using SRB1
at each possible occasion when no other RRC message has to be sent (see
sub-clause 7.9.2). Similarly, in the downlink direction, SYSTEM
INFORMATION TYPE 5, 6 and optionally 5bis and 5ter messages are sent on
SRB1 when no other RRC message has to be sent. The network may, in
addition, send MEASUREMENT INFORMATION messages on SRB1 to a mobile
station in RRC-Cell\_Dedicated state. This message may order the MS to
use the enhanced measurement reporting. The mapping of SRB1 onto logical
channels is specified in 3GPP TS 44.160.

A mobile station with extended measurement capabilities, which receives
EXTENDED MEASUREMENT ORDER messages on SRB1, shall perform and report
extended measurements, see sub-clause 7.9.3.

The SYSTEM INFORMATION TYPE 5bis message shall be sent if and only if
the EXT IND bit in the *Neighbour Cell Description* information element
in both the SYSTEM INFORMATION TYPE 5 and TYPE 5bis messages indicates
that each information element only carries part of the BA.

A GSM 900 mobile station which only supports the primary GSM band
P-GSM 900 (cf. 3GPP TS 45.005) may consider the EXT-IND bit in the
*Neighbour Cell Description* IE in the SYSTEM INFORMATION TYPE 5 message
bit as a spare bit, assume that the information element carries the
complete BA, and ignore any SYSTEM INFORMATION TYPE 5bis messages.

NOTE: The network should take into account limitations of certain mobile
stations to understand SYSTEM INFORMATION TYPE 5ter and TYPE 5bis
messages, the EXT-IND bit in the *Neighbour Cell Description* IE, and
formats used in the *Neighbour Cell Description* information element and
*Cell Channel Description* information element used in system
information messages, see 3GPP TS 44.018.

Problems occurring in the reception of SACCH frames are interpreted as a
loss of communication means and appropriate procedures are then
triggered as specified in 3GPP TS 45.008.

### 7.9.2 Measurement Report and Enhanced Measurement Report

#### 7.9.2.2 Parameters for Measurements and Reporting

##### 7.9.2.2.1 General

Some parameters from the MEASUREMENT INFORMATION or PSI3quater messages
allow an MS to build lists which are used for Measurement reporting and
Enhanced Measurement reporting.

Full sets of MEASUREMENT INFORMATION messages and PSI3quater messages
are defined by a number of different instances indicated respectively by
the parameters MI\_COUNT and **PSI3\_QUATER\_COUNT**. Two different
instances of MEASUREMENT INFORMATION) messages and PSI3quater messages
are respectively distinguished by different MI\_INDEX and
**PSI3\_QUATER\_INDEX** parameter values.

If the MP\_CHANGE\_MARK parameter or the PSI3\_CHANGE\_MARK parameter is
changed, the MS shall re-read the Real Time differences, REP\_PRIORITY,
CCN\_SUPPORTED, Measurement Parameters and 3G Measurement Parameters in
all instances of respectively MEASUREMENT INFORMATION messages or
PSI3quater messages. The MS shall start using the parameters as soon as
they have been received. In the case that not all the parameters have
been received in a full set of instances, then the default values shall
be used. If different values occur for the same parameter in different
instances of a MEASUREMENT INFORMATION message or PSI3quater message,
the instance with the highest index shall be used.

##### 7.9.2.2.2 Deriving the 3G Neighbour Cell list from the 3G Neighbour Cell Description

A multi-RAT MS shall form a 3G Neighbour Cell list.

In RRC-Idle mode, the MS obtains the 3G Neighbour Cell Description
information on PBCCH by one or more instances of the PSI3quater message
as specified in 3GPP TS 44.160 sub-clause 5.5.3. When the
PSI3\_CHANGE\_MARK parameter is changed in a PSI3quater message, the MS
shall re-read all instances and rebuild the 3G Neighbour Cell list. This
3G neighbour cell list shall then be used for measurement reporting when
the MS enters RRC-Cell\_Dedicated state, until the MS has received a
given number of instances of MEASUREMENT INFORMATION messages that
contain 3G Neighbour Cell Description. This number of instances is
defined by the 3G-WAIT parameter.

In RRC-Cell\_Dedicated state, the MS obtains the 3G Neighbour Cell
Description information on SRB1 by one or more instances of the
MEASUREMENT INFORMATION message with the same 3G\_BA\_IND value as
defined in this sub-clause. When the 3G\_BA\_IND parameter in the
MEASUREMENT INFORMATION message is changed, the MS shall also re-read
all instances of MEASUREMENT INFORMATION messages, rebuild the
3G Neighbour Cell list, and use the new list for measurement reporting
based on the parameter 3G-WAIT.

The 3G Neighbour Cell list may contain up to 96 3G Neighbour Cells.

Each *3G Neighbour Cell Description* received is added to the
3G Neighbour Cell list, starting with the index equal to the parameter
Index\_Start\_3G. If this parameter is not present then the value 0
shall be used.

For each 3G Neighbour Cell Description, the cells are indexed in the
following order:

1\) UTRAN FDD cells: FDD ARFCNs are indexed in the order of occurrence
in the 3G Neighbour Cell description. Then for each FDD ARFCN, the cells
are indexed in the order of increasing values of the decoded
FDD\_CELL\_INFORMATION parameters.

2\) UTRAN TDD cells: TDD ARFCNs are indexed in the order of occurrence
in the 3G Neighbour Cell description. Then for each TDD ARFCN, the cells
are indexed in the order of increasing values of the decoded
TDD\_CELL\_INFORMATION parameters.

3\) CDMA 2000 cells: the cells are indexed in the order of occurrence in
the 3G Neighbour Cell description.

If a *3G Neighbour Cell Description* includes non-supported frequencies
or Radio Access Technologies, this shall not be considered as an error;
indices in the 3G Neighbour Cell list shall be incremented accordingly.

If more than one cell with the same index in the 3G Neighbour Cell list
are provided by different instances of *3G Neighbour Cell Descriptions*,
the cell from the message instance with the highest index shall be used.
In case the same 3G Cell occurs more than once in the resulting
3G Neighbour Cell list, each occurrence shall be assigned an index but
only the cell with the highest index in the 3G Neighbour Cell list shall
be referred to in measurement reports.

If a cell is provided for an index higher than 95 in the 3G Neighbour
Cell list, this shall not be considered as an error; the cell shall not
be included in the 3G Neighbour Cell list.

##### 7.9.2.2.3 Deriving the GSM Neighbour Cell list from the BSICs and the BCCH Allocation

In RRC-Idle mode, the MS shall derive the GSM Neighbour Cell from
information received on PBCCH, by one or more instances of the PSI3 or
PSI3bis message as specified in 3GPP TS 44.160. In RRC-Cell\_Dedicated
state, the GSM Neighbour Cell list shall be derived from information
received, on SRB1, by one or more instances of the MEASUREMENT
INFORMATION message as defined in this sub-clause. The GSM Neighbour
Cell list may contain up to 96 Neighbour Cells.

To obtain the GSM neighbour cell list, the MS shall combine the BA
(list) received in SI5/SI5bis/SI5ter with the BSIC list received in one
or more instances of the MEASUREMENT INFORMATION message with the same
BA\_IND value as the BA (list). The BSICs may be received before the
corresponding BA (list). The first BSIC in each instance applies to the
frequency in the BA (list) referenced by the parameter
BA\_Index\_Start\_BSIC. For each successive BSIC, one bit indicates if
the BSIC applies to the same frequency as the previous BSIC or to the
next frequency in the BA (list), as defined in 3GPP TS 44.018. When the
BA\_IND is changed the MS shall rebuild the combined list and the BSIC
list shall also be rebuilt.

##### 7.9.2.2.4 Deriving the Neighbour Cell list from the GSM Neighbour Cell list and the 3G Neighbour Cell list

For report with the ENHANCED MEASUREMENT REPORT message, the Neighbour
Cell list is the concatenation of the GSM Neighbour Cell list and the
3G Neighbour Cell list (if any). In this concatenation the value of the
parameter Absolute\_Index\_Start\_EMR is added to the 3G Neighbour Cell
list indices. The Neighbour Cell list may contain up to 96 Neighbour
Cells. If the same index occurs for a GSM Cell and a 3G Cell, the GSM
Cell shall be used.

NOTE: For report with the MEASUREMENT REPORT message, the concatenated
list is not used. Instead, the two lists are used separately, as defined
in 3GPP TS 44.018.

##### 7.9.2.2.5 Real Time Differences

To obtain the Real Time Differences, the MS shall combine the BA (list)
with the Real Time Differences parameters received in the MEASUREMENT
INFORMATION message with the same BA\_IND value as the BA (list). The
Real Time Difference list may contain up to 96 Real Time Difference
parameters. Each frequency in the BA (list) may be associated to 0, 1 or
more Real Time Difference parameters. The Real Time Difference
parameters may be received before the corresponding BA (list). The
parameter BA\_Index\_Start\_RTD in each structure indicates the index of
the frequency in the BA (list) to be taken as a starting reference. A
sub-structure is included for each frequency referenced. Each of those
sub-structures indicates if 0, 1 or more RTD parameters are present for
this frequency. If a frequency in the BA (list) is not provided with
Real Time Difference information by any of the message instances with
correct BA\_IND, it shall be assumed that no information is available
for that frequency, see 3GPP TS 44.018. When the BA\_IND is changed the
MS shall re-read the Real Time Differences parameters in all instances.

The Real Time Difference may be received from the PSI3ter message in the
GPRS Real Time Difference Description (see 3GPP TS 44.160).

##### 7.9.2.2.6 Report Priority Description

Report Priority information can be received in one instance of the
MEASUREMENT INFORMATION message. The Report Priority information is
associated with the Neighbour Cell list (see 7.9.2.2.4) having the same
BA\_IND value and 3G\_BA\_IND value. Each REP\_PRIORITY bit of this
field relates to indices of the Neighbour Cell list, starting with index
0. The Report Priority information may be received before the
corresponding Neighbour Cell list. When the BA\_IND or 3G\_BA\_IND are
changed the MS shall re-read the REP\_PRIORITY parameters in all
instances.

Indices exceeding the value 95 shall be ignored. If there are fewer
indices than the number of Neighbour Cells, the value 0 shall be assumed
for the missing bits.

Report Priority Description for GSM cells may also be received from the
PSI3ter message and Report Priority Description for 3G cells from the
PSI3quarter message(see 3GPP TS 44.160).

##### 7.9.2.2.7 The 3G Cell Reselection list

This applies only to a multi-RAT MS. The 3G Cell Reselection list is
defined in 3GPP TS 44.160.

##### 7.9.2.2.8 CCN Support description

The CCN Support description may be received from the PSI3 message or any
instance of the PSI3bis or PSI3quater messages(see 3GPP TS 44.160).

### 7.9.3 Extended measurement report

Only applicable to mobile stations which support extended measurement.

When in RRC-Cell\_Dedicated state, a mobile station may receive an
EXTENDED MEASUREMENT ORDER message from the network. As defined in
3GPP TS 45.008, the mobile station shall then perform measurements on
the frequencies specified by this EXTENDED MEASUREMENT ORDER message for
one reporting period. The mobile station shall thereafter send an
EXTENDED MEASUREMENT REPORT message. This message contains the
measurement results as defined in 3GPP TS 45.008.

If the mobile station has not started to send its EXTENDED MEASUREMENT
REPORT message within 10 seconds after the reception of the EXTENDED
MEASUREMENT ORDER message, no EXTENDED MEASUREMENT REPORT message shall
be sent. The mobile station shall after a successful channel change
abort any pending measurements or reporting related to an EXTENDED
MEASUREMENT ORDER message received on the old channel.

If a mobile station receives an EXTENDED MEASUREMENT ORDER message
indicating the same value of the sequence code as an EXTENDED
MEASUREMENT ORDER message received earlier on the same channel without
having received any EXTENDED MEASUREMENT ORDER message indicating a
different value of the sequence code in between, that EXTENDED
MEASUREMENT ORDER message shall be ignored. If the mobile station,
before the reporting related to an EXTENDED MEASUREMENT ORDER message
has started, receives a new EXTENDED MEASUREMENT ORDER message with a
different value of the sequence code, any pending measurements or
reporting related to the earlier EXTENDED MEASUREMENT ORDER message
shall be aborted and the new message treated.

The EXTENDED MEASUREMENT ORDER message and the EXTENDED MEASUREMENT
REPORT message are sent on SRB1.

7.10 Handover to UTRAN procedure
--------------------------------

### 7.10.1 General

This procedure is only valid for UTRAN capable MSs. A change to UTRAN
channel(s) can be requested by the network RRC sublayer in
RRC-Cell\_Dedicated state.

The handover to UTRAN procedure includes:

1\> the reconfiguration of the layer 2 established for the DBPSCHs;

1\> the disconnection and the deactivation of physical channels and
their release (layer 1).

1\> the establishment of UTRAN channel(s), see 3GPP TS 25.331.

### 7.10.2 Initiation

The network initiates the handover to UTRAN procedure by sending an
INTER SYSTEM TO UTRAN HANDOVER COMMAND message to the mobile station on
the SRB2 in GERAN in *Iu mode*. The INTER SYSTEM TO UTRAN HANDOVER
COMMAND message shall contain encapsulated the RADIO BEARER
RECONFIGURATION message. If the INTER SYSTEM TO UTRAN HANDOVER COMMAND
refers to a not known cell (see 3GPP TS 25.133 and 3GPP TS 25.123), this
shall not be considered as an error.

### 7.10.3 Reception of INTER SYSTEM TO UTRAN HANDOVER COMMAND message by the MS

Upon the receipt of INTER SYSTEM TO UTRAN HANDOVER COMMAND message, the
mobile station shall:

1\> initiate reconfiguration of the layer 2 and disconnection of the
DBPSCHs;

1\> switch to the assigned cell(s) and establish the physical channels
as described in 3GPP TS 25.331.

1\> establish the connection to the UTRA cell, by using the contents of
encapsulated RADIO BEARER RECONFIGURATION message.

### 7.10.4 Successful completion of the inter-RAT handover

When inter-RAT handover to UTRAN is performed, the MS shall:

1\> perform the actions on reception of RADIO BEARER RECONFIGURATION
message as specified in 3GPP TS 25.331;

1\> keep the ciphering and integrity keys that are stored in the
USIM/SIM for that CN domain.

1\> if inter-RAT handover to UTRAN is performed and if there are any NAS
messages for which the successful delivery of the INITIAL DIRECT
TRANSFER message or UPLINK DIRECT TRANSFER message on signalling radio
bearer SRB3 or signalling radio bearer SRB4 has not yet been confirmed
by RLC:

2\> retransmit those NAS messages to the network on the newly
established radio connection to the target radio access technology.

1\> clear or set variables upon leaving GERAN RRC connected mode as
specified in sub-clause 10.4.

After lower layer connections are successfully established, the mobile
station returns a RADIO BEARER RECONFIGURATION COMPLETE message on UTRAN
channels(s), see 3GPP TS 25.331.

When receiving the RADIO BEARER RECONFIGURATION COMPLETE message (see
3GPP TS 25.331), the network shall release the old channels (see
3GPP TS 25.413).

### 7.10.5 Unsuccesful inter-rat handover at the MS side

If the MS does not succeed in establishing the connection to the UTRA
cell, it shall:

1\> revert back to the old configuration;

1\> establish the GERAN physical channel(s) used at the time of
reception of the INTERSYSTEM HANDOVER TO UTRAN COMMAND message;

1\> if the lower layer failure happens while attempting to connect back
to the old channels;

2\> the PROTOCOL\_ERROR\_REJECT variable is set TRUE;

1\> if the MS does not succeed to establish the GERAN physical
channel(s):

2\> perform a Cell Update procedure according to sub-clause 7.8 with
cause \"radio link failure\";

2\> when the Cell Update procedure has been completed successfully:

3\> proceed as below.

1\> transmit the HANDOVER FAILURE message setting the information
elements as specified below:

2\> include the IE \"*RRC Transaction Identifier*\"; and

2\> set it to the value of \"RRC transaction identifier\" in the entry
for the INTER SYSTEM HANDOVER TO UTRAN COMMAND message in the table
\"Accepted transactions\" in the variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"*Failure Cause*\" to \"physical channel failure\".

2\> when the HANDOVER FAILURE message has been submitted to lower layer
for transmission the procedure ends.

If the INTER SYSTEM TO UTRAN HANDOVER COMMAND instructs the mobile to
use a predefined configuration not implemented or if the INTER SYSTEM TO
UTRAN HANDOVER COMMAND instructs the mobile to use a default
configuration not supported by the MS, the MS shall:

1\> set the variable PROTOCOL\_ERROR\_REJECT to TRUE; and

1\> if allowed by the source RAT:

2\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION;

1\> then stay on the current channel(s) and return a HANDOVER FAILURE
message on SRB2 with cause \"UTRAN configuration unknown\";

> 1\> clear all the UTRAN predefined configurations.

When sending a HANDOVER FAILURE message in response to an INTERSYSTEM TO
UTRAN HANDOVER COMMAND message, the mobile station shall erase all the
UTRAN predefined configurations.

If the INTER SYSTEM TO UTRAN HANDOVER COMMAND message instructs the
mobile station to use a frequency that it is not capable of, then the
mobile station shall:

1\> stay on the current channel(s) and return a HANDOVER FAILURE message
on SRB2 with cause \"frequency not implemented\".

### 7.10.6 Reception of an HANDOVER FAILURE message by GERAN in Iu mode

When HANDOVER FAILURE has been received, the network shall

1\> release the UTRAN channel(s), if they were dedicated channels;

1\> if a HANDOVER FAILURE message is received on the old channels on
SRB2; or

1\> if the GERAN has received CELL UPDATE message with the cause \"Radio
link failure\" then:

2\> the old channels shall be released if they were DBPSCHs and all
contexts related to the connections with that mobile station are
cleared.

7.11 Handover to CDMA2000 procedure
-----------------------------------

### 7.11.1 General

This procedure is only valid for CDMA2000 capable MSs. A change to
CDMA2000 channel(s) can be requested by the network RRC sublayer in
RRC-Cell\_Dedicated state.

The handover to CDMA2000 procedure includes:

\- the disconnection and the deactivation of physical channels and their
release (layer 1).

\- the establishment of CDMA2000 channel(s), see TIA/EIA/IS-833 and
TIA/EIA/IS-2000-5.

### 7.11.2 Initiation

The network initiates the handover to CDMA2000 procedure by sending an
INTER SYSTEM TO CDMA2000 HANDOVER COMMAND message to the mobile station
on the SRB2 in GERAN in *Iu mode*. The INTER SYSTEM TO CDMA2000 HANDOVER
COMMAND message shall contain encapsulated the HANDOVER TO CDMA2000
COMMAND. If the INTER SYSTEM TO CDMA2000 HANDOVER COMMAND refers to a
not known base station (see TIA/EIA/IS-98), this shall not be considered
as an error.

### 7.11.3 Reception of INTERSYSTEM TO CDMA2000 HANDOVER COMMAND message by the MS

Upon the receipt of INTER SYSTEM TO CDMA2000 HANDOVER COMMAND message,
the mobile station shall:

1\> switch to the assigned cell(s) and establish the physical channels
as described in TIA/EIA/IS-833 and TIA/EIA/IS-2000-5.

1\> establish the connection to the CDMA cell, by using the contents of
encapsulated message HANDOVER TO CDMA2000 COMMAND.

1\> in case one or more IEs \"*RAB Info*\" is included in the INTER
SYSTEM TO CDMA2000 HANDOVER COMMAND message:

2\> connect upper layer entities corresponding to indicated RABs to the
radio resources indicated in the inter-RAT message.

2\> and act upon received information element as specified in
sub-clauses 7.18 and 7.19.

### 7.11.4 Successful completion of the inter-RAT handover

NOTE: After lower layer connections are successfully established, the
mobile station returns a Handoff Completion message on CDMA2000
channels(s), see TIA/EIA/IS-833.

When receiving the Handoff Completion message (see TIA/EIA/IS-833 and
3GPP TS 25.413), the network shall release the old channels.

### 7.11.5 Unsuccesful inter-rat handover at the MS side

If the MS does not succeed in establishing the connection to the
CDMA2000 cell (see TIA/EIA/IS-2000-5), it shall:

> 1\> revert back to the old configuration;
>
> 1\> establish the GERAN physical channel(s) used at the time of
> reception of the INTER SYSTEM HANDOVER TO CDMA2000 COMMAND;

1\> if the lower layer failure happens while attempting to connect back
to the old channels;

2\> the PROTOCOL\_ERROR\_REJECT variable is set TRUE;

1\> if the MS does not succeed to establish the GERAN physical
channel(s):

> 2\> perform a Cell Update procedure according to sub-clause 7.8 with
> cause \"radio link failure\";
>
> 2\> when the Cell Update procedure has been completed successfully:

3\> proceed as below.

1\> transmit the HANDOVER FAILURE message setting the information
elements as specified below:

2\> include the IE \"*RRC Transaction Identifier*\"; and

2\> set it to the value of \"RRC transaction identifier\" in the entry
for the INTER SYSTEM HANDOVER TO CDMA2000 COMMAND message in the table
\"Accepted transactions\" in the variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"*Failure Cause*\" to \"physical channel failure\".

1\> when the HANDOVER FAILURE message has been submitted to lower layer
for transmission the procedure ends.

If the INTER SYSTEM TO CDMA2000 HANDOVER COMMAND message instructs the
mobile station to use a frequency that it is not capable of, then the
mobile station shall:

1\> stay on the current channel(s) and return a HANDOVER FAILURE message
on SRB2 with cause \"frequency not implemented\".

### 7.11.6 Reception of an HANDOVER FAILURE message by GERAN in Iu mode

When HANDOVER FAILURE has been received, the network shall

1\> release the CDMA2000 channel(s);

1\> if a HANDOVER FAILURE message is received on the old channels on
SRB2; or

1\> the mobile station has received CELL UPDATE with the cause \"radio
link failure\" then:

2\> the old channels shall be released and all contexts related to the
connections with that mobile station are cleared.

7.12 Mapping of user data substreams onto timeslots in a multislot configuration
--------------------------------------------------------------------------------

For multislot configurations the following rules for mapping of the user
data substreams onto timeslots shall apply for each channel set:

1\> at initial assignment, the lowest numbered user data substream shall
be mapped to the lowest numbered timeslot etc. in ascending order (the
user data substreams are numbered 0 to (n-1), where n is the number of
substreams)

1\> at channel changes using handover procedure or radio bearer
procedures, the lowest numbered user data substream shall be mapped to
the lowest numbered timeslot etc. in ascending order (the user data
substreams are numbered 0 to (n-1), where n is the number of substreams)

1\> at channel changes using radio bearer procedures:

2\> user data substream(s) mapped to timeslot(s) that are present in
both the old and the new configuration shall continue to be mapped to
the same timeslot(s) as before the channel change; and

2\> possibly added timeslot(s) shall carry the lowest numbered available
user data substream so that the lowest numbered data substream among the
added is mapped to the lowest numbered added timeslot and so on in
ascending order.

NOTE: The user data substream number is a number that need not be the
same as the inband number used for transparent services. The user data
substream number is only used as a point of reference to a specific user
data substream.

7.13 Application Procedures
---------------------------

### 7.13.1 LCS transfer

Figure 7.13.1.1: LCS transfer

#### 7.13.1.1 General

The LCS Transfer procedure enables the SMLC on the network side and the
MS to exchange RRLP Protocol Data Units (PDUs). Only the GERAN may
initiate the exchange of RRLP PDU\'s (initiated by the SMLC). The MS
only sends RRLP PDU\'s in the uplink direction in response to RRLP
PDU\'s sent by the GERAN (SMLC).

The maximum size of the RRLP PDU in the LCS DOWNLINK INFORMATION and LCS
UPLINK INFORMATION messages is 242 octets. Since RRLP pseudo
segmentation limits the length of RRLP PDUs, segmentation is not defined
for the LCS Transfer procedure.

#### 7.13.1.2 Intiation of LCS transfer procedure in the GERAN

In the GERAN, the LCS transfer procedure is initiated when the the SMLC
requests the transfer of an RRLP PDU after the initial signaling
connection is established. The GERAN may also initiate the LCS transfer
procedure when another RRC procedure is ongoing, and in that case the
state of the latter procedure shall not be affected. The RRLP PDU in the
LCS DOWNLINK INFORMATION message shall contain a complete RRLP PDU
according to the RRLP protocol 3GPP TS 44.031. The GERAN shall transmit
the LCS DOWNLINK INFORMATION message on the downlink using AM RLC on
signalling radio bearer SRB3.

The SMLC may be a \"stand alone SMLC\" (and therefore not tightly
integrated to the GERAN). This can lead to message loss or truncation
during the Handover procedure (during change of BPSCH).

#### 7.13.1.3 Reception of LCS DOWNLINK INFORMATION message by the MS

When the MS has received an LCS DOWNLINK INFORMATION message, the MS
shall deliver the RRLP PDU to the LCS local application.

The MS shall detect RRLP PDU truncation if an LCS DOWNLINK INFORMATION
message is received carrying an RRLP PDU that is shorter than the
indicated length. If a truncated RRLP PDU is received, RRLP PDU shall be
discarded.

#### 7.13.1.4 Transmission of a response message by the MS

When the LCS local application has received and processed an RRLP PDU
from the LCS DOWNLINK INFORMATION message, one or two RRLP PDU\'s shall
be returned to the GERAN. The MS shall

1\> encapsulate the RRLP PDU received from the LCS local application in
the LCS UPLINK INFORMATION message;

1\> transmit the LCS UPLINK INFORMATION message on the uplink using AM
RLC on signalling radio bearer SRB3;

1\> if a second RRLP PDU is received from the LCS local application,
repeat the previous two steps;

Suspend/Resume functions of lower layers will prevent message loss on
the uplink. If the BPSCH is changed before the RLC ACK is received in
the MS, message duplication is possible in the uplink after change of
the physical channel.

#### 7.13.1.5 Reception of a response message by the GERAN

When the GERAN has received an LCS UPLINK INFORMATION message, the GERAN
shall deliver the RRLP PDU to the SMLC.

The GERAN shall detect RRLP PDU truncation if an LCS UPLINK INFORMATION
message is received carrying an RRLP PDU that is shorter than the
indicated length. If a trucated RRLP PDU is received, the RRLP PDU shall
be discarded.

#### 7.13.1.6 Invalid LCS DOWNLINK INFORMATION message

If the MS receives a LCS DOWNLINK INFORMATION message, which contains a
protocol error causing the variable PROTOCOL\_ERROR\_REJECT to be set to
TRUE according to sub-clause 8, the MS shall perform procedure specific
error handling as follows. The MS shall:

1\> transmit an RRC STATUS message on the SRB2;

1\> include the IE \"*Identification of Received Message*\";

1\> set the IE \"*Received Message Type*\" to LCS DOWNLINK INFORMATION
message;

1\> set the IE \"*RRC Transaction Identifier*\" to the value of \"RRC
transaction identifier\" in the entry for the LCS DOWNLINK INFORMATION
message in the table \"Rejected transactions\" in the variable
TRANSACTIONS;

1\> clear that entry;

1\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION;

> 1\> when the RRC STATUS message has been submitted to lower layers for
> transmission;

2\> continue with any ongoing processes and procedures as if the invalid
LCS DOWNLINK INFORMATION message has not been received.

7.14 Radio Bearer control procedures
------------------------------------

### 7.14.1 Reconfiguration procedures

Figure 7.14.1.1: Radio Bearer Establishment, normal case

Figure 7.14.1.2: Radio Bearer Establishment, MS reverts to old
configuration

Figure 7.14.1.3: Radio Bearer Reconfiguration, normal flow

Figure 7.14.1.4: Radio Bearer Reconfiguration, failure case

Figure 7.14.1.5: Radio Bearer Release, normal case

Figure 7.14.1.6: Radio Bearer Release, MS reverts to old configuration

#### 7.14.1.1 General

The reconfiguration procedures include the following procedures:

\- the Radio Bearer Establishment procedure;

\- the Radio Bearer Reconfiguration procedure;

\- the Radio Bearer Release procedure;

The Radio Bearer Establishment procedure is used to establish new radio
bearer(s).

The Radio Bearer Reconfiguration procedure is used to reconfigure
parameters for a radio bearer.

The Radio Bearer Release procedure is used to release radio bearer(s).

The Radio Bearer Reconfiguration procedure is used to reconfigure
transport channel(s).

#### 7.14.1.2 Initiation

To initiate any one of the reconfiguration procedures, the GERAN shall:

1\> configure new radio links in any new physical channel;

1\> start transmission and reception on the new radio links;

1\> for a Radio Bearer Establishment procedure:

2\> transmit a RADIO BEARER SETUP message on the SRB2;

2\> if signaling radio bearer SRB4 is setup with this procedure and
signaling radio bearers SRB1-SRB3 were already established prior to the
procedure:

3\> if the variable \"LATEST\_CONFIGURED\_CN\_DOMAIN\" has been
initialised:

4\> any radio bearers setup by the same message as signalling radio
bearer SRB4 shall be connected to the CN domain indicated in the
variable \"LATEST CONFIGURED CN DOMAIN\";

1\> for a Radio Bearer Reconfiguration procedure:

2\> transmit a RADIO BEARER RECONFIGURATION message on the SRB2;

1\> for a Radio Bearer Release procedure:

2\> transmit a RADIO BEARER RELEASE message on the SRB2;

1\> for a transport channel reconfiguration (setup, reconfigure or
release) procedure:

2\> transmit a RADIO BEARER SETUP, RADIO BEARER RECONFIGURATION or RADIO
BEARER RELEASE message on the SRB2.

1\> if transport channels are setup, reconfigured or released in uplink
and/or downlink:

2\> set TFCS according to the new transport channel(s).

1\> if transport channels are added or deleted in uplink and/or
downlink, and the IE \"*RB Mapping Info\"* applicable to the new
configuration has not been previously provided to the MS, the GERAN
shall:

2\> send the IE \"*RB Mapping Info\"* for the new configuration.

The RADIO BEARER RECONFIGURATION message shall include in case of SBSS
relocation procedure the structure \"*Downlink Counter Synchronisation
Info*\"and

1\> if ciphering and/or integrity protection are activated:

2\> include new ciphering and/or integrity protection configuration
information to be used after reconfiguration.

If one of the reconfiguration messages is transmited then the IE \"*New
G-RNTI*\" may be present.

NOTE 1: The RADIO BEARER RECONFIGURATION message always includes the IE
\"*RB Information to Reconfigure*\", even if GERAN does not require the
reconfiguration of any RB. In these cases, GERAN may include only the IE
\"*RB Identity*\" within the IE \"*RB Information to Reconfigure*\".

GERAN shall take the MS capabilities into account when setting the new
configuration. If the message is used to initiate a transition from
RRC-Cell\_Dedicated state to RRC-Cell\_Shared state, the RRC may
allocate the new physical resources.

#### 7.14.1.3 Reception of RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION or RADIO BEARER RELEASE message by the MS

If the MS receives the one of the following reconfiguration messages:

\- RADIO BEARER SETUP; or

\- RADIO BEARER RECONFIGURATION; or

\- RADIO BEARER RELEASE;

it shall:

1\> set the variable ORDERED\_RECONFIGURATION to TRUE;

1\> act upon all received information elements as specified in
sub-clause 7.18 and 7.19, unless specified in the following and perform
the actions below.

1\> if a complete reconfiguration, setup or release is indicated in the
reconfiguration messages:

2\> initiate the radio bearer, transport channel and physical channel
reconfiguration in accordance with the received radio bearer, transport
channel and physical channel information elements as is specified in
sub-clauses 7.18 and 7.19.

The MS may first release the physical channel used at reception of the
reconfiguration message (i.e a RADIO BEARER SETUP message, a RADIO
BEARER RECONFIGURATION message or a RADIO BEARER RELEASE message). The
MS shall:

1\> then stop the RLC operation for the duration of the reconfiguration
procedure;

1\> establish a new physical channel and act upon all received
information elements as specified in sub-clause 7.19;

1\> enter a state according to sub-clause 7.19;

1\> continue the RLC operation, if applicable.

NOTE: The RADIO BEARER RECONFIGURATION message always includes the IE
\"*RB Information to Reconfigure*\". GERAN has to include it even if it
does not require the reconfiguration of any RB.

If the MS is in RRC-Cell\_Dedicated state upon reception of the
reconfiguration message and remains in RRC-Cell\_Dedicated state after
that, the MS shall:

1\> stop the RLC operation for the duration of the reconfiguration
procedure;

1\> then establish a new physical channel and act upon all received
information elements as specified in sub-clause 7.19.6 and:

2\> if the IE \"*DBPSCH Description\"* is present then set the network
response times as specified in sub-clause 7.18.12;1\> if the
reconfiguration messages contain the transport channel information
elements:

2\> then establish,reconfigure or release a new transport channel and
act upon all received information elements as specified in sub-clause
7.19.7;

1\> if RADIO BEARER RECONFIGURATION message has been received; and if
the IE \"*DBPSCH Description*\" is present and:

2\> if the following IEs are present IE \"*Handover Reference*\", IE
\"*Power Command and Access Type*\", IE \"*Cell Description*\" and IE
\"*Description of the First Channel After Time*\", the MS shall:

3\> if the IE \"*Synchronization Indication*\" is not present, establish
new physical channel using non-synchronized method as specified in
sub-clause 7.18.6 and act upon all received information elements and
7.19.

3\> if the IE \"*Synchronization Indication*\" is present, establish new
physical channel using one of the synchronized methods as specified
below:

4\> if IE \"*Timing Advance*\" is present and if the IE
\"*Synchronization Indication*\" indicates pre-synchronized type of
physical channel establishment, the MS shall:

5\> establish new physical channel using the pre-synchronized method as
specified in sub-clause 7.18.6 and act upon all received information
elements and 7.19.

4\> if IE \"*Real Time Difference*\" is present and if the IE
\"*Synchronization Indication*\" indicates pseudo-synchronized type of
physical channel establishment, the MS shall:

5\> establish new physical channel using the pseudo-synchronized method
as specified in sub-clause 7.18.6 and act upon all received information
elements and 7.19;

4\> if the IE \"*Synchronization Indication*\" is present and if it
indicates finely synchronized type of physical channel establishment,
the MS shall:

5\> establish new physical channel using the finely synchronized method
as specified in sub-clause 7.18.6 and act upon all received information
elements and 7.19;

2\> if the following IEs, IE \"*Handover Reference*\", IE \"*Power
Command and Access Type*\", IE \"*Cell Description*\" are not present,
the MS shall:

3\> not use the procedures specified in sub-clause 7.18.6;

2\> if at least one of the following IEs, IE \"*Handover Reference*\",
IE \"*Power Command and Access Type*\" and IE \"*Cell Description*\" and
IE \"*Description of the First Channel After Time*\" is not present, the
MS shall:

3\> act as specified in sub-clause 7.14.1.14.

1\> if RADIO BEARER RELEASE message has been received and is indicating
the release of one or more channels, then:

2\> deactivate the physical channel to be released; and

2\> if at least one of the following Transport channel information
elements (IE \"*Deleted DL TrCH Information*\", IE \"*Deleted UL TrCH
Information*\") is present in the message then:

3\> release the transport channels and act upon all received information
elements as specified in sub-clause 7.19.7.

If the RADIO BEARER RECONFIGURATION message refers to a cell to which
the mobile station is not synchronised to (see 3GPP TS 45.008), this
shall not be considered as an error.

NOTE: The network takes into account limitations of certain mobile
stations to understand formats used in the IE \"*Frequency List\"*, IE
\"*Frequency Short List\"*, and IE \"*Cell Channel Description\"* used
in the RADIO BEARER RECONFIGURATION message, see sub-clause 7.19.

If the MS is in RRC-Cell\_Dedicated state when receives the one of the
reconfiguration messages (i.e RADIO BEARER SETUP message, a RADIO BEARER
RECONFIGURATION message or RADIO BEARER RELEASE message) and enters in
RRC-Cell\_Shared state after state transition, the MS shall:

1\> release the dedicated basic physical resources;

1\> act upon all received information elements as specified in
sub-clause 7.19;

1\> if RADIO BEARER RELEASE message has been received and is indicating
the release of one or more channels, then:

2\> deactivate the physical channel to be released; and

2\> if at least one of the following Transport channel information
elements (IE \"*Deleted DL TrCH Information*\", IE \"*Deleted UL TrCH
Information*\") is present in the message then:

3\> release the transport channels and act upon all received information
elements as specified in sub-clause 7.19.7.

If after state transition the MS enters RRC-Cell\_Shared state, the MS
shall:

1\> if timer T305 is not running and if periodical update in the IE
\"*MS Timers and Constants In Connected Mode*\" has been set to any
other value than \"infinity\" in PACKET SYSTEM INFORMATION TYPE16
message;

2\> start timer T305 using its initial value;

1\> if the IE \"*GERAN DRX Cycle Length Coefficient*\" is included in
the received message:

2\> store this IE and apply this coefficient as specified in
3GPP TS 44.160.

If the MS is in RRC-Cell\_Shared state when receives the one of the
reconfiguration messages (i.e RADIO BEARER SETUP message or RADIO BEARER
RECONFIGURATION message or RADIO BEARER RELEASE message) and enters in
RRC-Cell\_Dedicated state after state transition, the MS shall:

1.  establish the dedicated basic physical resources as specified in
    7.19.6.1 and set the network response times as specified in
    sub-clause 7.18.12;

1\> act upon all received information elements as specified in
sub-clause 7.19.6.1;

1\> if RADIO BEARER RELEASE message has been received and is indicating
the release of one or more channels, then:

2\> deactivate the physical channel to be released.

If the MS is in RRC-Cell\_Shared state upon reception of the
reconfiguration message and remains in RRC-Cell\_Shared state after
that, the MS shall:

1\> if IE \"*SBPSCH Description*\" is included then:

2\> establish new physical channels for each RB identity included in the
IE \"*RB Information to Reconfigure*\" and act upon all received
information elements as specified in sub-clause 7.19.

If after state transition the MS enters RRC-GRA\_PCH state, the MS
shall:

1\> if timer T305 is not running and if periodical update in the IE
\"*MS Timers And Constants In Connected Mode*\" has been set to any
other value than \"infinity\" in PACKET SYSTEM INFORMATION TYPE 16
message;

2\> start timer T305 using its initial value;

1\> if the IE \"*GERAN DRX Cycle Length Coefficient*\" is included in
the message:

2\> use the value in the IE \"*GERAN DRX Cycle Length Coefficient*\" for
calculating Paging occasion as specified in sub-clauses 7.18 and 7.19;

1\> if the IE \"*GERAN DRX Cycle Length Coefficient*\" is not included
in the same message:

2\> set the variable INVALID\_CONFIGURATION to TRUE.

The MS shall transmit a response message as specified in 7.14.1.4,
setting the information elements as specified below. The MS shall:

1\> if the received reconfiguration message includes the structure
\"Downlink Counter Synchronisation Info\"; or

1\> if the received reconfiguration message includes the IE \"*New
G-RNTI*\":

2\> if the variable PDCP\_SN\_INFO is empty:

3\> configure the corresponding RLC entity for all AM and UM radio
bearers and AM and UM signalling radio bearers except SRB2 to \"stop\";

2\> else:

3\> configure the RLC entity for signalling radio bearers SRB1, SRB3 and
SRB4 to \"stop\";

3\> configure the RLC entity for UM and AM radio bearers for which the
IE \"*PDCP SN Info*\" is not included to \"stop\";

2\> re-establish SRB2;

2\> for the downlink and the uplink, apply the ciphering configuration
as follows:

3\> if the received re-configuation message included the IE \"*Ciphering
Mode Info*\":

4\> use the ciphering configuration in the received message when
transmitting the response message;

3\> if the ciphering configuration for SRB2 from a previously received
SECURITY MODE COMMAND has not yet been applied because of the activation
times not having been reached:

4\> if the previous SECURITY MODE COMMAND was received due to new keys
being received:

5\> consider the new ciphering configuration to include the received new
keys;

5\> initialise the HFN component of the uplink COUNT-C and downlink
COUNT-C of SRB2 as indicated in subclause 7.16.1.2.3.1.

4\> if the ciphering configuration for SRB2 from a previously received
SECURITY MODE COMMAND has not yet been applied because of the
corresponding activation times not having been reached and the previous
SECURITY MODE COMMAND caused a change in LATEST\_CONFIGURED\_CN\_DOMAIN:

5\> initialise the HFN component of the uplink COUNT-C and downlink
COUNT-C of SRB2 to the most recently transmitted IE \"*START List*\" or
IE \"*START*\" for the LATEST\_CONFIGURED\_CN\_DOMAIN at the reception
of the previous SECURITY MODE COMMAND message.

5\> consider the new ciphering configuration to include the keys
associated with the LATEST\_CONFIGURED\_CN\_DOMAIN;

4\> apply the new ciphering configuration immediately following RLC
re-establishment.

3\> else:

4\> continue using the current ciphering configuration;

2\> set the new uplink and downlink HFN component of COUNT-C of SRB2 to
MAX(uplink HFN component of COUNT-C of SRB2, downlink HFN component of
COUNT-C of SRB2);

2\> increment by one the downlink and uplink values of the HFN component
of COUNT -C for SRB2;

2\> calculate the START value according to sub-clause 7.18.4;

2\> include the calculated START values for each CN domain in the IE
\"*START List*\" in the structure \"*Uplink Counter Synchronisation
Info*\";

1\> if the handover is performed from UTRAN and RADIO BEARER
RECONFIGURATION message is received*:*

2\> set the 20 most significant bits of the uplink and downlink HFN
component of COUNT-C of SRB2 to MAX (uplink HFN~U~, downlink HFN~U~)
where HFN~U~ is the HFN component of COUNT-C of SRB2 in UTRAN;

2\> set the remaining bits of the uplink and downlink HFN component of
COUNT-C of SRB2 equal to zero;

2\> increment by one the downlink and uplink values of the HFN component
of COUNT-C for SRB2;

2\> calculate the START value according to sub-clause 7.18;

2\> include the calculated START values for each CN domain in the IE
\"*START list*\" in the RADIO BEARER RECONFIGURATION COMPLETE message;

2\> set the variable LATEST\_CONFIGURED\_CN\_DOMAIN equal to the
corresponding UTRAN variable*;*

2\> set the variable MS\_CAPABILITY\_TRANSFERRED equal to the
corresponding UTRAN variable *;*

2\> set the variable ESTABLISHED\_RABS equal to the corresponding UTRAN
variable *;*

2\> set the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS equal to the
corresponding UTRAN variable *;*

2\> set the variable CIPHERING\_STATUS equal to the corresponding UTRAN
variable *;*

2\> set the variable START\_THRESHOLD equal to the corresponding UTRAN
variable *;*

2\> set the variable START\_VALUE\_TO\_TRANSMIT equal to the
corresponding UTRAN variable *;*

2\> set IE \"*Status*\" for the ciphering status in the the variable
SECURITY\_MODIFICATION equal to the corresponding UTRAN variable;

2\> set IE \"*Status*\" for the integrity protection in the the variable
INTEGRITY\_PROTECTION\_INFO equal to the corresponding UTRAN variable;

1\> if inter-mode handover is performed from A/Gb *mode* and RADIO
BEARER RECONFIGURATION message is received:

2\> store G-RNTI value (32 bits), which is derived by the IEs \"*SRNC
identity*\" (12 bits) and \"S-RNTI\" (20 bits) shall be derived by
padding the IE \"S-RNTI \" with 10 zero bits in the most significant
positions; and

2\> initialise the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS with
the signalling connections that remains after the handover according to
the specifications of the source;

2\> initialise the variable MS\_CAPABILITIES\_TRANSFERRED with the MS
capabilities that have been transferred to the network up to the point
prior to the handover, if any;

2\> initialise the variable TIMERS\_AND\_CONSTANTS to the default values
and start to use values;

2\> set the IE \"*START*\" for each CN domain, in the IE \"*START
list*\" in the RADIO BEARER RECONFIGURATION COMPLETE message equal to
the START value for each CN domain stored in the USIM if the USIM is
present, or as stored in the MS for each CN domain if the SIM is
present; and then;

2\> set the value of \"THRESHOLD\" in the variable START\_THRESHOLD to
the 20 MSBs of the value stored in the USIM (see 3GPP TS 31.102) for the
maximum value of START for each CN Domain, or to the default value in
3GPP TS 33.102 if the SIM is present.

Keys received while in A/Gb *mode* shall not be regarded as \"new\" (i.e
not trigger the actions in 7.16.1.2.3.1) in a subsequent security
control procedure in GERAN (*Iu mode*), irrespective of whether the keys
are already being used in *A/Gb mode* or not. If the MS has received new
keys in A/Gb *mode* before handover, then the START values in the USIM
(sent in the RADIO BEARER RECONFIGURATION COMPLETE message to BSS) will
not reflect the receipt of these new keys. At a subsequent Security Mode
Control procedure in GERAN *Iu mode*, the MS shall activate ciphering
and/or integrity protection using the key set stored in USIM/SIM.

2\> if ciphering has been activated and ongoing in *A/Gb mode* when the
handover is performed:

3\> for the CN domain included in the IE \"*CN Domain Identity*\" which
is included in the IE \"*RAB Information to Reconfigure*\", or the CS
domain when these IEs are not present:

4\> set the variable LATEST\_CONFIGURED\_CN\_DOMAIN to the value
indicated in the IE \"*CN Domain Identity*\", or to the CS domain when
this IE is not present;

4\> set the 20 MSB of the HFN component of the COUNT-C variable for all
radio bearers using RLC-TM and all signalling radio bearers to the
\"START\" value included in the IE \" *GERAN A/Gb Security* *Info* \";

4\> set the remaining LSBs of the HFN component of COUNT-C for all radio
bearers using RLC-TM and all signalling radio bearers to zero;

4\> not increment the HFN component of COUNT-C for radio bearers using
RLC-TM;

4\> set the IE \"*Status*\" in the variable CIPHERING\_STATUS to
\"Started\";

4\> apply the algorithm according to IE \"*Ciphering Algorithm*\" with
the ciphering key set stored in the USIM/SIM and apply ciphering
immediately upon reception of the RADIO BEARER RECONFIGURATION message.

If ciphering has been activated and ongoing in the A/Gb *mode* from
which inter mode handover is performed, GERAN Iu *mode* should not
include the IE \"*Ciphering Mode Info*\" in the SECURITY MODE COMMAND
message that starts Integrity protection.

2\> if ciphering has not been activated and ongoing in the source BSS:

3\> for the CN domain included in the IE \"*CN Domain Identity*\" which
is included in the IE \"*RAB* *Information To Reconfigure*\", or the CS
domain when these IEs are not present:

4\> set the IE \"*Status*\" in the variable CIPHERING\_STATUS to \"*Not
Started*\".

2\> if the MS has successfully connected to GERAN *Iu mode* then

3\> Set the START value stored in the USIM (see 3GPP TS 31.102) if
present, and as stored in the MS if the SIM is present for any CN domain
to the value \"THRESHOLD\" of the variable START\_THRESHOLD;

1\> if the received reconfiguration message did not include the
structure \"*Downlink Counter Synchronisation Info*\":

2\> if the variable START\_VALUE\_TO\_TRANSMIT is set:

3\> include and set the IE \"*START*\" to the value of that variable;

2\> if the variable START\_VALUE\_TO\_TRANSMIT is not set and the IE
\"*New G-RNTI*\" is included:

3\> calculate the START value according to sub-clause 7.18.4;

3\> include the calculated START values for each CN domain in the IE
\"*START List*\" in the structure \"Uplink Counter Synchronisation
Info\";

2\> if the received reconfiguration message caused a change in the RLC
size for any RB using RLC-AM:

3\> calculate the START value according to sub-clause 7.18.4;

3\> include the calculated START values for the CN domain associated
with the corresponding RB identity in the IE \"*START List*\" in the
structure \"Uplink Counter Synchronisation Info\".

1\> if the received reconfiguration message contained the IE
\"*Ciphering Mode Info*\" or contained the IE \"*Integrity Protection
Mode Info*\":

2\> set the IE \"*Status*\" in the variable SECURITY\_MODIFICATION for
all the CN domains in the variable SECURITY\_MODIFICATION to
\"Affected\";

1\> if the received reconfiguration message (contained the IE
\"*Ciphering Mode Info*\":

2\> include and set the IE \"*Radio Bearer Uplink Ciphering Activation
Time Info*\" to the value of the variable
RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

1\> if the received reconfiguration message did not contain the IE
\"*Ciphering Activation Time for DBPSCH*\" in the IE \"*Ciphering Mode
Info*\":

2\> if prior to this procedure there exist no transparent mode RLC radio
bearers for the CN domain indicated in the IE \"*CN Domain Identity*\"
in the IE \"*RAB info*\":

3\> if, at the conclusion of this procedure, the MS will be in
RRC-Cell\_Dedicated state; and

3\> if, at the conclusion of this procedure, at least one transparent
mode RLC radio bearer exists for the CN domain indicated in the IE \"*CN
Domain Identity*\" in the IE \"*RAB info*\":

4\> include the IE \"*COUNT-C Activation Time*\" and specify a TDMA
frame number for this IE.

NOTE: GERAN does not include the IE \"*Ciphering Mode Info*\" in any
reconfiguration messages unless it is also used to perform an SBSS
relocation with change of ciphering algorithm.

1\> set the IE \"*RRC Transaction Identifier*\" to the value of \"RRC
transaction identifier\" in the entry for the received message in the
table \"Accepted transactions\" in the variable TRANSACTIONS; and

1\> clear that entry;

1\> if the variable PDCP\_SN\_INFO is not empty:

2\> include the IE \"*RB with PDCP Information List*\" and set it to the
value of the variable PDCP\_SN\_INFO;

1\> if the IE \"*Integrity Protection Mode Info*\" was present in the
received reconfiguration message

2\> start applying the new integrity protection configuration in the
uplink for SRB2 from and including the transmitted response message.

If after state transition the MS enters RRC-GRA\_PCH state, the MS
shall, after the transmission of the response message:

1\> if the criteria for GRA Update caused by \"GRA reselection\"
according to sub-clause 7.8 is fulfilled:

2\> initiate a GRA Update procedure according to sub-clause 7.8 using
the cause \"GRA reselection\";

2\> when the GRA Update procedure completed:

3\> the procedure ends.

#### 7.14.1.4 Transmission of a response message by the MS, normal case

In case the procedure was triggered by reception of a RADIO BEARER SETUP
message, the MS shall:

1\> transmit a RADIO BEARER SETUP COMPLETE as response message on the
uplink SRB2

In case the procedure was triggered by reception of a RADIO BEARER
RECONFIGURATION message, the MS shall:

1\> transmit a RADIO BEARER RECONFIGURATION COMPLETE as response message
on the uplink SRB2 ;

In case the procedure was triggered by reception of a RADIO BEARER
RELEASE message, the MS shall:

1\> transmit a RADIO BEARER RELEASE COMPLETE as response message on the
uplink SRB2;

If the new RRC state is RRC-Cell\_Dedicated state or RRC-Cell\_Shared
state, the response message shall be transmitted using the new
configuration after the state transition, and the MS shall:

1\> if the structure \"Downlink Counter Synchronization Info\" was
included in the reconfiguration message; or

1\> if the received reconfiguration message is a RADIO BEARER
RECONFIGURATION and the IE \"*New G-RNTI*\" is included:

2\> when RLC sub-layer has confirmed the successful transmission of the
response message:

3\> if the variable PDCP\_SN\_INFO is empty:

4\> configure the RLC entity for all AM and UM radio bearers and AM and
UM signalling radio bearers except SRB2 to \"continue\";

3\> else:

4\> configure the RLC entity for signalling radio bearers SRB1, SRB3 and
SRB4 to \"continue\";

4\> configure the RLC entity for UM and AM radio bearers for which the
IE \"*PDCP SN Info*\" is not included to \"continue\";

3\> re-establish all AM and UM RLC entities with RB identities larger
than 4 and set the first 20 bits of all the HFN component of the
respective COUNT-C values to the START value included in the response
message for the corresponding CN domain;

3\> re-establish the RLC entities with RB identities 1, 3 and 4 and set
the first 20 bits of all their HFN component of the respective COUNT-C
values to the START value included in the response message for the CN
domain stored in the variable LATEST\_CONFIGURED\_CN\_DOMAIN;

3\> set the remaining bits of the HFN component of COUNT-C values of all
UM RLC entities to zero;

3\> set the remaining bits of the HFN component of the COUNT-C values of
all AM RLC entities to zero, for those bearers to which RLC entitie
where re-established;

3\> if the IE \"*PDCP Context Relocation Info*\" is not present:

4\> re-initialise the PDCP header compression entities of each radio
bearer in the variable ESTABLISHED\_RABS as specified in 3GPP TS 25.323.

3\> if the IE \"*PDCP Context Relocation Info*\" is present:

4\> perform the actions as specified in 7.19.

1\> if the variable PDCP\_SN\_INFO is empty:

2\> if the received reconfiguration message contained the IE
\"*Ciphering Mode Info*\":

3\> when RLC sub-layer has confirmed the successful transmission of the
response message:

4\> notify upper layers upon change of the security configuration;

4\> perform the actions below;

2\> if the received reconfiguration message did not contain the IE
\"*Ciphering Mode Info*\":

3\> when RLC sub-layer has been requested to transmit the response
message:

4\> perform the actions below;

1\> if the variable PDCP\_SN\_INFO is non-empty:

2\> when RLC sub-layer has confirmed the successful transmission of the
response message:

3\> for each radio bearer in the variable PDCP\_SN\_INFO:

4\> if the IE \"*RB Started*\" in the variable ESTABLISHED\_RABS is set
to \"started\":

5\> configure the RLC entity for that radio bearer to \"continue\";

3\> perform the actions below.

If the IE \"*Synchronization Indication*\" is present in the RADIO
BEARER RECONFIGURATION and if requested in the IE \"*Synchronization
Indication*\", the mobile station shall:

1\> include the observed time difference which it has measured when
performing reconfiguration of the physical channels, corrected by half
the timing advance received in the IE \"*Timing Advance*\" in the RADIO
BEARER RECONFIGURATION COMPLETE message (detailed specifications are
given in 3GPP TS 45.010).

If the new RRC state is RRC-GRA\_PCH state, the response message shall
be transmitted using the old configuration before the state transition
and the MS shall:

1\> when RLC sub-layer has confirmed the successful transmission of the
response message:

2\> for each radio bearer in the variable PDCP\_SN\_INFO:

3\> if the IE \"*RB Started*\" in the variable ESTABLISHED\_RABS is set
to \"started\":

4\> configure the RLC entity for that radio bearer to \"continue\";

2\> enter the new RRC state (RRC-Cell\_Shared state or RRC-GRA\_PCH
state, respectively);

2\> perform the actions below.

The MS shall:

1\> set the variable ORDERED\_RECONFIGURATION to FALSE;

1\> if the received reconfiguration message contained the IE
*\"Ciphering Mode Info\":*

2\> resume data transmission on any suspended radio bearer and
signalling radio bearer mapped on RLC-AM or RLC-UM;

2\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

1\> if the received reconfiguration message contained the IE
*\"Integrity Protection Mode Info\":*

2\> allow the transmission of RRC messages on all signalling radio
bearers with any RRC SN;

2\> set the IE \"Reconfiguration\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

1\> clear the variable PDCP\_SN\_INFO;

1\> clear the variable START\_VALUE\_TO\_TRANSMIT;

1\> clear the variable SECURITY\_MODIFICATION*;*

1\> continue RLC operation.

#### 7.14.1.5 Reception of a response message by the GERAN, normal case

When GERAN has received one of the following reconfiguration response
messages:

\- RADIO BEARER SETUP COMPLETE message; or

\- RADIO BEARER RECONFIGURATION COMPLETE message; or

\- RADIO BEARER RELEASE COMPLETE message;

GERAN shall delete the old configuration.

If the IE \"*START*\" or the IE \"*START List*\" is included in
reconfiguration response message, the GERAN shall:

1\> set the START value for each CN domain with the corresponding values
as received in this response message;

1\> consequently, then use the START values to initialise the hyper
frame numbers, in the same way as specified for the MS in sub-clause
7.14.1.3, for any new radio bearers that are established.

If GERAN has ordered a ciphering reconfiguration by including the IE
\"*Ciphering Mode Info*\", GERAN shall:

1\> For radio bearers using RLC-AM or RLC-UM:

2\> use the old ciphering configuration for received RLC PDUs with RLC
sequence number less than the RLC sequence number indicated in the IE
\"*Radio Bearer Uplink Ciphering Activation Time Info*\" sent by the MS;

2\> use the new ciphering configuration for received RLC PDUs with RLC
sequence number greater than or equal to the RLC sequence number
indicated in the IE \"*Radio Bearer Uplink Ciphering Activation Time
Info*\" sent by the MS;

2\> if an RLC reset or re-establishment occurs after the reconfiguration
response message has been received by the GERAN before the activation
time for the new ciphering configuration has been reached:

3\> ignore the activation time; and

3\> apply the new ciphering configuration immediately after the RLC
reset or RLC re-establishment.

1\> For radio bearers using RLC-TM:

2\> use the new ciphering configuration and only begin incrementing the
COUNT-C at the TDMA FRAME NUMBER as indicated in:

3\> the IE \"*Ciphering Activation Time for DBPSCH*\" in the IE
\"*Ciphering Mode Info*\", if included in the message that triggered the
radio bearer control procedure; or

3\> the IE \"*COUNT-C Activation Time*\", if included in the response
message for this procedure.

1\> the procedure ends on the GERAN side

#### 7.14.1.6 Unsupported configuration in the MS

If the GERAN instructs the MS to use a configuration, which it does not
support and/or if the received message causes the variable
UNSUPPORTED\_CONFIGURATION to be set to TRUE, the MS shall:

1\> transmit a failure response as specified in sub-clause 7.14.1.9,
setting the information elements as specified below:

2\> include the IE \"*RRC Transaction Identifier*\"; and

2\> set it to the value of \"RRC Transaction Identifier\" in the entry
for the received message in the table \"Accepted transactions\" in the
variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"*Failure Cause*\" to \"configuration unsupported\";

1\> set the variable UNSUPPORTED\_CONFIGURATION to FALSE;

1\> continue with any ongoing processes and procedures as if the
reconfiguration message was not received.

The procedure ends.

#### 7.14.1.7 Physical channel failure

A physical channel failure occurs in case the criteria defined in 7.18
are not fulfilled.

If the received message (a RADIO BEARER SETUP message, a RADIO BEARER
RECONFIGURATION message or a RADIO BEARER RELEASE message) causes the MS
to enter in RRC-Cell\_Dedicated state and the MS fails to establish the
basic physical subchannel(s) indicated in the received message the MS
shall:

1\> revert to the configuration prior to the reception of the message
(old configuration);

1\> if the old configuration includes dedicated physical channels
(RRC-Cell\_Dedicated state) and the MS is unable to revert to the old
configuration:

2\> initiate a Cell Update procedure according to sub-clause 7.8, using
the cause \"radio link failure\";

2\> after the Cell Update procedure has completed successfully:

3\> proceed as below;

1\> if the old configuration does not include dedicated physical
channels (RRC-Cell\_Shared state):

2\> select a suitable GRA cell according to 7.8;

2\> if the MS selects another cell than the cell the MS camped on upon
reception of the reconfiguration message :

3\> initiate a Cell Update procedure according to sub-clause 7.8, using
the cause \"cell reselection\";

3\> after the Cell Update procedure has completed successfully:

4\> proceed as below;

1\> transmit a failure response message as specified in sub-clause
7.14.1.9, setting the information elements as specified below:

2\> include the IE \"*RRC Transaction Identifier*\"; and

2\> set it to the value of \"RRC transaction identifier\" in the entry
for the received message in the table \"Accepted transactions\" in the
variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"*Failure Cause*\" to \"physical channel failure\";

1\> set the variable ORDERED\_RECONFURATION to FALSE;

1\> continue with any ongoing processes and procedures as if the
reconfiguration message was not received;

The procedure ends.

If the criteria for radio link failure is met in the old configuration
during the reconfiguration procedure as specified in sub-clause 7.18.8
the MS shall:

1\> if MS would have entered in RRC-GRA\_PCH state as a successful
completion of this reconfiguration procedure and MS has already
submitted a response message to lower layers:

> 2\> initiate a Cell Update procedure according to sub-clause 7.8.1.3,
> using the cause \"radio link failure\";

2\> the procedure ends.If the criteria for radio link failure is met in
the new configuration during the reconfiguration procedure (i.e. while
MS is waiting for RLC acknowledgement for a response message.) the MS
shall act as specified in sub-clause 7.18.8 and in addition it shall:

1\> if the received reconfiguration causes:

\- the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS to be
set to TRUE; or

\- the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to be set to TRUE

2\> perform the actions specified in sub-clause 7.14.1.12.2.

#### 7.14.1.8 Cell re-selection

If the MS performs cell re-selection during the reconfiguration
procedure, the MS shall:

1\> initiate a Cell Update procedure, as specified in sub-clause 7.8;

1\> continue with the Reconfiguration procedure.

#### 7.14.1.9 Transmission of a response message by the MS, failure case

The MS shall:

1\> in case of reception of a RADIO BEARER SETUP message:

2\> if the Radio Bearer Establishment procedure affects several radio
bearers:

3\> (may) include the identities of the radio bearers for which the
procedure would have been successful into the RADIO BEARER SETUP FAILURE
message;

2\> transmit a RADIO BEARER SETUP FAILURE as response message on the
SRB2;

1\> in case of reception of a RADIO BEARER RECONFIGURATION message:

2\> if the Radio Bearer Reconfiguration procedure affects several radio
bearers:

3\> (may) include the identities of the radio bearers for which the
procedure would have been successful into the RADIO BEARER
RECONFIGURATION FAILURE message;

2\> transmit a RADIO BEARER RECONFIGURATION FAILURE as response message
on the SRB2;

1\> in case of reception of a RADIO BEARER RELEASE message:

2\> if the Radio Bearer Release procedure affects several radio bearers:

3\> (may) include the identities of the radio bearers for which the
procedure would have been successful into the RADIO BEARER RELEASE
FAILURE message;

2\> transmit a RADIO BEARER RELEASE FAILURE as response message on the
SRB2;

1\> when the response message has been submitted to lower layers for
transmission:

2\> continue with any ongoing processes and procedures as if no
reconfiguration attempt had occurred;

2\> if a lower layer failure happens while attempting to connect back to
the old channels, the standard rules are applied according to 7.19.4.5.

#### 7.14.1.10 Reception of a response message by the GERAN, failure case

When the GERAN has received:

\- the RADIO BEARER SETUP FAILURE message; or

\- the RADIO BEARER RECONFIGURATION FAILURE message; or

\- the RADIO BEARER RELEASE FAILURE message

the GERAN may restore the old and delete the new configuration. Upper
layers shall be notified of the failure.

The procedure ends on the GERAN side.

#### 7.14.1.11 Invalid configuration

If the variable INVALID\_CONFIGURATION is set to TRUE the MS shall:

1\> keep the configuration existing before the reception of the message;

1\> transmit a failure response message as specified in sub-clause
7.14.1.9, setting the information elements as specified below:

2\> include the IE \"*RRC Transaction Identifier*\"; and

3\> set it to the value of \"RRC transaction identifier\" in the entry
for the received message in the table \"Accepted transactions\" in the
variable TRANSACTIONS; and

3\> clear that entry;

2\> set the IE \"*Failure Cause*\" to \"invalid configuration\";

1\> set the variable INVALID\_CONFIGURATION to FALSE;

1\> continue with any ongoing processes and procedures as if the
reconfiguration message was not received;

The procedure ends.

#### 7.14.1.12 Incompatible simultaneous reconfiguration

If the table \"Rejected transactions\" in the variable TRANSACTIONS is
set due to the received message and the variable PROTOCOL\_ERROR\_REJECT
is set to FALSE, the MS shall:

1\> not apply the configuration contained in the received
reconfiguration message;

1\> transmit a failure response message as specified in sub-clause
7.14.1.9, setting the information elements as specified below:

2\> include the IE \"*RRC Transaction Identifier*\"; and

2\> set it to the value of \"RRC transaction identifier\" in the entry
for the received message in the table \"Rejected transactions\" in the
variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"*Failure Cause*\" to \"incompatible simultaneous
reconfiguration\";

1\> continue with any ongoing processes and procedures as if the
reconfiguration message was not received;

The procedure ends.

#### 7.14.1.12.1 Incompatible simultaneous security reconfiguration

If the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION is set to TRUE
due to the received reconfiguration message, the MS shall:

1\> transmit a failure response message as specified in sub-clause
7.14.1.9, setting the information elements as specified below:

2\> include the IE \"*RRC Transaction Identifier*\"; and

2\> set it to the value of \"RRC transaction identifier\" in the entry
for the received message in the table \"Accepted transactions\" in the
variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"*Failure Cause*\" to the cause value \"incompatible
simultaneous reconfiguration\";

1\> set the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION to FALSE;

1\> continue with any ongoing processes and procedures as if the
reconfiguration message was not received.

The procedure ends.

#### 7.14.1.12.2 Cell Update procedure during security reconfiguration

If:

\- a Cell Update procedure according to sub-clause 7.8.1 is initiated;
and

\- the received reconfiguration message causes either,

\- the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS to be
set to TRUE; and/or

\- the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to be set to TRUE;

the MS shall:

1\> release all radio resources;

1\> indicate the release of the established signalling connections (as
stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers; and

1\> clear any entry for the RRC CONNECTION RELEASE message in the tables
\"Accepted transactions\" and \"Rejected transactions\" in the variable
TRANSACTIONS;

1\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

1\> clear the variable ESTABLISHED\_RABS;

1\> if the received reconfiguration message contained the IE
\"*Ciphering Mode Info*\":

2\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

2\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;2\>
clear the variable SECURITY\_MODIFICATION.

1\> if the received reconfiguration message contained the IE
\"*Integrity Protection Mode Info*\":

2\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

2\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

1\> enter RRC-Idle mode;

1\> perform the actions specified in clause 6 and sub-clause 7.18 when
entering RRC- Idle mode from RRC-Connected mode;

1\> the procedure ends.

NOTE: The GERAN shall use radio bearer control messages to perform an
SBSS relocation only in case of state transitions from
RRC-CELL\_Dedicated to RRC-Cell-CELL\_Dedicated state.

#### 7.14.1.13 Invalid received message

If the received reconfiguration message contains a protocol error
causing the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE according
to sub-clause 8, the MSshall perform procedure specific error handling
as follows. The MS shall:

1\> transmit a failure response message as specified in sub-clause
7.14.1.9, setting the information elements as specified below:

2\> include the IE \"*RRC Transaction Identifier*\"; and

2\> set it to the value of \"RRC transaction identifier\" in the entry
for the received message in the table \"Rejected transactions\" in the
variable TRANSACTIONS; and

2\> clear that entry;

2\> set the IE \"*Failure Cause*\" to the cause value \"protocol
error\";

2\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION.

1\> continue with any ongoing processes and procedures as if the
reconfiguration message was not received.

#### 7.14.1.14 Abnormal cases

If the mobile station has no current CA and if it needs a CA to analyse
one of the messages RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION,
or RADIO BEARER RELEASE the MS shall:

1\> stay on the current channel(s); and

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"no cell allocation available\"; and

1\> act and set the variables according with the sub-clauses 7.19 and
10.4.

If the RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION or RADIO
BEARER RELEASE message instructs the MS to use a Channel Description or
Channel Mode that it does not support, or if the Channel Mode to use is
not defined for all channel sets, then the mobile station shall:

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"channel mode unacceptable\"; and

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s) and use the old Channel Description
or Channel Mode(s).

If the RADIO BEARER SETUP, RADIO BEARER RECONFIGURATION or RADIO BEARER
RELEASE message instructs the MS to use a Modulation or Interleaving for
FLO configuration that it does not support, or if the Mode and
Modulation to use is not defined for all channel sets, then the mobile
station shall:

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"channel mode unacceptable\"; and

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s) and use the old configuration.

If the mobile station receives the RADIO BEARER SETUP or RADIO BEARER
RECONFIGURATION or RADIO BEARER RELEASE message containing an
inconsistent IE \"*MultiRate Configuration*\", then the mobile station
shall:

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"channel mode unacceptable\"; and

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s) and use the old Channel Description
or Channel Mode(s).

If during the initial assignment of the multirate speech the mobile
station receives RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION or
RADIO BEARER RELEASE message and the IE \"*MultiRate Configuration*\" is
not present, then the mobile station shall:

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"channel mode unacceptable\"; and

1\> act and set the variables according with the sub-clause 7.19.; and

1\> remain on the current channel(s) and use the old Channel Description
or Channel Mode(s).

If the RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION or RADIO
BEARER RELEASE message instructs the mobile station to use a frequency
that it is not capable of, then the mobile station shall:

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"frequency not implemented\"; and

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s).

If MS receives the RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION or
RADIO BEARER RELEASE message with a IE \"*Frequency List*\" indicating
frequencies that are not all in one band, then the mobile station shall:

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"frequency not implemented\"; and

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s).

If the mobile station receives the RADIO BEARER SETUP or RADIO BEARER
RECONFIGURATION or READIO BEARER RELEASE message with a IE *Mobile
Allocation* indexing frequencies that are not all in one band, then the
mobile station shall:

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"frequency not implemented\"; and

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s).

NOTE: A RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION or RADIO
BEARER RELEASE message sent to a multi band mobile station shall not be
considered invalid because it indicates frequencies that are all in a
different frequency band to that of the current channel.

If the mobile station receives RADIO BEARER RECONFIGURATION message with
a IE *Mobile Allocation* indexing frequencies that are not all in one
band and a IE *Starting Time* indicating a time that has not elapsed
then the mobile station shall:

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s).

1\> send a RRC STATUS message with cause \"frequency not implemented\".

If the mobile station receives a RADIO BEARER RECONFIGURATION message
with a IE \"*Mobile Allocation*\" indexing frequencies that are not all
in one band and a IE \"*Starting Time*\" indicating a time that has
elapsed, then the mobile station shall act and set the variables
according with the sub-clause 7.19.

If the mobile station receives a RADIO BEARER RECONFIGURATION message
with the IE \"*Synchronization Indication*\" and the IE \"*Timing
Advance* \" included; and

If synchronous or pseudo-synchronous (see sub-clause 7.18.6) physical
channel establisment is performed, when using Radio Bearer
Reconfiguration procedure; and

If the mobile station knows that the timing advance with the new cell is
out of range, i.e. is bigger than the maximum timing advance that can be
coded as specified in 3GPP TS 44.004; and

If the new cell does not accept out of range timing advance as indicated
in the RADIO BEARER RECONFIGURATION message, the mobile station shall:

1\> send a a failure message according with sub-clause 7.14.1.9 on the
SRB2 and does not attempt that reconfiguration as defined in sublcause
7.14.1.3;

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s).

If the mobile station receives a RADIO BEARER RECONFIGURATION message
with IE \"*Frequency Short List*\" indicating frequencies that are not
all in one band, then the mobile station shall:

1\> send the failure message according to sub-clause 7.14.1.9 with cause
\"frequency not implemented\"; and

1\> act and set the variables according with the sub-clauses 7.19 and
10.4.; and

1\> remain on the current channel(s).

If \"*Synchronization Indication*\" IE is present in RADIO BEARER
RECONFIGURATION message and if it indicates non- synchronized type of
physical channel establishment (see sub-clause 7.18.6), and if timer
T3124 times out or if a lower layer failure happens on the new channel
before the RADIO BEARER RECONFIGURATION COMPLETE message has been sent,
the mobile station shall:

1\> deactivate the new channels, reactivates the old channels;

1\> reconnect the DBPSCHs if any;

1\> then send a failure message as specified in sub-clause 7.14.1.9; and

1\> resume normal operation as if no physical channel establishment (see
sub-clause 7.18.6) attempt had occurred. The operational parameters
(e.g. ciphering mode) when returning on the old channel are those
applied before the RADIO BEARER RECONFIGURATION message was received.

If the mobile station receives a RADIO BEARER RECONFIGURATION message
and if at least one of the following IEs, IE \"*Handover Reference*\",
IE \"*Power Command and Access Type*\", IE \"*Cell Description*\" and IE
\"*Description of the first channel after time*\" is not present, the MS
shall:

1\> send a a failure message according with sublcause 7.14.1.9 on the
SRB2 and does not attempt that reconfiguration as defined in sublcause
7.14.3;

1\> act and set the variables according with the sub-clauses 7.19 and
10.4; and

1\> remain on the current channel(s).

If the mobile station receives a RADIO BEARER RECONFIGURATION message
and if only IE \"*Power Command*\" is present, the MS shall:

1\> send a a failure message according with sublcause 7.14.1.9 on the
SRB2 and does not attempt that reconfiguration as defined in sublcause
7.14.3 and 10.4;

1\> act and set the variables according with the sub-clause 7.19 and
10.4.

If IE \"*SBPSCH Description*\" is present in the reconfiguration
messages and if RLC data blocks are not received in the T3190 seconds(as
specified in TS 44.060), the mobile station shall:

1\> deactivate the new channels, reactivates the old channels;

1\> reconnect the SBPSCHs if any;

1\> then send a failure message as specified in sub-clause 7.14.1.9 with
a cause \"protocol error unspecified\"; and

1\> resume normal operation as if no physical channel establishment (see
sub-clause 7.18.6) attempt had occurred. The operational parameters
(e.g. ciphering mode) when returning on the old channel are those
applied before the reconfiguration message was received.

If IE \"*SBPSCH Description*\" is present in the reconfiguration
messages and if the mobile station has been assigned more PDCHs than it
supports according to its MS multislot class or if the mobile station
has been assigned a TBF in EGPRS TBF mode and the MS does not support
EGPRS, or if the MS has been assigned an MCS (e.g. 8-PSK in the uplink)
that the MS does not support or if the failure is due to any other
reason, return to MAC-Idle state and cell reselection continues.

The MS shall:

1\> then send a failure message as specified in sub-clause 7.14.1.9 with
a cause \"protocol error unspecified\"

### 7.14.2 MS initiated DTM procedures while in RRC-Cell\_Dedicated-MAC-Dedicated state

#### 7.14.2.1 General

While in RRC-Cell\_Dedicated-MAC-Dedicated state, the establishment of
one or more SBPSCHs may be initiated by the RRC entity of the mobile
station using the DTM Request procedure. The procedure is used only for
existing radio bearers and is triggered by a request from upper layers
to transfer an upper layer PDU.

#### 7.14.2.2 Initiation of the DTM Request procedure by the MS

The mobile station initiates the DTM Request procedure by sending a
GERAN Iu mode DTM REQUEST message on the SRB2.

The MS shall set the IEs in the GERAN Iu mode DTM REQUEST message as
follows:

1\> calculate the START according to sub-clause 7.19.4 for the CN domain
as set in the IE \"*CN Domain Identity*\"; and

2\> include the calculated START value for that CN domain in the IE
\"*START*\";

1\> include IE \"*Iu mode* *RRC Channel RequestDescription*\" to
indicate the establishment cause, as applicable, a request to send user
data, page response or a mobility management message;

1\> may include \"*Integrity Check Info*\" IE. If the IE is included,
act as is specified in sub-clause 7.19.4.6;

The MS shall:

1\> transmit the GERAN Iu mode DTM REQUEST message on the uplink SRB 2;

1\> start timer T3148.

#### 7.14.2.3 Reception of a GERAN Iu mode DTM REQUEST message by the GERAN

##### 7.14.2.3.1 General

Upon receiving a GERAN Iu mode DTM REQUEST message, GERAN shall either:

1\> transmit the RADIO BEARER RECONFIGURATION message on the downlink
SRB 2 as specified in sub-clause 7.14.2.3.2; or

1\> transmit the GERAN Iu mode DTM REJECT message on the downlink SRB 2
as specified in sub-clause 7.14.2.3.3.

##### 7.14.2.3.2 SBPSCH assignment

On receipt of a GERAN Iu mode DTM REQUEST message the network may
allocate one or more uplink SBPSCH(s) for the mobile station. The
SBPSCH(s) are assigned to the mobile station in the RADIO BEARER
RECONFIGURATION message.

The RADIO BEARER RECONFIGURATION is sent on SRB2 as specified in
sub-clause 7.14.1. If frequency hopping is applied, the mobile station
shall use the cell allocation defined for the cell to decode the mobile
allocation.

The allocation of the uplink SBPSCH(s) may imply the reallocation of the
DBPSCH(s). The RADIO BEARER RECONFIGURATION message shall not be used to
change to a dependent configuration.

On receipt of a RADIO BEARER RECONFIGURATION message the mobile station
shall stop T3148.

If the received RADIO BEARER RECONFIGURATION message includes uplink
SBPSCH(s), the mobile station shall proceed as specified in
sub-clause 7.14.1.3. If the received RADIO BEARER RECONFIGURATION
message includes downlink SBPSCH(s) and no uplink SBPSCH(s), the mobile
station shall stop T3148, abort the DTM request procedure and proceed as
specified in sub-clause 7.14.1.3, and then attempt an establishment of
uplink TBF, using the applicable procedure specified in 3GPP TS 44.160.

If the RADIO BEARER RECONFIGURATION includes allocation of one or more
uplink SBPSCHs but the resources can not be allocated for all RBs
requested by the mobile station, then failure is triggered for the radio
bearers to which resources where not granted and T3148 is stopped.
Request of resources for failed RBs is then done as specified in
3GPP TS 44.160.

##### 7.14.2.3.3 DTM Request rejection

If the network cannot allocate the requested SBPSCH(s) it may send to
the mobile station a GERAN Iu mode DTM REJECT message on the SRB2. This
message shall contain

1\> the \"*Wait Indication*\" IE;

1\> the \"*RB Identity*\" IE set to the RB\_IDENTITY;

1\> the \"*RRC transaction identifier*\" IE set to the the value of
\"RRC transaction identifier\" in the entry for the GERAN Iu mode DTM
REJECT message in the table \"Rejected transactions\" in the variable
TRANSACTIONS;

1\> the \"*Failure Cause*\" IE set to the cause value \"protocol
error\";

1\> the \"*Protocol Error Information*\" IE with contents set to the
value of the variable PROTOCOL\_ERROR\_INFORMATION.

##### 7.14.2.3.4 Reception of a GERAN Iu mode DTM REJECT message by the MS, normal case

On receipt of the GERAN Iu mode DTM REJECT message, the mobile station
shall:

1\> stop T3148;

1\> notify upper layers of a SBPSCH establishment failure;

1\> start timer T3142 with the value given in the \"*Wait Indication*\"
information element.

The mobile station is not allowed to make a new attempt for a DTM
request procedure in the same cell until T3142 expires. The value of the
wait indication (i.e. T3142) relates to the cell from which it was
received.

After sending GERAN Iu mode DTM REQUEST message the MS shall wait for
the response from the network or expiry of timer T3148 before it may
initiate new DTM Request procedure.

The GERAN Iu mode DTM Reject procedure rejects all pending requests that
were sent in the previous GERAN Iu mode DTM Request message.

##### 7.14.2.3.5 Invalid GERAN Iu mode DTM REJECT message

If the MS receives an GERAN Iu mode DTM REJECT message which contains a
protocol error causing the variable PROTOCOL\_ERROR\_REJECT to be set to
TRUE according to sub-clause 8, the MS shall perform procedure specific
error handling as follows:

The MS shall:

1\> set the variable PROTOCOL\_ERROR\_INDICATOR to TRUE;

1\> set the IEs in the GERAN Iu mode DTM REQUEST message as specified in
sub-clause 7.14.2.2;

1\> transmit the GERAN Iu mode DTM REQUEST message on the uplink SRB 2;

1\> start timer T3148.

#### 7.14.2.4 Abnormal cases

Abnormal cases related to radio bearer reconfiguration procedures are
defined in sub-clause 7.14.1.14.

In the following cases a GERAN Iu mode DTM Request failure has occurred:

\- At expiry of T3148;

\- If a RADIO BEARER RECONFIGURATION message indicates resources in a
non-supported frequency band. The cause value is \"frequency not
implemented\". The actions are defined in sub-clause 7.14.1.14.

\- If the information available in the mobile station after the
reception of a RADIO BEARER RECONFIGURATION message does not
satisfactorily define uplink packet resources. The cause value is
\"protocol error unspecified\". The actions are defined in sub-clause
7.14.1.14.

\- If a RADIO BEARER RECONFIGURATION message includes a mobile
allocation or a frequency list that indexes frequencies in more than one
frequency band. The cause value is \"frequency not implemented\". The
actions are defined in sub-clause 7.14.1.14.

\- If a RADIO BEARER RECONFIGURATION message assigns resources not
compliant with the multislot capabilities of the mobile station. The
cause value is \"channel mode unacceptable\". The actions are defined in
sub-clause 7.14.1.14.

\- If the mobile station has no current CA and if it needs a CA to
analyse the RADIO BEARER RECONFIGURATION message. The cause value is
\"no cell allocation available\". The actions are defined in sub-clause
7.14.1.14.

\- If the RADIO BEARER RECONFIGURATION message instructs the mobile
station to use a channel description or mode that it does not support.
The cause value is \"channel mode unacceptable\". The actions are
defined in sub-clause 7.14.1.14.

\- If the RADIO BEARER RECONFIGURATION message does not include any
uplink or downlink packet resources. The cause value is \"protocol error
unspecified \". The actions are defined in sub-clause 7.14.1.4.

#### 7.14.2.5 T3148 expiry

> On expiry of timer T3148 DTM Request procedure has failed on the
> mobile station side. The mobile station shall then reinitiate DTM
> Request procedure unless it has already been reinitiated 4 times. In
> that case DTM Request procedure shall be aborted.

7.15 Signalling flow procedures
-------------------------------

### 7.15.1 Signalling connection release procedure

#### 7.15.1.1 General

Figure 7.15.1.1.1: Signalling Connection Release procedure, normal case

The Signalling Connection Release procedure is used to notify to the MS
that one of its ongoing signalling connections has been released. The
procedure does not initiate the release of the RRC connection.

#### 7.15.1.2 Initiation of SIGNALLING CONNECTION RELEASE by the GERAN

To initiate the procedure, the GERAN transmits a SIGNALLING CONNECTION
RELEASE message on SRB 2 .

#### 7.15.1.3 Reception of SIGNALLING CONNECTION RELEASE by the MS

Upon reception of a SIGNALLING CONNECTION RELEASE message, the MS shall:

1\> indicate the release of the signalling connection and pass the value
of the IE \"*CN Domain Identity*\" to upper layers;

1\> remove the signalling connection with the identity indicated by the
IE \"*CN Domain Identity*\" from the variable
ESTABLISHED\_SIGNALLING\_CONNECTIONS;

1\> clear the entry for the SIGNALLING CONNECTION RELEASE message in the
table \"Accepted transactions\" in the variable TRANSACTIONS;

1\> the procedure ends.

#### 7.15.1.4 Invalid SIGNALLING CONNECTION RELEASE message

If the MS receives a SIGNALLING CONNECTION RELEASE message, which
contains a protocol error causing the variable PROTOCOL\_ERROR\_REJECT
to be set to TRUE according to sub-clause 8, the MS shall perform
procedure specific error handling as follows:

1\> include the IE \"*Identification of Received Message*\"; and

2\> set the IE \"*Received Message Type*\" to SIGNALLING CONNECTION
RELEASE;

2\> set the IE \"*RRC Transaction Identifier*\" to the value of \"RRC
transaction identifier\" in the entry for the SIGNALLING CONNECTION
RELEASE message in the table \"Rejected transactions\" in the variable
TRANSACTIONS; and

2\> clear that entry;

1\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION;

1\> transmit an RRC STATUS message on SRB 2 uplink;

1\> when the RRC STATUS message has been submitted to lower layers for
transmission:

2\> continue with any ongoing processes and procedures as if the invalid
SIGNALLING CONNECTION RELEASE message has not been received.

#### 7.15.1.5 Invalid configuration

If radio access bearers for the CN domain indicated by the IE \"CN
domain identity\" exist in the variable ESTABLISHED\_RABS, the MS shall:

1\> transmit an RRC STATUS message on SRB 2 uplink using AM RLC;

1\> include the IE \"*Identification of Received Message*\"; and

1\> set the IE \"*Received Message Type*\" to SIGNALLING CONNECTION
RELEASE; and

1\> set the IE \"*RRC Transaction Identifier*\" to the value of \"RRC
transaction identifier\" in the entry for the SIGNALLING CONNECTION
RELEASE message in the table \"Accepted transactions\" in the variable
TRANSACTIONS and clear that entry;

1\> include the IE \"*Protocol Error Information*\" with contents set to
the value \"Message not compatible with receiver state\";

1\> when the RRC STATUS message has been submitted to lower layers for
transmission:

2\> continue with any ongoing processes and procedures as if the invalid
SIGNALLING CONNECTION RELEASE message has not been received.

### 7.15.2 Signalling connection release indication procedure

#### 7.15.2.1 General

Figure 7.15.2.1.1: Signalling Connection Release Indication procedure,
normal case

The Signalling Connection Release Indication procedure is used by the MS
to indicate to the GERAN that one of its signalling connections has been
released. The procedure may in turn initiate the RRC connection release
procedure.

#### 7.15.2.2 Initiation

The MS shall, on receiving a request to release (abort) the signalling
connection from upper layers:

1\> if a signalling connection in the variable
ESTABLISHED\_SIGNALLING\_CONNECTIONS for the specific CN domain
identified with the IE \"*CN domain identity*\" exists:

2\> initiate the signalling connection release indication procedure.

1\> otherwise:

2\> abort any ongoing establishment of signalling connection for that
specific CN domain as specified in 7.15.2.2a.

Upon Initiation of the Signalling Connection Release Indication
procedure in RRC-GRA\_PCH state, the MS shall:

1\> perform a Cell Update procedure, according to sub-clause 7.8, using
the cause \"uplink data transmission\";

1\> when the Cell Update procedure completed successfully:

2\> continue with the signalling connection release indication procedure
as described below;

The MS shall:

1\> set the IE \"*CN Domain Identity*\" to the value indicated by the
upper layers. The value of the IE indicates the CN domain whose
associated signalling connection the upper layers are indicating to be
released;

1\> remove the signalling connection with the identity indicated by
upper layers from the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

1\> transmit a SIGNALLING CONNECTION RELEASE INDICATION message on SRB
2.

When the successful delivery of the SIGNALLING CONNECTION RELEASE
INDICATION message has been confirmed by RLC sub-layer the procedure
ends.

#### 7.15.2.2a RLC re-establishment, inter-mode handover or inter-RAT change

If a re-establishment of RLC on signalling radio bearer SRB2 occurs
before the successful delivery of the SIGNALLING CONNECTION RELEASE
INDICATION message has been confirmed by RLC sublayer, the MS shall:

1\> retransmit the SIGNALLING CONNECTION RELEASE INDICATION message on
the uplink using signalling radio bearer SRB2.

If an inter-RAT handover from GERAN procedure occurs before the
successful delivery of the SIGNALLING CONNECTION RELEASE INDICATION
message has been confirmed by RLC sublayer, the MS shall:

1\> abort the signalling connection while in the new RAT.

If an inter-mode handover procedure occurs before the successful
delivery of the SIGNALLING CONNECTION RELEASE INDICATION message has
been confirmed by RLC sublayer, the MS shall:

1\> abort the signalling connection while in A/Gb mode*.*

#### 7.15.2.3 Reception of SIGNALLING CONNECTION RELEASE INDICATION by the GERAN

Upon reception of a SIGNALLING CONNECTION RELEASE INDICATION message,
the GERAN requests the release of the signalling connection from upper
layers. Upper layers may then initiate the release of the signalling
connection.

7.16 Security mode control
--------------------------

### 7.16.1 Security mode control

Figure 7.16.1.1: Security mode control procedure

#### 7.16.1.1 General

The purpose of this procedure is to trigger the start of ciphering or to
command the restart of the ciphering with a new ciphering configuration,
for the radio bearers of one CN domain and for all signalling radio
bearers.

It is also used to start integrity protection or to modify the integrity
protection configuration for all signalling radio bearers.

#### 7.16.1.2 Initiation

##### 7.16.1.2.1 Ciphering configuration change

To start/restart ciphering, GERAN sends a SECURITY MODE COMMAND message
on one downlink SRB2 using the most recent ciphering configuration. If
no such ciphering configuration exists then the SECURITY MODE COMMAND
message is not ciphered. The GERAN shall not transmit a SECURITY MODE
COMMAND message to signal a change in ciphering algorithm.

When configuring ciphering, GERAN shall ensure that the MS needs to
store at most two different ciphering configurations (keyset and
algorithm) per CN domain, in total over all radio bearers at any given
time. For signalling radio bearers the total number of ciphering
configurations that need to be stored is at most three.

Prior to sending the SECURITY MODE COMMAND message, for the CN domain
indicated in the IE \"*CN Domain Identity*\" in the SECURITY MODE
COMMAND message, the GERAN shall:

1\> suspend all radio bearers using RLC-AM or RLC-UM and suspend all
signalling radio bearers using RLC-AM or RLC-UM, except the signalling
radio bearer used to send the SECURITY MODE COMMAND message on the
downlink SRB2 according to the following:

2\> send an indication to lower layers:

3\> not to transmit RLC PDUs with sequence number greater than or equal
to the number in IE \"*RB Downlink Ciphering Activation Time Info*\" in
the IE \"*Ciphering Mode Info*\" on all suspended radio bearers and all
suspended signalling radio bearers;

3\> set, for the signalling radio bearer used to send the SECURITY MODE
COMMAND message, the \"RLC sequence number\" in IE \"*RB Downlink
Ciphering Activation Time Info*\" in the IE \"*Ciphering Mode Info*\",
at which time the new ciphering configuration shall be applied;

1\> if a transparent mode radio bearer for this CN domain exists

2\> include the \"Ciphering Activation Time for DBPSCH\" in IE
\"*Ciphering Mode Info*\", at which time the new ciphering configuration
shall be applied;

2\> GERAN chooses the value for the \" Ciphering Activation Time for
DBPSCH \" such that the new ciphering configuration will occur after all
the pending ciphering activation times have been reached for the
transparent mode radio bearers of this CN domain.

1\> consider an ciphering activation time in downlink to be pending
until the RLC sequence number of the next RLC PDU to be transmitted for
the first time is equal to or larger than the selected activation time;

1\> set, for each suspended radio bearer and signalling radio bearer
that has no pending ciphering activation time set by a previous security
mode control procedure, an \"RLC sequence number\" in IE \"*RB Downlink
Ciphering Activation Time Info*\" in the IE \"*Ciphering Mode Info*\",
at which time the new ciphering configuration shall be applied;

1\> set, for each suspended radio bearer and signalling radio bearer
that has a pending ciphering activation time set by a previous security
mode control procedure, the \"RLC sequence number\" in IE \"*RB Downlink
Ciphering Activation Time Info*\" in the IE \"*Ciphering Mode Info*\" to
the value used in the previous security mode control procedure, at which
time the latest ciphering configuration shall be applied.

1\> if Integrity protection has already been started for the MS; and

2\> if for the CN domain indicated in the IE \"*CN* *Domain Identity*\"
in the SECURITY MODE COMMAND message, a new security key set (new
ciphering and integrity protection keys) has been received from upper
layers since the transmission of the last SECURITY MODE COMMAND message
for that CN domain:

3\> include the IE \"*Integrity Protection Mode Info*\" in the SECURITY
MODE COMMAND message

1\> if integrity protection has already been started for the MS; and

2\> if the IE \"*CN Domain Identity*\" in the SECURITY MODE COMMAND
message is different from the IE \"*CN Domain Identity*\" that was sent
in the previous SECURITY MODE COMMAND message to the MS:

3\> include the IE \"*Integrity Protection Mode Info*\" in the SECURITY
MODE COMMAND message

1\> transmit the SECURITY MODE COMMAND message on the downlink SRB2.

##### 7.16.1.2.2 Integrity protection configuration change

To start or modify integrity protection, the GERAN sends a SECURITY MODE
COMMAND message on the downlink SRB2 using the new integrity protection
configuration. The GERAN shall not modify integrity protection for a CN
domain for which a SECURITY MODE COMMAND message configuring integrity
protection has been previously sent for an ongoing signalling connection
unless the application of new integrity keys needs to be signalled to
the MS. The GERAN shall not transmit a SECURITY MODE COMMAND message to
signal a change in integrity protection algorithm.

When configuring Integrity protection, the GERAN shall:

1\> ensure that the MS needs to store at most three different Integrity
protection configurations (keysets) at any given time. This includes the
total number of Integrity protection configurations for all signalling
radio bearers.

1\> if Ciphering has already been started for the MS for the CN domain
to be set in the IE \"*CN Domain Identity*\" in the SECURITY MODE
COMMAND message; and

2\> if for the CN domain indicated in the IE \"*CN* *Domain Identity*\"
in the SECURITY MODE COMMAND message, a new security key set (new
ciphering and integrity protection keys) has been received from upper
layers since the transmission of the last SECURITY MODE COMMAND message
for that CN domain:

3\> include the IE \"*Ciphering Mode Info*\" in the SECURITY MODE
COMMAND message;

1\> if Ciphering has already been configured for the MS for a CN domain
different from the CN domain to be set in the IE \"*CN Domain
Identity*\" in the SECURITY MODE COMMAND;

2\> include the IE \"*Ciphering Mode Info*\" in the SECURITY MODE
COMMAND message;

Prior to sending the SECURITY MODE COMMAND message, for the CN domain
indicated in the IE \"*CN Domain Identity*\" in the SECURITY MODE
COMMAND message, the GERAN shall:

1\> if this is the first SECURITY MODE COMMAND message sent for this RRC
connection:

2\> if new keys have been received:

3\> initialise the hyper frame numbers as follows:

4\> set all bits of the hyper frame numbers of the COUNT-I values for
all signalling radio bearers to zero;

2\> else (if new keys have not been received):

3\> use the value \"START\" in the most recently received IE \"*START
List*\" or IE \"*START*\" that belongs to the CN domain indicated in the
IE \"*CN Domain Identity*\" to initialise all hyper frame numbers of
COUNT-I for all the signalling radio bearers; by:

4\> setting the 20 most significant bits of the hyper frame numbers for
all signalling radio bearers to the value \"START\" in the most recently
received IE \"*START List*\" or IE \"*START*\" for that CN domain;

4\> setting the remaining bits of the hyper frame numbers equal to zero;

1\> else (this is not the first SECURITY MODE COMMAND message sent for
this RRC connection):

2\> if new keys have been received;

3\> initialise the hyper frame number for COUNT-I for SRB2 as follows:

4\> set all bits of the HFN of the COUNT-I value for SRB2 to zero;

2\> if new keys have not been received;

3\> initialize the hyper frame number for COUNT-I for SRB2 as follows:

4\> set the 20 most significant bits of the HFN of the downlink and
uplink COUNT-I to the value of the most recently received IE \"*START*\"
or IE \"*START List*\" for the CN domain to be set in the the IE \"*CN
Domain Identity*\";

4\> set the remaining bits of the HFN of the downlink and uplink COUNT-I
to zero;

1\> if the IE \"*Integrity Protection Mode Command*\" has the value
\"Start\":

2\> prohibit the transmission of signalling messages with any RRC SN on
all signalling radio bearers, except SRB2;

2\> set the FRESH value in the IE \"*Integrity Protection Initialisation
Number*\", included in the IE \"*Integrity Protection Mode Info*\";

1\> if the IE \"*Integrity Protection Mode Command*\" has the value
\"Modify\":

2\> for each signalling radio bearer SRBn, except SRB2:

3\> prohibit the transmission of signalling messages with RRC SN greater
or equal to the RRC sequence number in entry for signalling radio bearer
n in the \"RRC message sequence number list\" in the IE \"*Downlink
Integrity Protection Activation Info*\", included in the IE \"*Integrity
Protection Mode Info*\";

2\> consider an integrity protection activation time in downlink to be
pending until the selected activation time is equal to the next RRC
sequence number to be used, which means that the last RRC message using
the old integrity protection configuration has been transmitted to lower
layers;

2\> set, for each signalling radio bearer SRBn, that has no pending
integrity protection activation time set by a previous security mode
control procedure, an RRC sequence number in entry for signalling radio
bearer n in the \"RRC message sequence number list\" in the IE
\"*Downlink Integrity Protection Activation Info*\", included in the IE
\"*Integrity Protection Mode Info*\", at which time the new integrity
protection configuration shall be applied;

2\> set, for each signalling radio bearer SRBn, that has a pending
integrity protection activation time set by a previous security mode
control procedure, the RRC sequence number in entry for signalling radio
bearer n in the \"RRC message sequence number list\" in the IE
\"*Downlink Integrity Protection Activation Info*\", included in the IE
\"*Integrity Protection Mode Info*\", to the value used in the previous
security mode control procedure, at which time the latest integrity
protection configuration shall be applied;

1\> transmit the SECURITY MODE COMMAND message on SRB2 using the new
integrity protection configuration.

NOTE 1: In the case of re-initialisation of Integrity Protection at HFN
wrap around, the network takes into account the MS actions as described
in sub-clauses 7.18.5.1 and 7.18.5.2

NOTE 2: After the SECURITY MODE COMMAND message is transmitted, the
network needs to ensure that it can revert back to the old integrity
protection until it receives a SECURITY MODE COMPLETE message, and take
into account the MS actions when the Security Mode Control procedure is
unsuccessful. The network is also aware that the MS may revert to old
configuration when waiting for the acknowledgement from layer 2 for
SECURITY MODE COMPLETE message, and it has to act accordingly.

##### 7.16.1.2.3 Reception of SECURITY MODE COMMAND message by the MS

Upon reception of the SECURITY MODE COMMAND message, the MS shall :

1\> if neither IE \"*Ciphering Mode Info*\" nor IE \"*Integrity
Protection Mode Info*\" is included in the SECURITY MODE COMMAND:

2\> set the variable INVALID\_CONFIGURATION to TRUE.

1\> if the IE \"*Security Capability*\" is the same as indicated by
variable MS\_CAPABILITY\_TRANSFERRED, and the IE \"*GSM MS* *Security
Capability*\" (if included in the SECURITY MODE COMMAND message) is the
same as indicated by the variable MS\_CAPABILITY\_TRANSFERRED:

2\> set the variable LATEST\_CONFIGURED\_CN\_DOMAIN equal to the IE
\"*CN Domain Identity*\";

2\> set the IE \"*Status*\" in the variable SECURITY\_MODIFICATION
message for the CN domain indicated in the IE \"CN domain identity\" in
the received SECURITY MODE COMMAND message to the value \"Affected\";

2\> set the IE \"*Status*\" in the variable SECURITY\_MODIFICATION for
all CN domains other than the CN domain indicated in the IE \"*CN Domain
Identity*\" to \"Not affected\";

2\> set the IE \"*RRC Transaction Identifier*\" in the SECURITY MODE
COMPLETE message to the value of \"RRC transaction identifier\" in the
entry for the SECURITY MODE COMMAND message in the table \"Accepted
transactions\" in the variable TRANSACTIONS; and

2\> clear that entry;

2\> if the SECURITY MODE COMMAND message contained the IE \"*Ciphering
Mode Info*\":

3\> perform the actions as specified in sub-clause 7.19.4.4 \"Ciphering
mode info\".

2\> if the SECURITY MODE COMMAND message contained the IE \"*Integrity
Protection Mode Info*\":

3\> perform the actions as specified in sub-clause 7.19.4.5 \"*Integrity
Protection Mode Info*\".

1\> Prior to sending the SECURITY MODE COMPLETE message the MS shall:

2\> use the old ciphering configuration for this message;

2\> if the SECURITY MODE COMMAND message containes the IE \"*Ciphering
Mode Info*\":

3\> include and set the IE \"*Radio Bearer Uplink Ciphering Activation
Time Info*\" to the value of the variable
RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO.

3\> for each radio bearer and signalling radio bearer that belongs to
the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN:

4\> start or continue incrementing the COUNT-C values for all RLC-AM and
RLC-UM signalling radio bearers at the ciphering activation time as
specified in the Ciphering mode info procedure (see sub-clause
7.19.4.4);

4\> start or continue incrementing the COUNT-C values common for all
transparent mode radio bearers for this CN domain at the ciphering
activation time as specified in the Ciphering mode info procedure (see
sub-clause 7.19.4.4);

4\> continue incrementing the COUNT-C values for all RLC-AM and RLC-UM
radio bearers;

3\> if no new security key set (new ciphering and integrity protection
keys) has been received from the upper layers (see 3GPP TS 33.102) for
the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN:

4\> for ciphering on signalling radio bearers using RLC-AM and RLC-UM in
the downlink, at the RLC sequence number indicated in IE \"*RB Downlink
Ciphering Activation Time Info*\" in the IE \"*Ciphering Mode Info*\"
included in the SECURITY MODE COMMAND message, for each signalling radio
bearer:

5\> set the 20 most significant bits of the HFN component of the
downlink COUNT-C to the value \"START\" in the most recently transmitted
IE \"*START List*\" or IE \"*START*\", at the reception of the SECURITY
MODE COMMAND message, that belongs to the CN domain as indicated in the
variable LATEST\_CONFIGURED\_CN\_DOMAIN;

5\> set the remaining bits of the hyper frame numbers to zero;

3\> if new keys have been received perform the actions in sub-clause
7.16.1.2.3.1.

2\> if the SECURITY MODE COMMAND message contained the IE \"*Integrity*
*Protection Mode Info*\";

3\> include and set the IE \"*Uplink Integrity Protection Activation
Info*\" to the value of the variable
INTEGRITY\_PROTECTION\_ACTIVATION\_INFO for each signalling radio
bearer;

3\> if no new security key set (new ciphering and integrity protection
keys) has been received from the upper layers (see 3GPP TS 33.102) for
the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN, for SRB2:

4\> in the downlink, for the received SECURITY MODE COMMAND message :

5\> set the 20 most significant bits of the IE \"*Downlink RRC HFN*\" in
the variable INTEGRITY\_PROTECTION\_INFO of the downlink COUNT-I to the
value \"START\" in the most recently transmitted IE \"*START List*\" or
IE \"*START*\", at the reception of the SECURITY MODE COMMAND message,
that belongs to the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN;

5\> set the remaining bits of the IE \"*Downlink RRC HFN*\" to zero;

4\> in the uplink, for the transmitted response message, SECURITY MODE
COMPLETE message:

5\> set the 20 most significant bits of the IE \"*Uplink RRC HFN*\" in
the variable INTEGRITY\_PROTECTION\_INFO of the uplink COUNT-I to the
value \"START\" in the most recently transmitted IE \"*START List*\" or
IE \"*START*\", at the reception of the SECURITY MODE COMMAND message,
that belongs to the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN;

5\> set the remaining bits of the IE \"*Uplink RRC HFN*\" to zero;

3\> if no new security key set (new ciphering and integrity protection
keys) has been received from the upper layers (3GPP TS 33.102) for the
CN domain indicated in the variable LATEST\_CONFIGURED\_CN\_DOMAIN, the
MS shall for each signalling radio bearer other than SRB2:

4\> if the IE \"*Integrity Protection Mode Command*\" has the value
\"start\":

> 5\> in the downlink, for this signalling radio bearer, set the 20 most
> significant bits of IE \"*Downlink RRC HFN*\" in the variable
> INTEGRITY\_PROTECTION\_INFO of the downlink COUNT-I to the value START
> transmitted in the most recently transmitted IE \"*START List*\" or IE
> \"*START*\", at the reception of the SECURITY MODE COMMAND message,
> that belongs to the CN domain as indicated in the variable
> LATEST\_CONFIGURED\_CN\_DOMAIN;
>
> 5\> set the remaining bits of the IE \"*Downlink RRC HFN*\" in the
> variable INTEGRITY\_PROTECTION\_INFO of the downlink COUNT-I to zero;

4\> else:

5\> in the downlink, for the first message for which the RRC sequence
number in a received RRC message for this signalling radio bearer is
equal to or greater than the activation time as indicated in IE
\"*Downlink Integrity Protection Activation Info*\" as included in the
IE \"*Integrity Protection Mode Info*\":

> 6\> for this signalling radio bearer, set the 20 most significant bits
> of the IE \"*Downlink RRC HFN*\" in the variable
> INTEGRITY\_PROTECTION\_INFO of the downlink COUNT-I to the value
> \"START\" in the most recently transmitted IE \"*START List*\" or IE
> \"*START*\", at the reception of the SECURITY MODE COMMAND message,
> that belongs to the CN domain as indicated in the variable
> LATEST\_CONFIGURED\_CN\_DOMAIN;
>
> 6\> set the remaining bits of the IE \"*Downlink RRC HFN*\" to zero;

3\> if new keys have been received perform the actions in sub-clause
7.16.1.2.3.1;

2\> start applying the new integrity protection configuration in the
uplink for signalling radio bearer SRB2 from and including the
transmitted SECURITY MODE COMPLETE message;

2\> transmit the SECURITY MODE COMPLETE message on the uplink SRB2.

After submission of the SECURITY MODE COMPLETE message to the lower
layers, the MS shall accept messages received in the DL which require
the new security configuration to be applied on them. If a received
message is successfully integrity checked, the MS shall not discard the
message due to lack of completion of the security procedure caused by
the successful delivery of the SECURITY MODE COMPLETE message not having
been confirmed by lower layers yet, unless the security configuration to
be applied has been aborted and the message received requires integrity
protection (see 3GPP TS 24.008).

1\> when the successful delivery of the SECURITY MODE COMPLETE message
has been confirmed by RLC:

2\> if the SECURITY MODE COMMAND message contained the IE \"*Ciphering
Mode Info*\":

3\> if no new security key set (new ciphering and integrity protection
keys) has been received from the upper layers (see3GPP TS 33.102) for
the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN:

4\> for ciphering on signalling radio bearers using RLC-AM and RLC-UM in
the uplink, at the RLC sequence number indicated in IE \"*Radio Bearer
Uplink Ciphering Activation Time Info*\" included in the SECURITY MODE
COMPLETE message, for each signalling radio bearer:

5\> set the HFN component of the uplink COUNT-C to the value \"START\"
in the most recently transmitted IE \"*START List*\" or IE \"*START*\",
at the reception of the SECURITY MODE COMMAND message, that belongs to
the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN.

5\> set the remaining bits of the hyper frame numbers to zero;

3\> if new keys have been received perform the actions in sub-clause
7.16.1.2.3.1.

3\> resume data transmission on any suspended radio bearer and
signalling radio bearer mapped on RLC-AM or RLC-UM;

3\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

3\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO.

2\> if the SECURITY MODE COMMAND message containes the IE \"*Integrity
protection mode info*\":

3\> if no new security key set (new ciphering and integrity protection
keys) has been received from the upper layers (see3GPP TS 33.102) for
the CN domain indicated in the variable LATEST\_CONFIGURED\_CN\_DOMAIN,
the MS shall for each signalling radio bearer other than SRB2:

4\> if the IE \"*Integrity Protection Mode Command*\" has the value
\"start\":

5\> in the uplink, for this signalling radio bearer, set the 20 most
significant bits of IE \"*Uplink RRC HFN*\" in the variable
INTEGRITY\_PROTECTION\_INFO of the uplink COUNT-I to the value START
transmitted in the most recently transmitted IE \"*START List*\" or IE
\"*START*\", at the reception of the SECURITY MODE COMMAND message, that
belongs to the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN;

5\> set the remaining bits of the IE \"*Uplink RRC HFN*\" in the
variable INTEGRITY\_PROTECTION\_INFO of the uplink COUNT-I to zero;

4\> else:

5\> in the uplink, for the first transmitted RRC message for this
signalling radio bearer with RRC sequence number equal to the activation
time as indicated in IE \"*Uplink Integrity Protection Activation
Info*\" included in the transmitted SECURITY MODE COMPLETE message:

> 6\> for this signalling radio bearer, set the 20 most significant bits
> of the IE \"*Uplink RRC HFN*\" in the variable
> INTEGRITY\_PROTECTION\_INFO of the uplink COUNT-I to the value
> \"START\" in the most recently transmitted IE \"*START List*\" or IE
> \"*START*\", at the reception of the SECURITY MODE COMMAND message,
> that belongs to the CN domain as indicated in the variable
> LATEST\_CONFIGURED\_CN\_DOMAIN;
>
> 6\> set the remaining bits of the IE \"*Uplink RRC HFN*\" to zero;

3\> if new keys have been received perform the actions in sub-clause
7.16.1.2.3.1;

3\> allow the transmission of RRC messages on all signalling radio
bearers with any RRC SN;

3\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

3\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO.

2\> clear the variable SECURITY\_MODIFICATION;

2\> notify upper layers upon change of the security configuration;

2\> and the procedure ends.

1\> if the IE \"*Security Capability*\" is not the same as indicated by
the variable MS\_CAPABILITY\_TRANSFERRED, or the IE \"*GSM MS Security
Capability*\" (if included in the SECURITY MODE COMMAND message) is not
the same as indicated by the variable MS\_CAPABILITY\_TRANSFERRED, or if
the IE \"*GSM* MS *Security Capability*\" is not included in the
SECURITY MODE COMMAND message and is included in the variable
MS\_CAPABILITY\_TRANSFERRED:

2\> release all its radio resources;

2\> indicate the release of the established signalling connections (as
stored in the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS) and
established radio access bearers (as stored in the variable
ESTABLISHED\_RABS) to upper layers;

2\> clear the variable ESTABLISHED\_SIGNALLING\_CONNECTIONS;

2\> clear the variable ESTABLISHED\_RABS;

2\> clear the variable SECURITY\_MODIFICATION;

2\> enter RRC-Idle mode;

2\> perform actions when entering RRC-Idle mode as specified in
sub-clause 7.18 \"Actions when entering RRC-Idle mode from RRC-Connected
mode\";

2\> and the procedure ends.

###### 7.16.1.2.3.1 New ciphering and integrity protection keys

The actions in this sub-clause are to be performed only if the new keys
were received for an on-going signalling connection while in GERAN *Iu
mode*.

If a new security keyset (new ciphering and integrity protection keys)
has been received from the upper layers (see 3GPP TS 33.102) for the CN
domain as indicated in the variable LATEST\_CONFIGURED\_CN\_DOMAIN, the
MS shall:

1\> set the START value for the CN domain indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN to zero;

1\> if the SECURITY MODE COMMAND message contained the IE \"*Integrity*
*Protection Mode Info*\":

2\> for integrity protection in the downlink on each signalling radio
bearer except SRB2:

3\> if IE \"*Integrity Protection Mode Command*\" has the value
\"start\":

4\> for the first received message on this signalling radio bearer:

5\> start using the new integrity key;

5\> for this signalling radio bearer, set the IE \"*Downlink RRC HFN*\"
in the variable INTEGRITY\_PROTECTION\_INFO of the downlink COUNT-I to
zero.

3\> else:

4\> for the first message for which the RRC sequence number in a
received RRC message for this signalling radio bearer is equal to or
greater than the activation time as indicated in IE \"*Downlink
Integrity Protection Activation Info*\" as included in the IE
\"*Integrity Protection Mode Info*\":

5\> start using the new integrity key;

5\> for this signalling radio bearer, set the IE \"*Downlink RRC HFN*\"
in the variable INTEGRITY\_PROTECTION\_INFO of the downlink COUNT\_I to
zero.

2\> for integrity protection in the uplink on each signalling radio
bearer except SRB2:

3\> for the first message for which the RRC sequence number in a to be
transmitted RRC message for this signalling radio bearer is equal to the
activation time as indicated in IE \"*Uplink Integrity Protection
Activation Info*\" included in the transmitted SECURITY MODE COMPLETE
message:

4\> start using the new integrity key;

4\> for this signalling radio bearer, set the IE \"*Uplink RRC HFN*\" in
the variable INTEGRITY\_PROTECTION\_INFO of the uplink COUNT-I to zero.

2\> for integrity protection in the downlink on signalling radio bearer
SRB2:

3\> at the received SECURITY MODECOMMAND:

4\> start using the new integrity key;

4\> set the IE \"*Downlink RRC HFN*\" in the variable
INTEGRITY\_PROTECTION\_INFO of the downlink COUNT-I to zero;

2\> for integrity protection in the uplink on signalling radio bearer
SRB2 :

3\> at the transmitted SECURITY MODE COMPLETE:

4\> start using the new integrity key;

4\> set the IE \"*Uplink RRC HFN*\" in the variable
INTEGRITY\_PROTECTION\_INFO of the uplink COUNT-I to zero;

1\> if the SECURITY MODE COMMAND message contained the IE \"*Ciphering
Mode Info*\":

2\> for each signalling radio bearer and for each radio bearer for the
CN domain as indicated in the variable LATEST\_CONFIGURED\_CN\_DOMAIN:

3\> if the IE \"*Status*\" in the variable CIPHERING\_STATUS has the
value \"Started\" for this CN domain, then for ciphering on the radio
bearer using RLC-TM:

4\> at the TDMA frame number as indicated in the IE \"*Ciphering
Activation Time for DBPSCH*\" in the IE \"*Ciphering Mode Info\";*

5\> start using the new key in uplink and downlink;

5\> set the HFN component of the COUNT-C to zero.

3\> if the IE \"*Status*\" in the variable CIPHERING\_STATUS has the
value \"Started\" for this CN domain, then for ciphering on the radio
bearers and signalling radio bearers using RLC-AM and RLC-UM:

4\> in the downlink, at the RLC sequence number indicated in IE \"*RB
Downlink Ciphering Activation Time Info*\" in the IE \"*Ciphering Mode
Info*\":

5\> start using the new key;

5\> set the HFN component of the downlink COUNT-C to zero.

4\> in the uplink, at and after the RLC sequence number indicated in IE
\"*Radio* *Bearer Uplink Ciphering Activation Time Info*\":

5\> start using the new key;

5\> set the HFN component of the uplink COUNT-C to zero.

1\> consider the value of the latest transmitted START value to be zero.

##### 7.16.1.2.4 Incompatible simultaneous security reconfiguration

If the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION becomes set to
TRUE of the received SECURITY MODE COMMAND message, the MS shall:

1\> transmit a SECURITY MODE FAILURE message on the uplink SRB2, using
the ciphering and integrity protection configurations prior to the
reception of this SECURITY MODE COMMAND;

1\> set the IE \"*RRC Transaction Identifier*\" in the SECURITY MODE
FAILURE message to the value of \"RRC transaction identifier\" in the
entry for the SECURITY MODE COMMAND message in the table \"Accepted
transactions\" in the variable TRANSACTIONS; and

1\> clear that entry;

1\> set the IE \"*Failure Cause*\" to the cause value \"incompatible
simultaneous reconfiguration\";

1\> when the response message has been submitted to lower layers for
transmission:

2\> set the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION to FALSE;

2\> continue with any ongoing processes and procedures as if the invalid
SECURITY MODE COMMAND message has not been received;

2\> only accept a message on SRB 2, with a COUNT-I that:

3\> is higher than the COUNT-I used prior to receiving the SECURITY MODE
COMMAND message incremented by one; and

3\> not take into account the HFN from the received SECURITY MODE
COMMAND message.

1\> and the procedure ends.

##### 7.16.1.2.5 Cell Update procedure during security reconfiguration

If:

\- a cell update procedure according to sub-clause 7.6.1 is initiated;
and

\- the received SECURITY MODE COMMAND message causes,

\- the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS to be
set to TRUE; and/or

\- the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to be set to TRUE:

the MS shall:

1\> abort the ongoing integrity and/or ciphering reconfiguration;

1\> resume data transmission on any suspended radio bearer and
signalling radio bearer mapped on RLC-AM or RLC-UM;

1\> allow the transmission of RRC messages on all signalling radio
bearers with any RRC SN;

1\> when the CELL UPDATE message has been submitted to lower layers for
transmission:

2\> if the SECURITY MODE COMMAND message contained the IE \"*Ciphering
Mode Info*\":

3\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE; and

3\> clear the variable RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

2\> if the SECURITY MODE COMMAND message contained the IE \"*Integrity
Protection Mode Info*\":

3\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to FALSE; and

3\> clear the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO.

2\> continue with any ongoing processes and procedures as if the
SECURITY MODE COMMAND message had not been received;

2\> only accept a message on SRB 2, with a COUNT-I that:

3\> is higher than the COUNT-I used prior to receiving the SECURITY MODE
COMMAND message incremented by one; and

3\> does not take into account the HFN from the received SECURITY MODE
COMMAND message.

2\> if the MS has already submitted the SECURITY MODE COMPLETE message,
use a COUNT-I value for transmission of the next message on SRB2 as
stated below:

3\> take the COUNT-I used prior to the transmission of the SECURITY MODE
COMPLETE message;

3\> increment that COUNT-I with 2;

3\> apply that COUNT-I on the next message to transmit.

2\> clear the variable SECURITY\_MODIFICATION;

2\> the procedure ends.

##### 7.16.1.2.6 Invalid configuration

If the variable INVALID\_CONFIGURATION is set to TRUE due to the
received SECURITY MODE COMMAND message, the MS shall:

1\> transmit a SECURITY MODE FAILURE message on the uplink SRB2 after
setting the IEs as specified below;

1\> set the IE \"*RRC Transaction Identifier*\" in the SECURITY MODE
FAILURE message to the value of \"RRC transaction identifier\" in the
entry for the SECURITY MODE COMMAND message in the table \"Accepted
transactions\" in the variable TRANSACTIONS; and

1\> clear that entry;

1\> set the IE \"*Failure Cause*\" to the cause value \"invalid
configuration\".

1\> when the response message has been submitted to lower layers for
transmission:

2\> set the variable INVALID\_CONFIGURATION to FALSE;

2\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to FALSE

2\> continue with any ongoing processes and procedures as if the invalid
SECURITY MODE COMMAND message has not been received;

2\> only accept a message on SRB 2, with a COUNT-I that:

3\> is higher than the COUNT-I used prior to receiving the SECURITY MODE
COMMAND message incremented by one; and

3\> not take into account the HFN from the received SECURITY MODE
COMMAND message.

1\> and the procedure ends.

##### 7.16.1.2.7 Reception of SECURITY MODE COMPLETE message by the GERAN

The GERAN shall apply integrity protection on the received SECURITY MODE
COMPLETE message and all subsequent messages with the new integrity
protection configuration, if changed. When GERAN has received a SECURITY
MODE COMPLETE message and the integrity protection has successfully been
applied, GERAN shall:

1\> if the IE \"*Ciphering Mode Info*\" was included in the SECURITY
MODE COMMAND message:

2\> if new keys were received for the CN domain set in the IE \"*CN
Domain Identity*\" in the SECURITY MODE COMMAND:

3\> at the downlink and uplink activation time set all the bits of the
hyper frame numbers of the downlink and uplink COUNT-C values
respectively for all radio bearers for this CN domain and all signalling
radio bearers to zero;

2\> else (if new keys were not received)

3\> at the downlink and uplink activation time use the value \"START\"
in the most recently received IE \"*START List*\" or IE \"*START*\" that
belongs to the CN domain as indicated in the IE \"*CN* *Domain
Identity*\" to initialise all hyper frame numbers of the downlink and
uplink COUNT-C values respectively for all the signalling radio bearers
by:

4\> setting the 20 most significant bits of the hyper frame numbers of
the COUNT-C for all signalling radio bearers to the value \"START\" in
the most recently received IE \"*START List*\" or IE \"*START*\" for
that CN domain;

4\> setting the remaining bits of the hyper frame numbers equal to zero.

1\> if the IE \"*Integrity* *Protection Mode Info*\" was included in the
SECURITY MODE COMMAND message:

2\> if this was not the first SECURITY MODE COMMAND message for this RRC
connection:

3\> if new keys have been received for the CN domain set in the IE \"*CN
Domain Identity*\" included in the transmitted SECURITY MODE COMMAND
message:

4\> at the downlink and uplink activation time initialise all hyper
frame numbers of the downlink and uplink COUNT-I values respectively for
all the signalling radio bearers other than SRB2 as follows:

5\> set all bits of the hyper frame numbers of the uplink and downlink
COUNT-I to zero;

3\> if no new keys have been received for the CN domain set in the IE
\"*CN Domain Identity*\" included in the transmitted SECURITY MODE
COMMAND message:

4\> at the downlink and uplink activation time use the value \"START\"
in the most recently received IE \"*START List*\" or IE \"*START*\" that
belongs to the CN domain as indicated in the IE \"*CN Domain Identity*\"
to initialise all hyper frame numbers of the downlink and uplink COUNT-I
values respectively for all the signalling radio bearers other than SRB2
by:

5\> setting the 20 most significant bits of the hyper frame numbers of
the downlink and uplink COUNT-I respectively for all signalling radio
bearers to the value \"START\" in the most recently received IE \"*START
List*\" or IE \"*START*\" for that CN domain;

5\> setting the remaining bits of the hyper frame numbers equal to zero.

1\> send an indication to upper layers that the new integrity protection
configuration has been activated;

1\> resume in the downlink, all suspended radio bearers and all
signalling radio bearers;

1\> allow the transmission of RRC messages on all signalling radio
bearers with any RRC SN;

1\> if the IE \"*Integrity Protection Mode Command*\" included in the
SECURITY MODE COMMAND had the value \"Start\":

2\> start applying integrity protection in the downlink for all
signalling radio bearers;

1\> if the IE \" *Integrity Protection Mode Command* \" included in the
SECURITY MODE COMMAND had the value \"Modify\":

2\> start applying the new integrity protection configuration in the
downlink at the RRC sequence number, for each signalling radio bearers
SRBn, except for signalling radio bearer SRB2, indicated by the entry
for signalling radio bearer n in the \"RRC message sequence number
list\" in the IE \"*Downlink Integrity Protection Activation Info*\";

2\> continue applying the new integrity configuration for signalling
radio bearer SRB2;

2\> apply the new integrity protection configuration on the received
signalling messages with RRC SN greater than or equal to the number
associated with the signalling radio bearer in IE \"*Uplink* *Integrity
Protection Activation Info*\";

1\> apply the old ciphering configuration for the transmission of RLC
PDUs with RLC sequence number less than the number indicated in the IE
\"*RB Downlink Ciphering Activation Time Info*\" included in the IE
\"*Ciphering Mode Info*\";

1\> apply the new ciphering configuration for the transmission of RLC
PDUs with RLC sequence number greater than or equal to the number
indicated in IE \"*Radio Bearer Downlink Ciphering Activation Time
Info*\" included in the IE \"*Ciphering Mode Info*\";

1\> apply the old integrity protection configuration on the received
signalling messages with RRC SN smaller than the number associated with
the signalling radio bearer in IE \"*Uplink Integrity Protection
Activation Info*\";

1\> for radio bearers and signalling radio bearers using RLC-AM or
RLC-UM:

2\> send an indication to lower layers:

2\> use the old ciphering configuration for received RLC PDUs with RLC
sequence number less than the RLC sequence number indicated in the IE
\"*Radio Bearer Uplink Ciphering Activation Time Info*\" sent by the MS;

2\> use the new ciphering configuration for received RLC PDUs with RLC
sequence number greater than or equal to the RLC sequence number
indicated in the IE \"*Radio Bearer Uplink Ciphering Activation Time
Info*\" sent by the MS;

2\> if an RLC reset or re-establishment occurs after the SECURITY MODE
COMPLETE message has been received by GERAN before the activation time
for the new ciphering configuration has been reached, ignore the
activation time and apply the new ciphering configuration immediately
after the RLC reset or RLC re-establishment;

1\> for radio bearers using RLC-TM:

2\> send an indication to lower layers:

2\> use the old ciphering configuration for the received RLC PDUs before
the TDMA frame number as indicated in the IE \"*Ciphering Activation
Time for DBPSCH*\" in the IE \"*Ciphering Mode Info*\" as included in
the SECURITY MODE COMMAND;

2\> use the new ciphering configuration for the received RLC PDUs at the
TDMA frame number as indicated in the IE \"*Ciphering Activation Time
for DBPSCH*\" in the IE \"*Ciphering Mode Info*\" as included in the
SECURITY MODE COMMAND;

1\> and the procedure ends.

##### 7.16.1.2.8 Invalid SECURITY MODE COMMAND message

If the SECURITY MODE COMMAND message contains a protocol error causing
the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE according to
sub-clause \"General error handling\", the MS shall perform procedure
specific error handling as follows:

1\> transmit a SECURITY MODE FAILURE message on the uplink SRB2;

1\> set the IE \"*RRC Transaction Identifier*\" in the SECURITY MODE
FAILURE message to the value of \"RRC transaction identifier\" in the
entry for the SECURITY MODE COMMAND message in the table \"Rejected
transactions\" in the variable TRANSACTIONS; and

1\> clear that entry;

1\> set the IE \"*Failure Cause*\" to the cause value \"protocol
error\";

1\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION.

1\> when the response message has been submitted to lower layers for
transmission:

2\> continue with any ongoing processes and procedures as if the invalid
SECURITY MODE COMMAND message has not been received;

2\> only accept a message on SRB 2, with a COUNT-I that:

3\> is higher than the COUNT-I used prior to receiving the SECURITY MODE
COMMAND message incremented by one; and

3\> not take into account the HFN from the received SECURITY MODE
COMMAND message;

1\> and the procedure ends.

7.17 Delivery of Non-Access stratum messages
--------------------------------------------

### 7.17.1 Initial Direct transfer

Figure 7.17.1.1: Initial Direct transfer in the uplink, normal flow

#### 7.17.1.1 General

The Initial Direct Transfer procedure is used in the uplink to establish
a signalling connection. It is also used to carry an initial upper layer
(NAS) messages over the radio interface.

#### 7.17.1.2 Initiation of Initial direct transfer procedure in the MS

In the MS, the Initial Direct Transfer procedure shall be initiated,
when the upper layers request establishment of a signalling connection.
This request also includes a request for the transfer of a NAS message.

Upon initiation of the Initial Direct Transfer procedure when the MS is
in RRC-Idle mode, the MS shall:

1\> set the variable ESTABLISHMENT\_CAUSE to the cause for establishment
indicated by upper layers;

1\> perform an RRC Connection Establishment procedure, according to
sub-clause 7.5;

1\> if the RRC Connection Establishment procedure was not successful:

2\> indicate failure to establish the signalling connection to upper
layers and end the procedure;

1\> when the RRC Connection Establishment procedure is completed
successfully:

2\> continue with the Initial Direct Transfer procedure as below;

Upon initiation of the Initial Direct Transfer procedure when the MS is
in RRC-GRA\_PCH state, the MS shall:

1\> perform a Cell Update procedure, according to sub-clause 7.8, using
the cause \"uplink data transmission\";

1\> when the Cell Update procedure completed successfully:

2\> continue with the Initial Direct Transfer procedure as below.

The MS shall, in the INITIAL DIRECT TRANSFER message:

1\> set the IE \"*NAS Message*\" as received from upper layers; and

1\> set the IE \"*CN* *Domain Identity*\" as indicated by the upper
layers; and

2\> set the IE \"*Intra Domain NAS Node Selector*\" as follows:

2\> derive the IE \"*Intra Domain NAS Node Selector*\" from TMSI/PMTSI,
IMSI, or IMEI; and

2\> provide the coding of the IE \"*Intra Domain NAS Node Selector*\"
according to the following priorities:

1\. derive the routing parameter for IDNNS from TMSI (CS domain) or
PTMSI (PS domain) whenever a valid TMSI/PTMSI is available;

2\. base the routing parameter for IDNNS on IMSI when no valid
TMSI/PTMSI is available;

3\. base the routing parameter for IDNNS on IMEI only if no (U)SIM is
inserted in the MS.

1\> calculate the START according to sub-clause 7.18.4 for the CN domain
as set in the IE \"*CN Domain Identity*\"; and

2\> include the calculated START value for that CN domain in the IE
\"*START*\";

The MS shall:

1\> transmit the INITIAL DIRECT TRANSFER message on the uplink using AM
RLC on signalling radio bearer SRB 3;

1\> when the INITIAL DIRECT TRANSFER message has been submitted to lower
layers for transmission:

2\> confirm the establishment of a signalling connection to upper
layers; and

2\> add the signalling connection with the identity indicated by the IE
\"*CN* *Domain Identity*\" in the variable
ESTABLISHED\_SIGNALLING\_CONNECTIONS; and

1\> when the successful delivery of the INITIAL DIRECT TRANSFER message
has been confirmed by RLC sub-layer:

2\> the procedure ends.

When not stated otherwise elsewhere, the MS may also initiate the
initial direct transfer procedure when another procedure is ongoing, and
in that case the state of the latter procedure shall not be affected.

A new signalling connection request may be received from upper layers
subsequent to the indication of the release of a previously established
signalling connection to upper layers. From the time of the indication
of release to upper layers until the MS has entered RRC-Idle mode, any
such upper layer request to establish a new signalling connection shall
be queued. This request shall be processed after the MS has entered
RRC-Idle mode.

#### 7.17.1.3 RLC re-establishment, inter-mode handover or inter-RAT change

If a re-establishment of RLC on SRB3 occurs before the successful
delivery of the INITIAL DIRECT TRANSFER message has been confirmed by
RLC, the MS shall:

1\> retransmit the INITIAL DIRECT TRANSFER message on the uplink using
SRB3.

If inter-mode handover occurs before the successful delivery of the
INITIAL DIRECT TRANSFER message has been confirmed by RLC, for messages
with the IE \"*CN Domain Identity*\" set to \"CS domain\", the MS shall:

1\> retransmit the NAS message as specified in sub-clause 7.8.4.4

If inter-RAT handover occurs before the successful delivery of the
INITIAL DIRECT TRANSFER message has been confirmed by RLC, the MS shall:

1.  retransmit the NAS message as specified in sub-clause 7.10.4.

#### 7.17.1.4 Abortion of signalling connection establishment

If the MS receives a request from upper layers to release (abort) the
signalling connection for the CN domain for which the initial direct
transfer procedure is ongoing, the MS shall:

1\> if the MS has not yet entered GERAN RRC-Connected mode:

2\> abort the RRC Connection Establishment procedure as specified in
sub-clause 7.5.1.6;

the procedure ends.

#### 7.17.1.5 Reception of INITIAL DIRECT TRANSFER message by the GERAN

On reception of the INITIAL DIRECT TRANSFER message the NAS message
should be routed using the IE \"*CN Domain Identity*\". GERAN may also
use the IE \"*Intra Domain NAS Node Selector*\" for routing among the CN
nodes for the addressed CN domain.

If no signalling connection exists towards the chosen node, then a
signalling connection is established.

When the GERAN receives an INITIAL DIRECT TRANSFER message, it shall not
affect the state of any other ongoing RRC procedures, when not stated
otherwise elsewhere.

The GERAN should:

1\> set the START value for the CN domain indicated in the IE \"*CN
Domain Identity*\" to the value of the IE \"*START*\".

### 7.17.2 Downlink Direct transfer

Figure 7.17.2.1: Downlink Direct transfer, normal flow

#### 7.17.2.1 General

The Downlink Direct Transfer procedure is used in the downlink direction
to carry upper layer (NAS) messages over the radio interface.

#### 7.17.2.2 Initiation of downlink direct transfer procedure in the GERAN

In the GERAN, the Direct Transfer procedure is initiated when the upper
layers request the transfer of a NAS message after the initial
signalling connection is established. The GERAN may also initiate the
Downlink Direct Transfer procedure when another RRC procedure is
ongoing, and in that case the state of the latter procedure shall not be
affected. The GERAN shall transmit the DOWNLINK DIRECT TRANSFER message
on the downlink using AM RLC on signalling radio bearer SRB 3 or
signalling radio bearer SRB 4. The GERAN should:

1\> if upper layers indicate \"low priority\" for this message:

2\> select signalling radio bearer SRB4, if available. Specifically, for
a GSM-MAP based CN, signalling radio SRB4 should, if available, be
selected when \"SAPI 3\" is requested;

2\> select signalling radio SRB3 when signalling radio SRB 4 is not
available;

1\> if upper layers indicate \"high priority\" for this message:

2\> select signalling radio SRB3. Specifically, for a GSM-MAP based CN,
signalling radio bearer RB3 should be selected when \"SAPI 0\" is
requested.

The GERAN sets the IE \"*CN Domain Identity*\" to indicate, which CN
domain the NAS message is originated from*.*

#### 7.17.2.3 Reception of a DOWNLINK DIRECT TRANSFER message by the MS

Upon reception of the DOWNLINK DIRECT TRANSFER message, the MS RRC
shall, using the IE \"*CN Domain Identity*\", route the contents of the
IE \"*NAS Message*\" and the value of the IE\"*CN Domain Identity*\" to
the upper layers.

The MS shall clear the entry for the DOWNLINK DIRECT TRANSFER message in
the table \"Accepted transactions\" in the variable TRANSACTIONS.

When the MS receives a DOWNLINK DIRECT TRANSFER message, it shall not
affect the state of any other ongoing RRC procedures when not stated
otherwise elsewhere.

#### 7.17.2.4 No signalling connection exists

If the MS receives a DOWNLINK DIRECT TRANSFER message, and the
signalling connection identified with the IE \"*CN Domain Identity*\"
does not exist according to the variable
ESTABLISHED\_SIGNALLING\_CONNECTIONS, the MS shall:

1\> ignore the content of the DOWNLINK DIRECT TRANSFER message;

1\> transmit an RRC STATUS message on the uplink SRB2;

1\> include the IE \"*Identification of Received Message*\"; and

1\> set the IE \"*Received Message Type*\" to DOWNLINK DIRECT TRANSFER
message; and

1\> set the IE \"*RRC Transaction Identifier*\" to the value of \"RRC
transaction identifier\" in the entry for the DOWNLINK DIRECT TRANSFER
message in the table \"Accepted transactions\" in the variable
TRANSACTIONS; and

1\> clear that entry;

1\> include the IE \"*Protocol Error Information*\" with the IE
\"*Protocol Error Cause*\" set to \"Message not compatible with receiver
state\".

When the RRC STATUS message has been submitted to lower layers for
transmission, the MS shall:

1\> continue with any ongoing processes and procedures as if the
DOWNLINK DIRECT TRANSFER message has not been received.

#### 7.17.2.5 Invalid DOWNLINK DIRECT TRANSFER message

If the MS receives a DOWNLINK DIRECT TRANSFER message, which contains a
protocol error causing the variable PROTOCOL\_ERROR\_REJECT to be set to
TRUE according to clause 8 the MS shall perform procedure specific error
handling as follows:

1\> transmit an RRC STATUS message on the uplink SRB2;

1\> include the IE \"*Identification of Received Message*\"; and

1\> set the IE \"*Received Message Type*\" to DOWNLINK DIRECT TRANSFER;
and

1\> set the IE \"*RRC Transaction Identifier*\" to the value of \"RRC
transaction identifier\" in the entry for the DOWNLINK DIRECT TRANSFER
message in the table \"Rejected transactions\" in the variable
TRANSACTIONS; and

1\> clear that entry;

1\> include the IE \"*Protocol Error Information*\" with contents set to
the value of the variable PROTOCOL\_ERROR\_INFORMATION.

When the RRC STATUS message has been submitted to lower layers for
transmission, the MS shall:

1\> continue with any ongoing processes and procedures as if the invalid
DOWNLINK DIRECT TRANSFER message has not been received.

### 7.17.3 Uplink Direct transfer

Figure 7.17.3.1: Uplink Direct transfer, normal flow

#### 7.17.3.1 General

The Uplink Direct Transfer procedure is used in the uplink direction to
carry all subsequent upper layer (NAS) messages over the radio interface
belonging to a signalling connection.

#### 7.17.3.2 Initiation of uplink direct transfer procedure in the MS

In the MS, the Uplink Direct Transfer procedure shall be initiated when
the upper layers request a transfer of a NAS message on an existing
signalling connection. When not stated otherwise elsewhere, the MS may
initiate the Uplink Direct Transfer procedure when another procedure is
ongoing, and in that case the state of the latter procedure shall not be
affected.

Upon initiation of the Uplink Direct Transfer procedure in RRC-GRA\_PCH
state, the MS shall:

1\> perform a Cell Update procedure, according to sub-clause 7.8, using
the cause \"uplink data transmission\";

1\> when the Cell Update procedure has been completed successfully:

2\> continue with the Uplink Direct Transfer procedure as below.

The MS shall transmit the UPLINK DIRECT TRANSFER message on the uplink
using AM RLC on signalling radio bearer SRB3 or signalling radio bearer
SRB4. The MS shall:

1\> if upper layers indicates \"low priority\" for this message:

2\> select signalling radio SRB4, if available. Specifically, for a
GSM-MAP based CN, signalling radio bearer SRB4 shall, if available, be
selected when \"SAPI 3\" is requested;

2\> select signalling radio bearer SRB3 when signalling radio bearer
SRB4 is not available;

1\> if upper layers indicates \"high priority\" for this message:

2\> select signalling radio bearer SRB3. Specifically, for a GSM-MAP
based CN, signalling radio bearer SRB3 shall be selected when \"SAPI 0\"
is requested.

The MS shall set the IE \"*NAS Message\"* as received from upper layers
and set the IE \"*CN Domain Identity*\" as indicated by the upper
layers.

When the sucessful delivery of the UPLINK DIRECT TRANSFER message has
been confirmed by RLC sub-layer the procedure ends.

#### 7.17.3.3 RLC re-establishment, inter-mode handover or inter-RAT change

If SRB n (where n equals to 3 or 4) was used when transmitting the
UPLINK DIRECT TRANSFER message and a re-establishment of RLC on the same
SRB n occurs before the successful delivery of the UPLINK DIRECT
TRANSFER message has been confirmed by RLC, the MS shall:

1\> retransmit the UPLINK DIRECT TRANSFER message on the uplink SRB n.

If inter-mode handover occurs before the successful delivery of the
UPLINK DIRECT TRANSFER message has been confirmed by RLC, for messages
with the IE \"CN Domain Identity\" set to \"CS domain\", the MS shall:

1\> retransmit the NAS message as specified in sub-clause 7.8.4.4

If inter-RAT handover occurs before the successful delivery of the
UPLINK DIRECT TRANSFER message has been confirmed by RLC, the MS shall:

1\> retransmit the NAS message as specified in sub-clause 7.10.4.

#### 7.17.3.4 Reception of UPLINK DIRECT TRANSFER message by the GERAN

On reception of the UPLINK DIRECT TRANSFER message the NAS message
should be routed using the value indicated in the IE \"*CN Domain
Identity*\".

When the GERAN receives an UPLINK DIRECT TRANSFER message, it shall not
affect the state of any other ongoing RRC procedures, when not stated
otherwise elsewhere.

7.18 General procedures
-----------------------

### 7.18.1 Selection of initial MS identity

The purpose of the IE \"*Initial MS Identity*\" is to provide a unique
MS identification at the establishment of an RRC connection. The MS
shall choose \"MS id type\" in the IE \"*Initial MS Identity*\" with the
following priority:

1\. TMSI (GSM-MAP): The TMSI (GSM-MAP) shall be chosen if available. The
IE \"*LAI*\" in the IE \"*Initial MS Identity*\" shall also be present
when TMSI (GSM-MAP) is used.

2\. P-TMSI (GSM-MAP): The P-TMSI (GSM-MAP) shall be chosen if available
and no TMSI (GSM-MAP) is available. The IE \"*RAI*\" in the IE
\"*Initial MS Identity*\" shall in this case also be present when P-TMSI
(GSM-MAP) is used.

3\. IMSI (GSM-MAP): The IMSI (GSM-MAP) shall be chosen if no TMSI
(GSM-MAP) or P-TMSI is available.

4\. IMEI: The IMEI shall be chosen when none of the above three
conditions are fulfilled.

When being used, the IEs \"*TMSI* *(GSM-MAP)*\", \"*P-TMSI (GSM-MAP)*\",
\"*IMSI (GSM-MAP)*\", \"*LAI*\" and \"*RAI*\" shall be set equal to the
values of the corresponding identities stored in the USIM.

If the variable SELECTED\_PLMN in the MS indicates \"ANSI-41\", the MS
shall choose \"*MS Id Type*\" in the IE \"*Initial MS Identity*\"
according to the procedure specified in the 3GPP2 document \"3GPP2
C.P0004-A\".

### 7.18.2 Actions when entering RRC-Idle mode from RRC-Connected mode

When entering RRC-Idle mode from RRC-Connected mode, the MS shall:

1\> clear or set variables upon leaving GERAN RRC-Connected mode as
specified in sub-clause 10.4;

1\> attempt to select a suitable cell to camp on.

When leaving the RRC-Connected mode according to 3GPP TS 45.010, the MS
shall:

1\> perform cell selection.

While camping on a cell, the MS shall:

1\> acquire system information according to the system information
procedure in sub-clause 7.3;

1\> perform measurements according to the measurement control procedure
specified in sub-clause 7.9; and

1\> if the MS is registered:

2\> be prepared to receive paging messages according to the Paging
procedure in sub-clause 7.4.

If IE \"*PLMN Identity*\" within variable SELECTED\_PLMN has the value
\"GSM-MAP\", the MS shall:

1\> delete any NAS system information received in RRC-Connected Mode;

1\> acquire the NAS system information in packet system information 16;
and

1\> proceed according to sub-clause 7.19.

When entering RRC-Idle mode, the MS shall:

1\> if the USIM is present, for each CN domain:

2\> if a new security key set was received for this CN domain but was
not used either for integrity protection or ciphering during this RRC
connection:

3\> set the \"START\" value for this domain to zero; and

3\> store this \"START\" value for this domain in the USIM.

2\> else:

3\> if the current \"START\" value, according to sub-clause 7.18 for a
CN domain, is greater than or equal to the value \"THRESHOLD\" of the
variable START\_THRESHOLD:

4\> delete the ciphering and integrity keys that are stored in the USIM
for that CN domain;

4\> inform the deletion of these keys to upper layers.

3\> else:

4\> store the current \"START\" value for this CN domain on the USIM.

1\> else:

2\> if the SIM is present, for each CN domain:

3\> if a new security key set was received for this CN domain but was
not used either for integrity protection or ciphering during this RRC
connection:

4\> set the \"START\" value for this domain to zero; and

4\> store this \"START\" value for this domain in the MS.

3\> else, the MS shall:

4\> if the current \"START\" value, according to sub-clause 7.18 for
this CN domain, is greater than or equal to the value \"THRESHOLD\" of
the variable START\_THRESHOLD:

5\> delete the Kc key for this CN domain;

5\> delete the ciphering and integrity keys that are stored in the MS
for that CN domain;

5\> set the \"START\" value for this CN domain to zero and store it in
the MS;

5\> inform the deletion of the key to upper layers.

4\> else:

4\> store the current \"START\" value for this CN domain in the MS.

### 7.18.2a Actions when entering GERAN *A/Gb mode* or CDMA2000 from GERAN *Iu mode*, RRC- Connected mode

When entering GERAN *A/Gb mode* or CDMA2000 from GERAN *Iu mode*, RRC-
Connected mode (due to Inter-mode handover from GERAN or Inter-system
handover to CDMA2000), after successful completion of the procedure
causing the transition to the GERAN *A/Gb mode* or CDMA2000 from GERAN
*Iu mode*, the MS shall:

1\> if the USIM is present, for each CN domain:

2\> if a new security key set was received for this CN domain but was
not used either for integrity protection or ciphering during this RRC
connection:

3\> set the \"START\" value for this domain to zero and;

3\> store this \"START\" value for this domain in the USIM;

2\> else

3\> after calculating the \"START\" value according to sub-clause
7.18.4, store the current \"START\" value for every CN domain in the
USIM;

1\> if the SIM is present, for each CN domain:

2\> if a new security key was received for this CN domain but was not
used either for integrity protection or ciphering during this RRC
connection:

3\> set the \"START\" value for this domain to zero and;

3\> store this \"START\" value for this domain in the MS;

2\> else

3\> after calculating the \"START\" value according to sub-clause
7.18.4, store the current \"START\" value for this CN domain in the MS.

### 7.18.3 Maintenance of Hyper Frame Numbers

The MSBs of both the ciphering sequence numbers (COUNT-C) and integrity
sequence numbers (COUNT-I), for the ciphering and integrity protection
algorithms, respectively (see 3GPP TS 33.102), are called the Hyper
Frame Numbers (HFN). For TM RLC bearers an extended TDMA frame number is
used, which is built by an HFN plus part of a TDMA frame number.

For integrity protection, the MS shall:

1\> maintain COUNT-I as specified in sub-clause 7.18.5;

The following hyper frame numbers types are defined:

1\> MAC HFN:\
11 MSB of COUNT-C for data sent over RLC TM

1\> RLC HFN:

2\> if the RLC sequence number is of length 7 bits(GPRS TBF mode, see
3GPP TS 44.160), then the HFN

3\> defines the 24 MSB of the COUNT-C parameter for data sent over RLC
UM, and

3\> defines the 24 MSB of the COUNT-C parameter for data sent over RLC
AM.

2\> if the RLC sequence number is of length 11bits ( EGPRS TBF mode, see
3GPP TS 44.160), then the HFN

3\> defines the 20 MSB of the COUNT-C parameter for data sent over RLC
UM, and

3\> defines the 20 MSB of the COUNT-C parameter for data sent over RLC
AM.

2\> if the RLC sequence number is of length 4 bits (DCCH TBF mode, see
3GPP TS 44.160), then the HFN

3\> defines the 27 MSB of the COUNT-C parameter for data sent over RLC
UM, and

3\> defines the 27 MSB of the COUNT-C parameter for data sent over RLC
AM.

2\> if the RLC sequence number is of length 8 bits (TCH TBF mode, see
3GPP TS 44.160), then the HFN

3\> defines the 23 MSB of the COUNT-C parameter for data sent over RLC
UM, and

3\> defines the 23 MSB of the COUNT-C parameter for data sent over RLC
AM.

2\> if the RLC sequence number is of length 10 bits (UDCH TBF mode, see
3GPP TS 44.160), then the HFN:

3\> defines the 21 MSB of the COUNT-C parameter for data sent over RLC
AM .

2\> if the RLC sequence number is of length 4 bits (UDCH TBF mode, see
3GPP TS 44.160), then the HFN:

3\> defines the 27 MSB of the COUNT-C parameter for data sent over RLC
UM.

2\> if the RLC sequence number is of length 4 bits (CDCH TBF mode, see
3GPP TS 44.160), then the HFN:

3\> defines the 27 MSB of the COUNT-C parameter for data sent over RLC
AM.

1\> RRC HFN:\
28 MSB of COUNT-I.

For non-transparent mode RLC radio bearers, the MS shall:

1\> maintain one uplink and one downlink COUNT-C per radio bearer and
one uplink and one downlink COUNT-I per signalling radio bearer.

For all transparent mode RLC signalling radio bearers and radio bearers
of the same CN domain, the MS shall:

1\> maintain one COUNT-C, common for all signalling radio bearers and
radio bearers in uplink and downlink;

1\> if the activation time for a new ciphering configuration set by an
RRC procedure is equal to zero:

2\> apply the configured MAC HFN at this activation time, i.e. the
configured HFN is not incremented;

1\> maintain one uplink and one downlink COUNT-I per signalling radio
bearer.

### 7.18.4 START value calculation

In RRC connected mode, if a Security Mode Command procedure has been
successfully completed for a CN domain during the current RRC
connection, the \"START\" value for that CN domain is calculated as

Let START~X~ = the \"START\" value for CN domain \'X\' prior to the
calculation below:

START~X~\' = MSB~20~ ( MAX {COUNT-C, COUNT-I \| radio bearers and
signalling radio bearers using CK~X~ and IK~X~}) + 2.

\- if START~X~\'= the maximum value = 20\^2 --1 = 1048575 then START~X~
= START~X~\';

\- if the current START~X~ \< START~X~\' then START~X~ = START~X~\',
otherwise START~X~ is unchanged.

NOTE: Here, \"most recently configured\" means that if there are more
than one key in use for a CN domain, due to non expiry of the ciphering
and/or integrity protection activation time for any signalling radio
bearers and/or radio bearers, do not include the COUNT-I/COUNT-C for
these signalling radio bearers and/or radio bearers in the calculation
of the START~X~\'.

COUNT-C corresponding to non-ciphered radio bearers (i.e. RBs with
ciphering status set to \"not started\") shall not be included in the
calculation of the START~X~\'. If a radio bearer is released and the
radio bearer was ciphered, the values of the COUNT-C at the time the
radio bearer is released shall be taken into account in the calculation
of the START~X~\'.

If a Security Mode Command procedure has not been successfully completed
for a CN domain during the current RRC connection, the MS shall use the
latest transmitted \"START\" value for this CN domain.

### 7.18.5 Integrity protection

#### 7.18.5.0 General

If the \"Status\" in the variable INTEGRITY\_ PROTECTION\_INFO has the
value \"Started\" then the MS and the GERAN shall:

1\> perform integrity protection (and integrity checking) on all RRC
messages, with the following exceptions:

RRC CONNECTION REJECT

RRC CONNECTION SETUP

RRC CONNECTION REQUEST

RRC CONNECTION SETUP COMPLETE

SYSTEM INFORMATION TYPE 5, 5bis, 5ter, 6

SYNCHRONIZATION CHANNEL INFORMATION

RRC STATUS

EXTENDED MEASUREMENT ORDER

EXTENDED MEASUREMENT REPORT

MEASURMENT REPORT

MEASUREMENT INFORMATION

ENHANCED MEASUREMENT REPORT

If the \"Status\" in the variable INTEGRITY\_ PROTECTION\_INFO has the
value \"Not started\" then integrity protection (and integrity checking)
shall not be performed on any RRC message.

For each signalling radio bearer, the MS shall use two RRC hyper frame
numbers:

1\> \"Uplink RRC HFN\";

1\> \"Downlink RRC HFN\".

and two message sequence numbers:

1\> \"Uplink RRC Message sequence number\";

1\> \"Downlink RRC Message sequence number\".

The above information is stored in the variable
INTEGRITY\_PROTECTION\_INFO per signalling radio bearer (RB1-RB4).

Upon the first activation of integrity protection for an RRC connection,
MS and GERAN initialise the \"Uplink RRC Message sequence number\" and
\"Downlink RRC Message sequence number\" for all signalling radio
bearers as specified in sub-clauses 7.18.5.2 and 7.18.5.1.

The RRC message sequence number (RRC SN) is incremented for every
integrity protected RRC message.

If the IE \"*Integrity Protection Mode Info*\" is present in a received
message, the MS shall:

1\> perform the actions in sub-clause 7.19.4.5 before proceeding with
the integrity check of the received message.

#### 7.18.5.1 Integrity protection in downlink

If the MS receives an RRC message on signalling radio bearer with RB
identity n, the \"Status\" in the variable INTEGRITY\_ PROTECTION\_INFO
has the value \"Started\" and the IE *\'Integrity Check Info*\' is
present the MS shall:

1\> check the value of the IE \"*RRC Message Sequence Number*\" included
in the IE \"*Integrity Check Info*\";

2\> if the \"Downlink RRC Message sequence number\" for signalling radio
bearer RBn is not present in the variable INTEGRITY\_PROTECTION\_INFO:

3\> initialise the \"Downlink RRC Message sequence number\" for
signalling radio bearer RBn in the variable INTEGRITY\_PROTECTION\_INFO
with the value of the IE \"*RRC Message Sequence Number*\" included in
the IE \"*Integrity Check Info*\" of the received message;

2\> if the \"Downlink RRC Message sequence number\" is present in the
variable INTEGRITY\_PROTECTION\_INFO:

3\> if the RRC message sequence number is lower than the \"Downlink RRC
Message sequence number\" for signalling radio bearer RBn in the
variable INTEGRITY\_PROTECTION\_INFO:

4\> increment \"Downlink RRC HFN\" for signalling radio bearer SRBn in
the variable INTEGRITY\_PROTECTION\_INFO with one.

NOTE: The actions above imply that also for the case the \"Downlink RRC
HFN\" is re-initialised by a security mode control procedure, this
\"Downlink RRC HFN\" value is incremented by one before it is applied
for the integrity protection of any received message if the conditions
above are fulfilled.

3\> if the RRC message sequence number is equal to the \"Downlink RRC
Message sequence number\" for signalling radio bearer RBn in the
variable INTEGRITY\_PROTECTION\_INFO:

4\> discard the message;

1\> calculate an expected message authentication code in accordance with
sub-clause 7.18.5.3;

1\> compare the expected message authentication code with the value of
the received IE \"*Message Authentication Code*\" contained in the IE
\"*Integrity* *Check Info*\";

2\> if the expected message authentication code and the received message
authentication code are the same, the integrity check is successful:

3\> update the \"Downlink RRC Message sequence number\" for signalling
radio bearer RBn in the variable INTEGRITY\_PROTECTION\_INFO with the
value of the IE \"*RRC* *Message Sequence Number*\" included in the IE
\"*Integrity Check Info*\" of the received RRC message;

2\> if the calculated expected message authentication code and the
received message authentication code differ:

3\> act as though the message was not received.

If the MS receives an RRC message on signalling radio bearer with
identity n, the \"Status\" in the variable INTEGRITY\_PROTECTION\_INFO
has the value \"Started\" and the IE *\'Integrity Check Info\'* is not
present the MS shall:

1\> discard the message.

#### 7.18.5.2 Integrity protection in uplink

Prior to sending an RRC message using the signalling radio bearer with
radio bearer identity n, and the \"Status\" in the variable
INTEGRITY\_PROTECTION\_INFO has the value \"Started\" the MS shall:

1\> increment \"Uplink RRC Message sequence number\" for signalling
radio bearer RBn in the variable INTEGRITY\_PROTECTION\_INFO with 1,
even if the message is a retransmission of a previously transmitted
message.

1\> if the \"Uplink RRC Message sequence number\" for signalling radio
bearer RBn in the variable INTEGRITY\_PROTECTION\_INFO equals zero :

2\> the MS shall increment \"Uplink RRC HFN\" for signalling radio
bearer RBn in the variable INTEGRITY\_PROTECTION\_INFO by one;

NOTE: The actions above imply that also for the case the \"Uplink RRC
HFN\" is re-initialised by a security mode control procedure, this
\"Uplink RRC HFN\" is incremented before it is applied in the integrity
protection of any transmitted message if the conditions above are
fulfilled.

1\> calculate the message authentication code in accordance with
sub-clause 7.18.5.3;

1\> replace the \"Message authentication code\" in the IE \"*Integrity
Check Info*\" in the message with the calculated message authentication
code;

1\> replace the \"RRC Message sequence number\" in the IE \"*Integrity
Check Info*\" in the message with contents set to the new value of the
\"Uplink RRC Message sequence number\" for signalling radio bearer RBn
in the variable INTEGRITY\_PROTECTION\_INFO;

In the response message for the procedure ordering the security
reconfiguration, the MS indicates the activation time, for each
signalling radio bearer. When the new integrity configuration is to be
applied in uplink, GERAN should then start to apply the new integrity
protection configuration according to the activation time for each
signalling radio bearer (except for the signalling radio bearer which is
used to send the message that is reconfiguring the security
configuration) where the new configuration is to be applied starting
from and including reception of the response message.

#### 7.18.5.3 Calculation of message authentication code

The MS shall calculate the message authentication code in accordance
with 3GPP TS 33.102. The construction of the input parameter MESSAGE
(see 3GPP TS 33.102) for the integrity algorithm is FFS.

For usage on an RRC message transmitted or received on the radio bearer
with identity n, the MS shall:

1\> construct the input parameter COUNT-I (see 3GPP TS 33.102) by
appending the following IEs from the IE \"*Signalling Radio Bearer
Specific Integrity Protection Information*\" for radio bearer n in the
variable INTEGRITY\_PROTECTION\_INFO:

2\> for uplink:

3\> \"Uplink RRC HFN\", as the MSB, and \"Uplink RRC Message sequence
number\", as LSB;

2\> for downlink:

3\> \"Downlink RRC HFN\", as the MSB, and the IE \"*RRC Message Sequence
Number*\" included in the IE \"*Integrity Check Info*\", as LSB.

### 7.18.6 Physical channel establishment

#### 7.18.6.0 General

![](media/image38.wmf){width="6.000694444444444in"
height="2.222916666666667in"}

Figure 7.18.6.0.1: Handover Access procedure

The Handover Access procedure initiation in RRC-Cell\_Dedicated state is
done by sending a HANDOVER-Req primitive to the MS MAC layer as
described in 3GPP TS 44.160. The MS MAC uses this procedure to initiate
access in the new cell. The reception of a HANDOVER ACCESS message at
GERAN MAC is indicated to GERAN RRC by sending the HANDOVER-Ind
primitive as specified in 3GPP TS 44.160.

The Physical Information procedure initiation is done by sending a
PHYSICAL INFO-Req primitive to the GERAN MAC layer as specified in
3GPP TS 44.160 upon receipt of a HANDOVER-Ind primitive from the GERAN
MAC layer. When the network has the necessary mobile station\'s RF
characteristics it sends PHYSICAL INFORMATION message as specified in
sub-clause 7.18.6.2. The reception of a PHYSICAL INFORMATION message at
MS MAC is indicated to the MS RRC by sending the PHYSICAL INFO-Ind
primitive.

Four procedures are defined: Finely synchronized cell, Non-synchronized
cell, Pseudo-synchronized cell and Pre-synchronized cell. The support of
all of them except the pseudo-synchronized cell case is mandatory in the
mobile station. A pseudo-synchronized establishment can be commanded
only to a mobile station that can support it, as indicated in the
classmark.

#### 7.18.6.1 Finely synchronized cell case

When MS receives the RADIO BEARER RECONFIGURATION message and

1\> if the IE \"*Timing Advance*\"with the new cell is not out of range,
i.e. smaller than or equal to the maximum timing advance that can be
coded as specified in 3GPP TS 44.004, or

1\> if the new cell does accept out of range timing advance as indicated
in the RADIO BEARER RECONFIGURATION message, the mobile station shall:

2\> after having switched to the assigned channels, send the HANDOVER
ACCESS message as specified in 3GPP TS 44.160 The transmission of this
message is optional if so indicated by the network in the RADIO BEARER
RECONFIGURATION message.

The MS shall not transmit the HANDOVER ACCESS message in those cells
that support extended TA values if TA value in the new cell is greater
than 63 and the RADIO BEARER RECONFIGURATION message indicates that the
transmission of the HANDOVER ACCESS messages is optional.

Then the MS shall:

1\> activate the channels in sending and receiving mode.

If applicable, ciphering is immediately started.

#### 7.18.6.2 Non synchronized cell case

Upon reception of the RADIO BEARER RECONFIGURATION message and after
having switched to the assigned channels, the mobile station shall:

1\> send repeatedly the HANDOVER ACCESS message as specified in
3GPP TS 44.160;

1\> start timer T3124 at the start point of the timeslot in which the
HANDOVER ACCESS message is sent the first time;

1\> then, activate the channels in receiving mode; If applicable,
deciphering is then immediately started.

Upon receipt of a HANDOVER-ind primitive the GERAN RRC shall:

1\> set the value of the Timing Advance Value parameter in the PHYSICAL
INFO-Req primitive to the timing advance value received from the GERAN
MAC layer.

1\> initiate the transmission of PHYSICAL INFORMATION message by
transmitting a PHYSICAL INFO-Req service primitive to the GERAN MAC
sublayer.

When the network has the necessary mobile station\'s RF characteristics
it shall send aPHYSICAL INFORMATION message to the mobile station as
specified in 3GPP TS 44.160. If applicable, ciphering and deciphering is
immediately started

The network shall start timer T3143 immediately after having sent the
PHYSICAL INFORMATION message. If this timer times out before the
reception of the RADIO BEARER RECONFIGURATION COMPLETE message from the
mobile station, the network shall send the PHYSICAL INFORMATION message
once more and shall restart timer T3143. The network shall not send the
PHYSICAL INFORMATION message more than N3143 times. The value of T3143
and N3143 is an implementation issue.

At the mobile side, when the MAC layer indicates the reception of a
PHYSICAL INFORMATION message, the MS shall:

1\> stop timer T3124;

1\> stop sending HANDOVER ACCESS messages;

1\> activate the physical channels in sending and receiving mode;

If the allocated channel is a DBPSCH/S, the performance of the mobile
station must enable the mobile station toaccept a correct PHYSICAL
INFORMATION message sent by the network in any block while T3124 is
running.

#### 7.18.6.3 Pseudo-synchronized cell case

The details of the use of this procedure are described in
3GPP TS 45.010.

If the RADIO BEARER RECONFIGURATION message is received by the MS and if
the IE \"*Timing Advance*\" and the IE \"*Real Time Difference*\" are
included in the message, then MS shall:

1\> compute the timing advance to be used with the new cell from the
real time difference value given in the RADIO BEARER RECONFIGURATION
message.

The mobile station shall switch to the new physical channel and proceed
as follows:

1\> if the \"*Timing Advance*\" IE is received in the RADIO BEARER
RECONFIGURATION; and

1\> if the mobile station knows that the timing advance with the new
cell is not out of range, i.e. smaller or equal to the maximum timing
advance that can be coded as specified in 3GPP TS 44.004; or

1\> if the new cell accepts an out of range timing advance as indicated
in the RADIO BEARER RECONFIGURATION message after having switched to the
assigned channels, the mobile station shall:

2\> send the HANDOVER ACCESS message as specified in 3GPP TS 44.160. The
transmission of this message is optional if so indicated by the network
in the RADIO BEARER RECONFIGURATION message.

The MS shall not transmit the HANDOVER ACCESS message in those cells
that support extended TA values if TA value in new cell is greater than
63 and the RADIO BEARER RECONFIGURATION message indicates that the
transmission of the HANDOVER ACCESS messages is optional.Then MS shall:

1\> activate the channels in sending and receiving mode while sending
the HANDOVER ACCESS message.

If applicable, ciphering is immediately started.

#### 7.18.6.4 Pre-synchronized cell case

The details of the use of this procedure are described in
3GPP TS 45.010.

Upon reception of the RADIO BEARER RECONFIGURATION message, the mobile
station shall:

1\> switch to the new channel; and

1\> send the HANDOVER ACCESS message as specified in 3GPP TS 44.160. The
transmission of this message is optional if so indicated by the network
in the RADIO BEARER RECONFIGURATION message.

The MS shall not transmit the HANDOVER ACCESS message in those cells
that support extended TA values if TA value in new cell is greater than
63 and the RADIO BEARER RECONFIGURATION message indicates that the
transmission of the HANDOVER ACCESS messages is optional.Then MS shall
activate the channels in sending and receiving mode during the
transmission of the HANDOVER ACCESS message.The timing advance value to
be used with the new cell is:

1\> either the value contained in the RADIO BEARER RECONFIGURATION
message if the timing advance information element is present; or

1\> the default value for pre-synchronized handover as defined in
3GPP TS 45.010, if the timing advance information element is not
included in the RADIO BEARER RECONFIGURATION message. The MS may
activate the channels in receiving mode while sendingHANDOVER ACCESS
message.

If applicable, ciphering is immediately started.

### 7.18.7 (void)

### 7.18.8 Link failure and Radio link failure criteria and actions upon link or radio link failure

When a radio link failure is detected at L2, it is notified to RRC as
specified in 3GPP TS 44.160.

When a link failure is reported by a given RLC entity to RRC, RRC shall:

1\> stop the RLC entity

When a radio link failure occurs signalled by the MAC sublayer or the
physical layer (see 3GPP TS 45.008), the MS shall:

1\> clear the dedicated physical channel configuration;

1\> perform actions as specified for the ongoing procedure;

1\> if no procedure is ongoing or no actions are specified for the
ongoing procedure:

2\> perform a Cell Update procedure according to sub-clause 7.8 using
the cause \"radio link failure\".

### 7.18.9 Unsupported configuration

The MS should set the variable UNSUPPORTED\_CONFIGURATION to TRUE if the
received message is not according to the MS capabilities.

### 7.18.10 Invalid RLC/MAC control message notification

When notification is received of the reception of an invalid RLC/MAC
acknowledgement message on DBPSCH, the MS shall:

1\> re-establish all RLC entities for the radio bearers currently
established on the DBPSCH(s);

1\> clear the dedicated physical channel configuration;

1\> perform actions as specified for the ongoing procedure;

1\> if no procedure is ongoing or no actions are specified for the
ongoing procedure:

2\> perform a Cell Update procedure according to sub-clause 7.8 using
the cause \"Invalid RLC/MAC control message\"

### 7.18.11 Actions related to Radio Bearer mapping

When the MS receives the IE \"*RB Mapping Info*\" and/or the IE
\"*Transport Format Set*\", when the MS performs a cell reselection or a
state transition, or when the MS releases a RB, the MS shall for each of
the configured Radio Bearers:

1\> configure the MAC with the appropriate transport format set (with
computed transport block sizes) for the transport channel used by that
RB;

1\> determine the sets of RLC sizes that apply to the RLC entity used by
that RB, based on the IE \"*RLC Size List*\" included in the applicable
\"Transport format set\" (either the ones received in the same message
or the ones stored if none were received);

1\> if that RB is using RLC AM and the RLC size list applicable to the
RLC entity transporting data PDUs is different from the one derived from
the previously stored configuration:

2\> if the old RLC size list is not contained in the new one then:

3\> re-establish the RLC entity;

3\> configure the corresponding RLC entity with the new RLC size list;

2\> else configure the corresponding RLC entity with the new RLC size
list;

2\> for each RLC AM radio bearer in the CN domain as indicated in the IE
*\"CN Domain Identity*\" in the IE \"*RAB Info*\" in the variable
ESTABLISHED\_RABS whose RLC size is changed; and

2\> for each RLC AM signalling radio bearer in the CN domain as
indicated in the IE \"*CN Domain Identity*\" in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN whose RLC size is changed:

3\> if the IE \"*Status*\" in the variable CIPHERING\_STATUS of this CN
domain is set to \"Started\":

4\> set the HFN values for the corresponding RLC entity equal to the
value of the IE \"*START*\" for this CN domain that will be included in
the CELL UPDATE message following cell reselection.

4\> if the RLC re-establishment is caused by a CELL UPDATE CONFIRM:

5\> set the HFN values for the corresponding RLC entity equal to the
value of the IE \"*START*\" included in the latest transmitted CELL
UPDATE message for this CN domain.

4\> if the RLC re-establishment is caused by a reconfiguration message:

5\> set the HFN values for the corresponding RLC entity equal to the
value of the IE \"*START*\" that will be included in the reconfiguration
complete message for this CN domain.

1\> if that RB is using RLC UM:

2\> indicate the largest applicable RLC size to the corresponding RLC
entity.

1\> configure the MAC with the set of applicable RLC Sizes for each of
the RLC entity used for that RB;

1\> if there is no RLC information applicable for the transport channels
to be used:

2\> set the variable INVALID\_CONFIGURATION to TRUE.

### 7.18.12 Network response times for DBPSCH allocation

Upon reception of a CELL UPDATE CONFIRM message or one of the radio
bearer reconfiguration messages (RADIO BEARER SETUP or RADIO BEARER
RECONFIGURATION or RADIO BEARER RELEASE message) by the MS, and if the
IE \"*DBPSCH Description*\" and the structure \"Network Response Times\"
are included, the MS shall set the response times for layer 2 as
specified in 3GPP TS 44.160.

7.19 Generic actions on receipt and absence of an information element
---------------------------------------------------------------------

### 7.19.1 CN information info

If the IE \"*CN Information Info*\" is present in a message, the MS
shall:

1\> if present, forward the content of the IE \"*PLMN Identity*\" to
upper layers;

1\> if present, forward the content of the IE \"*CN Common GSM-MAP NAS
System Information*\" to upper layers;

1\> if the IE \"*CN Domain Related Information*\" is present:

2\> forward each occurrence of the IE \"*CN Domain Specific GSM-MAP NAS
System Info*\" together with the IE \"*CN Domain Identity*\" to upper
layers;

2\> if an IE \"*CN Domain Specific GSM-MAP NAS System Info*\" is not
present for a particular CN domain:

3\> indicate to upper layers that no CN system information is available
for that CN domain.

### 7.19.2 Signalling connection release indication

If the IE \"*Signalling Connection Release Indication*\" is present in a
message, the MS shall:

1\> if all radio access bearers for the CN domain identified with the
value of the IE \"*Signalling Connection Release Indication*\" would
have been released in the variable ESTABLISHED\_RABS after processing of
the received message:

2\> indicate release of the signalling connection identified with the
value of the IE \"*Signalling Connection Release Indication*\" to the
upper layers;

2\> remove the signalling connection identified with the value of the IE
\"*Signalling Connection Release Indication*\" from the variable
ESTABLISHED\_SIGNALLING\_CONNECTIONS;

1\> if radio access bearers for the CN domain identified with the value
of the IE \"*Signalling Connection Release Indication*\" would remain in
the variable ESTABLISHED\_RABS after processing of the received message:

2\> set the variable INVALID\_CONFIGURATION to TRUE.

### 7.19.3 GERAN mobility information elements

#### 7.19.3.1 GRA identity

The MS shall:

1\> if the IE \"*GRA Identity*\" is included in a received message:

2\> if the IE \"*RRC State Indicator*\" is included and set to
\"GRA\_PCH\":

3\> store this GRA identity in the variable GRA\_IDENTITY;

3\> after sending a possible message to GERAN and entering GRA\_PCH
state as specified elsewhere, read packet system information 16 in the
selected cell;

3\> if the stored GRA identity in the variable GRA\_IDENTITY is not
included in the list of GRA identities in System Information 16 in the
selected cell, the list of GRA identities in system information 16 is
empty or if the packet system information 16 can not be found, a
confirmation error of GRA identity list has occurred:

4\> if no GRA Update procedure is ongoing:

5\> initiate a GRA Update procedure after entering GRA\_PCH state; see
sub-clause 7.8;

4\> if a GRA Update procedure is ongoing:

5\> take actions as specified in sub-clause 7.8;

1\> if the IE \"*GRA Identity*\" is not included in a received message:

2\> the IE \"*RRC State Indicator*\" is included and set to \"
GRA\_PCH\":

3\> after sending a possible message to GERAN and entering GRA\_PCH
state as specified elsewhere, read System Information 16 in the selected
cell;

3\> if System Information 16 in the selected cell contains a single GRA
identity:

4\> store this GRA identity in the variable GRA\_IDENTITY;

3\> if Packet system information 16 of the selected cell contains more
than one GRA identity, the list of GRA identities in packet system
information 16 is empty or if the system information 16 can not be
found, a confirmation error of GRA identity list has occurred:

4\> if no GRA Update procedure is ongoing:

5\> initiate a GRA Update procedure after entering RRC-GRA\_PCH state
see sublsub-clause 7.8;

4\> if a GRA Update procedure is ongoing:

5\> take actions as specified in sub-clause 7.8.

#### 7.19.3.2 Mapping info

If the IE \"*Mapping Info*\" is received, the MS shall in this version
of the specification:

1\> ignore the contents of this IE.

### 7.19.4 MS information elements

#### 7.19.4.1 Activation time

If the MS receives a message containing the IE \"*Activation time*\"
with a value other than 0, the MS shall:

1\> select the beginning of the FN (TDMA Frame Number) indicated by the
IE \"*Activation Time*\" as the activation time T.

1\> at the activation time T:

2\> for a physical channel reconfiguration caused by the received
message:

3\> release the physical channel configuration, which was present before
T;

3\> initiate the establishment of the physical channel configuration as
specified for the physical channel information elements in the received
message as specified elsewhere.

2\> for actions, other than a physical channel reconfiguration, caused
by the received message:

3\> perform the actions for the information elements in the received
message as specified elsewhere.

If the MS receives a message containing the IE \"*Activation time*\"
with the value 0 meaning \"Now\", the MS shall:

1\> as an immediate reaction to the reception of the message (see
3GPP TS 45.010 for timing constraints):

2\> perform the actions for the information elements in the received
message as specified elsewhere,

NOTE: If the MS was in RRC-Idle mode or RRC- CELL\_Shared state upon
reception of the message, and the value of the IE \"*Activation Time*\"
in the received message is different from \"Now\", regardless of the
state the MS enters after reception of the message the MS behaviour is
unspecified.

#### 7.19.4.2 DRX parameters

##### 7.19.4.2.1 CN domain specific DRX cycle length coefficients

**The GERAN shall broadcast the** CN domain specific DRX cycle length
coefficients **parameter on PBCCH.** The MS may be attached to different
CN domains with different CN domain specific DRX cycle lengths. The MS
shall store each CN domain specific DRX cycle length for each CN domain
the MS is attached to.

For the CS CN domain, the CS CN specific DRX cycle length coefficient
shall be updated locally in the MS using information given in system
information.

For the PS CN domain, the PS CN specific DRX cycle length coefficient
may be updated after indication by the MS to the PS CN in NAS procedure.
If no specific value is indicated, the MS and PS CN shall use the DRX
cycle length given for PS CN domain in system information.

NOTE: Broadcast of CN domain specific DRX cycle length coefficients
shall be introduced with System Information broadcasting for GERAN *Iu
mode*.

##### 7.19.4.2.2 GERAN DRX cycle length coefficient

In RRC-Connected mode, GERAN shall determine and it may **send its**
GERAN specific DRX cycle length coefficients **parameter to a given MS**
in the following RRC messages:

\- CELL UPDATE CONFIRM

\- GRA UPDATE CONFIRM

\- RADIO BEARER RECONFIGURATION

\- RADIO BEARER RELEASE

\- RADIO BEARER SETUP

\- RRC CONNECTION SETUP

##### 7.19.4.2.3 Paging Group

In DRX mode, the MS shall compute its paging group and the GERAN shall
compute a paging group listened by the MS (see 3GPP TS 23.122) using the
SPLIT\_PG\_CYCLE parameter obtained with the following equation:

SPLIT\_PG\_CYCLE = 3 x 2 ^(9-\"main\ DRX\ cycle\ length\ coefficient\")^

In RRC-Idle mode, the \"main DRX cycle length coefficient\" is:

1\> for the MS, the smallest of the stored CN domain specific DRX cycle
length coefficients corresponding to the CN domains to which the MS is
attached;

1\> for the GERAN, the smallest of:

2\> the broadcast CN domain specific DRX cycle length coefficients
corresponding to the CN domains to which the MS is attached, and

2\> the DRX cycle length coefficient, if indicated in the PAGING message
received via RANAP.

In RRC-Connected mode, the \"main DRX cycle length coefficient\" is:

1\> for the MS, the smallest of:

2\> the stored CN domain specific DRX cycle length coefficients
corresponding to the CN domains to which the MS is attached, and,

2\> the GERAN DRX cycle length coefficient, if previously received.

1\> for the GERAN, the smallest of:

2\> the broadcast CN domain specific DRX cycle length coefficients
corresponding to the CN domains to which the MS is attached,

2\> the GERAN DRX cycle length coefficient, if previously received, and

2\> the DRX cycle length coefficient, if indicated in the PAGING message
received via RANAP.

The paging group is indicated to lower layers via primitives.

NOTE: Primitives between RLC/MAC and RRC shall be described in
3GPP TS 44.160.

#### 7.19.4.3 Generic state transition rules depending on received information elements

The IE \"*RRC State Indicator*\" indicates the state the MS shall enter.
The MS shall enter the state indicated by the IE \"*RRC State
Indicator*\" even if the received message includes other IEs relevant
only for states other than indicated by the IE \"*RRC State
Indicator*\". E.g. if the RRC state indicator is set to
\"RRC-Cell\_Shared\" while other IEs provide information about a
configuration including dedicated channels, the MS shall enter
RRC-Cell\_Shared state. If however the MS has no information about the
configuration corresponding to the state indicated by the IE \"*RRC
State Indicator*\", it shall consider the requested configuration as
invalid.

The MS shall, if the IE \"*RRC State Indicator*\" in the received
message has the value:

1\> \"RRC-Cell\_Shared\":

2\> enter RRC-Cell\_Shared state as dictated by the procedure governing
the message received;

1\> \"RRC-CELL\_Dedicated\":

2\> if neither DBPSCH is assigned in the message nor is the MS is
RRCRRC-CELL\_Dedicated state:

3\> set the variable INVALID\_CONFIGURATION to TRUE;

2\> else:

3\> enter RRC-Cell\_Dedicated state as dictated by the procedure
governing the message received;

1\> \"RRC-GRA\_PCH\":

2\> if the received message is RRC CONNECTION SETUP and IE \"*RRC State
Indicator*\" is set to RRC-GRA\_PCH:

3\> set the variable INVALID\_CONFIGURATION to TRUE;

2\> else:

3\> enter RRC-GRA\_PCH state as dictated by the procedure governing the
message received.

#### 7.19.4.4 Ciphering mode info

The IE \"*Ciphering Mode Info*\" defines the new ciphering
configuration. At any given time, the MS needs to store at most two
different ciphering configurations (keyset and algorithm) per CN domain
at any given time in total for all radio bearers, and three
configurations in total for all signalling radio bearers.

If the IE \"*Ciphering Mode Info*\" is present and if the IE
\"*Reconfiguration*\" in the variable CIPHERING\_STATUS is set to TRUE,
the MS shall:

1\> ignore this attempt to change the ciphering configuration; and

1\> set the variable INCOMPATIBLE\_SECURITY\_CONFIGURATION to TRUE.

If the IE \"*Ciphering Mode Info*\" is present and if the IE
\"*Reconfiguration*\" in the variable CIPHERING\_STATUS is set to FALSE,
the MS shall:

1\> if none of the IE \"*Status*\" in the variable CIPHERING STATUS has
the value \"Started\", and this IE \"*Ciphering Mode Info*\" was
included in a message that is not the message SECURITY MODE COMMAND
message; or

1\> if the IE \"*Ciphering Mode Info*\" was received in the message
SECURITY MODE COMMAND message and there does not exist exactly one
ciphering activation time in the IE \"*Radio Bearer Downlink Ciphering
Activation Time Info*\" for each established RLC-AM and RLC-UM radio
bearers included in the IE \"*RB Information*\" in the ESTABLISHED\_RABS
for the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN; or

1\> if the IE \"*Ciphering Mode Info*\" was received in the message
SECURITY MODE COMMAND message and the IE \"*Ciphering Activation Time
for DBPSCH*\" is not included in the message, and there exist radio
bearers using RLC-TM according to the IE \"*RB Information*\" in the IE
\"ESTABLISHED\_RABS\" for the CN domain as indicated in the variable
LATEST\_CONFIGURED\_CN\_DOMAIN; or

1\> if the IE \"*Ciphering Mode Info*\" was received in the message
SECURITY MODE COMMAND message and there does not exist excactly one
ciphering activation time in the IE \"*Radio Bearer Downlink Ciphering
Activation Time Info*\" for each established signalling radio bearer
included in the IE \"*Signalling Radio Bearer Information*\" in the
ESTABLISHED-RABS;

2\> ignore this attempt to change the ciphering configuration;

2\> set the variable INVALID\_CONFIGURATION to TRUE;

2\> perform the actions as specified in sub-clause 7.16.1.2.6;

If the IE \"*Ciphering Mode Info*\" is present and if the IE
*\"Reconfiguration*\" in the variable CIPHERING\_STATUS is set to FALSE,
the MS shall:

1\> set the IE \"*Reconfiguration*\" in the variable CIPHERING\_STATUS
to TRUE;

1\> set the IE \"*Status*\" in the variable CIPHERING\_STATUS of the the
CN domains for which the IE \"*Status*\" of the variable
SECURITY\_MODIFICATION is set to \"Affected\" to \"Started\";

1\> apply the new ciphering configuration in the lower layers for all
RBs that belong to a CN domain for which the IE \"*Status*\" of the
variable SECURITY\_MODIFICATION is set to \"Affected\" and all
signalling radio bearers:

2\> using the ciphering algorithm (UEA (see 3GPP TS 33.102)) indicated
by the IE \"*Ciphering Algorithm*\" as part of the new ciphering
configuration;

2\> for each radio bearer that belongs to a CN domain for which the IE
\"*Status*\" of the variable SECURITY\_MODIFICATION is set to
\"Affected\" and all signalling radio bearers:

3\> use the value of the IE \"*RB Identity*\" in the variable
ESTABLISHED\_RABS minus one as the value of BEARER (see 3GPP TS 33.102)
in the ciphering algorithm;

1\> for the downlink and the uplink, the new ciphering configuration
shall be applied as follows:

2\> if the ciphering configuration for a radio bearer or signalling
radio bearer from a previously received SECURITY MODE COMMAND message
has not yet been applied because of the corresponding activaton times
not having been reached and the current received message includes the IE
\"*Downlink Counter Synchronization Info*\" or the current received
message is a RADIO BEARER RECONFIGURATION message and includes the IE
\"*New G-RNTI*\":

3\> if the previous SECURITY MODE COMMAND message was received due to
new keys being received:

4\> consider the new ciphering configuration to include the received new
keys;

3\> else if the previous SECURITY MODE COMMAND caused a change in
LATEST\_CONFIGURED\_CN\_DOMAIN

4\> consider the new ciphering configuration to include the keys
associated with the LATEST\_CONFIGURED\_CN\_DOMAIN;

2\> apply the new ciphering configuration in uplink and downlink
immediately following RLC re-establishment.

2\> if the IE \"*Ciphering Activation Time for DBPSCH*\" is present in
the IE \"*Ciphering Mode Info*\" and the MS was in Cell\_Dedicated state
prior to this procedure:

3\> for radio bearers using RLC-TM:

4\> apply the old ciphering configuration for the TDMA frame number less
than the number indicated by the IE \"*COUNT-C activation time*\" in the
IE \"*Ciphering Activation Time for DBPSCH*\";

4\> apply the new ciphering configuration for the TDMA frame number
greater than or equal to the number indicated in IE \"*Ciphering
Activation Time for DBPSCH*\";

2\> if the IE \"*Radio Bearer Downlink Ciphering Activation Time Info*\"
is present:

3\> apply the following procedure for each radio bearer and signalling
radio bearers using RLC-AM or RLC-UM indicated by the IE \"*RB
Identity*\":

4\> suspend uplink transmission on the radio bearer or the signalling
radio bearer (except for the SRB where the response message is
transmitted) according to the following:

5\> do not transmit RLC PDUs with sequence number greater than or equal
to the uplink activation time, where the uplink activation time is
seclected according to the rules below;

4\> select an \"RLC sequence number\" at which (activation) time the new
ciphering configuration shall be applied in uplink for that radio bearer
according to the following:

5\> consider an ciphering activation time in uplink to be pending until
the RLC sequence number of the next RLC PDU to be transmitted for the
first time is equal to or larger than the selected activation time;

5\> for each radio bearer and signalling radio bearer that has no
pending ciphering activation time in the uplink as set by a previous
procedure changing the security configuration:

> 6\> set a suitable value that would ensure a minimised delay in the
> change to the latest ciphering configuration;

5\> for each radio bearer and signalling radio bearer that has a pending
ciphering activation time in uplink as set by a previous procedure
changing the security configuration:

> 6\> for radio bearers and signalling radio bearers except SRB2, set
> the same value as the pending ciphering activation time;

4\> store the selected \"RLC send sequence number\" for that radio
bearer in the entry for the radio bearer in the variable
RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO;

4\> switch to the new ciphering configuration according to the
following:

5\> use the old ciphering configuration for the transmitted and received
RLC PDUs with RLC sequence number smaller than the corresponding RLC
sequence number indicated in the IE \"*Radio Bearer Uplink Ciphering
Activation Time Info*\" sent to GERAN and the received IE \"*Radio
Bearer Downlink Ciphering Activation Time Info*\" received from GERAN,
respectively;

5\> use the new ciphering configuration for the transmitted and received
RLC PDUs with RLC sequence numbers greater than or equal to the
corresponding RLC sequence number indicated in the IE \"*Radio Bearer
Uplink Ciphering Activation Time Info*\" sent to GERAN and in the
received IE \"*Radio Bearer Downlink Ciphering Activation Time Info*\"
received from GERAN, respectively;

5\> for a radio bearer using RLC-AM, when the RLC sequence number
indicated in the IE \"*Radio Bearer Downlink Ciphering Activation Time
Info*\" falls below the RLC receiving window and the RLC sequence number
indicated in the IE \"*Radio Bearer Uplink Ciphering Activation Time
Info*\" falls below the RLC transmission window, the MS may release the
old ciphering configuration for that radio bearer;

5\> if an RLC reset or re-establishment occurs before the activation
time for the new ciphering configuration has been reached, ignore the
activation time and apply the new ciphering configuration both in uplink
and downlink immediately after the RLC reset or RLC re-establishment.

If the IE \"*Ciphering Mode Info*\" is not present, the MS shall:

1\> for the downlink and the uplink, apply the ciphering configuration
as follows:

2\> if the ciphering configuration for a AM or UM radio bearer or
signalling radio bearer from a previously received SECURITY MODE COMMAND
has not yet been applied because of the corresponding activation times
not having been reached and the current received message includes the IE
\"*DL Counter Synch Info*\" or the current received message is a RADIO
BEARER RECONFIGURATION message and includes the IE \"*New G-RNTI*\":

3\> if the previous SECURITY MODE COMMAND was received due to new keys
being received:

4\> consider the ciphering configuration to include the received new
keys;

3\> else if the previous SECURITY MODE COMMAND caused a change in
LATEST\_CONFIGURED\_CN\_DOMAIN:

4\> consider the ciphering configuration to include the keys associated
with the LATEST\_CONFIGURED\_CN\_DOMAIN;

3\> apply the ciphering configuration in uplink and downlink immediately
following RLC re-establishment;

2\> else:

3\> not change the ciphering configuration.

#### 7.19.4.5 Integrity protection mode info

##### 7.19.4.5.1 General

The IE \"*Integrity Protection Mode Info\"* defines the new integrity
protection configuration. At any given time, the MS needs to store at
most three different integrity protection configurations (keysets) in
total for all signalling radio bearers for all CN domains.

If the IE \"*Integrity Protection Mode Info*\" is present and if the IE
\"*Reconfiguration*\" in the variable INTEGRITY\_PROTECTION\_INFO is set
to TRUE, the MS shall:

1\> ignore this second attempt to change the integrity protection
configuration; and

1\> set the variable INCOMPATIBLE\_SECURITY\_RECONFIGURATION to TRUE.

If IE \"*Integrity Protection Mode Command*\" has the value \"Start\"
and the IE \"*Status*\" in the variable INTEGRITY\_PROTECTION\_INFO has
the value \"Not started\", and the IE \"*Integrity Protection Mode
Command Info*\" was not included in the message SECURITY MODE COMMAND
message; or

If IE \"*Integrity Protection Mode Command*\" has the value \"Start\"
and the IE \"*Status*\" in the variable INTEGRITY\_PROTECTION\_INFO has
the value \"Not started\", and the IE \"*Integrity* *Protection Mode
Info*\" was included in the message SECURITY MODE COMMAND message, and
the IE \"*Integrity Protection Algorithm*\" is not included; or

If the IE \"*Integrity Protection Mode Command*\" has the value
\"Modify\" and the IE \"*Status*\" in the variable
INTEGRITY\_PROTECTION\_INFO has the value \"Not Started\"; or

If IE \"*Integrity Protection Mode Command*\" has the value \"Start\"
and the IE \"*Status*\" in the variable INTEGRITY\_PROTECTION\_INFO has
the value \"Started\", and the IE \"Integrity protection mode command
info\" was included in the message SECURITY MODE COMMAND message; or

If the IE \"*Integrity Protection Mode Command*\" has the value
\"Modify\" and there does not exist exactly one integrity protection
activation time in the IE \"*Downlink Integrity Protection Activation
Info*\" for each established signalling radio bearer included in the IE
\"*Signalling Radio Bearer Information*\" in the variable
ESTABLISHED\_RABS; or

If IE \"*Integrity Protection Mode Command*\" has the value \"Modify\"
and the IE \"*Status*\" in the variable INTEGRITY\_PROTECTION\_INFO has
the value \"Started\", and the IE \"*Integrity Protection Mode Info*\"
was not included in the message SECURITY MODE COMMAND message:

the MS shall:

1\> ignore this attempt to change the integrity protection
configuration; and

1\> set the variable INVALID\_CONFIGURATION to TRUE.

If the IE \"Integrity protection mode info\" is not present, the MS
shall:

1\> not change the integrity protection configuration.If the IE
\"*Integrity Protection Mode Info*\" is present and if the IE
\"*Reconfiguration*\" in the variable INTEGRITY\_PROTECTION\_INFO is set
to FALSE, the MS shall:

1\> set the IE \"*Reconfiguration*\" in the variable
INTEGRITY\_PROTECTION\_INFO to TRUE;

1\> perform the actions in accordance with sub-clauses 7.19.4.5.2,
7.19.4.5.3 and 7.19.4.5.4.;

##### 7.19.4.5.2 Initialization of Integrity ProtectionThe MS shall:

1\> if IE \"*Integrity Protection Mode Command*\" has the value
\"start\" and the IE \"*Status*\" in the variable
INTEGRITY\_PROTECTION\_INFO has the value \"Not started\", and this IE
was included in the message SECURITY\_MODE\_COMMAND:

2\> initialise the information for all signalling radio bearers in the
variable INTEGRITY\_PROTECTION\_INFO according to the following:

3\> set the IE \"*Uplink RRC Message Sequence Number*\" in the variable
INTEGRITY\_PROTECTION\_INFO to zero;

3\> do not set the IE \"*Downlink RRC Message Sequence Number*\" in the
variable INTEGRITY\_PROTECTION\_INFO;

3\> set the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO to zero for
each signalling radio berer in the variable ESTABLISHED\_RABS .

NOTE: The IE \"*Integrity Protection Activation Info*\" and \"*RRC
Message Sequence Number*\"included in the IE \"*Integrity Check Info*\"
in the transmitted message do not have identical values, but integrity
protection is applied from the first transmitted message.

2\> set the IE \"*Status*\" in the variable INTEGRITY\_PROTECTION\_INFO
to the value \"Started\";

2\> perform integrity protection on the received message, applying the
new integrity protection configuration, as described in sub-clause
7.18.5 by:

3\> using the algorithm (UIA (see 3GPP TS 33.102)) indicated by the IE
\"*Integrity Protection Algorithm*\" contained in the IE \"*Integrity
Protection Mode Info*\";

3\> using the IE \"*Integrity Protection Initialisation Number*\",
contained in the IE \"*Integrity Protection Mode Info*\" as the value of
FRESH (see 3GPP TS 33.102);

2\> start applying the new integrity protection configuration in the
downlink for each signalling radio bearer in the IE \"*Established
RABS*\" except SRB2 at the next received RRC message;

2\> start applying the new integrity protection configuration in the
downlink for signalling radio bearer SRB2 from and including the
received SECURITY MODE COMMAND message;

2\> start applying the new integrity protection configuration in the
uplink for signalling radio bearer SRB2 from and including the
transmitted SECURITY MODE COMPLETE message;

2\> start applying the new integrity protection configuration in the
uplink for signalling radio bearers other than SRB2 at the uplink
activation time included in the IE \"*Uplink Integrity Protection
Activation Info*\".

##### 7.19.4.5.3 Integrity Protection Re-configuration for SBSS Relocation

The MS shall:

1\> if IE \"*Integrity Protection Mode Command*\" has the value
\"start\" and the IE \"*Status*\" in the variable
INTEGRITY\_PROTECTION\_INFO has the value \"Started\" and this IE was
not included SECURITY MODE COMMAND:

NOTE: This case is used in SBSS relocation

2\> perform integrity protection on the received message, applying the
new integrity protection configuration, as described in sub-clause
7.18.5 by:

3\> using the algorithm (UIA (see 3GPP TS 33.102)) indicated by the IE
\"*Integrity* *Protection Algorithm*\" contained in the IE \"*Integrity
Protection Mode Info*\";

3\> using the IE \"*Integrity Protection Initialisation Number*\",
contained in the IE \"*Integrity Protection Mode Info*\" as the value of
FRESH (see 3GPP TS 33.102);

2\> let SRBm be the signalling radio bearer where the reconfiguration
message was received and let SRBn be the signalling radio bearer where
the response message is transmitted;

2\> for the downlink, for each signalling radio bearer, if for the
signalling radio bearer, a security configuration triggered by a
previous SECURITY MODE COMMAND message has not yet been applied, due to
the activation time for the signalling radio bearer not having been
reached:

3\> set \"Down link RRC Message sequence number\" for this signalling
radio bearer in the variable INTEGRITY\_PROTECTION\_INFO to (activation
time - 1), where the activation time is the corresponding activation
time for this signalling radio bearer;:

3\> if the previous SECURITY MODE COMMAND message was received due to
new keys being received:

4\> consider the new integrity protectioon configuration to include the
received new keys;

3\> else if the previous SECURITY MODE COMMAND caused a change in
LATEST\_CONFIGURED\_CN\_DOMAIN:

4\> consider the new Integrity Protection configuration to include the
keys associated with the LATEST\_CONFIGURED\_CN\_DOMAIN associated with
the previously received SECURITY MODE COMMAND message;

2\> start applying the new integrity protection configuration in the
downlink for each signalling radio bearer in the variable
ESTABLISHED\_RABS except RBm at the next received RRC message for the
corresponding signalling radio bearer;

2\> start applying the new integrity protection configuration in the
downlink for signalling radio bearer RBm from and including the received
configuration message;

2\> start applying the new integrity protection configuration in the
uplink for signalling radio bearer RBn from and including the
transmitted response message;

2\> start applying the new integrity protection configuration in the
uplink for signalling radio bearers other than RBn from the first
message onwards.

##### 7.19.4.5.4 Integrity Protection modification in case of new keys or initialisation of signalling connection

The MS shall:

1\> if IE \"*Integrity Protection Mode Command*\" has the value
\"modify\" and the IE \"*Status*\" in the variable
INTEGRITY\_PROTECTION\_INFO has the value \"Started\" and this IE was
included SECURITY\_MODE\_COMMAND:

2\> store the (oldest currently used) integrity protection configuration
until activation times have elapsed for the new integrity protection
configuration to be applied on all signalling radio bearers;

2\> start applying the new integrity protection configuration in the
downlink at the RRC sequence number, for each radio bearer n, indicated
by the entry for radio bearer n in the \"RRC message sequence number
list\" in the IE \"*Downlink Integrity Protection Activation Info*\",
included in the IE \"*Integrity Protection Mode Info*\";

2\> perform integrity protection on the received message, applying the
new integrity protection configuration, as described in sub-clause
7.18.5;

3\> if present, use the algorithm indicated by the IE \"*Integrity
Protection Algorithm*\" (UIA (see 3GPP TS 33.102));

2\> set the content of the variable
INTEGRITY\_PROTECTION\_ACTIVATION\_INFO according to the following:

3\> for each established signalling radio bearer, stored in the variable
ESTABLISHED\_RABS:

4\> select a value of the RRC sequence number at which (activation) time
the new integrity protection configuration shall be applied in uplink
for that signalling radio bearer according to the following:

5\> for each signalling radio bearer:

> 6\> set the activation time for the new integrity protection
> configuration to the next RRC SN;

4\> prohibit the transmission of RRC messages on all signalling radio
bearers, except for SRB2, with RRC SN greater than or equal to the value
in the \"RRC message sequence number list\" for the signalling radio
bearer in the IE \"*Uplink Integrity Protection Activation Info*\" of
the variable INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> start applying the new integrity protection configuration in the
uplink at the RRC sequence number, for each SRBn, except for signalling
radio bearer SRB2, indicated by the entry for radio bearer n in the
\"RRC message sequence number list\" in the IE \"*Uplink Integrity
Protection Activation Info*\", included in the variable
INTEGRITY\_PROTECTION\_ACTIVATION\_INFO;

2\> start applying the new integrity protection configuration in the
uplink at the RRC sequence number for signalling radio bearer SRB2, as
specified for the procedure initiating the integrity protection
reconfiguration;

2\> start applying the new integrity protection configuration in the
downlink at the RRC sequence number, for each SRBn, except for
signalling radio bearer SRB2, indicated by the entry for signalling
radio bearer n in the \"*RRC* *Message Sequence Number List*\" in the IE
\"*Downlink Integrity Protection Activation Info*\".

NOTE: For signalling radio bearers that have a pending activation time
as set for integrity protection by a previous procedure changing the
integrity protection configuration, the GERAN shall set this value in IE
\"*Downlink Integrity Protection Activation Info*\".

2\> start applying the new integrity protection configuration in the
downlink at the RRC sequence number for signalling radio bearer SRB2, as
specified for the procedure initiating the integrity protection
reconfiguration.

#### 7.19.4.6 Integrity check info

If the IE \"Integrity check info\" is present the MS shall:

1\> act as described in sub-clause 7.18.4.1 .

#### 7.19.4.7 New G-RNTI

If the IE \"*New G-RNTI*\" is included in a received message, the MS
shall:

1\> store the value in the variable G\_RNTI, replacing any old stored
value.

#### 7.19.4.8 RRC Transaction Identifier

The IE \"*RRC Transaction Identifier*\" may be used, together with the
message type, for identification of an invocation of a downlink
procedure (transaction). The MS behaviour for accepting or rejecting
transactions based on the message type and the IE \"*RRC Transaction
Identifier*\" is specified below.

If the IE \"*RRC Transaction Identifier*\" is included in a received
message, the MS shall perform the actions below. The MS shall:

If the received message is any of the messages:

\- RADIO BEARER SETUP; or

\- RADIO BEARER RECONFIGURATION; or

\- RADIO BEARER RELEASE;

the MS shall:

1\> if the variable ORDERED\_RECONFIGURATION is set to FALSE; and

1\> if the variable CELL\_UPDATE\_STARTED is set to FALSE; and

1\> if the received message does not contain a protocol error according
to clause 8 and the variable PROTOCOL\_ERROR\_REJECT is set to FALSE:

2\> accept the transaction; and

2\> store the IE \"*Message Type*\" and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Accepted
transactions\" in the variable TRANSACTIONS;

1\> else:

2\> if the variable ORDERED\_RECONFIGURATION is set to TRUE; or

2\> if the variable CELL\_UPDATE\_STARTED is set to TRUE; or

2\> if the received message contains a protocol error according to
clause 8 causing the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE:

3\> if the IE \"*RRC Transaction Identifier*\" of the received message
is identical to the \"RRC Transaction Identifier\" stored for the same
\"Message Type\" as the received message in the table \"Accepted
transactions\" in the variable TRANSACTIONS:

4\> ignore the transaction; and

4\> continue with any ongoing processes and procedures as the message
was not received;

4\> and end the procedure;

3\> else:

4\> reject the transaction; and

4\> if the IE \"*Message Type*\" of the received message is not present
in the table \"Rejected transactions\" in the variable TRANSACTIONS:

5\> store the IE \"*Message Type*\" and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Rejected
transactions\" in the variable TRANSACTIONS.

Else:

If the received message is any of the messages:

\- RRC CONNECTION SETUP; or

\- CELL UPDATE CONFIRM; or

\- GRA UPDATE CONFIRM;

the MS shall:

1\> if the IE \"*Message Type*\" of the received message is not present
in the table \"Accepted transactions\" in the variable TRANSACTIONS:

2\> if the received message does not contain a protocol error according
to clause 8 and the variable PROTOCOL\_ERROR\_REJECT is set to FALSE:

3\> accept the transaction; and

3\> store the IE \"*Message Type*\" and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Accepted
transactions\" in the variable TRANSACTIONS;

2\> else:

2\> if the received message contains a protocol error according to
clause 8 causing the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE:

3\> reject the transaction; and

3\> if the IE \"*Message Type*\" of the received message is not present
in the table \"Rejected transactions\" in the variable TRANSACTIONS:

3\> store the IE \"*Message Type*\" and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Rejected
transactions\" in the variable TRANSACTIONS.

1\> else:

1\> if the IE \"*Message Type*\" of the received message is present in
the table \"Accepted transactions\" in the variable TRANSACTIONS:

2\> if the IE \"*RRC Transaction Identifier*\" of the received message
is identical to the \"RRC Transaction Identifier\" stored for the
\"Message Type\" in the table \"Accepted transactions\" in the variable
TRANSACTIONS:

3\> ignore the transaction; and

3\> continue with any ongoing processes and procedures as the message
was not received; and

3\> end the procedure;

2\> else:

2\> if the IE \"*RRC Transaction Identifier*\" of the received message
is different from the \"RRC transaction identifier\" stored for the
\"Message Type\" in the table \"Accepted transactions\" in the variable
TRANSACTIONS:

3\> if the received message does not contain a protocol error according
to clause 8 and the variable PROTOCOL\_ERROR\_REJECT is set to FALSE:

4\> ignore the once accepted transaction and instead accept the new
transaction; and

4\> store the IE \"*Message Type\"* and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Accepted
transactions\" in the variable TRANSACTIONS, replacing the previous
entry;

NOTE 1: The MS is expected to process the first RRC CONNECTION
SETUP/CELL UPDATE CONFIRM/GRA UPDATE COMFIRM message that it receives
after transmitting an RRC CONNECTION REQUEST/CELL UPDATE/GRA UPDATE
message. If the MS receives further RRC CONNECTION SETUP/CELL UPDATE
CONFIRM/GRA UPDATE COMFIRM messages without having transmitted another
RRC CONNECTION REQUEST/CELL UPDATE/GRA UPDATE message, the MS is not
required to process these messages.

3\> else:

3\> if the received message contains a protocol error according to
clause 8 causing the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE:

4\> reject the transaction; and

4\> if the IE \"*Message Type*\" of the received message is not present
in the table \"Rejected transactions\" in the variable TRANSACTIONS:

5\> store the IE \"*Message Type*\" and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Rejected
transactions\" in the variable TRANSACTIONS.

Else:

If the received message is any other message, the MS shall:

1\> if the IE \"*Message Type*\" of the received message is not present
in the table \"Accepted transactions\" in the variable TRANSACTIONS:

2\> if the received message does not contain a protocol error according
to clause 8 and the variable PROTOCOL\_ERROR\_REJECT is set to FALSE:

3\> accept the transaction; and

3\> store the IE \"*Message Type*\" and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Accepted
transactions\" in the variable TRANSACTIONS;

2\> else:

2\> if the received message contains a protocol error according to
clause 8 causing the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE:

3\> reject the transaction; and

3\> store the IE \"*Message Type*\" and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Rejected
transactions\" in the variable TRANSACTIONS.

1\> else:

1\> if the IE \"*Message Type*\" of the received message is present in
the table \"Accepted transactions\" in the variable TRANSACTIONS:

2\> if the IE \"*RRC Transaction Identifier*\" of the received message
is identical to the \"RRC transaction identifier\" stored in any entry
for the \"Message Type\" in the table \"Accepted transactions\" in the
variable TRANSACTIONS:

3\> ignore the transaction; and

3\> continue with any ongoing processes and procedures as the message
was not received; and

3\> end the procedure;

2\> else:

2\> if the IE \"*RRC Transaction Identifier*\" of the received message
is different from the \"RRC transaction identifier\" stored in all
entries for the \"Message Type\" in the table \"Accepted transactions\"
in the variable TRANSACTIONS:

3\> if the received message does not contain a protocol error according
to clause 9 and the variable PROTOCOL\_ERROR\_REJECT is set to FALSE:

4\> accept the additional transaction; and

4\> store the IE \"*Message Type*\" and the IE \"*RRC Transaction
Identifier*\" of the received message in the table \"Accepted
transactions\" in the variable TRANSACTIONS, in addition to the already
existing entries;

3\> else:

3\> if the received message contains a protocol error according to
clause 8 causing the variable PROTOCOL\_ERROR\_REJECT to be set to TRUE:

4\> reject the transaction; and

4\> store the IE \"*Message Type\"* and the IE \"*RRC* *Transaction
Identifier*\" of the received message in the table \"Rejected
transactions\" in the variable TRANSACTIONS.

#### 7.19.4.9 Capability Update Requirement

If the IE \"*Capability Update Requirement*\" is included the MS shall:

1\> if the IE \"*MS GERAN A/Gb mode Radio Acces Capability Update
Requirement*\" is set to \"required\":

2\> if the MS supports the GERAN *A/Gb mode*:

3\> include its GERAN *A/Gb mode* radio access capability in the IE
\"*MS GERAN A/Gb mode Radio Access Capability* \" of the variable
MS\_CAPABILITY\_REQUESTED;

1\> if one or more of the 3 the IEs \"*UE Radio Access FDD Capability
Update Requirement*\" or \"*UE Radio Access 3,84 Mcps TDD Capability
Update Requirement*\" or \"*UE Radio Access 1,28 Mcps TDD Capability
Update Requirement*\" is set to \"required\":

2\> include its UE UTRAN Radio Access Capability in the IE \"*UE UTRAN
Radio Access Capability*\" and its UE UTRAN Radio Access Capability
Extension if present in the IE \"*UE UTRAN Radio Access Capability
Extension*\" of the variable MS\_CAPABILITY\_REQUESTED as specified in
of 3GPP TS 25.331.

1\> if the IE \"*UE CDMA2000 Radio Acces Capability Update Requirement
List*\" is set to \"required\":

2\> if the MS supports the CDMA2000 RAT:

3\> include its UE CDMA2000 radio acces capability in the IE \"*UE
CDMA2000 Radio Acces Capability*\" of the variable
MS\_CAPABILITY\_REQUESTED

If the IE \"*Capability Update Requirement*\" is not present, the MS
shall:

1\> assume no capabilities were required and act in accordance with the
above.

### 7.19.5 Radio bearer information elements

#### 7.19.5.1 Signalling RB information to setup list

If the IE \"*Signalling RB Information To Setup List*\" is included the
MS shall:

1\> use the same START value to initialise the COUNT-C and COUNT-I
variables for all the signalling radio bearers in the list;

1\> if the IE \"*Signalling RB* *Information To Setup List*\" was
included in the RADIO BEARER SETUP message:

2\> if the variable \"LATEST\_CONFIGURED\_CN\_DOMAIN\" has been
initialised:

3\> calculate the START value only once during this procedure according
to sub-clause 7.18.4 for the CN domain indicated in the variable
\"LATEST\_CONFIGURED\_CN\_DOMAIN\";

3\> store the calculated START value in the variable
START\_VALUE\_TO\_TRANSMIT;

1\> for each occurrence of the IE \"*Signalling RB Information to
Setup*\":

2\> use the value of the IE \"*RB Identity\"* as the identity of the
signalling radio bearer to setup;

2\> if the signalling radio bearer identified with the IE \"*RB
Identity*\" does not exist in the variable ESTABLISHED\_RABS:

3\> create a new entry for the signalling radio bearer in the variable
ESTABLISHED\_RABS;

2\> if the variable LATEST\_CONFIGURED\_CN\_DOMAIN has been initialised
and the value \"Status\" of the variable \"INTEGRITY\_PROTECTION\_INFO\"
of the CN domain stored in this variable is \"Started\":

3\> initialise the 20 MSB of the hyper frame number component of COUNT-I
for this signalling radio bearer with the START value in the variable
START\_VALUE\_TO\_TRANSMIT

3\> set the remaining LSB of the hyper frame number component of COUNT-I
for this signalling radio bearer to zero;

3\> for this signalling radio bearer, set the IE \"*Uplink RRC Message
Sequence Number*\" in the variable INTEGRITY\_PROTECTION\_INFO to zero.

3\> start performing integrity protection according to sub-clause
7.18.5.1 and 7.18.5.2;

2\> perform the actions for the IE \"*RB mapping info*\" as specified in
sub-clause 7.19.5.9a, applied for that signalling radio bearer;

1\> apply a default value of the IE \"*RB Identity*\" equal to 1 for the
first IE \"*Signalling RB Information To Setup*\"; and

1\> increase the default value by 1 for each occurrence.

#### 7.19.5.2 RAB Information for Setup

If the IE \"*RAB* *Information For Setup*\" is included, the procedure
is used to establish radio bearers belonging to a radio access bearer,
and the MS shall:

1\> if several IEs \"*RAB Information For Setup*\" are included and the
included IEs \"CN domain identity\" in the IE \"*RAB Info*\" does not
all have the same value:

2\> set the variable INVALID\_CONFIGURATION to TRUE;

1\> if the radio access bearer identified with the IE \"*RAB Info*\"
does not exist in the variable ESTABLISHED\_RABS:

2\> create a new entry for the radio access bearer in the variable
ESTABLISHED\_RABS;

2\> store the content of the IE \"*RAB Info*\" in the entry for the
radio access bearer in the variable ESTABLISHED\_RABS;

2\> indicate the establishment of the radio access bearer to the upper
layer entity using the IE \"CN *Domain Identity*\", forwarding the
content of the IE \"*RAB Identity*\";

2\> calculate the START value only once during this procedure (the same
START value shall be used on all new radio bearers created for this
radio access bearer) according to sub-clause 7.18 for the CN domain as
indicated in the IE \"*CN* *Domain Identity*\" in the IE \"*RAB Info*\"
part of the IE \"*RAB* *Information To Setup*\";

2\> store the calculated START value in the variable
START\_VALUE\_TO\_TRANSMIT;

1\> for each radio bearer in the IE \"*RB Information To Setup*\":

2\> if the radio bearer identified with the IE \"*RB Identity*\" does
not exist in the variable ESTABLISHED\_RABS for another radio access
bearer than the one identified with the IE \"*RAB Info*\":

3\> perform the actions specified in sub-clause 7.19;

3\> store information about the new radio bearer in the entry for the
radio access bearer identified by \"RAB info\" in the variable
ESTABLISHED\_RABS;

2\> if the radio bearer identified with the IE \"*RB Identity*\" already
exists in the variable ESTABLISHED\_RABS for another radio access bearer
than the one identified with the IE \"*RAB Info*\":

3\> set the variable INVALID\_CONFIGURATION to TRUE.

#### 7.19.5.3 RAB Information to Reconfigure

If the IE \"*RAB Information to Reconfigure*\" is included then the MS
shall:

1\> if the entry for the radio access bearer identified by the IE \"*CN
Domain Identity*\" together with the IE \"*RAB Identity*\" in the
variable ESTABLISHED\_RABS already exists:

2\> perform the action for the IE \"*NAS Synchronization Indicator*\",
according to sub-clause 7.19.13;

1\> else:

2\> set the variable INVALID\_CONFIGURATION to TRUE.

#### 7.19.5.4 RB information to setup

If the IE \"*RB Information To Setup*\" is included, the MS shall apply
the following actions on the radio bearer identified with the value of
the IE \"RB identity\". The MS shall:

1\> use the same START value to initialise the hyper frame number
components of COUNT-C variables for all the new radio bearers to setup;

1\> perform the actions for the IE \"*PDCP Info*\", if present,
according to sub-clause 7.19.5.10, applied for the radio bearer;

1\> perform the actions for the IE \"*RLC Info*\", according to
sub-clause 7.19.5.9, applied for the radio bearer;

1\> perform the actions for the IE \"*RB Mapping Info*\", according to
sub-clause 7.19.5.9a, applied for the radio bearer;

1\> if IE \"*Physical Channel Configuration*\" is included

2\> perform the actions as specified in sub-clause 7.19.5.14 applied for
the radio bearer;

1\> if the IE \"*Downlink RLC mode*\" either in the IE \"*RLC info*\" or
referenced by the RB identity in the IE \"*Same as RB*\" is set to \"TM
RLC\":

2\> configure delivery of erroneous SDUs in lower layers according to
indication from upper layer as in 3GPP TS 24.008.

1\> if the IE \"*Uplink RLC mode*\" or the IE \"*Downlink RLC mode*\"
either in the IE \"*RLC info*\" or referenced by the RB identity in the
IE \"*Same as RB*\" is set to \"AM RLC\" or \"UM RLC\":

2\> initialise the 20 MSB of the hyper frame number component of COUNT-C
for this radio bearer with the START value in the variable
START\_VALUE\_TO\_TRANSMIT;

2\> set the remaining LSB of the hyper frame number component of COUNT-C
for this radio bearer to zero;

2\> start incrementing the COUNT-C values.

1\> if the IE \"*Uplink RLC mode*\" and the IE \"*Downlink RLC mode*\"
either in the IE \"*RLC info*\" or referenced by the RB identity in the
IE \"Same as RB\" is set to \"TM RLC\":

2\> if prior to this procedure there exists no transparent mode radio
bearer for the CN domain included in the IE \"*CN domain identity*\" in
the IE \"*RAB info*\" in the variable ESTABLISHED\_RABS and at least one
transparent mode radio bearer is included in the IE \"*RB information to
setup*\":

3\> if the IE \"*Status*\" in the variable CIPHERING\_STATUS of the CN
domain as indicated in the IE \"*CN domain identity*\" in the IE \"*RAB
info*\" in the variable ESTABLISHED\_RABS is set to \"Not Started\":

4\> at the activation time as specified in the IE \"*Ciphering
activation time for DBPSCH*\" if included in the IE \"*Ciphering mode
info*\" in the command message or, if this IE is not included, as
specified in the IE \"*COUNT-C activation time*\" included in the
response message:

5\> initialise the 20 most significant bits of the hyper frame number
component of COUNT-C common for all transparent mode radio bearers of
this CN domain with the START value in the variable
START\_VALUE\_TO\_TRANSMIT;

5\> set the remaining LSB of the hyper frame number component of COUNT-C
to zero;

5\> do not increment the COUNT-C value common for all transparent mode
radio bearers for this CN domain;

4\> if the IE \"*Status*\" in the variable CIPHERING\_STATUS of the CN
domain as indicated in the IE \"*CN domain identity*\" in the IE \"*RAB
info*\" in the variable ESTABLISHED\_RABS is set to \"Started\":

4\> at the activation time as specified in the IE \"*Activation Time*\"
in the RADIO BEARER SETUP message:

5\> initialise the 20 most significant bits of the hyper frame number
component of COUNT-C commom for all transparent mode RLC radio bearer to
the value of the latest transmitted START for this CN domain, while not
incrementing the value of the HFN component of COUNT-C at each TDMA
frame number cycle; and;

5\> set the remaining LSB of the hyper frame number component of COUNT-C
to zero;

5\> start to perform ciphering on the radio bearer in lower layers while
not incrementing the HFN;

4\> at the activation time as specified in the IE \"*Ciphering
activation time for DBPSCH*\" if included in the IE \"*Ciphering mode
info*\" in the command message or, if this IE is not included, as
specified in the IE \"COUNT-C activation time\" included in the response
message:

5\> initialise the 20 most significant bits of the hyper frame number
component of COUNT-C common for all transparent mode radio bearers of
this CN domain with the START value in the variable
START\_VALUE\_TO\_TRANSMIT;

5\> set the remaining LSB of the hyper frame number component of COUNT-C
to zero;

5\> start incrementing the COUNT-C value common for all transparent mode
radio bearers offor this CN domain as normal, at each TDMA frame number
cycle value, i.e. the HFN component is no longer fixed in value but
incremented at each TDMA frame number cycle.

2\> if prior to this procedure there exists at least one transparent
mode radio bearer for the CN domain included in the IE \"*CN Domain
Identity*\" in the IE \"*RAB info*\" in the variable ESTABLISHED\_RABS:

3\> if the IE \"*Status*\" in the variable CIPHERING\_STATUS of the CN
domain as indicated in the IE \"*CN Domain Identity*\" in the IE \"RAB
info\" in the variable ESTABLISHED\_RABS is set to \"Not Started\":

4\> do not increment the COUNT-C value common for all transparent mode
radio bearers for this CN domain.

> 3\> if the IE \"*Status*\" in the variable CIPHERING\_STATUS of the CN
> domain as indicated in the IE \"*CN* *Domain Identity*\" in the IE
> \"*RAB Info*\" in the variable ESTABLISHED\_RABS is set to \"
> Started\":

4\> continue incrementing the COUNT-C value common for all transparent
mode radio bearers of this CN domain.

1\> if the IE \"*Status*\" in the variable CIPHERING\_STATUS of the CN
domain as indicated in the IE \"*CN* *Domain Identity*\" in the IE
\"*RAB Info*\" in the variable ESTABLISHED\_RABS is set to \"Started\":

2\> start to perform ciphering on the radio bearer in lower layers,
using the value of the IE \"*RB Identity*\" minus one as the value of
BEARER in the ciphering algorithm.

NOTE: The GERAN does not use the IE \"*RB Information To Setup*\" to
setup radio bearers with RB identity in the range 1-4.

#### 7.19.5.5 RB information to be affected

If the IE \"RB *Information To Be Affected*\" is included, the MS shall
apply the actions on the radio bearer identified with the value of the
IE \"RB *Identity*\".

#### 7.19.5.6 RB information to reconfigure

If the IE \"*RB Information To Reconfigure*\" is included, the MS shall
apply the following actions on the radio bearer identified with the
value of the IE \"*RB Identity*\". The MS shall:

1\> perform the actions for the IE \"*PDCP Info*\", if present,
according to sub-clause 7.19.5.10, applied for the radio bearer;

1\> perform the actions for the IE \"*RLC Info\",* according to
sub-clause 7.19.5.9, applied for the radio bearer;

1\> if IE \"*Physical Channel Configuration*\" is included

2\> perform the actions as specified in sub-clause 7.19.5.14 applied for
the radio bearer;

1\> perform the actions for the IE \"*RB Mapping Info*\", according to
sub-clause 7.19.5.9a, applied for the radio bearer;

1\> if the IE \"*PDCP SN Info*\" is included:

2\> perform the actions as specified in sub-clause 7.19.5.11 applied for
the radio bearer;

1\> if the IE \"*RB Stop/Continue*\" is included; and

2\> if the \"*RB* *Identity*\" has a value greater than 2; and

3\> if the value of the IE \"*RB* *Stop/Continue*\" is \"stop\":

4\> configure the RLC entity for the radio bearer to stop;

4\> set the IE \"*RB Started*\" in the variable ESTABLISHED\_RABS to
\"stopped\" for that radio bearer;

3\> if the value of the IE \"*RB Stop/Continue*\" is \"continue\":

4\> configure the RLC entity for the radio bearer to continue;

4\> set the IE \"*RB Started*\" in the variable ESTABLISHED\_RABS to
\"started\" for that radio bearer;

2\> if the IE \"*RB Identity*\" is set to a value less than 2:

3\> set the variable INVALID\_CONFIGURATION to TRUE.

#### 7.19.5.7 RB Information to Release

If the IE \"*RB Information to Release*\" is included, the MS shall
apply the following actions on the radio bearer identified with the
value of the IE \"*RB Identity*\". The MS shall:

1\> release the PDCP and RLC entities dedicated for that radio bearer;

1\> if IE \"*Physical Channel Configuration*\" is included

2\> perform the actions as specified in sub-clause 7.19.5.14 applied for
the radio bearer;

1\> if the information about the radio bearer is stored in the variable
ESTABLISHED\_RABS:

2\> delete the information about the radio bearer from the variable
ESTABLISHED\_RABS;

2\> when all radio bearers belonging to the same radio access bearer
have been released:

3\> indicate release of the radio access bearer to upper layers
providing the \"CN domain identity\" together with the \"*RAB
Identity*\" stored in the variable ESTABLISHED\_RABS;

3\> delete all information about the radio access bearer from the
variable ESTABLISHED\_RABS.

#### 7.19.5.8 RB with PDCP Information

If the IE \"*RB with PDCP Information*\" is included, the MS shall apply
the following actions on the radio bearer identified with the value of
the IE \"*RB Identity*\". The MS shall:

1\> for the IE \"*PDCP SN Info\":*

2\> perform the actions as specified in sub-clause 7.19.5.11.

#### 7.19.5.9 (void)

#### 7.19.5.9a RB Mapping Info

If the IE \"*RB Mapping Info*\" is included, the MS shall:

1\> for this RB:

2\> if a transport channel that would not exist as a result of the
message (i.e. removed in the same message in IE \"*Deleted DL TrCH
Information*\" and IE \"*Deleted UL TrCH Information*\") is referred to:

3\> set the variable INVALID\_CONFIGURATION to TRUE.

2\> for each RLC entity:3\> if the value of the IE \"*RLC Size List*\"
is set to \"Explicit list\":

4\> if a \"Transport format set\" for the transport channel is included
in the same message, and the value (index) of any IE \"RLC *Size
Index*\" in the IE \"*Explicit List*\" does not correspond to an \"RLC
size\" in the IE transport format set of that transport channel given in
the message; or

4\> if a \"Transport format set\" for that transport channel is not
included in the same message, and the value (index) of any IE \"*RLC
Size Index*\" in the IE \"*Explicit List*\" does not correspond to an
\"RLC size\" in the stored transport format set of that transport
channel:

5\> set the variable INVALID\_CONFIGURATION to TRUE.

3\> if the value of the IE \"*RLC Size List*\" is set to \"All\":4\> if
a \"Transport format set\" for the transport channel is not included in
the same message:

5\> set the variable INVALID\_CONFIGURATION to TRUE.

3\> if the value of the IE \"*RLC Size List*\" is set to \"Configured\":

4\> if a \"Transport format set\" for the transport channel for this RLC
entity is included in the same message, and for none of the RLC sizes
defined for that transport channel in the \"Transport format set\", or

4\> if a \"Transport format set\" for the transport channel for this RLC
entity is not included in the same message, and for none of the RLC
sizes defined in the transport format set stored for that transport
channel:

5\> set the variable INVALID\_CONFIGURATION to TRUE.

1\> if the \"*RB Mapping Info*\" is considered as valid according to the
rules above:

2\> delete the previously stored configuration for that radio bearer;

2\> store the new configuration for that radio bearer;

2\> perform the actions as specified in sub-clause 7.18.11.

As regards the IE \"*Channel Type*\", the following rule should be
applied to derive the DL channel type from the UL channel included in
the IE:

  -------------------- ----------------------------------------
  Channel used in UL   DL channel type implied by \"same as\"
  DCH                  DCH
  -------------------- ----------------------------------------

#### 7.19.5.10 RLC Info

If the IE \"*RLC Info*\" is included, the MS shall:

1\> configure the transmitting and receiving RLC entities in the MS for
that radio bearer accordingly.

#### 7.19.5.11 PDCP Info

For RFC 3095:

1\> the chosen MAX\_CID shall not be greater than the value \"Maximum
Number of ROHC Context Sessions\" as indicated in the IE \"*PDCP
Capability*\";

1\> the configuration for the PACKET\_SIZES\_ALLOWED governs which
packet sizes RFC 3095 is allowed to use.

If IE \"*PDCP Info*\" is included, the MS shall:

1\> if the radio bearer is connected to a CS domain radio access bearer:

2\> set the variable INVALID\_CONFIGURATION to TRUE;

1\> if the IE \"*PDCP PDU Header*\" is set to the value \"absent\":

2\> if the IE \"*Support for Lossless SBSS Relocation*\" is true:

3\> set the variable INVALID\_CONFIGURATION to TRUE;

1\> if the IE \"*PDCP PDU Header*\" is set to the value \"present\":

2\> if the IE \"*Support for Lossless SBSS Relocation*\" is false:

3\> if the structure \"Header Compression Information\" is absent:

4\> set the variable INVALID\_CONFIGURATION to TRUE;

1\> if the structure \"Header compression information\" is absent:

2\> not use Header compression after the successful completion of this
procedure;

2\> remove any stored configuration for the structure \"Header
compression information\".

> \> if the structure \"Header compression information\" is present:

2\> if RFC 2507 is used:

3\> if the MS capability \"Maximum header compression context space\",
as specified in 3GPP TS 25.306, is exceeded with this configuration:

4\> set the variable INVALID\_CONFIGURATION to TRUE.1\> if the structure
\"Header compression information\" is present in the reconfiguration
message:

2\> only use header compression algorithms present in the structure
\"Header compression information\" in that message for the configured
radio bearer.

2\> use the order in which the header compression algorithms are
received in the message as the order that shall be used by PDCP for
mapping of PID values (see 3GPP TS 25.323)

1\> configure the PDCP entity for that radio bearer accordingly;

1\> configure the RLC entity for that radio bearer according to the
value of the IE \"*Support for Lossless SBSS Relocation*\".

1\> set the PROFILES parameter, used by inband ROHC profile negotiation,
for this PDCP entity for both UL and DL equal to the list of ROHC
profiles received in the IE \"*PDCP info*\". A MS complying with this
version of the specification shall support ROHC profiles 0x0000 (ROHC
uncompressed), 0x0001 (ROHC RTP), 0x0002 (ROHC UDP) and 0x0003 (ROHC
ESP) (IANA ROHC profile identifier definition).

#### 7.19.5.11a PDCP context relocation info

If the IE \"PDCP context relocation info\" is included, the MS shall,
for each radio bearer included in this IE:

1\> If the IE \"*Downlink RFC3095 Context Relocation Indication*\" is
set to TRUE:

2\> perform the actions as specified in 3GPP TS 25.323 for all RFC3095
contexts associated to that radio bearer in the downlink;

1\> If the IE \"*Uplink RFC3095 Context Relocation Indication*\" is set
to TRUE:

2\> perform the actions as specified in 3GPP TS 25.323 for all RFC3095
contexts associated to that radio bearer in the uplink.

#### 7.19.5.12 PDCP SN Info

If the IE \"*PDCP SN Info*\" is included, the MS shall:

1\> transfer the sequence number to the PDCP entity for the radio
bearer;

1\> configure the RLC entity for the radio bearer to stop;

1\> include the current PDCP receive sequence number and the radio
bearer identity for the radio bearer in the variable PDCP\_SN\_INFO.

#### 7.19.5.13 NAS Synchronisation Indicator

If the IE \"*NAS Synchronisation Indicator*\" is present in a message,
the MS shall:

1\> forward the content to upper layers along with the IE \"*CN Domain
Identity*\" of the associated RAB stored in the variable
ESTABLISHED\_RABS at the CFN indicated in the IE \"*Activation Time*\"
in order to synchronise actions in NAS and AS.

#### 7.19.5.14 Physical Channel Configuration

If the IE \"*Physical Channel Configuration*\" is included, the MS
shall:

1\> if the IE \"*SBPSCH Description*\" is included;

2\> perform the action specified in 7.19.6.2;

2\> start timer T3190.

1\> if the IE \"*DBPSCH Description*\" is included;

1\> perform the action specified in 7.19.6.1;

### 7.19.6 Physical channel parameters

#### 7.19.6.1 DBPSCH Description

If the MS receives the one of the messages RADIO BEARER SETUP, RADIO
BEARER RECONFIGURATION, RADIO BEARER RELEASE or CELL UPDATE CONFIRM
message and if IE \"*Power Command*\" is present, the MS shall:

1\> set the power level accordingly for the initial power on the new
channel(s) and it shall not affect the power used on the old channel(s).

else set the INVALID\_CONFIGURATION to TRUE, in case that MS enters the
RRC-Cell\_Dedicate state-MAC-Dedicated state.

If the IE \"*Mode of the First Channel*\" to be applied corresponds to a
multi-rate speech codec in one of the messages RADIO BEARER SETUP, RADIO
BEARER RECONFIGURATION, RADIO BEARER RELEASE or CELL UPDATE CONFIRM
message shall contain the MultiRate Configuration IE, then the MS shall:

1\> expect the IE *MultiRate Configuration* and ;

1\> if it is initial establishment the MS shall:

2\> use the Initial Codec Mode specified in the IE *MultiRate
Configuration*

1\> otherwise apply the implicit rule defined in 3GPP TS 45.009.

else:

1\> set the INVALID\_CONFIGURATION to TRUE and;

1\> remain on the current channel(s) and use the old Channel Description
or Channel Mode(s).

If the value of IE *MultiRate Configuration* is incosistent the MS
shall:

1\> set the INVALID\_CONFIGURATION to TRUE;

1\> remain on the current channel(s) and use the old Channel Description
or Channel Mode(s).

The IE *MultiRate Configuration* shall be considered as inconsistent by
the MS if:

\- the active set does not include any codec mode or the active set
includes more than four codec modes; or

\- one or more codec modes of the active codec set are not supported by
the physical channel; or

\- the threshold and hysteresis values are not set according to
requirements given in 3GPP TS 45.009.

If the MS receives one of the messages RADIO BEARER SETUP, RADIO BEARER
RECONFIGURATION RADIO BEARER RELEASE or CELL UPDATE CONFIRM and

1\> if the message contains only the description of a channel to be used
after the starting time in the IE \"*Description of the Channel After
Time*\", the MS shall:

1\> wait until the starting time before accessing the channel:

else:

1\> if the starting time already elapsed, the MS shall:

2\> access the channel as an immediate reaction to the reception of the
message (see 3GPP TS 45.010 for the timing constraints).

1\> if the message contains both the description of a channel to be used
after the indicated time and the description of a channel to be used
before the indicated time, in the IEs \"*Description of the Channel,
After Time*\" and \"*Description of the Channel, Before Time*\", the MS
may:

2\> access the channel immediatelly after the reception of the message.

2\> if the moment, at which the mobile station is ready to access, is
before the time indicated by the IE \"*Description of the Channel, After
Time*\", the mobile station shall:

3\> access the channels as described in the IE \"*Description of the
Chanel, Before The Starting Time*\".

3\> then change to the channel described for after the starting time at
the indicated time. New parameters shall be frequency list, MAIO and
HSN. Other parameters describing the allocated channels must be
identical to the parameters described in the IE \"*Description of the
Chanel, Before The Starting Time*\". If the moment the mobile station is
ready to access is after the starting time, the mobile station accesses
the channel described in the IE \"*Description of the Chanel, Before The
After Time*\".

1\> if the IE \"*Starting Time*\" is not present and some of the
information elements referring to before the starting time is present,
these information elements shall be considered as IEs unnecessary in the
message.

1\> if the IE \"*Description of the Channel, Before Time*\" is not
present, the MS shall:

2\> apply the channel description for before the time, if needed, given
by the IE \"*Description of the* *Channel, After Time*\".

1\> if the IE \"*Starting Time*\" is present and the IE \"*Description
of the Channel, before time*\" indicates frequency hopping, one and only
one of the following information elements may be present and the MS
shall apply this before the starting time

\- IE\"*Mobile Allocation, Before Time*\";

\- IE \"*Frequency List, Before Time*\";

\- IE \"*Frequency Channel Sequence, Before Time*\".

1\> if the IE \"*Starting Time*\" is present and the IE \"*Channel
Description, Before The Starting Time*\" indicates frequency hopping,
and none of the above mentioned IE is present,

2\> the IE\"*Frequency List, After Time*\" must be present, and this
applies also for before the starting time.

2\> if frequency hopping is applied, the cell allocation if present in
the message is used to decode the mobile allocation. If the cell
allocation is not included, the mobile station shall use its current
cell allocation.

1\> if the RADIO BEARER RECONFIGURATION message contains only the IE
\"*Description of the Channel, After Time*\" and the handover is towards
a GERAN cell to which the mobile station is not synchronised for the
case of an intersystem handover to GERAN, the mobile station shall:

2\> wait up to the starting time before accessing the new channel;

2\> if the starting time has already elapsed, the mobile shall:

3\> access the new channel as an immediate reaction to the reception of
the message (see 3GPP TS 45.010 for the timing constraints). Between the
reception of the RADIO BEARER RECONFIGURATION and the starting time
there is no requirement for the mobile station to receive or transmit on
the old channel.

If MS receives the RADIO BEARER RECONFIGURATION and the IE \"*Power
Command and Access Type*\" is present, the MS shall:

1\> set the initial power on the new channel (s) to the the power level
defined in this power command (cf 3GPP TS 45.008). It shall not affect
the power used on the old channel(s).

else

1\> set the variable INVALID\_CONFIGURATION to TRUE.

If MS receives the RADIO BEARER RECONFIGURATION and if the IE
\"*Handover Reference*\" is present, the MS shall:

1\> use handover reference value used for access identification. The
choice of the handover reference by the network is out of the scope of
this specification and left to the manufacturers.

else

1\> set the variables INVALID\_CONFIGURATION to TRUE.

If MS receives the RADIO BEARER RECONFIGURATION and if the IE
\"*Synchronization Indication*\" is not be present then, the MS shall:

1\> assume the handover type is non-synchronized.

If MS receives the RADIO BEARER RECONFIGURATION and if the IE
\"*Timining Advance*\" is present then the MS shall:

1\> use this in the new cell;

1\> if in the case of a synchronous or pseudo-synchronous handover the
MS knows that the timing advance with the new cell is out of range, i.e.
is bigger than the maximum timing advance that can be coded as specified
in 3GPP TS 44.004, and if the new cell does not accept out of range
timing advance as indicated in the RADIO BEARER RECONFIGURATION message,
the mobile station shall:

2\> set the variable INVALID\_CONFIGURATION to TRUE.

If the mobile station receives a RADIO BEARER RECONFIGURATION message
and if at least one of the following IEs, IE \"*Handover Reference*\",
IE \"*Power Command and Access Type*\", IE \"*Cell Description*\" and IE
\"*Description of the first channel after time*\" is not present, the MS
shall:

1\> set the variable INVALID\_CONFIGURATION to TRUE.

If the MS receives RADIO BEARER RECONFIGURATION and the IE \"*Starting
Time*\" may be present, then the MS shall:

1\> change the frequency paramters of the channels more or less at the
moment a change of channel occurs. In this case a number of parameters
can be included.

If the MS receives RADIO BEARER RECONFIGURATION and if the IE
\"*Starting Time*\" is present and none of the information elements
referring to before the starting time are present, the mobile station
shall:

1\> wait and access the channels at the indicated time.

If the MS receives RADIO BEARER RECONFIGURATION and if the IE
\"*Starting Time*\" is present and at least one of the information
elements referring to before the starting time is present, the mobile
station shall:

1\> not wait for the indicated time and access the channel using the
frequency parameters for before the starting time.

If the MS receives RADIO BEARER RECONFIGURATION and if the IE
\"*Starting Time*\" is not present and some of the information elements
referring to before the starting time are present, these information
elements shall be considered as IEs unnecessary in the message.

If the MS receives RADIO BEARER RECONFIGURATION and if the IE
\"*Description of the First Channel, Before Time*\" is not present, the
MS shall:

1\> apply for the channel description the information given for before
the time, if needed, in the IE \"*Description of tThe First Channel,
After Time\"*.

If the MS receives RADIO BEARER RECONFIGURATION and if the IE
\"*Description of the Second Channel, After Time*\" is present, and if
the IE \"*Description of the* *Second Channel, Before Time*\" not
present, and a description of the configuration for before the time
needed, the MS shall:

1\> use the channel configuration before the starting time, and the
channel description to apply to the second channel before the starting
time is given by the IE \"*Description of the Second Channel, After
Time*\".

If the MS receives RADIO BEARER RECONFIGURATION and if the IE
\"*Starting Time\"* is present and at least one of the channel
descriptions for before the starting time indicates frequency hopping,
one and only one of the following information elements may be present
and applies before the starting time to all assigned channels:

\- IE \"*Mobile Allocation, Before Time*\";

\- IE \"*Frequency Short List, Before Time*\";

\- IE \"*Frequency List, Before Time*\";

\- IE \"*Frequency Channel Sequence, Before Time*\".

If the IE \"*Starting Time*\" is present and at least one of the channel
descriptions for before the starting time indicates frequency hopping,
and if none of the above mentioned IE is present, the MS shall use:

1\> a frequency list for after the starting time must be present, and
this list applies also for the channels before the starting time.

If MS receives the RADIO BEARER RECONFIGURATION and if at least one of
the channel descriptions for after time indicates frequency hopping, one
and only one of the following information elements shall be present IE
\"*Frequency Channel Sequence, After Time\",* IE *\"Frequency List,
After Time\",* IE *\"Frequency Short List, After Time\",* IE*\"Mobile
Allocation, After Time*\".

If MS receives the RADIO BEARER RECONFIGURATION and if neither of the
*Channel Description* IEs indicate frequency hopping, and if they are
not required for the decoding of *Channel Description* IEs for before
time, and if any of the four information elements are present they shall
be considered as IEs unnecessary in the message.

The IE *\"Frequency Channel Sequence*\" element shall not be used unless
all the ARFCNs that it indicates are in the P-GSM band.

If the RADIO BEARER RECONFIGURATION message instructs the mobile station
to use a frequency that it is not capable of, then the mobile station
shall:

1\> set the variable UNSUPPORTED\_CONFIGURATION to TRUE;

1\> remain on the current channel(s).

If the mobile station receives a RADIO BEARER RECONFIGURATION message
with a IE \"*Frequency List*\" or IE \"*Frequency Short List*\"
indicating frequencies that are not all in one band, then the mobile
station shall:

1\> stay on the current channel(s); and

1\> set the variable UNSUPPORTED\_CONFIGURATION to TRUE.

If MS receives the one of the messages RADIO BEARER SETUP, RADIO BEARER
RECONFIGURATION, RADIO BEARER RELEASE or CELL UPDATE CONFIRM message and
if the IE \"*Frequency List, After Time*\" or IE \"*Frequency List,
Before Time*\" is present, then MS shall:

1\> change the frequency according with the values of the IEs.

If the MS receives the reconfiguration message and if IE \"*Cell Channel
Description*\" is present in the message and if the frequency hopping is
applied, the MS may decode the mobile alocation based on the cell
allocation, if present in the message.

The network shall include the IE \"*Cell Channel Description*\" in the
RADIO BEARER RECONFIGURATION, RADIO BEARER SETUP, RADIO BEARER RELEASE
or CELL UPDATE CONFIRM message if no proper reference cell frequency
list (CA) has been sent previously to the mobile station.

If MS receives in the RADIO BEARER RECONFIGURATION message which
contains the \"*Cell Channel Description*\" IE or \"*Channel Mode*\" IE
which instruct the mobile station to use a Channel Description or Mode
that it does not support, or the Channel Mode indicated for use is not
defined for all channel sets, then the MS shall:

1\> set the variable UNSUPPORTED\_CONFIGURATION to TRUE

1\> remain on the current channel(s) and use the old Channel Description
or Mode(s).

If the cell allocation is not included, the mobile station shall use its
current cell allocation, the current CA is the last CA received. If the
mobile station receives RADIO BEARER RECONFIGURATION message with a IE
\"*Mobile Allocation*\" indexing frequencies that are not all in one
band and a IE *Starting Time* indicating a time that has not elapsed
then the mobile station shall:

1\> remain on the current channel(s).

1\> send a RRC STATUS message with cause \"frequency not implemented\";

1\> set the variable INVALID\_CONFIGURATION to TRUE.

If the mobile station receives a RADIO BEARER RECONFIGURATION message
with a IE \"Mobile Allocation\" indexing frequencies that are not all in
one band and a \"Starting Time\" IE indicating a time that has elapsed,
then the mobile station shall locally abort the radio connection and, if
permitted, attempt Call Re-establishment.

If the MS receives the RADIO BEARER RECONFIGURATION message and if IE
\"*Cell Description*\" is included in the message then MS shall:

1\> use its pre-knowledge about synchronization acquired by the
measurement process (i.e. BSIC + BCCH frequency)

else

1\> set the variable INVALID\_CONFIGURATION to TRUE.

If the MS receives the RADIO BEARER RECONFIGURATION and if the IE
\"*Real Time Difference*\" is included then the MS shall:

1\> apply the pseudo-synchronous case type of handover.

If the MS receives the RADIO BEARER RECONFIGURATION and if the IE
\"*Timing Advance*\" is included then the MS shall:

1\> if IE \"*Synchronization Indication*\" indicates a presynchronized
handover, use presynchronous type of handover.

1\> else

2\> if IE \"*Synchronization Indication*\" not indicates a
presynchronized handover, use the default value as defined in
3GPP TS 45.010. The MS shall consider an unnecessary information element
for other types of handover.

The \"*Dynamic ARFCN\"* IE shall only be included if the network
supports dynamic ARFCN mapping and there is a need to define new dynamic
ARFCN mapping, e.g. at handover to another PLMN or from another RAT to
GSM. This information replaces any previously received information about
dynamic ARFCN mapping. After returning to idle mode or packet idle mode,
the mobile station shall acquire new dynamic ARFCN mapping information,
except for the cases specified in 3GPP TS 44.018 (SI15). This mapping
shall apply to any ARFCN used in the RADIO BEARER RECONFIGURATION
message.

When one of the reconfiguration messages or CELL UPDATE CONFIRM message
is received and IE \"*PDTCH*\" is included, the MS shall

1\> set the structure \"Dynamic Allocation\" as specified in
3GPP TS 44.160, and

1\> if the MS is EGPRS capable

2\> set the IE *EGPRS Window Size* as specified in the PACKET UPLINK
ASSIGNMENT message in 3GPP TS 44.060 for each RB.

If the MS receives one of the RADIO BEARER SETUP, RADIO BEARER
RECONFIGURATION, RADIO BEARER RELEASE or CELL UPDATE CONFIRM messages
and if the structure \"*FLO Basic Physical Channels Parameters*\" is
present in the IE \"*DBPSCH*\", the MS shall:

1\> not use\"*Channel Mode*\" IE and \"*Channel Mode2*\" IE; and

1\> apply the channel description given by the IE \"*Mode\", IE\"
Modulation*\" and IE \"*Interleaving*\".

If the MS receives one of the RADIO BEARER SETUP, RADIO BEARER
RECONFIGURATION, RADIO BEARER RELEASE or CELL UPDATE CONFIRM messages
and if the structure \"*FLO Basic Physical Channels Parameters*\" is
present in the IE \"*DBPSCH*\"and none of the IE \"*Mode\",* IE
\"*Modulation*\" and IE \"*Interleaving*\" is present then the MS shall:

1.  set the variable INVALID\_CONFIGURATION to TRUE.

If the MS receives one of the RADIO BEARER SETUP, RADIO BEARER
RECONFIGURATION, RADIO BEARER RELEASE or CELL UPDATE CONFIRM messages
and if the struct \"FLO \" is present in the IE \"*DBPSCH*\", for each
timeslot the MS shall:

1\> if one of the FLO IEs is present (IE \"*UL TrCH Information Common
For All Transport Channels*\", IE \"*Deleted UL TrCH Information*\", IE
\"*Added or Reconfigured UL TrCH Information*\", IE \"*DL TrCH
Information Common For All Transport Channels*\", IE \"*Deleted DL TrCH
Information\"* or IE \"*Added or Reconfigured DL TrCH Information*\"):

2.  set the transport channels parameters as defined in sub-clause 7.19.

If the MS receives one of the RADIO BEARER SETUP, RADIO BEARER
RECONFIGURATION, RADIO BEARER RELEASE or CELL UPDATE CONFIRM messages
and if the struct \"*FLO* \" is present in the IE \"*DBPSCH*\" and if
one of the TrCH IEs (\"*UL TrCH Information Common For All Transport
Channels*\", IE \"*Deleted UL TrCH Information*\", IE \"*Added or
Reconfigured UL TrCH Information*\", IE \"*DL TrCH Information Common
For All Transport Channels*\", IE \"*Deleted DL TrCH Information\"* or
IE*\" Added or Reconfigured DL TrCH Information*\") instructs the MS to
use a TrCH configuration not supported, the MS shall:

1\> set the variable INVALID\_CONFIGURATION to TRUE.

If the MS receives one of the RADIO BEARER SETUP, RADIO BEARER
RECONFIGURATION RADIO BEARER RELEASE or CELL UPDATE CONFIRM messages and
if the IE \"*FLO Basic Physical Channels Parameters*\" is present in the
IE \"*DBPSCH*\"and if one of the FLO IEs ( IE \"*Mode\"*, IE*\"*
*Modulation*\" or IE \"*Interleaving*\") instructs the MS to use a
configuration not supported, the MS shall:

1\> set the variable INVALID\_CONFIGURATION to TRUE.

#### 7.19.6.2 SBPSCH parameters

The reconfiguration message can contain either the description of the
uplink TBF or the downlink TBF. The information on the power to be used
on the target TBF shall not affect the power used on the old channel(s).
The network may assign a radio resource on one or more PDCHs to be used
for the TBF. The amount of radio resource to be reserved is a network
dependent choice.

The IE \"*SBPSCH Description*\" message may indicate a frequency change
in progress, with a starting time and possibly alternative channel
descriptions.

If MS receives the one of the messages RADIO BEARER SETUP or RADIO
BEARER RECONFIGURATION RADIO BEARER RELEASE message and the message
includes either IE \"*RRC Packet Uplink Assignment*\" or IE\"*RRC Packet
Downlink Assignment*\" the MS shall:

1\> set the parameters for uplink or downlink TBF. The information on
the power to be used on the target TBF shall not affect the power used
on the old channel(s).

else

1\> set the INVALID\_CONFIGURATION to TRUE.

The RADIO BEARER SETUP or RADIO BEARER RECONFIGURATION or RADIO BEARER
RELEASE message may indicate a frequency change in progress, with a
starting time and possibly alternative channel descriptions. If the MS
is in RRC-Cell\_Dedicated state, MAC Dedicted or MAC DTM state and if MS
receives the reconfiguration message and if the message contains only
the description of a TBF to be used after the starting time, the mobile
station shall

1\> wait untill the starting time before using the TBF.

1\> if the starting time has already elapsed, the mobile shall:

2\> use the TBF immediatly after the reception of the message (see
3GPP TS 45.010 for the timing constraints).

1\> if the message contains both the description of a TBF to be used
after the indicated time and of a TBF to be used before, the mobile
station shall:

2\> use the TBF as an immediate reaction to the reception of the
message.

1\> if the moment the mobile station is ready to access is before the
indicated time, the mobile station shall:

2\> use the TBF described for before the starting time.

2\> the mobile station shall then change to the TBF described for after
the starting time at the indicated time. New parameters shall be
frequency list, MAIO and HSN. Other parameters describing the allocated
channels shall be identical to the parameters described for before the
starting time. If the moment the mobile station is ready to access is
after the starting time, the mobile station shall the TBF described for
after the starting time.

### 7.19.7 Transport channel information elements

#### 7.19.7.1 Transport Format Set

If the IE \"*Transport Format Set*\" is included, the MS shall:

1\> if that RB is using AM and the set of RLC sizes applicable to the
RLC entity transferring data PDUs has more than one element not equal to
zero:

2\> keep the transport format set if this exists for that transport
channel;

2\> set the variable INVALID\_CONFIGURATION to TRUE.

1\> if the total number of configured transport formats for the
transport channel exceeds maxTF:

2\> keep the transport format set if this exists for that transport
channel;

2\> set the variable INVALID\_CONFIGURATION to TRUE.

1\> if the IE \"*Transport Format Set*\" is considered as valid
according to the rules above:

2\> remove a previously stored transport format set if this exists for
that transport channel;

2\> store the transport format set for that transport channel;

2\> if the IE \"*Transport format Set*\" has the choice \"Transport
channel type\" set to \"Dedicated transport channel\":

3\> calculate the transport block size for all transport formats in the
TFS using the following

TB size = RLC/MAC block size if \"RLC size\" \<\> 0,\
TB size = 0 if \"RLC size\" = 0,

where:

\- RLC/MAC block size is calculated according to 3GPP TS 44.160.

\- \'RLC size\' reflects the RLC PDU size.

2\> if the IE \"*Transport Format Set*\" contains IE \"*Semi-static
Transport Format Information*\" then:

3\> set the values of CRC size to 0,6,12 or 18 and the Rate matching
attribute any value between 1 and 256.

2\> else:

3\> set the variable INVALID\_CONFIGURATION to TRUE.

2\> if the *Transport Block Size* \<\> 0 and IE \"*RLC size*\" = 0, no
RLC PDU data exists but only parity bits exist for that transport
format;

2\> if the *Transport Block Size* = 0, neither RLC PDU neither data nor
parity bits exist for that transport format;

1.  perform the actions as specified in sub-clause 7.18.21.

#### 7.19.7.2 Transport format combination set

If the IE \"*Transport Format Combination Set*\" is included, the MS
shall for that direction (uplink or downlink):

1\> store the new transport format combination set, or (if this exists)
modify a previously stored transport format combination set according to
IEs included in IE \"*Transport Format Combination Set*\";

1\> start to respect those transport format combinations;

If for a given TFCS in a given direction the size of the TFCI is changed
during reconfiguration, the network shall assign a new DBPSCH where the
TFCS will apply in the same direction after reconfiguration. A new
DBPSCH is a DBPSCH on which the TFCS did not apply prior to
reconfiguration.

If the IE \"*Transport Format Combination Set*\" is included and the
TFCI size is changed the MS shall:

1\> perform the TFCS reconfiguration of DBPSCH according to IEs included
in IE \"*Transport Format Combination Set*\".

If the IE \"*Transport Format Combination Set*\" is not included and if
there is no addition, removal or reconfiguration of transport channels,
the MS shall for that direction (uplink or downlink):

1\> use a previously stored transport format combination set if this
exists.

If the IE \"*Transport Format Combination Set*\" is not included; and

1\> if no transport format combination set is stored in the MS; or

1\> if transport channels are added or removed in the message; or

1\> if any transport channel is reconfigured in the message such that
the size of the transport format set is changed:

the MS shall:

1\> set the variable INVALID\_CONFIGURATION to TRUE.

In the uplink TFCS the minimum set of TFCs is the set of TFCs that is
needed for the TFC selection algorithm defined in 3GPP TS 44.160. The
minimum set of TFCs consists of the following:

1\> for each RLC UM entity:

2\> a TFC with one transport block for this transport channel and empty
TFs for all the others. If more than one TFC fulfils this criteria, only
the TFC with the lowest number of bits should be included in the minimum
set of TFCs.

1\> for each RLC AM entity:

2\> a TFC with a non-empty TF for the corresponding transport channel
and empty TFs for all other transport channels, where the non-empty TF
includes one transport block with \"Configured RLC Size\" equal to the
RLC PDU size.

1\> for each RLC TM entity:

2\> a TFC with non-empty TFs for the corresponding transport channel,
and empty TFs for all other transport channels, where:

3\> for RLC TM entity the non-empty TFs include, for the smallest SDU
size that can be received in a single TTI from higher layer:

4\> a TF with non-zero number of transport blocks with \"Configured RLC
Size\" equal to the corresponding SDU size. If more than one TFC fulfils
this criteria, only the TFC with the lowest number of bits in the TFC is
included in the minimum set of TFCs.

1\> an \"empty\" TFC.

Furthermore, the GERAN should ensure that the uplink TFCS satisfies the
following rules:

1\> for the TTI length with which at least one transport channel is
configured:

2\> for each combination of TFs for the transport channels configured
with this TTI length included in the TFCS:

3\> a TFC with these TFs for the transport channels configured with this
TTI length and empty TFs on all transport channels configured with the
TTI length is also included in the TFCS.

#### 7.19.7.3 (void)

#### 7.19.7.4 Added or Reconfigured UL TrCH information

If the IE \"*Added or Reconfigured UL TrCH Information*\" is included
then the MS shall:

> 1\> for the transport channel identified by the IE \"*UL Transport
> Channel Identity*\" and IE \"*Uplink Transport Channel Type*\":

2\> perform the actions for the IE \"*Transport Format Set*\" as
specified in sub-clause 7.19.7.1.

#### 7.19.7.5 Added or Reconfigured DL TrCH information

If the IE \"*Added or Reconfigured DL TrCH Information*\" is included
then for the transport channel identified by the IE \"*DL Transport
Channel Identity*\" the MS shall:

1\> if the choice \"DL parameters\" is set to \'explicit\':

2\> perform the actions for the IE \"*Transport Format Set*\" as
specified in sub-clause 7.19.7.1.

1\> if the choice \"DL parameters\" is set to \'same as uplink\':

2\> if the IE \"*UL Transport Channel Identity*\" indicates an existing
or a new UL Transport Channel:

3\> store as transport format for this transport channel the transport
format associated with the transport channel identified by the IE \"*UL
Transport Channel Identity*\".

2\> else:

3\> set the variable INVALID\_CONFIGURATION to TRUE.

#### 7.19.7.6 Deleted UL TrCH information

If the IE \"*Deleted UL TrCH Information*\" is included the MS shall:

1\> delete any information about the transport channel identified by the
IE \"*UL TrCH Identity*\" and IE \"*Uplink Transport Channel Type*\".

#### 7.19.7.7 Deleted DL TrCH information

If the IE \"*Deleted DL TrCH Information*\" is included the MS shall:

1\> delete any information about the transport channel identified by the
IE \"*DL TrCH Identity*\" as applicable.

#### 7.19.7.8 UL TrCH information common for all transport channels

If the IE \"*UL TrCH Information Common For All Transport Channels*\" is
included the MS shall:

1\> perform actions for the IE \"*UL DCH TFCS*\" as specified in
sub-clause 7.19.7.2.

#### 7.19.7.9 DL TrCH information common for all transport channels

If the IE \"*DL TrCH Information Common For All Transport Channels*\" is
included the MS shall:

1\> if the IE \"*DL DCH TFCS*\" is included:

2\> perform actions as specified in sub-clause 7.19.7.2.

The IE \"*DL TrCH Information Common For All Transport Channels*\" shall
always include a DL DCH TFCS configuration, either by including the IE
\"*DL DCH TFCS* \" or by specifying that the TFCS is the same as in UL.
If GERAN does not require the reconfiguration of the concerned
parameters, GERAN may replace one TFC with the value that is already
assigned for this IE.

#### 7.19.7.10 TFCS Reconfiguration/Addition Information

If the IE \"*TFCS Reconfiguration/Addition Information*\" is included
the MS shall:

1\> store the TFCs to be reconfigured/added indicated in the IE \"*CTFC
Information*\" as specified below;

In order to identify the TFCs included in this IE the MS shall calculate
the CTFC as specified in clause 11.

If the IE \"*TFCS Reconfiguration/Addition Information*\" is used in
case of TFCS \"Complete reconfiguration\" the MS shall:

1\> remove a previously stored transport format combination set if this
exists;

1\> consider the first instance of the IE \"*CTFC Information*\" as
Transport Format Combination 0 (TFCI=0)

If the IE \"*TFCS Reconfiguration/Addition Information*\" is used in
case of TFCS \"Addition\" the MS shall insert the new additional(s) TFC
into the first available position(s) in ascending TFCI order in the
TFCS.

#### 7.19.7.11 TFCS Removal Information

If the IE \"*TFCS Removal Information*\" is included the MS shall:

1\> remove the TFCs indicated by the IE \"*TFCI*\" from the current
TFCS, and mark these positions (TFCI) in the TFCS as vacant.

2.  if \"*Compression Algorithm*\" flag is set to one and if the size of
    the TFCI can be reduced as a result of removing the vacant TFCIs,
    then the TFCI values shall be shifted as follows:

> For TFCI~loop~=1 on FR channels and 2 on HR channels, to (Number of
> non vacant positions in the TFCS - 1)
>
> If TFCI~loop~ is vacant then
>
> Assign to TFCI~loop~ the first remaining TFC for which the assigned
> TFCI \> TFCI~loop~ and then mark the position of that TFC (TFCI) as
> vacant.
>
> End if.
>
> End for.

2\> if \"*Compression Algorithm*\" flag is set to zero then no shift
shall be applied.

NOTE: whether the size of the TFCI can be reduced or not can easily be
assessed by:

$\left\lceil \text{log}_{2}\left( \text{NumberOfNonVacantPositions} \right) \right\rceil < \text{CurrentTFCISize}$

If TFC is used for SRB data transfer and layer 2 signalling as defined
in section 11.5 it shall not be removed.

If the MS receives one of the messages RADIO BEARER SETUP, RADIO BEARER
RECONFIGURATION or RADIO BEARER RELEASE and if the IE \"*TFCS Removal
Information*\" is present and if the IE instructs the mobile station to
remove a TFCI which is not existent or it is used for signalling as
defined in subclause 11.5 then the MS shall:

1\> remain on the current channel(s).

1.  set the variable INVALID\_CONFIGURATION to TRUE.

1\> send failure message (RADIO BEARER SETUP FAILURE or RADIO BEARER
RECONFIGURATION FAILURE or RADIO BEARER RELEASE FAILURE) as it is
described in subclause 7.14.1.9.

#### 7.19.7.12 TFCS Explicit Configuration

If the IE \" *TFCS Explicit Configuration*\" is included the MS shall:

1\> if the IE choice \"*TFCS Representation*\" is set to \'complete
reconfiguration\':

2\> perform the actions for the IE \"*TFCS Reconfiguration/Addition
Information*\" as specified in sub-clause 7.19.7.10.

1\> if the IE choice \"*TFCS Representation*\" is set to \'addition\':

2\> perform the actions for the IE \"*TFCS Reconfiguration/Addition
Information*\" as specified in sub-clause 7.19.7.10.

1\> if the IE choice \"*TFCS Representation*\" is set to \'removal\':

2\> perform the actions for the IE \"*TFCS Removal Information*\" as
specified in sub-clause 7.19.7.11.

1\> if the IE choice \"*TFCS Representation*\" is set to \'replace\':

2\> perform first the actions for the IE \"*TFCS Removal Information*\"
as specified in sub-clause 7.19.7.11; and then

2\> perform the actions for the IE \"*TFCS Reconfiguration/Addition
Information*\" as specified in sub-clause 7.19.7.10.

8 Handling of unknown, unforeseen, and erroneous protocol data
==============================================================

8.1 General
-----------

This sub-clause specifies procedures for the handling of unknown,
unforeseen, and erroneous protocol data by the receiving entity. These
procedures are called \"error handling procedures\", but in addition to
provide recovery mechanisms for error situations they define a
compatibility mechanism for future extensions of the protocol.

The error handling procedures specified in this sub-clause shall apply
to all RRC messages. When there is a different handling for the same
message received on different logical channels, this is specified.

For system information, the error handling procedures applied on system
information messages are specified below.

When the MS receives an RRC message, it shall set the variable
PROTOCOL\_ERROR\_REJECT to FALSE and then perform the checks in the
order as defined below.

The error cases specified in the following include handling upon
reception of spare values. This behaviour also applies in case the
actual value of the IE results from mapping the originally sent IE
value. Moreover, in certain error cases, as specified in the following,
default values apply. In this case, the default values specified within
the procedure specifications apply.

The procedures for the handling of unknown, unforeseen, and erroneous
protocol data by the receiving entity for the ASN1 coded messages (CELL
UPDATE, GRA UPDATE and GRA UPDATE CONFIRM) sent on the SRB2 and IEs are
following the rules defined in 3GPP TS 25.331.

8.2 CSN.1 violation or encoding error
-------------------------------------

If the MS receives an RRC message on SRB 2, SRB 3 or SRB 4 for which the
encoded message does not result in any valid syntax value (or \"encoding
error\"), it shall perform the following. The MS shall:

1\> set the variable PROTOCOL\_ERROR\_REJECT to TRUE;

1\> transmit an RRC STATUS message on SRB2. The IE \"*Protocol Error
Information*\" shall contain an IE \"*Protocol Error Cause*\" set to
\"CSN.1 violation or encoding error\";

1\> when RRC STATUS message has been submitted to lower layers for
transmission:

2\> continue with any ongoing processes and procedures as if the invalid
message had not been received.

If the MS receives an RRC message sent via a radio access technology
other than GERAN, for which the encoded message does not result in any
valid syntax, the MS shall:

1\> set the variable PROTOCOL\_ERROR\_REJECT to TRUE;

1\> set the IE \"*Protocol Error Cause*\" in the variable
PROTOCOL\_ERROR\_INFORMATION to \"CSN.1 violation or encoding error\";

1\> perform procedure specific error handling according to clause 7.

If a set of system information message received on SRB 1 does not result
in any valid syntax value, the MS shall:

1\> ignore the set of system information message;

1\> treat the other sets of this system information message as if those
sets were not present.

If the MS receives an RRC message on SRB 1 for which the encoded message
does not result in any valid syntax value, it shall ignore the message.

If the MS receives an RRC message on SRB 2 and if the RRC message is
coded in ASN1 then MS shall follow the rules defined in 3GPP TS 25.331
for the DL messages sent on the DCCH.

If the MS receives an RRC message sent on SRB2 or via a radio access
technology other than GERAN, and the RRC message is coded in ASN1 for
which the encoded message does not result in any valid syntax, the MS
shall:

1\> set the variable PROTOCOL\_ERROR\_REJECT to TRUE;

1\> set the IE \"*Protocol Error Cause*\" in the variable
PROTOCOL\_ERROR\_INFORMATION to \"CSN.1 violation or encoding error\";

1\> perform procedure specific error handling according to clause 7.

8.3 Unknown or unforeseen message type
--------------------------------------

If a MS receives an RRC message on a SRB 2, SRB 3 or SRB 4 with a
message type not defined for that SRB it shall:

1\> set the variable PROTOCOL\_ERROR\_REJECT to TRUE;

1\> transmit an RRC STATUS message on SRB 2. The IE \"*Protocol Error
Information*\" shall contain an IE \"*Protocol Error Cause*\" set to
\"Message type non-existent or not implemented\";

1\> when the RRC STATUS message has been submitted to lower layers for
transmission:

2\> continue with any ongoing processes and procedures as if the invalid
message had not been received.

If the MS receives an RRC message on SRB 1 with a message type not
defined for the logical channel type the message was received on, it
shall ignore the message.

If the MS receives an RRC message on SRB2 with message type not defined for that SRB and if the RRC message is coded in ASN1 then MS shall follow the rules defined in 3GPP TS 25.331 for the DL messages sent on the DCCH.8.4 Unsolicited received message
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

If the MS receives any of the following messages, on SRB 2:

\- an RRC CONNECTION SETUP message addressed to the MS; or

\- an RRC CONNECTION REJECT message addressed to the MS; or

\- a MS CAPABILITY INFORMATION CONFIRM message; or

\- a CELL UPDATE CONFIRM message addressed to the MS; or

\- a GRA UPDATE CONFIRM message addressed to the MS

and no procedure is ongoing according to clause 7 which expects the
message to be received:

the MS shall:

1\> ignore the received message.

8.5 Unexpected critical message extension
-----------------------------------------

If the MS receives an RRC message on SRB 2, SRB 3 or SRB 4, or sent via
a radio access technology other than GERAN, containing an undefined
critical message extension indicated with the error label: \'Critical
extension\', the MS shall:

1\> set the variable PROTOCOL\_ERROR\_REJECT to TRUE;

1\> set the IE \"*Protocol Error Cause*\" in the variable
PROTOCOL\_ERROR\_INFORMATION to \"Message extension not comprehended\";

1\> if the IE \"*Message Type*\" of the received message is not present
in the table \"Rejected transactions\" in the variable TRANSACTIONS:

2\> store the IE \"*Message Type*\" of the received message in the table
\"Rejected transactions\" in the variable TRANSACTIONS; and

2\> set the IE \"*RRC Transaction Identifier*\" to zero in that table
entry.

1\> perform procedure specific error handling according to clause 7.

If the MS receives an RRC message on the SRB 1, containing an undefined
critical message extension, the MS shall:

1\> ignore the message.

8.6 Message with error label: \'Content part error\'
----------------------------------------------------

If the MS receives an RRC message containing the error label: \'Content
part error\', the MS shall:

1\> set the variable PROTOCOL\_ERROR\_REJECT to TRUE;

1\> set the IE \"*Protocol Error Cause*\" in the variable
PROTOCOL\_ERROR\_INFORMATION to \"Message content part error\";

1\> if the IE \"*Message Type*\" of the received message is not present
in the table \"Rejected transactions\" in the variable TRANSACTIONS:

2\> store the IE \"*Message Type*\" of the received message in the table
\"Rejected transactions\" in the variable TRANSACTIONS; and

2\> set the IE \"*RRC Transaction Identifier*\" to zero in that table
entry;

1\> ignore the data corresponding to the description following the error
label;

1\> perform procedure specific error handling according to clause 7.

8.7 Unknown or unforeseen information element value, mandatory information element
----------------------------------------------------------------------------------

If the MS receives an RRC message on SRB 2, SRB 3 or SRB 4, or sent via
a radio access technology other than GERAN, with a mandatory IE having a
value, including choice, reserved for future extension (spare) or a
value not used in this version of the specification (e.g. a dummy
value), the MS shall:

1\> if a default value of the IE is defined in the procedure:

2\> treat the rest of the message using the default value of the IE.

1\> if no default value of the IE is defined in the procedure:

2\> set the variable PROTOCOL\_ERROR\_REJECT to TRUE;

2\> set the IE \"*Protocol Error Cause*\" in the variable
PROTOCOL\_ERROR\_INFORMATION to \"Information element value not
comprehended\";

2\> perform procedure specific error handling according to clause 7.

If the MS receives a system information message on SRB 1 with a
mandatory IE having a value reserved for future extension (spare) or a
value not used in this version of the specification (e.g. a dummy
value), the MS shall:

1\> if a default value of the IE is defined in the procedure:

2\> treat the rest of the system information message using the default
value of the IE.

1\> if no default value of the IE is defined in the procedure:

2\> ignore the system information message.

If the MS receives an RRC message on SRB 1 with a mandatory IE having a
value reserved for future extension (spare) or a value not used in this
version of the specification (e.g. a dummy value), the MS shall:

1\> if a default value of the IE is defined in the procedure:

2\> treat the rest of the message using the default value of the IE.

1\> if no default value of the IE is defined in the procedure:

2\> ignore the message.

If the MS receives an RRC message on SRB 2 or sent via a radio access
technology other than GERAN, with a mandatory IE having a value,
including choice, reserved for future extension (spare) or a value not
used in this version of the specification (e.g. a dummy value) and if
the RRC message is coded in ASN1 then MS shall follow the rules defined
in 3GPP TS 25.331 for the DL messages sent on the DCCH.

8.8 Unexpected non-critical message extension
---------------------------------------------

If the MS receives an RRC message on the SRB 2, SRB 3 or SRB 4, or sent
via a radio access technology other than GERAN, containing an undefined
non-critical message extension, the MS shall:

1\> ignore the content of the extension and the message contents after
the extension, but treat the parts of the message up to the extension
normally.

If the MS receives an RRC message on the SRB 1, containing an undefined
non-critical message extension, the MS shall:

1\> ignore the content of the extension and the message contents after
the extension, but treat the parts of the message up to the extension
normally.

If the MS receives an RRC message on the SRB 2,or sent via a radio
access technology other than GERAN, containing an undefined non-critical
message extension and if the RRC message is coded in the ASN1 then MS
shall follow the rules defined in 3GPP TS 25.331 for the DL messages
sent on the DCCH.

8.9 Message with error label: \'Message escape\'
------------------------------------------------

If the MS receives an RRC message containing the error label: \'Message
escape\' where the number of bits of the extension is not defined in
clause 9, the MS shall:

1\> ignore the message.

If the MS receives an RRC message containing the error label: \'Message
escape\' where the number of bits of the extension is defined in clause
9, the MS shall:

1\> ignore the extension by skiping the number of bits indicated in
clause 9;

1\> treat the rest of the message as if the extension was not present.

8.10 Handling of errors in nested information elements
------------------------------------------------------

This sub-clause specifies the handling of errors in mandatory IEs as
well as for conditional IEs for which the specified conditions for
presence are met, that are nested in another IE.

In case the MS receives an IE (Information Element 1) that includes a
mandatory IE (Information Field 1-1) having a value, including reserved
for future extension (spare) or a value not used in this version of the
specification (e.g. a dummy value), the MS shall:

1\> consider Information Element 1 to have an undefined value; and

1\> apply the corresponding generic error handling to Information
Element 1.

In case there are many IE nesting levels, in all of which the IE is
mandatory while no default value is defined, this treatment may need to
be repeated several times. The following example illustrates the general
principle.

Table 8.11.1: EXAMPLE MESSAGE information elements

+----------------------------------------------------------------------+
| \< EXAMPLE MESSAGE message content \> ::=                            |
|                                                                      |
| {                                                                    |
|                                                                      |
| { 0 \| 1 \< **Information Element** **1** : \< Information Element 1 |
| IE \> \> }                                                           |
|                                                                      |
| \< **Information Element** **2** : \< Information Element 2 IE \> \> |
|                                                                      |
| ! \< content part error : bit (\*) = \< no string \> \> };           |
+----------------------------------------------------------------------+

Table 8.11.2: Information Element 1 information element

+--------------------------------------------------------------------------+
| \< Information Element 1 IE \> ::=                                       |
|                                                                          |
| {                                                                        |
|                                                                          |
| { 0 \| 1 \< **Information Field** **1-1** : bit (4) \> }                 |
|                                                                          |
| \< **Information Element** **1-2** : \< Information Element 1-2 IE \> \> |
|                                                                          |
| \< **Information Element** **1-3** : \< Information Element 1-3 IE \> \> |
|                                                                          |
| };                                                                       |
+--------------------------------------------------------------------------+

Table 8.11.3: Information Element 1 information element details

+---------------------------------------------+
| **Information Field** **1-1** (4 bit field) |
|                                             |
| 4 3 2 1\                                    |
| 0 0 0 0 1\                                  |
| 0 0 0 1 2\                                  |
| : : : :\                                    |
| 1 1 0 0 13\                                 |
| 1 1 0 1 reserved for future extension\      |
| 1 1 1 0 reserved for future extension\      |
| 1 1 1 1 reserved for future extension       |
+---------------------------------------------+
| **Information Element** **1-2**\            |
| Definition of Information Element 1-2.      |
+---------------------------------------------+
| **Information Element** **1-3**\            |
| Definition of Information Element 1-3.      |
+---------------------------------------------+

If in the above example, GERAN would include Information Element 1 and
set Information Field 1-1 to value 13, the MS experiences an error in a
mandatory IE. The guideline outlined in the previous then means that the
MS shall not discard the entire message but instead consider \"
Information Element 1\" to have an unknown value. Since Information
Element 1 is optional, the generic error handling would be to ignore \"
Information Element 1\".

In case the MS receives an IE (Information Element 1) that includes a
list of another IE (Information Field1-1) for which one or more entries
in the list have a value, including reserved for future extension
(spare) or a value not used in this version of the specification (e.g. a
dummy value), the MS shall:

1\> consider the list as if these entries were not included.

The rules of handling the errors for nested IE coded in ASN1 are defined
in 3GPP TS 25.331

8.11 Unknown or unforeseen information element value, optional information element coded in ASN1
------------------------------------------------------------------------------------------------

If the MS receives an RRC message coded in ASN1 on the SRB2, or sent via
a radio access technology other than GERAN, with an optional IE having a
value, including choice, reserved for future extension (spare) or a
value not used in this version of the specification (e.g. a dummy
value), it shall:

1\> ignore the value of the IE;

1\> treat the rest of the message as if the IE was not present.

9 Message functional definitions and contents
=============================================

9.1 General
-----------

### 9.1.1 Introduction

Padding is not needed for RRC messages since RRC is not a transmission
protocol.

For harmonization sake, it is assumed that GERAN RRC has to provide the
same extension capability as UTRAN RRC. The management of extension for
future releases is done at the message level or at Information Element
(IE) level when the IE uses the { \< Length of content \> \< Content \>
} format. The error handling is not defined at the IE level.

An IE can be structured or simple. A structured IE consists of other IEs
and/or fields. A simple IE consists of one field. A field defines
itself.

It was also agreed as working assumption that IEs in 3GPP TS 44.018 to
be used in both modes (e.g. physical channel parameters) will not be
copied from 3GPP TS 44.018 into 3GPP TS 44.018. Instead, in
3GPP TS 44.118, two fields will be defined: the length in octets, as
bit(8), and a content placeholder with such length and whose definition
points to the value part of the IE in 3GPP TS 44.018 should be included
in the 3GPP TS 44.118. When the IE in 3GPP TS 44.018 is coded in CSN.1
(e.g. RR PACKET UPLINK ASSIGNMENT) and it already includes the length, a
content placeholder with such length and whose definition points to the
value part of the IE in 3GPP TS 44.018 should be included in
3GPP TS 44.118.

Bit fields within RRC messages shall have the highest numbered bit of
the bit field in the highest numbered bit of the lowest number octet.
The mapping of an 11 bit field is illustrated in figure 9.1.1.1.

  ------- ------- ------- ------- -------- -------- ------- ------- -----------
  bit                                                               
  8       7       6       5       4        3        2       1       
                                                                    Octet N
                                  bit 11   bit 10   bit 9   bit 8   Octet N+1
  bit 7   bit 6   bit 5   bit 4   bit 3    bit 2    bit 1           Octet N+2
                                                                    Octet N+3
  ------- ------- ------- ------- -------- -------- ------- ------- -----------

Figure 9.1.1.1: Field mapping within RRC messages

The encoding rules of the RRC messages (CELL UPDATE, GRA UPDATE and GRA
UPDATE CONFIRM) coded in ASN1 are following the ones defined in 3GPP TS
25.331.

### 9.1.2 Repetitions of Structure, IE or field:

The following coding shall be used for unbounded repetition:

> { { 1 \< **label** : \< IE \> \> } \*\* 0 } or,\
> { { 1 \< **field** : bit (integer) \> } \*\* 0 } or,\
> { { 1 \< repeated **struct** \> } \*\* 0 }

The following coding shall be used for bounded extension for optional
structures, IE\'s or fields:

> { 0 \| 1 \< **number of repetition** : bit (integer) \>\
> \< **label** : \< IE \> \>\* (n+val(number of repetition)) }
>
> or
>
> { 0 \| 1 \< **number of repetition** : bit (integer) \>\
> \< **field**: bit (integer) \>\* (n+val(number of repetition)) }
>
> or
>
> { 0 \| 1 \< **number of repetition** : bit (integer) \>\
> \< repeated **struct** \>\* (n+val(number of repetition)) }

where n ≥ 1.

The following coding shall be used for bounded extension for mandatory
structures, IE\'s or fields:

> { \< **number of repetition** : bit (integer) \>\
> \< **label** : \< IE \> \>\* (n+val(number of repetition)) }
>
> or
>
> { \< **number of repetition** : bit (integer) \>\
> \< **field** : bit (integer) \>\* (n+val(number of repetition)) }
>
> or
>
> { \< **number of repetition** : bit (integer) \>\
> \< repeated **struct** \>\* (n+val(number of repetition)) }

where n ≥ 1.

### 9.1.3 Message format and error labels

#### 9.1.3.1 General

The general format of messages, including these error labels, is:

+-----------------------------------------------------------+
| \< General message format \> ::=                          |
|                                                           |
| \< **MESSAGE\_TYPE** : \< bit (8) \> \>                   |
|                                                           |
| { \< contents \>                                          |
|                                                           |
| ! \< Content part error : bit (\*) = \< no string \> \> } |
|                                                           |
| ! \< Unknown message type : bit (8) = \< no string \> ;   |
+-----------------------------------------------------------+

Message type shall be coded using 8 bits with separate message type for
uplink and downlink, as follow:

+----------------------------------------------------------------------+
| \< Uplink RRC messages \> ::=                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000000 \> \< MESSAGE NAME1 message content  |
| \> \|                                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000001 \> \< MESSAGE NAME2 message content  |
| \> ;                                                                 |
+----------------------------------------------------------------------+

The message content should be presented has follow:

9.2.x MESSAGE NAME

Explanation of the message use.

Radio Bearer: SRBx

Direction: GERAN→MS and/or MS →GERAN

Table 9.2.x.1: MESSAGE NAME information elements

+-------------------------------------------------------------+
| \< MESSAGE NAME message content \> ::=                      |
|                                                             |
| {                                                           |
|                                                             |
| \< **IE1** : \< IE1 \> \>                                   |
|                                                             |
| \< **IE2** : \< IE2 \> \>                                   |
|                                                             |
| ! \< Content part error : bit (\*) = \< no string \> \> } ; |
+-------------------------------------------------------------+

Table 9.2.x.2: MESSAGE NAME information element details

  -------------------------
  **IE1\
  **Definition of the IE1

  **IE2\
  **Definition of the IE2
  -------------------------

The encoding rules of the RRC messages (CELL UPDATE, GRA UPDATE and GRA
UPDATE CONFIRM) and the IEs coded in ASN1 are following the ones defined
in 3GPP TS 25.331.

#### 9.1.3.2 Message extension for new protocol version in RRC

Non-Critical message extension and critical message extension mechanism
from UTRAN RRC (3GPP TS 25.331) are duplicated in GERAN RRC.

The extension mechanism for the RRC messages (CELL UPDATE, GRA UPDATE
and GRA UPDATE CONFIRM) and the IEs coded in ASN1 is following the one
defined in 3GPP TS 25.331.

##### 9.1.3.2.1 Non-Critical extension

Non-critical extensions will be achieved by adding in the optional
references at the end of the message definition. The new elements
introduced to specify the extensions should be grouped together in a
structure with a name showing the version of the release.

Table 9.1.3.2.1.1: Coding non-critical extension in CSN.1

+----------------------------------------------------------------------+
| { null \| 0 bit \*\* = \< no string \> *\-- Receiver compatible with |
| earlier release*                                                     |
|                                                                      |
| \| 1 *\-- Additions in Release xx*                                   |
|                                                                      |
| \< **MessageLabel extension for R-XX**: \< Extension for R-XX struct |
| \> \> }                                                              |
+----------------------------------------------------------------------+

Table 9.1.3.2.1.2: Example message coding using non-critical extension
in CSN.1

+------------------------------------------------------------+
| \< MESSAGE NAME message content \> ::=                     |
|                                                            |
| {                                                          |
|                                                            |
| \< **IE1** : \< IE1 \> \>                                  |
|                                                            |
| \< **IE2** : \< IE2 \> \>                                  |
|                                                            |
| { null \| 0 bit \*\* = \< no string \>                     |
|                                                            |
| \| 1                                                       |
|                                                            |
| \< **R6** **IE1** : \< R6 IE1 \> \>                        |
|                                                            |
| \< **R6 IE2** : \< R6 IE2 \> \>                            |
|                                                            |
| { null \| 0 bit \*\* = \< no string \>                     |
|                                                            |
| \| 1                                                       |
|                                                            |
| \< **R7** **IE1** : \< R7 IE1 \> \>                        |
|                                                            |
| \< **R7 IE2** : \< R7 IE2 \> \>} }                         |
|                                                            |
| ! \< Content part error : bit (\*) = \< no string \> \>} ; |
+------------------------------------------------------------+

##### 9.1.3.2.2 Critical extension

At the beginning of the message, which may require critical extensions,
one bit is added for defining a choice of two branches. All Downlink
messages shall enable critical extension with an escape bit at the
beginning. One branch would include the message structure, the other
branch would be an empty sequence with the comment \'Message escape
critical extensions\'.

Table 9.1.3.2.2.1: Coding of critical extension in CSN.1

+-------------------------------------------------------+
| 0 *\-- critical extension escape available*           |
|                                                       |
| \< Content \>                                         |
|                                                       |
| ! \< Message escape : 1 bit (\*) = \< no string \> \> |
+-------------------------------------------------------+

Table 9.1.3.2.2.2: An example message coding containing critical
extension bit in CSN.1

+----------------------------------------------------------------------+
| \< MESSAGE NAME message content \> ::=                               |
|                                                                      |
| { 0 *\-- critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **IE1** : \< IE1 \> \>                                            |
|                                                                      |
| \< **IE2** : \< IE2 \> \> ! \< content part error : bit (\*) = \< no |
| string \> \> }                                                       |
|                                                                      |
| ! \< Message escape critical extension: 1 bit (\*) = \< no string \> |
| \> };                                                                |
+----------------------------------------------------------------------+

When a new release is introduced, the empty sequence with \'Message
escape critical extensions\' will be replaced by a new structure that
includes a new type containing the message extensions, and the same
extension mechanism recursively for further extensions.

Table 9.1.3.2.2.3: An example message coding using critical extension
bit in CSN.1

+----------------------------------------------------------------------+
| \< MESSAGE NAME message content \> ::=                               |
|                                                                      |
| { 0 *\-- critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **IE1** : \< IE1 \> \>                                            |
|                                                                      |
| \< **IE2** : \< IE2 \> \>                                            |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| \| 1 *\-- critical extension for R-7*                                |
|                                                                      |
| { 0                                                                  |
|                                                                      |
| {                                                                    |
|                                                                      |
| \<**IE3** : \< IE3 \> \>                                             |
|                                                                      |
| \<**IE4** : \< IE4 \> \>                                             |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \>}             |
|                                                                      |
| ! \< Message escape critical extension: 1 bit (\*) = \< no string \> |
| \> }                                                                 |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

The critical extension escape should be used as scarcely as possible in
order to preserve backward compatibility.

##### 9.1.3.2.3 Extension of IE\'s

If an IE is expected to be extended, the addition of a fixed length
extension length at the start of the IE, and \<spare bits \>\*\* at the
end will allow for future extension of the information element.

Table 9.1.3.2.3.1: Coding of IE extension in CSN.1

+------------------------------------+
| \< IE NAME message content \> ::=  |
|                                    |
| \< **IE Name Length** : bit (n) \> |
|                                    |
| \< **IE1** : \< IE1 \> \>          |
|                                    |
| \< **IE2** : \< IE2 \> \>          |
|                                    |
| \< spare bit \>\*\* ;              |
+------------------------------------+

Table 9.1.3.2.3.2: Example description of IE extension fields

  ---------------------------------------------------------------------------------------------------------------------------
  **IE Name Length (n bit field)**\
  This field is the binary representation of the length in bits of the IE (excluding the length field) struct. Range 0-2...

  ---------------------------------------------------------------------------------------------------------------------------

##### 9.1.3.2.4 \'Message escape\' error label

The \'Message escape\' error label is used to provide an escape for,
e.g. a future modification of the message syntax. The generic
description is:

+------------------------------------------------------+
| 0 \< Content \>                                      |
|                                                      |
| ! \< Message escape : 1 bit (N) = \< no string \> \> |
+------------------------------------------------------+

An \'Message escape\' error label shall be applied by the receiver of a
downlink RRC message when specified in the message description. The
description on the left of the error branch needs to be correctly
recognised. Otherwise, the error branch \'Message escape\' is called. N
should be an integer to enable the receiver to skip the exact number of
information bits in the message in case of error. N may also be \'\*\'
when the number of bits are not defined.

9.2 Messages for Radio Resources management
-------------------------------------------

### 9.2.1 General

Each definition given in the sub-clause 9.2 includes:

-   a brief description of the message direction and use;

-   a CSN.1 description of the message, information elements and fields
    (see CSN.1 Specification, Version 2.0). Definition of information
    elements may immediately follow the definition of the message. If
    the definition of an information element immediately follows the
    message definition, the information element name ends with
    \'struct\'. Otherwise the information element name ends with \'IE\'
    and the definition of the information element is defined in
    sub-clause 9.3 or in 3GPP TS 44.160. The definition of a \'struct\'
    is valid only within the table in which it is defined. No references
    shall be made to a \'struct\' definition from outside of the table
    in which it is defined or from outside the present document. The
    definition of an information element is valid throughout clause 9. ;

-   a table follows which contains a definition for each field
    referenced in the message definition or in an information element
    struct immediately following the message definition. Presence
    requirement for information elements or fields may be indicated in
    this table to define when the information elements shall be included
    or not, what non-presence of such information elements or fields
    means, and, for IEs with conditional presence requirement, the
    static conditions for presence and/or non-presence of the
    information elements or fields. However, the normative text for the
    presence requirement for information elements or fields is specified
    in the appropriate procedure sub-clause;

#### 9.2.1.1 References

Table 9.2.1.1.1 summarizes the messages for Radio Resources management.

NOTE: New messages will be added in this table.

Table 9.2.1.1.1: Messages for Radio Resources management

  ------------------------------------------------------ -------------------
  Messages                                               Reference
  RRC connection mobility                                
  CELL UPDATE                                            Sub-clause 9.2.2
  CELL UPDATE CONFIRM                                    Sub-clause 9.2.3
  GERAN MOBILITY INFORMATION                             Sub-clause 9.2.8
  GERAN MOBILITY INFORMATION CONFIRM                     Sub-clause 9.2.9
  GERAN MOBILITY INFORMATION FAILURE                     Sub-clause 9.2.10
  GRA UPDATE                                             Sub-clause 9.2.11
  GRA UPDATE CONFIRM                                     Sub-clause 9.2.12
  Handover                                               
  HANDOVER COMPLETE                                      Sub-clause 9.2.14
  HANDOVER FAILURE                                       Sub-clause 9.2.15
  HANDOVER FROM GERAN Iu COMMAND                         Sub-clause 9.2.16
  INTER SYSTEM TO CDMA2000 HANDOVER COMMAND              Sub-clause 9.2.18
  INTER SYSTEM TO UTRAN HANDOVER COMMAND                 Sub-clause 9.2.19
  LCS information                                        
  LCS DOWNLINK INFORMATION                               Sub-clause 9.2.20
  LCS UPLINK INFORMATION                                 Sub-clause 9.2.21
  MS Capability information                              
  MS CAPABILITY ENQUIRY                                  Sub-clause 9.2.24
  MS CAPABILITY INFORMATION                              Sub-clause 9.2.25
  MS CAPABILITY INFORMATION CONFIRM                      Sub-clause 9.2.26
  Measurement                                            
  EXTENDED MEASUREMENT ORDER                             Sub-clause 9.2.6
  EXTENDED MEASUREMENT REPORT                            Sub-clause 9.2.7
  MEASUREMENT INFORMATION                                Sub-clause 9.2.22
  MEASUREMENT REPORT                                     Sub-clause 9.2.23
  ENHANCED MEASUREMENT REPORT                            Sub-clause 9.2.7a
  Paging                                                 
  DEDICATED PAGING REQUEST                               Sub-clause 9.2.4
  Radio bearer control                                   
  RADIO BEARER RECONFIGURATION                           Sub-clause 9.2.28
  RADIO BEARER RECONFIGURATION COMPLETE                  Sub-clause 9.2.29
  RADIO BEARER RECONFIGURATION FAILURE                   Sub-clause 9.2.30
  RADIO BEARER RELEASE                                   Sub-clause 9.2.31
  RADIO BEARER RELEASE COMPLETE                          Sub-clause 9.2.32
  RADIO BEARER RELEASE FAILURE                           Sub-clause 9.2.33
  RADIO BEARER SETUP                                     Sub-clause 9.2.34
  RADIO BEARER SETUP COMPLETE                            Sub-clause 9.2.35
  RADIO BEARER SETUP FAILURE                             Sub-clause 9.2.36
  GERAN Iu mode DTM REQUEST                              Sub-clause 9.2.57
  GERAN Iu mode DTM REJECT                               Sub-clause 9.2.58
  RRC Connection Management                              
  RRC CONNECTION REJECT                                  Sub-clause 9.2.37
  RRC CONNECTION RELEASE                                 Sub-clause 9.2.38
  RRC CONNECTION RELEASE COMPLETE                        Sub-clause 9.2.39
  RRC CONNECTION REQUEST                                 Sub-clause 9.2.40
  RRC CONNECTION SETUP                                   Sub-clause 9.2.41
  RRC CONNECTION SETUP COMPLETE                          Sub-clause 9.2.42
  Security mode control                                  
  SECURITY MODE COMMAND                                  Sub-clause 9.2.45
  SECURITY MODE COMPLETE                                 Sub-clause 9.2.46
  SECURITY MODE FAILURE                                  Sub-clause 9.2.47
  Signalling flow                                        
  SIGNALLING CONNECTION RELEASE                          Sub-clause 9.2.48
  SIGNALLING CONNECTION RELEASE INDICATION               Sub-clause 9.2.49
  System information                                     
  SYSTEM INFORMATION 13                                  3GPP TS 44.108
  SYSTEM INFORMATION 3                                   3GPP TS 44.108
  SYSTEM INFORMATION 5                                   Sub-clause 9.2.51
  SYSTEM INFORMATION 5bis                                Sub-clause 9.2.52
  SYSTEM INFORMATION 5ter                                Sub-clause 9.2.53
  SYSTEM INFORMATION 6                                   Sub-clause 9.2.54
  Delivery of NAS                                        
  DOWNLINK DIRECT TRANSFER                               Sub-clause 9.2.5
  INITIAL DIRECT TRANSFER                                Sub-clause 9.2.17
  UPLINK DIRECT TRANSFER                                 Sub-clause 9.2.56
  Miscellaneous                                          
  RRC STATUS                                             Sub-clause 9.2.43
  RRC FAILURE INFO                                       Sub-clause 9.2.44
  INTER RAT or MODE HANDOVER INFO WITH MS CAPABILITIES   Sub-clause 11.1.5
  SBSS RELOCATION INFO                                   Sub-clause 11.1.5
  ------------------------------------------------------ -------------------

#### 9.2.1.2 Downlink RRC messages

The different types of messages are distinguished by the MESSAGE\_TYPE
field.

+----------------------------------------------------------------------+
| \< Downlink RRC messages \> ::=                                      |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000000 \> \< CELL UPDATE CONFIRM message    |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000001 \> \< DEDICATED PAGING REQUEST       |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000010 \> \< DOWNLINK DIRECT TRANSFER       |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000011 \> \< EXTENDED MEASUREMENT ORDER     |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000100 \> \< GERAN MOBILITY INFORMATION     |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000111 \> \< HANDOVER FROM GERAN Iu COMMAND |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001000 \> \< INTERSYSTEM HANDOVER TO        |
| CDMA2000 message content \> \|                                       |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001001 \> \< INTERSYSTEM HANDOVER TO UTRAN  |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001010 \> \< LCS DOWNLINK INFORMATION       |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001011 \> \< MEASUREMENT INFORMATION        |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001100 \> \< MS CAPABILITY ENQUIRY message  |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001101 \> \< MS CAPABILITY INFORMATION      |
| CONFIRM message content \> \|                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001110 \> \< RADIO BEARER RECONFIGURATION   |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010000 \> \< RADIO BEARER RELEASE message   |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010111 \> \< RADIO BEARER SETUP message     |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010001 \> \< RRC CONNECTION REJECT message  |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010010 \> \< RRC CONNECTION RELEASE message |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010011 \> \< RRC CONNECTION SETUP message   |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010100 \> \< RRC STATUS message content \>  |
| \|                                                                   |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010101 \> \< SECURITY MODE COMMAND message  |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010110 \> \< SIGNALLING CONNECTION RELEASE  |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010111 \> \< GERAN Iu mode DTM REJECT       |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00011000 \> \< SYSTEM INFORMATION 5 message   |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00011001 \> \< SYSTEM INFORMATION 5bis        |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00011010 \> \< SYSTEM INFORMATION 5ter        |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00011011 \> \< SYSTEM INFORMATION 6 message   |
| content \>                                                           |
|                                                                      |
| \< spare bit \>\*\* }                                                |
|                                                                      |
| ! \< Unknown message type : { bit (8) = \< no string \> } \< Default |
| downlink message content \> \> ;                                     |
+----------------------------------------------------------------------+

#### 9.2.1.3 Uplink RRC messages

The different types of messages are distinguished by the MESSAGE\_TYPE
field.

+----------------------------------------------------------------------+
| \< Uplink RRC messages \> ::=                                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000001 \> \< EXTENDED MEASUREMENT REPORT    |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000010 \> \< GERAN MOBILITY INFORMATION     |
| CONFIRM message content \> \|                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000011 \> \< GERAN MOBILITY INFORMATION     |
| FAILURE message content \> \|                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000110 \> \< HANDOVER COMPLETE message      |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00000111 \> \< HANDOVER FAILURE message       |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001000 \> \< INITIAL DIRECT TRANSFER        |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001001 \> \< LCS UPLINK INFORMATION message |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001010 \> \< MEASUREMENT REPORT message     |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001011 \> \< MS CAPABILITY INFORMATION      |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001100 \> \< RADIO BEARER RECONFIGURATION   |
| COMPLETE message content \> \|                                       |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001101 \> \< RADIO BEARER RECONFIGURATION   |
| FAILURE message content \> \|                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001110 \> \< RADIO BEARER RELEASE COMPLETE  |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00001111 \> \< RADIO BEARER RELEASE FAILURE   |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010000 \> \< RADIO BEARER SETUP COMPLETE    |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010001 \> \< RADIO BEARER SETUP FAILURE     |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010010 \> \< RRC CONNECTION RELEASE         |
| COMPLETE message content \> \|                                       |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010011 \> \< RRC CONNECTION REQUEST message |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010100 \> \< RRC CONNECTION SETUP COMPLETE  |
| message content \> \|                                                |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010101 \> \< RRC STATUS message content \>  |
| \|                                                                   |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010110 \> \< SECURITY MODE COMPLETE message |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00010111 \> \< SECURITY MODE FAILURE message  |
| content \> \|                                                        |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00011000 \> \< SIGNALLING CONNECTION RELEASE  |
| INDICATION message content \> \|                                     |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00011001 \> \< UPLINK DIRECT TRANSFER message |
| content \>                                                           |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00011010 \> \< ENHANCED MEASUREMENT REPORT    |
| message content \>                                                   |
|                                                                      |
| \< **MESSAGE\_TYPE** : 00011011 \> \< GERAN Iu mode DTM REQUEST      |
| message content \>                                                   |
|                                                                      |
| \< spare bits \> \*\* } ;                                            |
+----------------------------------------------------------------------+

The \'Default downlink message contents\' consists an unspecified bit
string that expands to the end of the message.

+--------------------------------------------+
| \< Default downlink message content \> ::= |
|                                            |
| bit (\*) = \< no string \> ;               |
+--------------------------------------------+

##### 9.2.1.3.1 Message definitions

If the abstract syntax of an IE is defined using the ASN.1 type \"BIT
STRING then the encoding rules are defined in 3GPP TS 25.331.

Class-definitions DEFINITIONS AUTOMATIC TAGS ::=

BEGIN

IMPORTS

CellUpdate,

GRAUpdate,

GRAUpdateConfirm,

Reserved ::= NULL

FROM PDU-definitions

\-- Mobile Station IEs

IntegrityCheckInfo

FROM InformationElements;

\--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

\--

\-- Uplink SRB2 messages

\--

\--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

UL-Message ::= SEQUENCE {

integrityCheckInfo IntegrityCheckInfo OPTIONAL,

message UL-MessageType

}

UL-MessageType ::= CHOICE {

cellUpdate CellUpdate \-- 00000000,

reserved1 Reserved,

reserved2 Reserved,

reserved3 Reserved,

graUpdate GRAUpdate \-- 00000100,

reserved5 Reserved,

reserved6 Reserved,

reserved7 Reserved,

reserved8 Reserved,

reserved9 Reserved,

reserved10 Reserved,

reserved11 Reserved,

reserved12 Reserved,

reserved13 Reserved,

reserved14 Reserved,

reserved15 Reserved,

reserved16 Reserved,

reserved17 Reserved,

reserved18 Reserved,

reserved19 Reserved,

reserved20 Reserved,

reserved21 Reserved,

reserved22 Reserved,

reserved23 Reserved,

reserved24 Reserved,

reserved25 Reserved,

reserved26 Reserved,

reserved27 Reserved,

reserved28 Reserved,

reserved29 Reserved,

reserved30 Reserved,

reserved31 Reserved,

reserved32 Reserved,

reserved33 Reserved,

reserved34 Reserved,

reserved35 Reserved,

reserved36 Reserved,

reserved37 Reserved,

reserved38 Reserved,

reserved39 Reserved,

reserved40 Reserved,

reserved41 Reserved,

reserved42 Reserved,

reserved43 Reserved,

reserved44 Reserved,

reserved45 Reserved,

reserved46 Reserved,

reserved47 Reserved,

reserved48 Reserved,

reserved49 Reserved,

reserved50 Reserved,

reserved51 Reserved,

reserved52 Reserved,

reserved53 Reserved,

reserved54 Reserved,

reserved55 Reserved,

reserved56 Reserved,

reserved57 Reserved,

reserved58 Reserved,

reserved59 Reserved,

reserved60 Reserved,

reserved61 Reserved,

reserved62 Reserved,

reserved63 Reserved,

reserved64 Reserved,

reserved65 Reserved,

reserved66 Reserved,

reserved67 Reserved,

reserved68 Reserved,

reserved69 Reserved,

reserved70 Reserved,

reserved71 Reserved,

reserved72 Reserved,

reserved73 Reserved,

reserved74 Reserved,

reserved75 Reserved,

reserved76 Reserved,

reserved77 Reserved,

reserved78 Reserved,

reserved79 Reserved,

reserved80 Reserved,

reserved81 Reserved,

reserved82 Reserved,

reserved83 Reserved,

reserved84 Reserved,

reserved84 Reserved,

reserved85 Reserved,

reserved86 Reserved,

reserved87 Reserved,

reserved88 Reserved,

reserved89 Reserved,

reserved90 Reserved,

reserved91 Reserved,

reserved92 Reserved,

reserved93 Reserved,

reserved94 Reserved,

reserved95 Reserved,

reserved96 Reserved,

reserved97 Reserved,

reserved98 Reserved,

reserved99 Reserved,

reserved100 Reserved,

reserved101 Reserved,

reserved102 Reserved,

reserved103 Reserved,

reserved104 Reserved,

reserved105 Reserved,

reserved106 Reserved,

reserved107 Reserved,

reserved108 Reserved,

reserved109 Reserved,

reserved110 Reserved,

reserved111 Reserved,

reserved112 Reserved,

reserved113 Reserved,

reserved114 Reserved,

reserved115 Reserved,

reserved116 Reserved,

reserved117 Reserved,

reserved118 Reserved,

reserved119 Reserved,

reserved120 Reserved,

reserved121 Reserved,

reserved122 Reserved,

reserved123 Reserved,

reserved124 Reserved,

reserved125 Reserved,

reserved126 Reserved,

reserved127 Reserved,

reserved128 Reserved,

reserved129 Reserved,

reserved130 Reserved,

reserved131 Reserved,

reserved132 Reserved,

reserved133 Reserved,

reserved134 Reserved,

reserved135 Reserved,

reserved136 Reserved,

reserved137 Reserved,

reserved138 Reserved,

reserved139 Reserved,

reserved140 Reserved,

reserved141 Reserved,

reserved142 Reserved,

reserved143 Reserved,

reserved144 Reserved,

reserved145 Reserved,

reserved146 Reserved,

reserved147 Reserved,

reserved148 Reserved,

reserved149 Reserved,

reserved150 Reserved,

reserved151 Reserved,

reserved152 Reserved,

reserved153 Reserved,

reserved154 Reserved,

reserved155 Reserved,

reserved156 Reserved,

reserved157 Reserved,

reserved158 Reserved,

reserved159 Reserved,

reserved160 Reserved,

reserved161 Reserved,

reserved162 Reserved,

reserved163 Reserved,

reserved164 Reserved,

reserved165 Reserved,

reserved166 Reserved,

reserved167 Reserved,

reserved168 Reserved,

reserved169 Reserved,

reserved170 Reserved,

reserved171 Reserved,

reserved172 Reserved,

reserved173 Reserved,

reserved174 Reserved,

reserved175 Reserved,

reserved176 Reserved,

reserved177 Reserved,

reserved178 Reserved,

reserved179 Reserved,

reserved180 Reserved,

reserved181 Reserved,

reserved182 Reserved,

reserved183 Reserved,

reserved184 Reserved,

reserved185 Reserved,

reserved186 Reserved,

reserved187 Reserved,

reserved188 Reserved,

reserved189 Reserved,

reserved190 Reserved,

reserved191 Reserved,

reserved192 Reserved,

reserved193 Reserved,

reserved194 Reserved,

reserved195 Reserved,

reserved196 Reserved,

reserved197 Reserved,

reserved198 Reserved,

reserved199 Reserved,

reserved200 Reserved,

reserved201 Reserved,

reserved202 Reserved,

reserved203 Reserved,

reserved204 Reserved,

reserved205 Reserved,

reserved206 Reserved,

reserved207 Reserved,

reserved208 Reserved,

reserved209 Reserved,

reserved210 Reserved,

reserved211 Reserved,

reserved212 Reserved,

reserved213 Reserved,

reserved214 Reserved,

reserved215 Reserved,

reserved216 Reserved,

reserved217 Reserved,

reserved218 Reserved,

reserved219 Reserved,

reserved220 Reserved,

reserved221 Reserved,

reserved222 Reserved,

reserved223 Reserved,

reserved224 Reserved,

reserved225 Reserved,

reserved226 Reserved,

reserved227 Reserved,

reserved228 Reserved,

reserved229 Reserved,

reserved230 Reserved,

reserved231 Reserved,

reserved232 Reserved,

reserved233 Reserved,

reserved234 Reserved,

reserved235 Reserved,

reserved236 Reserved,

reserved237 Reserved,

reserved238 Reserved,

reserved239 Reserved,

reserved240 Reserved,

reserved241 Reserved,

reserved242 Reserved,

reserved243 Reserved,

reserved244 Reserved,

reserved245 Reserved,

reserved246 Reserved,

reserved247 Reserved,

reserved248 Reserved,

reserved249 Reserved,

reserved250 Reserved,

reserved251 Reserved,

reserved252 Reserved,

reserved253 Reserved,

reserved254 Reserved,

reserved255 Reserved

}

\--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

\--

\-- Downlink SRB2 messages

\--

\--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

DL-Dedicated-Message ::= SEQUENCE {

integrityCheckInfo IntegrityCheckInfo OPTIONAL,

message DL-Dedicated-MessageType

}

DL-Dedicated-MessageType ::= CHOICE {

reserved0 Reserved,

reserved1 Reserved,

reserved2 Reserved,

reserved3 Reserved,

reserved4 Reserved,

graUpdateConfirm GRAUpdateConfirm \-- 00000101,

reserved6 Reserved,

reserved7 Reserved,

reserved8 Reserved,

reserved9 Reserved,

reserved10 Reserved,

reserved11 Reserved,

reserved12 Reserved,

reserved13 Reserved,

reserved14 Reserved,

reserved15 Reserved,

reserved16 Reserved,

reserved17 Reserved,

reserved18 Reserved,

reserved19 Reserved,

reserved20 Reserved,

reserved21 Reserved,

reserved22 Reserved,

reserved23 Reserved,

reserved24 Reserved,

reserved25 Reserved,

reserved26 Reserved,

reserved27 Reserved,

reserved28 Reserved,

reserved29 Reserved,

reserved30 Reserved,

reserved31 Reserved,

reserved32 Reserved,

reserved33 Reserved,

reserved34 Reserved,

reserved35 Reserved,

reserved36 Reserved,

reserved37 Reserved,

reserved38 Reserved,

reserved39 Reserved,

reserved40 Reserved,

reserved41 Reserved,

reserved42 Reserved,

reserved43 Reserved,

reserved44 Reserved,

reserved45 Reserved,

reserved46 Reserved,

reserved47 Reserved,

reserved48 Reserved,

reserved49 Reserved,

reserved50 Reserved,

reserved51 Reserved,

reserved52 Reserved,

reserved53 Reserved,

reserved54 Reserved,

reserved55 Reserved,

reserved56 Reserved,

reserved57 Reserved,

reserved58 Reserved,

reserved59 Reserved,

reserved60 Reserved,

reserved61 Reserved,

reserved62 Reserved,

reserved63 Reserved,

reserved64 Reserved,

reserved65 Reserved,

reserved66 Reserved,

reserved67 Reserved,

reserved68 Reserved,

reserved69 Reserved,

reserved70 Reserved,

reserved71 Reserved,

reserved72 Reserved,

reserved73 Reserved,

reserved74 Reserved,

reserved75 Reserved,

reserved76 Reserved,

reserved77 Reserved,

reserved78 Reserved,

reserved79 Reserved,

reserved80 Reserved,

reserved81 Reserved,

reserved82 Reserved,

reserved83 Reserved,

reserved84 Reserved,

reserved84 Reserved,

reserved85 Reserved,

reserved86 Reserved,

reserved87 Reserved,

reserved88 Reserved,

reserved89 Reserved,

reserved90 Reserved,

reserved91 Reserved,

reserved92 Reserved,

reserved93 Reserved,

reserved94 Reserved,

reserved95 Reserved,

reserved96 Reserved,

reserved97 Reserved,

reserved98 Reserved,

reserved99 Reserved,

reserved100 Reserved,

reserved101 Reserved,

reserved102 Reserved,

reserved103 Reserved,

reserved104 Reserved,

reserved105 Reserved,

reserved106 Reserved,

reserved107 Reserved,

reserved108 Reserved,

reserved109 Reserved,

reserved110 Reserved,

reserved111 Reserved,

reserved112 Reserved,

reserved113 Reserved,

reserved114 Reserved,

reserved115 Reserved,

reserved116 Reserved,

reserved117 Reserved,

reserved118 Reserved,

reserved119 Reserved,

reserved120 Reserved,

reserved121 Reserved,

reserved122 Reserved,

reserved123 Reserved,

reserved124 Reserved,

reserved125 Reserved,

reserved126 Reserved,

reserved127 Reserved,

reserved128 Reserved,

reserved129 Reserved,

reserved130 Reserved,

reserved131 Reserved,

reserved132 Reserved,

reserved133 Reserved,

reserved134 Reserved,

reserved135 Reserved,

reserved136 Reserved,

reserved137 Reserved,

reserved138 Reserved,

reserved139 Reserved,

reserved140 Reserved,

reserved141 Reserved,

reserved142 Reserved,

reserved143 Reserved,

reserved144 Reserved,

reserved145 Reserved,

reserved146 Reserved,

reserved147 Reserved,

reserved148 Reserved,

reserved149 Reserved,

reserved150 Reserved,

reserved151 Reserved,

reserved152 Reserved,

reserved153 Reserved,

reserved154 Reserved,

reserved155 Reserved,

reserved156 Reserved,

reserved157 Reserved,

reserved158 Reserved,

reserved159 Reserved,

reserved160 Reserved,

reserved161 Reserved,

reserved162 Reserved,

reserved163 Reserved,

reserved164 Reserved,

reserved165 Reserved,

reserved166 Reserved,

reserved167 Reserved,

reserved168 Reserved,

reserved169 Reserved,

reserved170 Reserved,

reserved171 Reserved,

reserved172 Reserved,

reserved173 Reserved,

reserved174 Reserved,

reserved175 Reserved,

reserved176 Reserved,

reserved177 Reserved,

reserved178 Reserved,

reserved179 Reserved,

reserved180 Reserved,

reserved181 Reserved,

reserved182 Reserved,

reserved183 Reserved,

reserved184 Reserved,

reserved185 Reserved,

reserved186 Reserved,

reserved187 Reserved,

reserved188 Reserved,

reserved189 Reserved,

reserved190 Reserved,

reserved191 Reserved,

reserved192 Reserved,

reserved193 Reserved,

reserved194 Reserved,

reserved195 Reserved,

reserved196 Reserved,

reserved197 Reserved,

reserved198 Reserved,

reserved199 Reserved,

reserved200 Reserved,

reserved201 Reserved,

reserved202 Reserved,

reserved203 Reserved,

reserved204 Reserved,

reserved205 Reserved,

reserved206 Reserved,

reserved207 Reserved,

reserved208 Reserved,

reserved209 Reserved,

reserved210 Reserved,

reserved211 Reserved,

reserved212 Reserved,

reserved213 Reserved,

reserved214 Reserved,

reserved215 Reserved,

reserved216 Reserved,

reserved217 Reserved,

reserved218 Reserved,

reserved219 Reserved,

reserved220 Reserved,

reserved221 Reserved,

reserved222 Reserved,

reserved223 Reserved,

reserved224 Reserved,

reserved225 Reserved,

reserved226 Reserved,

reserved227 Reserved,

reserved228 Reserved,

reserved229 Reserved,

reserved230 Reserved,

reserved231 Reserved,

reserved232 Reserved,

reserved233 Reserved,

reserved234 Reserved,

reserved235 Reserved,

reserved236 Reserved,

reserved237 Reserved,

reserved238 Reserved,

reserved239 Reserved,

reserved240 Reserved,

reserved241 Reserved,

reserved242 Reserved,

reserved243 Reserved,

reserved244 Reserved,

reserved245 Reserved,

reserved246 Reserved,

reserved247 Reserved,

reserved248 Reserved,

reserved249 Reserved,

reserved250 Reserved,

reserved251 Reserved,

reserved252 Reserved,

reserved253 Reserved,

reserved254 Reserved,

reserved255 Reserved

}END

###### 9.2.1.3.1.1 PDU definitions

\--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

\-- NOTE: The message type and integrity check info are not

\-- visible in this module as they are defined in the class module.

\--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

PDU-definitions DEFINITIONS AUTOMATIC TAGS ::=

BEGIN

\--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

\--

\-- IE parameter types from other modules

\--

\--\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

IMPORTS

ActivationTime,

CN-DomainIdentity,

CN-InformationInfo,

CellUpdateCause,

CipheringModeInfo,

FailureCauseWithProtErrTrId,

G-RNTI,

GRA-Identity,

GERAN-DRX-CycleLengthCoefficient,

GRA-UpdateCause,

DL-CounterSynchronisationInfo,

IntegrityProtectionModeInfo,

NAS-SystemInformationGSM-MAP,

ProtocolErrorIndicator,

PLMN-Identity,

PDCP-SN-Info,

RRC-StateIndicator,

RRC-TransactionIdentifier,

Rb-timer-indicator,

RB-WithPDCP-InfoList,

RB-PDCPContextRelocationList,

RB-Identity,

RB-PDCPContextRelocation,

START-Value,

STARTList

FROM InformationElements;

### 9.2.2 CELL UPDATE

This message is used by the MS to initiate a cell update procedure.

Radio Bearer : SRB2

Direction : MS→GERAN

\--
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

\--

\-- CELL UPDATE

\--

\--
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

CellUpdate ::= SEQUENCE {

\-- User equipment IEs

g-RNTI G-RNTI,

startList STARTList,

am-RLC-ErrorIndicationRb2-3or4 BOOLEAN,

am-RLC-ErrorIndicationRb5orAbove BOOLEAN,

cellUpdateCause CellUpdateCause,

\-- NOTE: RRC transaction identifier is nested in
FailureCauseWithProtErrTrId,

failureCause FailureCauseWithProtErrTrId OPTIONAL,

rb-timer-indicator Rb-timer-indicator,

laterNonCriticalExtensions SEQUENCE {

\-- Container for additional R5 extensions

cellUpdate-r5-add-ext BIT STRING OPTIONAL,

nonCriticalExtensions SEQUENCE {} OPTIONAL } OPTIONAL

}

\--
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

### 9.2.3 CELL UPDATE CONFIRM

This message confirms the cell update procedure and can be used to
reallocate new G-RNTI information for the MS valid in the new cell.

Radio Bearer : SRB2

Direction : GERAN→MS

Table 9.2.3.1: CELL UPDATE CONFIRM information elements

+----------------------------------------------------------------------+
| \< CELL UPDATE CONFIRM message content \> ::=                        |
|                                                                      |
| { 0 \-- *Critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS Information Elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Activation Time** : \< Activation Time IE \> \>                 |
|                                                                      |
| \< **RRC State Indicator** : \< RRC State Indicator IE \> \>         |
|                                                                      |
| \< **GERAN DRX Cycle Length Coefficient** : \< GERAN DRX Cycle       |
| Length Coefficient IE \> \>                                          |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Protection Mode Info** : \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| { 0 \| 1 \< **Ciphering Mode Info** : \< Ciphering Mode Info IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **New G-RNTI** : \< G-RNTI IE \> \> }                    |
|                                                                      |
| \< **RLC re-establishment indicator SRB2-4** : bit(1) \>             |
|                                                                      |
| \< **RLC re-establishment indicator RB5+** : bit(1) \>               |
|                                                                      |
| \-- *CN Information Elements*                                        |
|                                                                      |
| { 0 \| 1 \< **CN Information Info** : \< CN Information Info IE \>   |
| \> }                                                                 |
|                                                                      |
| \-- *GERAN Information Elements*                                     |
|                                                                      |
| { 0 \| 1 \< **GRA Identity** : \< GRA Identity IE \> \> }            |
|                                                                      |
| \-- *RB Information Elements*                                        |
|                                                                      |
| { 0 \| 1 \< **RB Information to Release list** : bit (5) \>          |
|                                                                      |
| { \< **RB Information to Release** : \< RB Information to Release IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **DBPSCH Description** : \< DBPSCH Description IE \> \>  |
| }                                                                    |
|                                                                      |
| 0 \| 1 \< **NETWORK\_RESPONSE\_TIMES** : \< Network Response Times   |
| struct \>\> }                                                        |
|                                                                      |
| }\*(1 + val(RB Information to Release list) ) }                      |
|                                                                      |
| { 0 \| 1 \< **RB Information to Reconfigure list** : bit (5) \>      |
|                                                                      |
| { \< **RB Information to Reconfigure** : \< RB Information to        |
| Reconfigure IE \> \>                                                 |
|                                                                      |
| { 0 \| 1 \< **DBPSCH Description** : \< DBPSCH Description IE \> \>  |
| }                                                                    |
|                                                                      |
| 0 \| 1 \< **NETWORK\_RESPONSE\_TIMES** : \< Network Response Times   |
| struct \>\> }                                                        |
|                                                                      |
| }\*(1 + val(RB Information to Reconfigure list) )                    |
|                                                                      |
| { 0 \| 1 \< **RB Information to Be Affected list** : bit (5) \>      |
|                                                                      |
| { \< **RB Information to Be Affected** : \< RB Information to Be     |
| Affected IE \> \>                                                    |
|                                                                      |
| { 0 \| 1 \< **DBPSCH Description** : \< DBPSCH Description IE \> \>  |
| }                                                                    |
|                                                                      |
| 0 \| 1 \< **NETWORK\_RESPONSE\_TIMES** : \< Network Response Times   |
| struct \>\> }                                                        |
|                                                                      |
| }\*(1 + val(RB Information to Be Affected list) ) }                  |
|                                                                      |
| { 0 \| 1 \< **Downlink Counter Synchronisation Info :** \< Downlink  |
| Counter Synchronisation info struct \> \> }                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions : 1 bit (\*) = \< no string  |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+
| \< Downlink Counter Synchronisation Info struct\> ::=                |
|                                                                      |
| \< **RB with PDCP Information List** : bit (5) \>                    |
|                                                                      |
| { { 0 \| 1 \< **RB with PDCP Information** : \< RB with PDCP         |
| Information IE \> \> }                                               |
|                                                                      |
| { 0 \| 1 \< **PDCP context relocation info** : \< PDCP context       |
| relocation info IE \> \> } } \* (1 + val(RB with PDCP Information    |
| List) );                                                             |
+----------------------------------------------------------------------+
| \< Network Response Times struct \> ::=                              |
|                                                                      |
| { 0 \-- *Network\'s response times on SDCCH*                         |
|                                                                      |
| \< **RESPONSE\_TIME\_SDCCH** : \< Response Time SDCCH struct \> \>   |
|                                                                      |
| \| 1 \-- *Network\'s reponse times on the assigned DBPSCH*           |
|                                                                      |
| \< **RESPONSE\_TIME\_SACCH** : \< Response Time SACCH struct \>\>    |
| \-- *Network\'s response time on SACCH*                              |
|                                                                      |
| { 00 \-- *Network\'s response time on FACCH/F*                       |
|                                                                      |
| \-- *i.e. between a request sent on TCH/F or FACCH/F and the         |
| corresponding response sent on FACCH/F*                              |
|                                                                      |
| \< **RESPONSE\_TIME\_FACCH\_F** : \< Response Time struct \>\>       |
|                                                                      |
| \| 01 \< **RESPONSE\_TIME\_FACCH\_H** : \< Response Time struct \>\> |
| \-- *Network\'s reponse time on FACCH/H*                             |
|                                                                      |
| \| 10 \< **RESPONSE\_TIME\_FLO**: \< Response Time FLO struct \> \>  |
| } \-- *Network\'s response times with FLO*                           |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+
| \< Response Time SDCCH struct \> ::=                                 |
|                                                                      |
| \< **TRMIN\_SDCCH** : bit (1) \> \-- *Network\'s minimum response    |
| time on SDCCH*                                                       |
|                                                                      |
| \< **TRESP\_SDCCH**: bit (1) \>; \-- *Network\'s maximum response    |
| time on SDCCH*                                                       |
+----------------------------------------------------------------------+
| \< Response Time SACCH struct \> ::=                                 |
|                                                                      |
| \< **TRMIN\_SACCH** : bit (1) \> \-- *Network\'s minimum response    |
| time on SACCH*                                                       |
|                                                                      |
| \< **TRESP\_SACCH**: bit (1) \>; \-- *Network\'s maximum response    |
| time on SACCH*                                                       |
+----------------------------------------------------------------------+
| \< Response Time struct \> ::=                                       |
|                                                                      |
| \< **TRMIN** : bit (6) \>                                            |
|                                                                      |
| \< **TRESP\_MAC\_DTM** : bit (7) \>                                  |
|                                                                      |
| \< **TRESP\_MAC\_Dedicated** : bit (7) \>;                           |
+----------------------------------------------------------------------+
| \< Response Time FLO struct \> ::= \-- *Response times when FLO is   |
| used*                                                                |
|                                                                      |
| \< **TRMIN\_DCH** : bit (6) \>                                       |
|                                                                      |
| \< **TRES\_DCH\_MAC\_DTM** : bit (7) \>                              |
|                                                                      |
| \< **TRESP\_DCH\_MAC\_Dedicated** : bit (7) \>;                      |
+----------------------------------------------------------------------+

Table 9.2.3.2: CELL UPDATE CONFIRM information element details

+----------------------------------------------------------------------+
| **RRC Transaction Identifier**\                                      |
| This IE is defined in sub-clause 9.3.98.                             |
+----------------------------------------------------------------------+
| **Activation Time**\                                                 |
| This IE is defined in sub-clause 9.3.1.                              |
+----------------------------------------------------------------------+
| **RRC State Indicator**\                                             |
| This IE is defined in sub-clause 9.3.97.                             |
+----------------------------------------------------------------------+
| **GERAN DRX cycle length coefficient**\                              |
| This IE is defined in sub-clause 9.3.29.                             |
+----------------------------------------------------------------------+
| **Integrity Check Info**\                                            |
| This IE is defined in sub-clause 9.3.36. The integrity Check Info IE |
| is included when integrity protection is applied                     |
+----------------------------------------------------------------------+
| **Integrity Protection Mode Info**\                                  |
| This IE is defined in sub-clause 9.3.39. The GERAN does not include  |
| this IE unless it is performing an SBSS relocation                   |
+----------------------------------------------------------------------+
| **Ciphering Mode Info**\                                             |
| This IE is defined in sub-clause 9.3.14. The GERAN does not include  |
| this IE unless it is performing an SBSS relocation and a change in   |
| ciphering algorithm.                                                 |
+----------------------------------------------------------------------+
| **New G-RNTI**\                                                      |
| This IE assigns a new G-RNTI to the MS. This IE is coded as the      |
| G-RNTI IE defined in sub-clause 9.3.32.                              |
+----------------------------------------------------------------------+
| **CN Information Info**\                                             |
| This IE is defined in sub-clause 9.3.17.                             |
+----------------------------------------------------------------------+
| **RLC Re-establishment indicator SRB2-4** (1 bit field)\             |
| This field indicates to the MS to re-establish the RLC instances for |
| SRB2-4 (see 3GPP TS 44.160).                                         |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Do not re-establish the RLC instances for SRB2-4\                  |
| 1 Re-esatblish the RLC instances for SRB2-4                          |
|                                                                      |
| It shall not be set to 1 if struct \"Downlink counter                |
| synchronisation info\" is included.                                  |
+----------------------------------------------------------------------+
| **RLC Re-establishment indicator RB5+** (1 bit field)\               |
| This field indicates to the MS to re-establish the RLC instances for |
| RB5+ (see 3GPP TS 44.160).                                           |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Do not re-establish the RLC instances for RB5+\                    |
| 1 Re-esatblish the RLC instances for RB5+                            |
|                                                                      |
| It shall not be set to 1 if struct \"Downlink counter                |
| synchronisation info\" is included.                                  |
+----------------------------------------------------------------------+
| **GRA Identity**\                                                    |
| This field is defined in sub-clause 9.3.30.                          |
+----------------------------------------------------------------------+
| **DBPSCH Description**\                                              |
| This IE is defined in sub-clause 9.3.19.                             |
+----------------------------------------------------------------------+
| **RB Information to Release list** (5 bit field)\                    |
| This field is used to repeat information on each RB to be released,  |
| where 0 enables one RB to be described. Range : 0 to maxRB-1.        |
+----------------------------------------------------------------------+
| **RB Information to Release**\                                       |
| This IE is defined in sub-clause 9.3.83.                             |
+----------------------------------------------------------------------+
| **RB Information to Reconfigure list** (5 bit field)\                |
| This field is used to repeat information on each RB to be            |
| reconfigured, where 0 enables one RB to be described. Range: 0 to    |
| maxRB-1.                                                             |
+----------------------------------------------------------------------+
| **RB Information to Reconfigure**\                                   |
| This IE is defined in sub-clause 9.3.82.                             |
+----------------------------------------------------------------------+
| **RB Information to Be Affected list** (5 bit field)\                |
| This field is used to repeat information on each RB to be affected,  |
| where 0 enables one RB to be described. Range: 0 to maxRB-1.         |
+----------------------------------------------------------------------+
| **RB Information to Be Affected**\                                   |
| This IE is defined in sub-clause 9.3.81.                             |
+----------------------------------------------------------------------+
| **RB with PDCP Information list** (5 bit field)\                     |
| This field is used to repeat information on each RB with PDCP        |
| Information, where 0 enables one RB to be described. . Range: 0 to   |
| maxRBallRABs-1.                                                      |
+----------------------------------------------------------------------+
| **RB with PDCP Information**\                                        |
| This IE is defined in sub-clause 9.3.86.                             |
+----------------------------------------------------------------------+
| **PDCP context relocation info**\                                    |
| This IE is defined in sub-clause 9.3.116.                            |
+----------------------------------------------------------------------+
| **Downlink Counter Synchronisation Info struct\                      |
| **This structure contains information about PDCP synchronisation.    |
+----------------------------------------------------------------------+
| **Network Response Times struct\                                     |
| **This structure contains information about network response times.  |
+----------------------------------------------------------------------+
| **TRMIN\_SDCCH (1 bit field)\                                        |
| **This field indicates the minimum response time of the network on   |
| SDCCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.     |
+----------------------------------------------------------------------+
| **TRESP\_SDCCH (1 bit field)\                                        |
| This field indicates the maximum response time of the network on     |
| SDCCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.**   |
+----------------------------------------------------------------------+
| **TRMIN\_SACCH (1 bit field)\                                        |
| **This field indicates the minimum response time of the network on   |
| SACCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.     |
+----------------------------------------------------------------------+
| **TRESP\_SACCH (1 bit field)\                                        |
| This field indicates the maximum response time of the network on     |
| SACCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.**   |
+----------------------------------------------------------------------+
| **TRMIN** (6 bit field)\                                             |
| This field indicates the minimum response time of the network,       |
| expressed as a number of TDMA frames. See 3GPP TS 44.060.            |
+----------------------------------------------------------------------+
| **TRESP\_MAC\_DTM (7 bit field)\                                     |
| TRESP\_MAC\_Dedicated (7 bit field)\                                 |
| These fields indicate for a given MAC state the maximum response     |
| time of the network expressed as a number of TDMA frames. See        |
| 3GPP TS 44.060.**                                                    |
+----------------------------------------------------------------------+
| **TRMIN\_DCH** (6 bit field)\                                        |
| This field indicates the minimum response time of the network when   |
| FLO is used, expressed as a number of TDMA frames. See               |
| 3GPP TS 44.160.                                                      |
+----------------------------------------------------------------------+
| **TRES\_DCH\_MAC\_DTM** **(7 bit field)\                             |
| TRES\_DCH\_MAC\_Dedicated** **(7 bit field)\                         |
| These fields indicate for a given MAC state the maximum response     |
| time of the network when FLO is used, expressed as a number of TDMA  |
| frames. See 3GPP TS 44.160.**                                        |
+----------------------------------------------------------------------+

### 9.2.4 DEDICATED PAGING REQUEST

In *RRC-Cell\_Dedicated state*, GERAN sends this message to signal a
core-network-originated page.

Radio Bearer : SRB2

Direction : GERAN → MS

Table 9.2.4.1: DEDICATED PAGING REQUEST information elements

+----------------------------------------------------------------------+
| \< DEDICATED PAGING REQUEST message content \> ::=                   |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| \< **Paging Cause :** \< Paging Cause IE \> \>                       |
|                                                                      |
| \< **CN Domain Identity** : \< CN Domain Identity IE \> \>           |
|                                                                      |
| \< **Paging Record Type Identifier** : \< **Paging Record Type       |
| Identifier** IE\> \>                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+

Table 9.2.4.2: DEDICATED PAGING REQUEST information element details

  ------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36.

  **Paging Cause**\
  This IE is defined in sub-clause 9.3.57.

  **CN Domain Identity**\
  This IE is defined in sub-clause 9.3.15.

  **Paging Record Type Identifier**\
  This IE is defined in sub-clause 9.3.58.
  ------------------------------------------

### 9.2.5 DOWNLINK DIRECT TRANSFER

This message is sent by GERAN to transfer higher layer messages.

Radio Bearer : SRB3 and SRB4

Direction : GERAN → MS

Table 9.2.5.1: DOWNLINK DIRECT TRANSFER information elements

+----------------------------------------------------------------------+
| \< DOWNLINK DIRECT TRANSFER message content \> ::=                   |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS Information Elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier :** \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| \-- *CN Information Elements*                                        |
|                                                                      |
| \< **CN Domain Identity** : \< CN Domain Identity IE \> \>           |
|                                                                      |
| \< **NAS Message** : \< NAS Message IE \> \>                         |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions : 1 bit (\*) = \< no string  |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+

Table 9.2.5.2: DOWNLINK DIRECT TRANSFER information element details

  -------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  The RRC Transaction Identifier IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  The *Integrity Check Info* IE is defined in sub-clause 9.3.36.\
  The *Integrity Check Info* IE is included if integrity protection is applied.

  **CN Domain Identity**\
  The *CN Domain Identity* IE is defined in sub-clause 9.3.15.

  **NAS Message**\
  The *NAS Message* IE is defined in sub-clause 9.3.54.
  -------------------------------------------------------------------------------

### 9.2.6 EXTENDED MEASUREMENT ORDER

This message is the same as the EXTENDED MEASUREMENT ORDER message
defined in 3GPP TS 44.018 but shall not contain:

\- RR management Protocol Discriminator IE.

\- Skip Indicator IE.

\- L2 pseudo length IE.

\- Extended Measurement Order IE.

Radio Bearer : SRB1

Direction : GERAN → MS

### 9.2.7 EXTENDED MEASUREMENT REPORT

This message is the same as the EXTENDED MEASUREMENT REPORT message
defined in 3GPP TS 44.018 but shall not contain:

\- RR management Protocol Discriminator IE.

\- Skip Indicator IE.

\- Extended Measurement Report Message Type IE.

Radio Bearer : SRB1

Direction : MS → GERAN

### 9.2.7a ENHANCED MEASUREMENT REPORT

This message is the same as the ENHANCED MEASUREMENT REPORT message
defined in 3GPP TS 44.018 but shall not contain:

\- RR short PD field.

\- Message type field.

\- Short layer 2 header field.

Radio Bearer : SRB1

Direction : MS → GERAN

### 9.2.8 GERAN MOBILITY INFORMATION

This message is used by GERAN to allocate a new G-RNTI and to convey
other GERAN mobility related information to a MS.

Radio Bearer : SRB2

Direction : GERAN→MS

Table 9.2.8.1: GERAN MOBILITY INFORMATION information elements

+----------------------------------------------------------------------+
| \< GERAN MOBILITY INFORMATION message content \> ::=                 |
|                                                                      |
| { 0 \-- *Critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS Information Elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **MS Timers and Constants in Connected Mode** : \< MS Timers and  |
| Constants in Connected Mode IE \> \>                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity protection mode info** : \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| { 0 \| 1 \< **Ciphering Mode Info** : \< Ciphering Mode Info IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **New G-RNTI** : \< G-RNTI IE \> \> }                    |
|                                                                      |
| \-- *CN Information Elements*                                        |
|                                                                      |
| { 0 \| 1 \< **CN Information Info** : \< CN Information Info Full IE |
| \> \> }                                                              |
|                                                                      |
| \-- *GERAN Information Elements*                                     |
|                                                                      |
| { 0 \| 1 \< **GRA Identity** : \< GRA Identity IE \> \> }            |
|                                                                      |
| { 0 \| 1 \< **Downlink Counter Synchronisation Info :** \< Downlink  |
| Counter Synchronisation Info struct \> \> }                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions : 1 bit (\*) = \< no string  |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+
| \< Downlink Counter Synchronisation Info struct\> ::=                |
|                                                                      |
| \< **RB with PDCP Information List** : bit (5) \>                    |
|                                                                      |
| { { 0 \| 1 \< **RB with PDCP Information** : \< RB with PDCP         |
| Information IE \> \> }                                               |
|                                                                      |
| { 0 \| 1 \< **PDCP context relocation info** : \< PDCP context       |
| relocation info IE \> \> } } \* (1 + val(RB with PDCP Information    |
| List) );                                                             |
+----------------------------------------------------------------------+

Table 9.2.8.2: GERAN MOBILITY INFORMATION information element details

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **MS Timers and Constants in connected mode**\
  This IE is defined in sub-clause 9.3.51.

  **Integrity Check Info**\
  This IE is defined in sub-clause sub-clause 9.3.36. The *Integrity Check Info IE* is included when integrity protection is applied

  **Integrity Protection Mode Info**\
  This IE is defined in sub-clause 9.3.39. The GERAN does not include this IE unless it is performing an SBSS relocation

  **Ciphering mode info**\
  This IE is defined in sub-clause 9.3.14. The GERAN does not include this IE unless it is performing an SBSS relocation and a change in ciphering algorithm

  **New G-RNTI**\
  This IE assigns a new G-RNTI to the MS. The *G-RNTI* IE is defined in sub-clause 9.3.32.

  **CN Information Info Full**\
  This IE is defined in sub-clause 9.3.18.

  **GRA Identity**\
  This IE is defined in sub-clause 9.3.30.

  **Downlink Counter Synchronisation info\
  **This structure contains information about PDCP synchronisation.

  **RB with PDCP Information List** (5 bit field)\
  This field is used to repeat information on each RB with PDCP Information, where 0 enables one RB to be described.. Range: 0 to maxRBallRABs-1. Other values are reserved.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.

  **PDCP context relocation info**\
  This IE is defined in sub-clause 9.3.116
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.9 GERAN MOBILITY INFORMATION CONFIRM

This message is used to confirm the new GERAN mobility information for
the MS.

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.9.1: GERAN MOBILITY INFORMATION CONFIRM information elements

+----------------------------------------------------------------------+
| \< GERAN MOBILITY INFORMATION CONFIRM message content \> ::=         |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS Information Elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Uplink Integrity Protection Activation Info** : \<     |
| Integrity Protection Activation Info IE \> \> }                      |
|                                                                      |
| \-- *RB Information Elements*                                        |
|                                                                      |
| { 0 \| 1 \< **COUNT-C Activation Time** : \< Activation Time IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Radio Bearer Uplink Ciphering Activation Time Info** : |
| \< RB Activation Time Info IE\> \>}                                  |
|                                                                      |
| { 0 \| 1 \< **Uplink Counter Synchronisation Info :** \< Uplink      |
| Counter Synchronisation Info struct \> \> }                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> };           |
+----------------------------------------------------------------------+
| \< Uplink Counter Synchronisation Info struct \> ::=                 |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **START List**: bit (2) \>                                        |
|                                                                      |
| { \< **START** : \< START IE \> \>                                   |
|                                                                      |
| \< **CN Domain Identity** : \< CN Domain Identity IE \> \> }         |
| \*(1+val(START list))                                                |
|                                                                      |
| { 0 \| 1 \< **RB with PDCP Information list** : bit (5) \>           |
|                                                                      |
| \< **RB with PDCP Information** : \< RB with PDCP Information IE \>  |
| \> \*(1 + val(RB with PDCP Information list) )}                      |
|                                                                      |
| }                                                                    |
+----------------------------------------------------------------------+

Table 9.2.9.2: GERAN MOBILITY INFORMATION CONFIRM information element
details

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included when integrity protection is applied.

  **Uplink Integrity Protection Activation Info**\
  The *Integrity Protection Activation Info* IE is defined in sub-clause 9.3.37.

  **COUNT-C Activation Time**\
  Thie IE is used for radio bearers mapped on RLC-TM when the MS is moving to RRC-Cell\_Dedicated state. **The Activation Time IE is defined in sub-clause 9.3**.1.

  **Radio Bearer Activation Time Info**\
  The RB Activation Time Info IE is defined in sub-clause 9.3.77.

  **Uplink Counter Synchronisation info\
  **This structure contains information about PDCP synchronisation.

  **START List** (2 bit field)\
  This field is the binary representation of the number of CN domain START struct**.** Range : 0 to maxCNdomains-1.

  **START**\
  This field is defined in sub-clause 9.3.102.

  **CN Domain Identity**\
  The *CN Domain Identity* IE identifies the type of core network domain. This IE is defined in sub-clause 9.3.15.

  **RB with PDCP Information List** (5 bit field)\
  This field is used to repeat information on each RB with PDCP Information, where 0 enables one RB to be described.. Range: 0 to maxRBallRABs-1.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.10 GERAN MOBILITY INFORMATION FAILURE

This message is sent to indicate a failure to act on a received GERAN
MOBILITY INFORMATION message.

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.10.1: GERAN MOBILITY INFORMATION FAILURE information elements

+----------------------------------------------------------------------+
| \< GERAN MOBILITY INFORMATION FAILURE message content \> ::=         |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Failure Cause** : \< Failure Cause and Error Information IE \>  |
| \>                                                                   |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> };           |
+----------------------------------------------------------------------+

Table 9.2.10.2: GERAN MOBILITY INFORMATION FAILURE information element
details

  --------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Failure Cause and Error Information**\
  The *Failure Cause And Error Information* IE is defined in sub-clause 9.3.25.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included when integrity protection is applied.
  --------------------------------------------------------------------------------------------------------------------------

### 9.2.11 **GRA UPDATE**

This message is used by the MS to initiate a GRA Update procedure.

Radio Bearer : SRB2

Direction : MS→GERAN

\--
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

\--

\-- GRA UPDATE

\--

\--
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

GRAUpdate ::= SEQUENCE {

\-- User equipment IEs

g-RNTI G-RNTI,

gra-UpdateCause GRA-UpdateCause,

protocolErrorIndicator ProtocolErrorIndicator,

laterNonCriticalExtensions SEQUENCE {

\-- Container for additional R5 extensions

graUpdate-r5-add-ext BIT STRING OPTIONAL,

nonCriticalExtensions SEQUENCE {} OPTIONAL

} OPTIONAL

}

### 9.2.12 GRA UPDATE CONFIRM

This message confirms the GRA update procedure and can be used to
reallocate new G-RNTI information for the MS valid after the GRA update.

Radio Bearer : SRB2

Direction : GERAN→MS

\-
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

\--

\-- GRA UPDATE CONFIRM

\--

\--
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

GRAUpdateConfirm ::= CHOICE {

r5 SEQUENCE {

graUpdateConfirm-r5 GRAUpdateConfirm-r5-IEs,

laterNonCriticalExtensions SEQUENCE {

\-- Container for additional R5 extensions

graUpdateConfirm-r5-add-ext BIT STRING OPTIONAL,

nonCriticalExtensions SEQUENCE {} OPTIONAL

} OPTIONAL

},

later-than-r5 SEQUENCE {

rrc-TransactionIdentifier RRC-TransactionIdentifier,

criticalExtensions SEQUENCE {}

}

}

GRAUpdateConfirm-r5-IEs ::= SEQUENCE {

rrc-TransactionIdentifier RRC-TransactionIdentifier,

integrityProtectionModeInfo IntegrityProtectionModeInfo OPTIONAL,

cipheringModeInfo CipheringModeInfo OPTIONAL,

new-G-RNTI G-RNTI OPTIONAL,

rrc-StateIndicator RRC-StateIndicator,

geran-DRX-CycleLengthCoeff GERAN-DRX-CycleLengthCoefficient OPTIONAL,

\-- CN information elements

cn-InformationInfo CN-InformationInfo OPTIONAL,

\-- GERAN mobility IEs

gra-Identity GRA-Identity OPTIONAL,

\-- Radio bearer IEs

dl-CounterSynchronisationInfo DL-CounterSynchronisationInfo OPTIONAL

}

END

### 9.2.13 (void)

### 9.2.14 HANDOVER COMPLETE

This message is sent from the MS when a physical channel reconfiguration
has been done.

Radio Bearer : SRB2

Direction : MS → GERAN

Table 9.2.14.1: HANDOVER COMPLETE **information** elements

+----------------------------------------------------------------------+
| \< HANDOVER COMPLETE message content \> ::=                          |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier :** \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **RRC Cause :** \< RRC Cause IE \> \>                             |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info :** \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Uplink Integrity Protection Activation Info :** \<     |
| Integrity Protection Activation Info IE \> \> }                      |
|                                                                      |
| { 0 \| 1 \< **Mobile Observed Time Difference :** \< Mobile Time     |
| Difference IE\> \> }                                                 |
|                                                                      |
| \-- *RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **COUNT-C Activation Time :** \< Activation Time IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Radio Bearer Uplink Ciphering Activation Time Info :** |
| \< RB Activation Time Info IE\> \> }                                 |
|                                                                      |
| { 0 \| 1 \< **Uplink Counter Synchronisation Info :** \< Uplink      |
| Counter Synchronisation Info struct \> \> }                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+
| \< Uplink Counter Synchronisation Info struct \> ::=                 |
|                                                                      |
| { \< **START List :** bit (2) \>                                     |
|                                                                      |
| { \< **CN Domain Identity :** \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **START :** \< START IE \> \> } \* (1+val(START List))            |
|                                                                      |
| { 0 \| 1 \< **RB with PDCP Information List :** bit (5) \>           |
|                                                                      |
| \< **RB with PDCP Information :** \< RB with PDCP Information IE \>  |
| \> \*(1+val(RB with PDCP Information List)) }                        |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.2.14.2: HANDOVER COMPLETE **information** element details

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE shall be set to the used signalling radio bearer identity when the encoded RRC message is used as the MESSAGE parameter in the integrity protection algorithm. This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included when integrity protection is applied.

  **Uplink Integrity Protection Activation Info**\
  This IE contains the time, in terms of RRC sequence numbers, when a new integrity protection configuration shall be activated for the signalling radio bearers. The Integrity protection activation info IE is defined in sub-clause 9.3.36.

  **COUNT-C Activation Time**\
  **The *Activation Time* IE is defined in sub-clause 9.3**.1

  **Radio Bearer Uplink Ciphering Activation Time info**\
  **The** *RB activation time info* IE **is defined in sub-clause** 9.3.77

  **Uplink Counter Synchronisation Info struct**\
  This structure enable to synchronise the Uplink security counters.

  **START List** (2 bit field)\
  This field is used to repeat information on each RB to be affected, where 0 enables one RB to be described.. Range : 0 to maxCNdomains-1.

  **CN Domain Identity**\
  This IE is defined in sub-clause 9.3.15.

  **START**\
  **This IE is defined in sub-clause 9.3**.102. START value to be used in this CN domain.

  **RB with PDCP Information List** (5 bit field)\
  This field is used to repeat information on each RB with PDCP Information, where 0 enables one RB to be described.. Range : 0 to maxRBallRABs-1.

  **RRC Cause**\
  **This IE is defined in sub-clause 9.3**.94.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.15 HANDOVER FAILURE

Radio Bearer : SRB2

Direction : MS → GERAN

Table 9.2.15.1: HANDOVER FAILURE **information** elements

+----------------------------------------------------------------------+
| \< HANDOVER FAILURE message content \> ::=                           |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **Failure Cause :** \< Failure Cause and Error Information IE \>  |
| \>                                                                   |
|                                                                      |
| \< **RRC Cause :** \< RRC Cause IE \> \>                             |
|                                                                      |
| { 0 \| 1 \< **RRC Transaction Identifier :** \< RRC Transaction      |
| Identifier IE \> \> }                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info :** \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.15.2: HANDOVER FAILURE **information** element details

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE shall be set to the used signalling radio bearer identity when the encoded RRC message is used as the MESSAGE parameter in the integrity protection algorithm. This IE is defined in sub-clause 9.3.36.

  **RRC Cause**\
  The *RRC Cause* IE is defined in sub-clause 9.3.94.

  **Failure Cause**\
  The *Failure Cause and Error Information* IE is defined in sub-clause 9.3.25.
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.16 HANDOVER FROM GERAN Iu COMMAND

This message is used for handover from GERAN Iu to GERAN A/Gb.

Radio Bearer : SRB2

Direction : GERAN→MS

Table 9.2.16.1: HANDOVER FROM GERAN Iu COMMAND **information** elements

+----------------------------------------------------------------------+
| \< HANDOVER FROM GERAN Iu COMMAND message content \> ::=             |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS Information Elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Activation Time :** \< Activation Time IE \> \>                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info :** \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Protection Mode Info :** \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| \-- *RB Information Elements*                                        |
|                                                                      |
| { 0 \| 1 \< **RAB Information List :** bit (4) \>                    |
|                                                                      |
| \< **RAB Info :** \< RAB Info IE \> \> \* (1 + val(RAB Information   |
| List) ) }                                                            |
|                                                                      |
| \< **Handover Command :** \< Handover Command struct \> \>           |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+
| \< Handover Command struct \> ::=                                    |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **Handover Command Length :** bit (8) \>                          |
|                                                                      |
| \< **Handover Command :** octet(val(Handover Command Length)) \>     |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.2.16.2: HANDOVER FROM GERAN Iu COMMAND **information** element
details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Activation Time**\
  This IE is defined in sub-clause 9.3.1.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included when integrity protection is applied.

  **Integrity Protection Mode Info**\
  This IE is defined in sub-clause 9.3.39

  **RAB Information List** (4 bit field)\
  This field is used to repeat information on each RABto Setup, where 0 enables one RAB to be described.Range : 0 to maxRABsetup-1. Other values are reserved.

  **RAB Information List**\
  The *RAB Info* IE is defined in sub-clause 9.3.73.

  **Handover Command** struct\
  This structure contains the message HANDOVER COMMAND and the length of the message. The HANDOVER COMMAND message is defined in 3GPP TS 44.018.
  --------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.17 INITIAL DIRECT TRANSFER

This message is used to initiate a signalling connection based on
indication from the upper layers, and to transfer a NAS message.

Radio Bearer : SRB3

Direction : MS → GERAN

Table 9.2.17.1: INITIAL DIRECT TRANSFER **information** elements

+----------------------------------------------------------------------+
| \< INITIAL DIRECT TRANSFER message content \> ::=                    |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **CN Domain Identity :** \< CN Domain Identity IE \> \>           |
|                                                                      |
| \< **Intra Domain NAS Node Selector :** \< Intra Domain NAS Node     |
| Selector IE \> \>                                                    |
|                                                                      |
| \< **NAS Message :** \< NAS Message IE \> \>                         |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| \< **Start** : \< Start IE \> \>                                     |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.17.2 : INITIAL DIRECT TRANSFER **information** element details

  ------------------------------------------------------------------------------------------------------------------------------------------
  **CN Domain Identity**\
  The CN Domain Identity IE is defined in sub-clause 9.3.15.

  **Intra Domain NAS Node Selector**\
  The Intra Domain NAS Node Selector IE is defined in sub-clause 9.3.41.

  **NAS Message**\
  The NAS Message IE is defined in sub-clause 9.3.54.

  **Integrity Check Info**\
  The Integrity Check Info IE is defined in sub-clause 9.3.36. The Integrity Check Info IE is included if integrity protection is applied.

  **Start**\
  This IE is defined in sub-clause 9.3.102.
  ------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.18 INTER SYSTEM TO CDMA2000 HANDOVER COMMAND

This message is used for handover from GERAN *Iu mode* to another system
e.g. CDMA2000. One or several messages from the other system can be
included in the Inter-RAT message information element in this message.
These messages are structured and coded according to that systems
specification.

Radio Bearer : SRB2

Direction : GERAN→MS

Table 9.2.18.1: INTER SYSTEM TO CDMA2000 HANDOVER COMMAND
**information** elements

+----------------------------------------------------------------------+
| \< INTER SYSTEM TO CDMA2000 HANDOVER COMMAND message content \> ::=  |
|                                                                      |
| { 0 \--*critical extension escape available*                         |
|                                                                      |
| {                                                                    |
|                                                                      |
| \--*MS information elements*                                         |
|                                                                      |
| \< **RRC Transaction Identifier :** bit (2) \>                       |
|                                                                      |
| \< **Activation Time :** \< Activation Time IE \> \>                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info :** \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Protection Mode Info :** \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| \-- *RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **RAB Information List :** bit (4) \>                    |
|                                                                      |
| \< **RAB Info :** \< RAB Info IE \> \> \* (1+val(RAB Information     |
| List))}                                                              |
|                                                                      |
| \< **Handover to CDMA2000 Command :** \< Handover to CDMA2000        |
| Command struct \> \>                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \> } ;                                                            |
+----------------------------------------------------------------------+
| \< Handover to CDMA2000 Command struct \> ::=                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **Length of Handover to CDMA2000 Command contents :** bit (8) \>  |
|                                                                      |
| \< **Handover to CDMA2000 Command :** octet(val(Length of Handover   |
| to CDMA2000 Command contents)) \>                                    |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.2.18.2 : INTER SYSTEM TO CDMA2000 HANDOVER COMMAND
**information** element details

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier** (2 bit field)\
  This field is defined in sub-clause 9.3.98.

  **Activation Time**\
  This IE is defined in sub-clause 9.3.1.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36.

  **Integrity Protection Mode Info**\
  This IE is defined in sub-clause 9.3.39

  **RAB Information List** (4 bit field)\
  This field is the binary representation of the number of Radio Access Bearers to setup. Range : 0 to maxRABsetup-1. Other values are reserved.

  **RAB Info**\
  The *RAB Info* IE is defined in sub-clause 9.3.73.

  **Handover to CDMA2000 Command struct**\
  This structure contains the message HANDOVER to CDMA2000 COMMAND and the length of the HANDOVER to CDMA2000 COMMAND message. The HANDOVER to CDMA2000 COMMAND message is defined in TIA/EIA/IS-833 and TIA/EIA/IS-2000-5.
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

NOTE: The MSG\_TYPE of the cdma2000 message used for the intersystem
handover is included in the first octet of the Handover to CDMA2000
Command struct. It is specified in TIA/EIA/IS-2000 and in
TIA/EIA/IS-833. (E.g. MSG\_TYPE::= {00010001} if Extended Handoff
Direction Message (EHDM) is used, MSG\_TYPE::= {00011111} if General
Handoff Direction Message is used, etc.). The order of the bits in this
octet representing is given by the following example. If
MSG\_TYPE::={00010001} (EHDM), the bit number 1 of \'cdma2000 MSG\_TYPE
IEI\' is \'0\', the bit number 2 shall be \'0\', etc., and the bit
number 8 is \'1\'.\
\
The remaining octets in the Handover to CDMA2000 Command struct is coded
as the payload of the message used for the inter system handover, as
specified in TIA/EIA/IS-2000-5 and in TIA/EIA/IS-833. The bit ordering
is similar to the case described above. The bit number 1 of \'cdma2000
message payload\' is coded as the first bit of the first record of the
message defined in TIA/EIA/IS-2000-5 and in TIA/EIA/IS-833, reading the
records defined in TIA/EIA/IS-2000-5 and in TIA/EIA/IS-833 from left to
right.

### 9.2.19 INTER SYSTEM TO UTRAN HANDOVER COMMAND

This message is used for handover from GERAN *Iu mode* to another system
e.g. UTRAN. One or several messages from the other system can be
included in the Inter-RAT message information element in this message.
These messages are structured and coded according to that systems
specification.

Radio Bearer : SRB2

Direction : GERAN→MS

Table 9.2.19.1: INTER SYSTEM TO UTRAN HANDOVER COMMAND **information**
elements

+----------------------------------------------------------------------+
| \< INTER SYSTEM TO UTRAN HANDOVER COMMAND message content \> ::=     |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier :** \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Activation Time :** \< Activation Time IE \> \>                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info :** \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Protection Mode Info :** \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| \-- *RB information elements*                                        |
|                                                                      |
| \< **Handover to UTRAN Command :** \< Handover to UTRAN Command      |
| struct \> \>                                                         |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \> } ;                                                            |
+----------------------------------------------------------------------+
| \< Handover to UTRAN Command struct \> ::=                           |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **Radio Bearer Reconfiguration Length** : bit (8) \>              |
|                                                                      |
| \< **Handover to UTRAN Command :** octet(val(**Radio Bearer          |
| Reconfiguration** Length)) \>                                        |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.2.19.2: INTER SYSTEM TO UTRAN HANDOVER COMMAND **information**
element details

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Activation Time**\
  This IE is defined in sub-clause 9.3.1.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The integrity Check Info IE is included when integrity protection is applied.

  **Integrity Protection Mode Info**\
  This IE is defined in sub-clause 9.3.39

  **Handover to UTRAN Command struct**\
  This structure contains the **RADIO BEARER RECONFIGURATION** message and the length of the **RADIO BEARER RECONFIGURATION** message. The **RADIO BEARER RECONFIGURATION** message is defined in 3GPP TS 25.331.
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.20 LCS DOWNLINK INFORMATION

This message is used by the GERAN to convey embedded LCS RRLP PDUs
between the SMLC and the MS.

Radio Bearer: SRB3

Direction: GERAN → MS

Table 9.2.20.1: LCS DOWNLINK INFORMATION information elements

+----------------------------------------------------------------------+
| \< LCS DOWNLINK INFORMATION message content \> ::=                   |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** :\< RRC Transaction Identifier IE  |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| \< RRLP PDU Length : bit (8) \>                                      |
|                                                                      |
| \< RRLP PDU : octet(val(RRLP PDU Length)) \>                         |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+

Table 9.2.21.2: LCS DOWNLINK INFORMATION information element details

  --------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This field is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **RRLP PDU Length** (8 bit field)\
  This field is the binary representation of the length in octets of the following RRLP PDU field. Range: 0 to 241. All other values are reserved.

  **RRLP PDU** (variable length octet string)\
  This field contains an RRLP PDU as defined in 3GPP TS 44.031.
  --------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.21 LCS UPLINK INFORMATION

This message is used by the MS to convey embedded LCS RRLP PDUs between
the MS and the GERAN (SMLC).

Radio Bearer: SRB3

Direction: MS → GERAN

Table 9.2.21.1: LCS UPLINK INFORMATION information elements

+----------------------------------------------------------------------+
| \< LCS UPLINK INFORMATION message content \> ::=                     |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| \< **RRLP PDU Length** : bit (8) \>                                  |
|                                                                      |
| \< **RRLP PDU** : octet(val(RRLP PDU Length)) \>                     |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.21.2: LCS UPLINK INFORMATION information element details

  --------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This field is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **RRLP PDU Length** (8 bit field)\
  This field is the binary representation of the length in octets of the following RRLP PDU field. Range: 0 to 241. All other values are reserved.

  **RRLP PDU** (variable length octet string)\
  This field contains an RRLP PDU as defined in 3GPP TS 44.031.
  --------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.22 MEASUREMENT INFORMATION

This message is the same as the MEASUREMENT INFORMATION message defined
in 3GPP TS 44.018 sub-clause 9.1.54, but shall not contain:

\- RR short PD field.

\- Message type field.

\- Short layer 2 header field.

Radio Bearer : SRB1

Direction : GERAN → MS

### 9.2.23 MEASUREMENT REPORT

This message is the same as the MEASUREMENT REPORT message defined in
3GPP TS 44.018 but shall not contain:

\- RR management Protocol Discriminator IE.

\- Skip Indicator IE.

\- Measurement Report Message Type IE.

Radio Bearer : SRB1

Direction : MS → GERAN

### 9.2.24 MS CAPABILITY ENQUIRY

The MS CAPABILITY ENQUIRY is used by the GERAN to enquire GERAN A/Gb
mode, UTRAN or CDMA2000 classmarks and UTRAN predefined configurations
from the MS.

Radio Bearer: SRB2

Direction: GERAN → MS

Table 9.2.24.1: MS CAPABILITY ENQUIRY information elements

+----------------------------------------------------------------------+
| \< MS CAPABILITY ENQUIRY message content \> ::=                      |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS Information Elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| \< **Capability Update Requirement** : \< **Capability Update        |
| Requirement** IE \> \>                                               |
|                                                                      |
| { 0 \| 1 \< **UTRAN predefined Configuration Requirement**: bit (1)  |
| \> }                                                                 |
|                                                                      |
| ! \< Content part error: bit(\*) = \< no string \> \> }              |
|                                                                      |
| ! \< Message escape critical extensions: 1 bit (\*) = \< no string   |
| \> \> } ;                                                            |
+----------------------------------------------------------------------+

Table 9.2.24.2: MS CAPABILITY ENQUIRY information element details

+----------------------------------------------------------------------+
| **RRC Transaction Identifier**\                                      |
| This field is defined in sub-clause 9.3.98.                          |
+----------------------------------------------------------------------+
| **Integrity Check Info**\                                            |
| This IE is defined in sub-clause 9.3.36.\                            |
| Integrity check info is included if integrity protection is applied. |
+----------------------------------------------------------------------+
| **UTRAN predefined Configuration Requirement (**1 bit field)\        |
| This field corresponds to the information whether the predefined     |
| configurations are requested by the network..                        |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 UTRAN predefined configuration not requested by the network\       |
| 1 UTRAN predefined configuration requested by the network            |
+----------------------------------------------------------------------+
| **Capability Update Requirement**\                                   |
| This IE is defined in sub-clause 9.3.4.                              |
+----------------------------------------------------------------------+

### 9.2.25 MS CAPABILITY INFORMATION

This message is sent by the MS to the GERAN to convey MS specific
capability information to the GERAN.

Radio Bearer: SRB2

Direction: MS → GERAN

Table 9.2.25.1: MS CAPABILITY INFORMATION information elements

+----------------------------------------------------------------------+
| \< MS CAPABILITY INFORMATION message content \> ::=                  |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS Information Elements*                                        |
|                                                                      |
| { 0 \| 1 \< **RRC Transaction Identifier** : \< **RRC Transaction    |
| Identifier IE \> \> }**                                              |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **MS GERAN Iu mode Radio Access Capability** : \< **MS   |
| GERAN Iu mode Radio Access Capability** IE \> \> }                   |
|                                                                      |
| { 0 \| 1 \< **MS GERAN A/Gb mode Radio Access Capability** : \< **MS |
| GERAN A/Gb mode Radio Access Capability** IE \> \> }                 |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability** : \< **UE UTRAN     |
| Radio Access Capability** IE \> \> }                                 |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability Extension** : \< **UE |
| UTRAN Radio Access Capability Extension** IE \>\> }                  |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Predefined Configuration Status Information** |
| : \< **UE UTRAN Predefined Configuration** Status Information IE     |
| \>\> }                                                               |
|                                                                      |
| { 0 \| 1 \< **UE CDMA2000 Radio Access Capability** : \< UE CDMA2000 |
| **Radio Access Capability** IE \> \> }                               |
|                                                                      |
| ! \< Content part error: bit (\*) = \< no string \> \> } ;           |
+----------------------------------------------------------------------+

Table 9.2.25.2: MS CAPABILITY INFORMATION information element details

  ----------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This field is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36.\
  Integrity check info is included if integrity protection is applied.

  **MS GERAN Iu mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.45.

  **MS GERAN A/Gb mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.46.

  **UE UTRAN Radio Access Capability\
  **This IE is defined in sub-clause 9.3.108.

  **UE UTRAN Radio Access Capability Extension\
  **This IE is defined in sub-clause 9.3.109.

  **UE UTRAN Predefined Configuration Status Information\
  **This IE is defined in sub-clause 9.3.108a.

  **UE CDMA2000 Radio Access Capability**\
  This IE is defined in sub-clause 9.3.110.
  ----------------------------------------------------------------------

### 9.2.26 MS CAPABILITY INFORMATION CONFIRM

This message is sent by the GERAN to the MS to confirm that the MS
capability information has been received.

Radio Bearer: SRB2

Direction: GERAN → MS

Table 9.2.26.1: MS CAPABILITY INFORMATION CONFIRM information elements

+----------------------------------------------------------------------+
| \< MS CAPABILITY INFORMATION CONFIRM message content \> ::=          |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS Information Elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions: 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+

Table 9.2.26.2: MS CAPABILITY INFORMATION CONFIRM information element
details

  ---------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This field is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36.\
  *Integrity Check Info* IE is included if integrity protection is applied.
  ---------------------------------------------------------------------------

### 9.2.27 (void)

### 9.2.28 RADIO BEARER RECONFIGURATION

This message is sent from GERAN to reconfigure parameters related to a
change of QoS or change of physical channel.

Radio Bearer : SRB2

Direction : GERAN → MS

Table 9.2.28.1: RADIO BEARER RECONFIGURATION information elements

+----------------------------------------------------------------------+
| \< RADIO BEARER RECONFIGURATION message content \> ::=               |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Activation Time** : \< Activation Time IE \> \>                 |
|                                                                      |
| \< **RRC State Indicator** : \< RRC State Indicator IE \> \>         |
|                                                                      |
| \< **GERAN DRX Cycle Length Coefficient** : \< GERAN DRX Cycle       |
| Length Coefficient IE \> \>                                          |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Protection Mode Info** : \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| { 0 \| 1 \< **Ciphering Mode Info** : \< Ciphering Mode Info IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **New G-RNTI** : \< G-RNTI IE \> \> }                    |
|                                                                      |
| \-- *CN information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **CN Information Info** : \< CN Information Info IE \>   |
| \> }                                                                 |
|                                                                      |
| \-- *GERAN information elements*                                     |
|                                                                      |
| { 0 \| 1 \< **GRA Identity** : \< GRA Identity IE \> \> }            |
|                                                                      |
| \-- *RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **RAB Information to Reconfigure List** : bit (4) \>     |
|                                                                      |
| \< **RAB Information to Reconfigure** : \< RAB Information to        |
| Reconfigure IE \> \> \* (1+val(RAB Information to Reconfigure List)) |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **RB Information to Reconfigure List** : bit (5) \>      |
|                                                                      |
| { \< **RB Information to Reconfigure** : \< RB Information to        |
| Reconfigure IE \> \>                                                 |
|                                                                      |
| { 0 \| 1 \< **Physical Information** : \< Physical Channel           |
| Configuration IE \> \> }                                             |
|                                                                      |
| 0 \| 1 \< **NETWORK\_RESPONSE\_TIMES** : \< Network Response Times   |
| struct \>\> }                                                        |
|                                                                      |
| }\* (1+val(RB Information to Reconfigure List))                      |
|                                                                      |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Downlink Counter Synchronisation Info :** \< Downlink  |
| Counter Synchronisation info struct \> \> }                          |
|                                                                      |
| { 0 \| 1 \< **RB Information to Be Affected List** : bit (5) \>      |
|                                                                      |
| \< **RB Information to Be Affected** : \< RB Information to Be       |
| Affected IE \> \> \*(1+val(RB Information to Be Affected List)) }    |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+
| \< Downlink Counter Synchronisation Info struct\> ::=                |
|                                                                      |
| \< **RB with PDCP Information List** : bit (5) \>                    |
|                                                                      |
| { { 0 \| 1 \< **RB with PDCP Information** : \< RB with PDCP         |
| Information IE \> \> }                                               |
|                                                                      |
| { 0 \| 1 \< **PDCP context relocation info** : \< PDCP context       |
| relocation info IE \> \> } } \* (1 + val(RB with PDCP Information    |
| List) );                                                             |
+----------------------------------------------------------------------+
| \< Network Response Times struct \> ::=                              |
|                                                                      |
| { 0 \-- *Network\'s response times on SDCCH*                         |
|                                                                      |
| \< **RESPONSE\_TIME\_SDCCH** : \< Response Time SDCCH struct \> \>   |
|                                                                      |
| \| 1 \-- *Network\'s reponse times on the assigned DBPSCH*           |
|                                                                      |
| \< **RESPONSE\_TIME\_SACCH** : \< Response Time SACCH struct \>\>    |
| \-- *Network\'s response time on SACCH*                              |
|                                                                      |
| { 00 \-- *Network\'s response time on FACCH/F*                       |
|                                                                      |
| \-- *i.e. between a request sent on TCH/F or FACCH/F and the         |
| corresponding response sent on FACCH/F*                              |
|                                                                      |
| \< **RESPONSE\_TIME\_FACCH\_F** : \< Response Time struct \>\>       |
|                                                                      |
| \| 01 \< **RESPONSE\_TIME\_FACCH\_H** : \< Response Time struct \>\> |
| \-- *Network\'s reponse time on FACCH/H*                             |
|                                                                      |
| \| 10 \< **RESPONSE\_TIME\_FLO**: \< Response Time FLO struct \> \>  |
| }}; \-- *Network\'s response times with FLO*                         |
+----------------------------------------------------------------------+
| \< Response Time SDCCH struct \> ::=                                 |
|                                                                      |
| \< **TRMIN\_SDCCH** : bit (1) \> \-- *Network\'s minimum response    |
| time on SDCCH*                                                       |
|                                                                      |
| \< **TRESP\_SDCCH**: bit (1) \>; \-- *Network\'s maximum response    |
| time on SDCCH*                                                       |
+----------------------------------------------------------------------+
| \< Response Time SACCH struct \> ::=                                 |
|                                                                      |
| \< **TRMIN\_SACCH** : bit (1) \> \-- *Network\'s minimum response    |
| time on SACCH*                                                       |
|                                                                      |
| \< **TRESP\_SACCH**: bit (1) \>; \-- *Network\'s maximum response    |
| time on SACCH*                                                       |
+----------------------------------------------------------------------+
| \< Response Time struct \> ::=                                       |
|                                                                      |
| \< **TRMIN** : bit (6) \>                                            |
|                                                                      |
| \< **TRESP\_MAC\_DTM** : bit (7) \>                                  |
|                                                                      |
| \< **TRESP\_MAC\_Dedicated** : bit (7) \>;                           |
+----------------------------------------------------------------------+
| \< Response Time FLO struct \> ::= \-- *Response times when FLO is   |
| used*                                                                |
|                                                                      |
| \< **TRMIN\_DCH** : bit (6) \>                                       |
|                                                                      |
| \< **TRES\_DCH\_MAC\_DTM** : bit (7) \>                              |
|                                                                      |
| \< **TRESP\_DCH\_MAC\_Dedicated** : bit (7) \>;                      |
+----------------------------------------------------------------------+

Table 9.2.28.2: RADIO BEARER RECONFIGURATION information element details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Activation Time**\
  **The *Activation Time* IE is defined in sub-clause 9.3.1**.

  **RRC State Indicator**\
  This IE is defined in sub-clause 9.3.86.

  **GERAN DRX Cycle Length Coefficient**\
  This IE is defined in sub-clause 9.3.29.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The integrity Check Info IE is included when integrity protection is applied.

  **Integrity Protection Mode Info**\
  This IE is defined in sub-clause 9.3.39. The GERAN does not include this IE unless it is performing an SBSS relocation

  **Ciphering Mode Info**\
  This IE is defined in sub-clause 9.3.14. The GERAN does not include this IE unless it is performing an SBSS relocation and a change in ciphering algorithm.

  **New G-RNTI**\
  This IE assigns a new G-RNTI to the MS. This IE is coded as the *G-RNTI* IE defined in sub-clause 9.3.32.

  **CN Information Info**\
  This IE is defined in sub-clause 9.3.17.

  **GRA Identity**\
  This IE is defined in sub-clause 9.3.30.

  **RAB Information to Reconfigure List** (4 bit field)\
  This field is used to repeat information on each RAB to reconfigure. Range: 0 to maxRABsetup-1, where 0 enables one RAB to be described.

  **RAB Information to Reconfigure**\
  This IE is defined in sub-clause 9.3.76.

  **RB Information to Reconfigure List** (5 bit field)\
  This field is used to repeat information on each RB to reconfigure, where 0 enables one RB to be described. Range : 0 to maxRB-1.

  **RB Information to Reconfigure**\
  This IE is defined in sub-clause 9.3.82.

  **RB Information to Be Affected List** (5 bit field)\
  This field is used to repeat information on each RB to be affected, where 0 enables one RB to be described. Range : 0 to maxRB-1.

  **RB Information to Be Affected**\
  This IE is defined in sub-clause 9.3.81.

  **RB with PDCP Information list** (5 bit field)\
  This field is used to repeat information on each RB with PDCP Information, where 0 enables one RB to be described. . Range: 0 to maxRBallRABs-1

  **Downlink Counter Synchronisation Info struct\
  **This structure contains information about PDCP synchronisation.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.

  **PDCP context relocation info**\
  This IE is defined in sub-clause 9.3.116.

  **Physical Information**\
  The *Physical Channel Configuration* IE is defined in sub-clause 9.3.62.

  **Network Response Times struct\
  **This structure contains information about network response times.

  **TRMIN\_SDCCH (1 bit field)\
  **This field indicates the minimum response time of the network on SDCCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_SDCCH (1 bit field)\
  This field indicates the maximum response time of the network on SDCCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN\_SACCH (1 bit field)\
  **This field indicates the minimum response time of the network on SACCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_SACCH (1 bit field)\
  This field indicates the maximum response time of the network on SACCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN** (6 bit field)\
  This field indicates the minimum response time of the network, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_MAC\_DTM (7 bit field)\
  TRESP\_MAC\_Dedicated (7 bit field)\
  These fields indicate for a given MAC state the maximum response time of the network expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN\_DCH** (6 bit field)\
  This field indicates the minimum response time of the network when FLO is used, expressed as a number of TDMA frames. See 3GPP TS 44.160.

  **TRES\_DCH\_MAC\_DTM** **(7 bit field)\
  TRES\_DCH\_MAC\_Dedicated** **(7 bit field)\
  These fields indicate for a given MAC state the maximum response time of the network when FLO is used, expressed as a number of TDMA frames. See 3GPP TS 44.160.**
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.29 RADIO BEARER RECONFIGURATION COMPLETE

This message is sent from the MS when a RB and/or a physical channel
reconfiguration has been done.

Radio Bearer : SRB2

Direction : MS→ GERAN

Table 9.2.29.1: RADIO BEARER RECONFIGURATION COMPLETE information
elements

+----------------------------------------------------------------------+
| \< RADIO BEARER RECONFIGURATION COMPLETE message content \> ::=      |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Uplink Integrity Protection Activation Info** : \<     |
| Integrity Protection Activation Info IE \> \> }                      |
|                                                                      |
| { 0 \| 1 \< **Mobile Observed Time Difference** : \< Mobile Time     |
| Difference IE \> \> }                                                |
|                                                                      |
| \-- *RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **COUNT-C Activation Time** : \< Activation Time IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Radio Bearer Uplink Ciphering Activation Time Info** : |
| \< RB Activation Time Info IE\> \> }                                 |
|                                                                      |
| { 0 \| 1 \< **Uplink Counter Synchronisation Info** : \< Uplink      |
| Counter Synchronisation Info struct \> \> }                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+
| \< Uplink Counter Synchronisation Info struct \> ::=                 |
|                                                                      |
| { \< **START List** : bit (2) \>                                     |
|                                                                      |
| { \< **CN Domain Identity** : \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **START** : \< START IE \> \> } \* (1+val(START List))            |
|                                                                      |
| { 0 \| 1 \< **RB with PDCP Information List** : bit (5) \>           |
|                                                                      |
| \< **RB with PDCP Information** : \< RB with PDCP Information IE \>  |
| \> \* (1+val(RB with PDCP Information List)) }                       |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.2.29.2: RADIO BEARER RECONFIGURATION COMPLETE information
element details

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **Uplink Integrity Protection Activation Info**\
  This IE contains the time, in terms of RRC sequence numbers, when a new integrity protection configuration shall be activated for the signalling radio bearers. The *Integrity protection activation info* IE is defined in sub-clause 9.3.37.

  **COUNT-C Activation Time**\
  **The *Activation Time* IE is defined in sub-clause 9.3.1**.

  **Radio Bearer Uplink Ciphering Activation Time Info**\
  **This IE is coded as the** *RB activation time info* IE **defined in sub-clause** 9.3.77.

  **Mobile Observed Time Difference**\
  The *Mobile Time Difference* IE is defined in sub-clause 9.3.43.

  **Uplink Counter Synchronisation Info struct**\
  This structure enable to synchronise the Uplink security counters.

  **START List** (2 bit field)\
  START value to be used in this CN domain. This field is the binary representation of the number of RB to be affected. Range : 0 to maxCNdomains-1.

  **CN Domain Identity**\
  **This IE is defined in sub-clause 9.3**.15.

  **START**\
  **This IE is defined in sub-clause 9.3**.102.

  **RB with PDCP Information List** (5 bit field)\
  This field is used to repeat information on each RB to reconfigure, where 0 enables one RB to be described. . Range : 0 to maxRBallRABs-1.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.30 RADIO BEARER RECONFIGURATION FAILURE

This message is sent by MS if the configuration given by GERAN is
unacceptable or if the MS failed to establish the physical channel(s).

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.30.1: RADIO BEARER RECONFIGURATION FAILURE information
elements

+----------------------------------------------------------------------+
| \< RADIO BEARER RECONFIGURATION FAILURE message content \> ::=       |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **RRC Cause** : \< RRC Cause IE \> \>                             |
|                                                                      |
| \< **Failure Cause** : \< Failure Cause and Error Information IE \>  |
| \>                                                                   |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| \-- *RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **Potentially Succesful RB List** : bit (5) \>           |
|                                                                      |
| \< **RB Identity** : \< RB Identity IE \>\> \*(1 + val(Potentially   |
| Succesful RB List) ) }                                               |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.30.2: RADIO BEARER RECONFIGURATION FAILURE information element
details

  ---------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. Integrity Check Info is included if integrity protection is applied.

  **Failure Cause**\
  This *Failure Cause and Error Information* IE is defined in sub-clause 9.3.25.

  **RRC Cause**\
  This *RRC Cause* IE is defined in sub-clause 9.3.94.

  **Potentially Succesful RB List** (5 bit field)\
  This field is the binary representation of the number of RB for which reconfiguration would have succeeded.\
  Range : 0 to maxRB-1.

  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.
  ---------------------------------------------------------------------------------------------------------------

### 9.2.31 RADIO BEARER RELEASE

This message is used by GERAN to release a radio bearer. It can also
include modifications to the configurations of physical channels.

Radio Bearer : SRB2

Direction : GERAN → MS

Table 9.2.31.1: RADIO BEARER RELEASE information elements

+----------------------------------------------------------------------+
| \< RADIO BEARER RELEASE message content \> ::=                       |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction IdentifierIE  |
| \> \>                                                                |
|                                                                      |
| \< **Activation Time** : \< Activation Time IE \> \>                 |
|                                                                      |
| \< **RRC State Indicator** : \< RRC State Indicator IE \> \>         |
|                                                                      |
| \< **GERAN DRX Cycle Length Coefficient** : \< GERAN DRX Cycle       |
| Length Coefficient IE \> \>                                          |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Protection Mode Info** : \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| { 0 \| 1 \< **Ciphering Mode Info** : \< Ciphering Mode Info IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **New G-RNTI** : \< G-RNTI IE \> \> }                    |
|                                                                      |
| *\-- CN information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **Signalling Connection Release Indication** : \< CN     |
| Domain Identity IE\> \> }                                            |
|                                                                      |
| { 0 \| 1 \< **CN Information Info** : \< CN Information Info IE \>   |
| \> }                                                                 |
|                                                                      |
| *\-- GERAN information elements*                                     |
|                                                                      |
| { 0 \| 1 \< **GRA Identity** : \< GRA Identity IE \> \> }            |
|                                                                      |
| *\-- RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **RAB Information to Reconfigure List** : bit (4) \>     |
|                                                                      |
| \< **RAB Information to Reconfigure** : \< RAB Information to        |
| Reconfigure IE \> \> \*(1+val(RAB Information to Reconfigure List))  |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **RB Information to Release List** : bit (5) \>          |
|                                                                      |
| { \< **RB Information to Release** : \< RB Information to Release IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Physical Information** : \< Physical Channel           |
| Configuration IE \> \> }                                             |
|                                                                      |
| 0 \| 1 \< **NETWORK\_RESPONSE\_TIMES** : \< Network Response Times   |
| struct \>\> }                                                        |
|                                                                      |
| }\*(1+val(RB Information to Release List))                           |
|                                                                      |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **RB Information to Be Affected List** : bit (5) \>      |
|                                                                      |
| \< **RB Information to Be Affected** : \< RB Information to Be       |
| Affected IE \> \>\*(1+val(RB Information to Be Affected List)) }     |
|                                                                      |
| { 0 \| 1 \< **Downlink Counter Synchronisation Info :** \< Downlink  |
| Counter Synchronisation info struct \> \> } ! \< Content part error  |
| : bit (\*) = \< no string \> \> }                                    |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+
| \< Downlink Counter Synchronisation Info struct\> ::=                |
|                                                                      |
| \< **RB with PDCP Information List** : bit (5) \>                    |
|                                                                      |
| { { 0 \| 1 \< **RB with PDCP Information** : \< RB with PDCP         |
| Information IE \> \> }                                               |
|                                                                      |
| { 0 \| 1 \< **PDCP context relocation info** : \< PDCP context       |
| relocation info IE \> \> } } \* (1 + val(RB with PDCP Information    |
| List) );                                                             |
+----------------------------------------------------------------------+
| \< Network Response Times struct \> ::=                              |
|                                                                      |
| { 0 \-- *Network\'s response times on SDCCH*                         |
|                                                                      |
| \< **RESPONSE\_TIME\_SDCCH** : \< Response Time SDCCH struct \> \>   |
|                                                                      |
| \| 1 \-- *Network\'s reponse times on the assigned DBPSCH*           |
|                                                                      |
| \< **RESPONSE\_TIME\_SACCH** : \< Response Time SACCH struct \>\>    |
| \-- *Network\'s response time on SACCH*                              |
|                                                                      |
| { 00 \-- *Network\'s response time on FACCH/F*                       |
|                                                                      |
| \-- *i.e. between a request sent on TCH/F or FACCH/F and the         |
| corresponding response sent on FACCH/F*                              |
|                                                                      |
| \< **RESPONSE\_TIME\_FACCH\_F** : \< Response Time struct \>\>       |
|                                                                      |
| \| 01 \< **RESPONSE\_TIME\_FACCH\_H** : \< Response Time struct \>\> |
| \-- *Network\'s reponse time on FACCH/H*                             |
|                                                                      |
| \| 10 \< **RESPONSE\_TIME\_FLO**: \< Response Time FLO struct \> \>  |
| }}; \-- *Network\'s response times with FLO*                         |
+----------------------------------------------------------------------+
| \< Response Time SDCCH struct \> ::=                                 |
|                                                                      |
| \< **TRMIN\_SDCCH** : bit (1) \> \-- *Network\'s minimum response    |
| time on SDCCH*                                                       |
|                                                                      |
| \< **TRESP\_SDCCH**: bit (1) \>; \-- *Network\'s maximum response    |
| time on SDCCH*                                                       |
+----------------------------------------------------------------------+
| \< Response Time SACCH struct \> ::=                                 |
|                                                                      |
| \< **TRMIN\_SACCH** : bit (1) \> \-- *Network\'s minimum response    |
| time on SACCH*                                                       |
|                                                                      |
| \< **TRESP\_SACCH**: bit (1) \>; \-- *Network\'s maximum response    |
| time on SACCH*                                                       |
+----------------------------------------------------------------------+
| \< Response Time struct \> ::=                                       |
|                                                                      |
| \< **TRMIN** : bit (6) \>                                            |
|                                                                      |
| \< **TRESP\_MAC\_DTM** : bit (7) \>                                  |
|                                                                      |
| \< **TRESP\_MAC\_Dedicated** : bit (7) \>;                           |
+----------------------------------------------------------------------+
| \< Response Time FLO struct \> ::= \-- *Response times when FLO is   |
| used*                                                                |
|                                                                      |
| \< **TRMIN\_DCH** : bit (6) \>                                       |
|                                                                      |
| \< **TRES\_DCH\_MAC\_DTM** : bit (7) \>                              |
|                                                                      |
| \< **TRESP\_DCH\_MAC\_Dedicated** : bit (7) \>;                      |
+----------------------------------------------------------------------+

Table 9.2.31.2: RADIO BEARER RELEASE information element details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Activation Time**\
  **The *Activation Time* IE is defined in sub-clause 9.3.1**.

  **RRC State Indicator**\
  This IE is defined in sub-clause 9.3.97.

  **GERAN DRX Cycle Length Coefficient**\
  This IE is defined in sub-clause 9.3.29.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. Integrity Check Info is included if integrity protection is applied.

  **Integrity Protection Mode Info**\
  This IE is defined in sub-clause 9.3.39. The GERAN does not include this IE unless it is performing an SBSS relocation

  **Ciphering Mode Info**\
  This IE is defined in sub-clause 9.3.14. The GERAN does not include this IE unless it is performing an SBSS relocation and a change in ciphering algorithm

  **New G-RNTI**\
  This IE assigns a new G-RNTI to the MS. This IE is coded as the G-RNTI IE defined in sub-clause 9.3.33.

  **Signalling Connection Release Indication**\
  **The *CN Domain Identity* IE is defined in sub-clause 9.3.15.**

  **CN Information Info**\
  This IE is defined in sub-clause 9.3.17.

  **GRA Identity**\
  This IE is defined in sub-clause 9.3.30.

  **RAB Information to Reconfigure List** (4 bit field)\
  This field is used to repeat information on each RAB to reconfigure, where 0 enables one RAB to be described. Range: 0 to maxRABsetup-1.

  **RAB Information to Reconfigure**\
  This IE is defined in sub-clause 9.3.76.

  **RB Information to Release List** (5 bit field)\
  This field is used to repeat information on each RB to reconfigure, where 0 enables one RB to be described. Range: 0 to maxRB-1.

  **RB Information to Release**\
  This IE is defined in sub-clause 9.3.83.

  **RB Information to Be Affected List** (5 bit field)\
  This field is used to repeat information on each RB to be affected, where 0 enables one RB to be described. Range: 0 to maxRB-1.

  **RB Information to Be Affected**\
  This IE is defined in sub-clause 9.3.81.

  **Downlink Counter Synchronisation Info struct\
  **This structure contains information about PDCP synchronisation.

  **RB with PDCP Information List** (5 bit field)\
  This field is used to repeat information on each RB with PDCP Information, where 0 enables one RB to be described. Range: 0 to maxRBallRABs-1.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.

  **PDCP context relocation info**\
  This IE is defined in sub-clause 9.3.116.

  **Physical Information**\
  The *Physical Channel Configuration* IE is defined in sub-clause 9.3.62.

  **Network Response Times struct\
  **This structure contains information about network response times.

  **TRMIN\_SDCCH (1 bit field)\
  **This field indicates the minimum response time of the network on SDCCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_SDCCH (1 bit field)\
  This field indicates the maximum response time of the network on SDCCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN\_SACCH (1 bit field)\
  **This field indicates the minimum response time of the network on SACCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_SACCH (1 bit field)\
  This field indicates the maximum response time of the network on SACCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN** (6 bit field)\
  This field indicates the minimum response time of the network, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_MAC\_DTM (7 bit field)\
  TRESP\_MAC\_Dedicated (7 bit field)\
  These fields indicate for a given MAC state the maximum response time of the network expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN\_DCH** (6 bit field)\
  This field indicates the minimum response time of the network when FLO is used, expressed as a number of TDMA frames. See 3GPP TS 44.160.

  **TRES\_DCH\_MAC\_DTM** **(7 bit field)\
  TRES\_DCH\_MAC\_Dedicated** **(7 bit field)\
  These fields indicate for a given MAC state the maximum response time of the network when FLO is used, expressed as a number of TDMA frames. See 3GPP TS 44.160.**
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.32 RADIO BEARER RELEASE COMPLETE

This message is sent from the MS when radio bearer release has been
completed.

Radio Bearer : SRB2

Direction : MS → GERAN

Table 9.2.32.1: RADIO BEARER RELEASE COMPLETE information elements

+----------------------------------------------------------------------+
| \< RADIO BEARER RELEASE COMPLETE message content \> ::=              |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Uplink Integrity Protection Activation Info** : \<     |
| Integrity Protection Activation Info IE \> \> }                      |
|                                                                      |
| \-- *RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **COUNT-C Activation Time** : \< Activation Time IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Radio Bearer Uplink Ciphering Activation Time Info** : |
| \< RB Activation Time Info IE\> \> }                                 |
|                                                                      |
| { 0 \| 1 \< **Uplink Counter Synchronisation Info** : \< Uplink      |
| Counter Synchronisation Info struct \> \> }                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+
| \< Uplink counter synchronisation Info struct \> ::=                 |
|                                                                      |
| { \< **START List** : bit (2) \>                                     |
|                                                                      |
| { \< **CN Domain Identity** : \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **START** : \< START IE \>) \> } \* (1+val(START List))           |
|                                                                      |
| { 0 \| 1 \< **RB with PDCP Information List** : bit (5) \>           |
|                                                                      |
| \< **RB with PDCP Information** : \< RB with PDCP Information IE \>  |
| \> \* (1+val(RB with PDCP Information List)) }                       |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.2.32.2: RADIO BEARER RELEASE COMPLETE information element
details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **Uplink Integrity Protection Activation Info**\
  This IE contains the time, in terms of RRC sequence numbers, when a new integrity protection configuration shall be activated for the signalling radio bearers. The *Integrity Protection Activation Info* IE is defined in sub-clause 9.3.3. 37

  **COUNT-C Activation Time**\
  **The *Activation Time* IE is defined in sub-clause 9.3.1**.

  **Radio Bearer Uplink Ciphering Activation Time Info**\
  **The** *RB Activation Time Info* IE **is defined in sub-clause** 9.3.77.

  **Uplink Counter Synchronisation Info Struct**\
  This structure enable to synchronise the Uplink security counters.

  **START List** (2 bit field)\
  START value to be used in this CN domain. This field is the binary representation of the number of RB to be affected. Range : 0 to maxCNdomains-1.

  **CN Domain Identity**\
  **This IE is defined in sub-clause 9.3**.15.

  **START**\
  **This IE is defined in sub-clause 9.3**.102.

  **RB with PDCP Information List** (5 bit field)\
  This field is used to repeat information on each RB with PDCP Information, where 0 enables one RB to be described. Range: 0 to maxRBallRABs-1.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.33 RADIO BEARER RELEASE FAILURE

This message is sent by MS if the configuration given by GERAN is
unacceptable or if radio bearer can not be released.

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.33.1: RADIO BEARER RELEASE FAILURE information elements

+----------------------------------------------------------------------+
| \< RADIO BEARER RELEASE FAILURE message content \> ::=               |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **RRC Cause** : \< RRC Cause IE \> \>                             |
|                                                                      |
| \< **Failure Cause** : \< Failure Cause and Error Information IE \>  |
| \>                                                                   |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Potentially Succesful RB List** : bit (5) \>           |
|                                                                      |
| \< **RB Identity** :\< **RB Identity IE \>** \> \*(1 +               |
| val(Potentially Succesful RB List) ) }                               |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.33.2: RADIO BEARER RELEASE FAILURE information element details

  -----------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36.The *Integrity Check Info* IE is included if integrity protection is applied.

  **Failure Cause**\
  The *Failure Cause and Error Information* IE is defined in sub-clause 9.3.25.

  **RRC Cause**\
  This *RRC Cause* IE is defined in sub-clause 9.3.94.

  **Potentially Succesful RB List** (5 bit field)\
  This field is the binary representation of the number of RB for which reconfiguration would have succeeded.\
  Range : 0 to maxRB-1.

  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.
  -----------------------------------------------------------------------------------------------------------------------

### 9.2.34 RADIO BEARER SETUP

This message is sent by GERAN to the MS to establish new radio
bearer(s).

Radio Bearer : SRB2

Direction : GERAN → MS

Table 9.2.34.1: RADIO BEARER SETUP information elements

+----------------------------------------------------------------------+
| \< RADIO BEARER SETUP message content \> ::=                         |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Activation Time** : \< Activation Time IE \> \>                 |
|                                                                      |
| \< **RRC State Indicator** : \< RRC State Indicator IE \> \>         |
|                                                                      |
| \< **GERAN DRX Cycle Length Coefficient** : \< GERAN DRX Cycle       |
| Length Coefficient IE \> \>                                          |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Protection Mode Info** : \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| { 0 \| 1 \< **Ciphering Mode Info** : \< Ciphering Mode Info IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **New G-RNTI** : \< G-RNTI IE \> \> }                    |
|                                                                      |
| \-- *CN information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **CN Information Info** : \< CN Information Info IE \>   |
| \> }                                                                 |
|                                                                      |
| \-- *GERAN information elements*                                     |
|                                                                      |
| { 0 \| 1 \< **GRA identity** : \< GRA identity IE \> \> }            |
|                                                                      |
| \-- *RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **RB Information to Setup List** : bit (3) \>            |
|                                                                      |
| { \< **RB Information to Setup** : \< Signalling RB Information to   |
| Setup IE \> \>                                                       |
|                                                                      |
| { 0 \| 1 \< **Physical Information** : \< Physical Channel           |
| Configuration IE \> \> }                                             |
|                                                                      |
| 0 \| 1 \< **NETWORK\_RESPONSE\_TIMES** : \< Network Response Times   |
| struct \>\> }                                                        |
|                                                                      |
| } \*(1+val(RB Information to Setup List))                            |
|                                                                      |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **RAB Information for Setup List** : bit (4) \>          |
|                                                                      |
| \< **RAB Information for Setup** : \< RAB Information for Setup IE   |
| \> \> \*(1+val(RAB Information for Setup List)) }                    |
|                                                                      |
| { 0 \| 1 \< **RB Information to Be Affected List** : bit (5) \>      |
|                                                                      |
| \< **RB Information to Be Affected** : \< RB Information to Be       |
| Affected IE \> \> \*(1+val(RB Information to Be Affected List)) }    |
|                                                                      |
| { 0 \| 1 \< **Downlink Counter Synchronisation Info :** \< Downlink  |
| Counter Synchronisation info struct \> \> }                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+
| \< Downlink Counter Synchronisation Info struct\> ::=                |
|                                                                      |
| \< **RB with PDCP Information List** : bit (5) \>                    |
|                                                                      |
| { { 0 \| 1 \< **RB with PDCP Information** : \< RB with PDCP         |
| Information IE \> \> }                                               |
|                                                                      |
| { 0 \| 1 \< **PDCP context relocation info** : \< PDCP context       |
| relocation info IE \> \> } } \* (1 + val(RB with PDCP Information    |
| List));                                                              |
+----------------------------------------------------------------------+
| \< Network Response Times struct \> ::=                              |
|                                                                      |
| { 0 \-- *Network\'s response times on SDCCH*                         |
|                                                                      |
| \< **RESPONSE\_TIME\_SDCCH** : \< Response Time SDCCH struct \> \>   |
|                                                                      |
| \| 1 \-- *Network\'s reponse times on the assigned DBPSCH*           |
|                                                                      |
| \< **RESPONSE\_TIME\_SACCH** : \< Response Time SACCH struct \>\>    |
| \-- *Network\'s response time on SACCH*                              |
|                                                                      |
| { 00 \-- *Network\'s response time on FACCH/F*                       |
|                                                                      |
| \-- *i.e. between a request sent on TCH/F or FACCH/F and the         |
| corresponding response sent on FACCH/F*                              |
|                                                                      |
| \< **RESPONSE\_TIME\_FACCH\_F** : \< Response Time struct \>\>       |
|                                                                      |
| \| 01 \< **RESPONSE\_TIME\_FACCH\_H** : \< Response Time struct \>\> |
| \-- *Network\'s reponse time on FACCH/H*                             |
|                                                                      |
| \| 10 \< **RESPONSE\_TIME\_FLO**: \< Response Time FLO struct \> \>  |
| }}; \-- *Network\'s response times with FLO*                         |
+----------------------------------------------------------------------+
| \< Response Time SDCCH struct \> ::=                                 |
|                                                                      |
| \< **TRMIN\_SDCCH** : bit (1) \> \-- *Network\'s minimum response    |
| time on SDCCH*                                                       |
|                                                                      |
| \< **TRESP\_SDCCH**: bit (1) \>; \-- *Network\'s maximum response    |
| time on SDCCH*                                                       |
+----------------------------------------------------------------------+
| \< Response Time SACCH struct \> ::=                                 |
|                                                                      |
| \< **TRMIN\_SACCH** : bit (1) \> \-- *Network\'s minimum response    |
| time on SACCH*                                                       |
|                                                                      |
| \< **TRESP\_SACCH**: bit (1) \>; \-- *Network\'s maximum response    |
| time on SACCH*                                                       |
+----------------------------------------------------------------------+
| \< Response Time struct \> ::=                                       |
|                                                                      |
| \< **TRMIN** : bit (6) \>                                            |
|                                                                      |
| \< **TRESP\_MAC\_DTM** : bit (7) \>                                  |
|                                                                      |
| \< **TRESP\_MAC\_Dedicated** : bit (7) \>;                           |
+----------------------------------------------------------------------+
| \< Response Time FLO struct \> ::= \-- *Response times when FLO is   |
| used*                                                                |
|                                                                      |
| \< **TRMIN\_DCH** : bit (6) \>                                       |
|                                                                      |
| \< **TRES\_DCH\_MAC\_DTM** : bit (7) \>                              |
|                                                                      |
| \< **TRESP\_DCH\_MAC\_Dedicated** : bit (7) \>;                      |
+----------------------------------------------------------------------+

Table 9.2.34.2: RADIO BEARER SETUP information element details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Activation Time**\
  **The *Activation Time* IE is defined in sub-clause 9.3.1**.

  **RRC State Indicator** (2 bit field)\
  This IE is defined in sub-clause 9.3.97.

  **GERAN DRX Cycle Length Coefficient** (3 bit field)\
  This IE is defined in sub-clause 9.3.29.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **Integrity Protection Mode Info**\
  This IE is defined in sub-clause 9.3.39. The GERAN does not include this IE unless it is performing an SBSS relocation

  **Ciphering Mode Info**\
  This IE is defined in sub-clause 9.3.14. The GERAN does not include this IE unless it is performing an SBSS relocation and a change in ciphering algorithm

  **New G-RNTI**\
  This IE assigns a new G-RNTI to the MS. This IE is coded as the G-RNTI IE defined in sub-clause 9.3.32.

  **CN Information Info**\
  This IE is defined in sub-clause 9.3.17.

  **GRA Identity**\
  This IE is defined in sub-clause 9.3.30.

  **Signalling RB Information to Setup List** (3 bit field)\
  This field is the binary representation of the number of SRB to setup. Range : 0 to maxSRBsetup-1.

  **Signalling RB Information to Setup**\
  This IE is present for each SRB to establish. This IE is defined in sub-clause 9.3.101.

  **RAB Information for Setup List** (4 bit field)\
  This field is used to repeat information on each RAB to reconfigure, where 0 enables one RAB to be described. Range: 0 to maxRABsetup-1.

  **RAB Information for Setup**\
  This IE is present for each signalling RAB to establish. This IE is defined in sub-clause 9.3.75.

  **RB Information to Be Affected List** (5 bit field)\
  This field is used to repeat information on each RB to reconfigure, where 0 enables one RB to be described. Range: 0 to maxRB-1.

  **RB Information to Be Affected**\
  This IE is defined in sub-clause 9.3.72.

  **Downlink Counter Synchronisation Info struct\
  **This structure contains information about PDCP synchronisation.

  **RB with PDCP Information List** (5 bit field)\
  This field is used to repeat information on each RB with PDCP Information, where 0 enables one RB to be described. Range: 0 to maxRBallRABs-1.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.

  **PDCP context relocation info**\
  This IE is defined in sub-clause 9.3.116.

  **Network Response Times struct**\
  This structure contains information about network response times.

  **TRMIN\_SDCCH (1 bit field)\
  **This field indicates the minimum response time of the network on SDCCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_SDCCH (1 bit field)\
  This field indicates the maximum response time of the network on SDCCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN\_SACCH (1 bit field)\
  **This field indicates the minimum response time of the network on SACCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_SACCH (1 bit field)\
  This field indicates the maximum response time of the network on SACCH, expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN** (6 bit field)\
  This field indicates the minimum response time of the network, expressed as a number of TDMA frames. See 3GPP TS 44.060.

  **TRESP\_MAC\_DTM (7 bit field)\
  TRESP\_MAC\_Dedicated (7 bit field)\
  These fields indicate for a given MAC state the maximum response time of the network expressed as a number of TDMA frames. See 3GPP TS 44.060.**

  **TRMIN\_DCH** (6 bit field)\
  This field indicates the minimum response time of the network when FLO is used, expressed as a number of TDMA frames. See 3GPP TS 44.160.

  **TRES\_DCH\_MAC\_DTM** **(7 bit field)\
  TRES\_DCH\_MAC\_Dedicated** **(7 bit field)\
  These fields indicate for a given MAC state the maximum response time of the network when FLO is used, expressed as a number of TDMA frames. See 3GPP TS 44.160.**
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.35 RADIO BEARER SETUP COMPLETE

This message is sent by MS to confirm the establishment of the radio
bearer.

Radio Bearer : SRB2

Direction : MS → GERAN

Table 9.2.35.1: RADIO BEARER SETUP COMPLETE information elements

+----------------------------------------------------------------------+
| \< RADIO BEARER SETUP COMPLETE message content \> ::=                |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Uplink Integrity Protection Activation Info** : \<     |
| Integrity Protection Activation Info IE \> \> }                      |
|                                                                      |
| { 0 \| 1 \< **COUNT-C Activation Time** : \< Activation Time : bit   |
| (8) \> \> }                                                          |
|                                                                      |
| { 0 \| 1 \< **Radio Bearer Uplink Ciphering Activation Time info** : |
| \< RB Activation Time info IE \> \> }                                |
|                                                                      |
| { 0 \| 1 \< **Uplink Counter Synchronisation Info** : \< Uplink      |
| Counter Synchronisation Info struct \> \> }                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+
| \< Uplink Counter Synchronisation Info struct \> ::=                 |
|                                                                      |
| { \< **START List** : bit (2) \>                                     |
|                                                                      |
| { \< **CN Domain Identity** : \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **START** : \< START IE \> \> } \* (1 + val(START List) )         |
|                                                                      |
| { 0 \| 1 \< **RB with PDCP Information List** : bit (5) \>           |
|                                                                      |
| \< **RB with PDCP Information** : \< RB with PDCP Information IE \>  |
| \> \* (1 + val(RB with PDCP Information List) ) }                    |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.2.35.2: RADIO BEARER SETUP COMPLETE information element details

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **Uplink Integrity Protection Activation Info**\
  This IE contains the time, in terms of RRC sequence numbers, when a new integrity protection configuration shall be activated for the signalling radio bearers. The Integrity protection activation info IE is defined in sub-clause 9.3.36.

  **COUNT-C Activation Time**\
  **The *Activation Time* IE is defined in sub-clause 9.3.1**.

  **Radio bearer uplink ciphering activation time info**\
  **The** *RB Activation Time Info* IE **is defined in sub-clause** 9.3.77.

  **Uplink Counter Synchronisation Info struct**\
  This structure enables the synchronisation of the Uplink security counters.

  **START List** (2 bit field)\
  START value to be used in this CN domain. This field is the binary representation of the number of RB to be affected. Range : 0 to maxCNdomains-1.

  **CN Domain Identity**\
  **This IE is defined in sub-clause 9.3**.15.

  **START**\
  **This IE is defined in sub-clause 9.3**.102.

  **RB with PDCP Information List** (5 bit field)\
  This field is used to repeat information on each RB with PDCP Information, where 0 enables one RB to be described. Range: 0 to maxRBallRABs-1.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.36 RADIO BEARER SETUP FAILURE

This message is sent by MS, if it does not support the configuration
given by GERAN.

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.36.1: RADIO BEARER SETUP FAILURE information elements

+----------------------------------------------------------------------+
| \< RADIO BEARER SETUP FAILURE message content \> ::=                 |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **RRC Cause** : \< RRC Cause IE \> \>                             |
|                                                                      |
| \< **Failure Cause** : \< Failure Cause and Error Information IE \>  |
| \>                                                                   |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Potentially Succesful RB List** : bit (5) \>           |
|                                                                      |
| \< **RB Identity** : \< **RB Identity IE \>** \>                     |
| \*(1+val(Potentially Succesful RB List)) }                           |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.36.2: RADIO BEARER SETUP FAILURE information element details

  ------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **Failure Cause**\
  The *Failure Cause and Error Information* IE is defined in sub-clause 9.3.25.

  **RRC Cause**\
  This *RRC Cause* IE is defined in sub-clause 9.3.94.

  **Potentially Succesful RB List** (5 bit field)\
  This field is the binary representation of the number of RB for which setup would have succeeded.\
  Range : 0 to maxRB-1.

  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.
  ------------------------------------------------------------------------------------------------------------------------

### 9.2.37 RRC CONNECTION REJECT

The network transmits this message when the requested RRC connection
cannot be accepted.

Radio Bearer : SRB2

Direction : GERAN → MS

Table 9.2.37.1: RRC CONNECTION REJECT information elements

+----------------------------------------------------------------------+
| \< RRC CONNECTION REJECT message content \> ::=                      |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Initial MS Identity** : \< Initial MS Identity IE \> \>         |
|                                                                      |
| \< **RRC** **Rejection Cause** : \< RRC Rejection Cause IE \> \>     |
|                                                                      |
| \< **Wait time** : \< Wait Time IE \> \>                             |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions : 1 bit (\*) = \< no string  |
| \> \> } ;                                                            |
+----------------------------------------------------------------------+

Table 9.2.37.2: RRC CONNECTION REJECT information element details

  ---------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Initial MS Identity**\
  This IE is defined in sub-clause 9.3.35.

  **RRC Rejection Cause**\
  This IE is defined in sub-clause 9.3.89. In this version of specification, the MS ignores the *Rejection Cause* IE.

  **Wait Time**\
  This IE is defined in sub-clause 9.3.112.
  ---------------------------------------------------------------------------------------------------------------------

### 9.2.38 RRC CONNECTION RELEASE

This message is sent by GERAN to release the RRC connection. The message
also releases all radio bearers between the MS and GERAN.

Radio Bearer : SRB 2

Direction : GERAN→MS

Table 9.2.38.1: RRC CONNECTION RELEASE information elements

+----------------------------------------------------------------------+
| \< RRC CONNECTION RELEASE message content \> ::=                     |
|                                                                      |
| { 0 *\-- critical extension escape available*                        |
|                                                                      |
| { \< **RRC Transaction Identifier** : \< RRC Transaction Identifier  |
| IE \> \>                                                             |
|                                                                      |
| \< **RRC Release Cause** : \< Release Cause IE \> \>                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **N308** : bit (3) \> }                                  |
|                                                                      |
| { 0 \| 1 \< **RPLMN Information** : \< RPLMN Information IE \> \>}   |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions : 1 bit (\*) = \< no string  |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+

Table 9.2.38.2: RRC CONNECTION RELEASE information element details

+----------------------------------------------------------------------+
| **RRC Transaction Identifier**\                                      |
| This IE is defined in sub-clause 9.3.98.                             |
+----------------------------------------------------------------------+
| **Integrity Check Info**\                                            |
| This IE is defined in sub-clause 9.3.36. The *Integrity Check Info*  |
| IE is included if integrity protection is applied.                   |
+----------------------------------------------------------------------+
| **N308 (3 bit field)**\                                              |
| This IE is present when MS is in RRC-CELL\_DEDICATED state.\         |
| N308 indicates the Maximum number of retransmissions of the RRC      |
| CONNECTION RELEASE COMPLETE message.                                 |
|                                                                      |
| bit\                                                                 |
| 3 2 1\                                                               |
| 0 0 0 1\                                                             |
| 0 0 1 2\                                                             |
| 0 1 0 3\                                                             |
| 0 1 1 4\                                                             |
| 1 0 0 5\                                                             |
| 1 0 1 6\                                                             |
| 1 1 0 7\                                                             |
| 1 1 1 8                                                              |
+----------------------------------------------------------------------+
| **Release cause**\                                                   |
| This IE is defined in sub-clause 9.3.90.                             |
+----------------------------------------------------------------------+
| **RPLMN Information**\                                               |
| This IE is defined in sub-clause 9.3.93.                             |
+----------------------------------------------------------------------+

### 9.2.39 RRC CONNECTION RELEASE COMPLETE

This message is sent by MS to confirm that the RRC connection has been
released.

Radio Bearer : SRB2

Direction : MS → GERAN

Table 9.2.39.1: RRC CONNECTION RELEASE COMPLETE information elements

+----------------------------------------------------------------------+
| \< RRC CONNECTION RELEASE COMPLETE message content \> ::=            |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Error Indication** : \< Failure Cause and Error        |
| Information IE \> \> }                                               |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
+----------------------------------------------------------------------+

Table 9.2.39.2: RRC CONNECTION RELEASE COMPLETE information element
details

  -----------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied

  **Error Indication**\
  The *Failure Cause and Error Information* IE is defined in sub-clause 9.3.25.
  -----------------------------------------------------------------------------------------------------------------------

### 9.2.40 RRC CONNECTION REQUEST

RRC Connection Request is the first message transmitted by the MS when
setting up an RRC Connection to the network.

Radio Bearer : SRB2

Direction : MS → GERAN

Table 9.2.40.1: RRC CONNECTION REQUEST information elements

+------------------------------------------------------------------------+
| \< RRC CONNECTION REQUEST message content \> ::=                       |
|                                                                        |
| {                                                                      |
|                                                                        |
| \< **Initial MS Identity** : \< Initial MS Identity IE \> \>           |
|                                                                        |
| \< **Establishment Cause : \< Establishment Cause IE \> \>**           |
|                                                                        |
| \< **Protocol Error Indicator : \< Protocol Error Indicator IE \> \>** |
|                                                                        |
| ! \< Content part error : bit (\*) = \< no string \> \> };             |
+------------------------------------------------------------------------+

Table 9.2.40.2: RRC CONNECTION REQUEST information element details

  ------------------------------------------
  **Initial MS Identity**\
  This IE is defined in sub-clause 9.3.35.

  **Establishment Cause**\
  This IE is defined in sub-clause 9.3.21

  **Protocol Error Indicator**\
  This IE is defined in sub-clause 9.3.70.
  ------------------------------------------

### 9.2.41 RRC CONNECTION SETUP

This message is used by the network to accept the establishment of an
RRC connection for an MS, including assignment of signalling link
information and optionally physical channel information.

Radio Bearer : SRB2

Direction : GERAN → MS

Table 9.2.41.1: RRC CONNECTION SETUP information elements

+----------------------------------------------------------------------+
| \< RRC CONNECTION SETUP message content \> ::=                       |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| *\-- MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier :** \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Initial MS Identity** : \< Initial MS Identity IE \> \>         |
|                                                                      |
| \< **Activation Time** : \< Activation Time IE \> \>                 |
|                                                                      |
| \< **New G-RNTI** : \< G-RNTI IE \> \>                               |
|                                                                      |
| \< **RRC State Indicator** : \< RRC State Indicator IE \> \>         |
|                                                                      |
| \< **GERAN DRX Cycle Length Coefficient** : \< GERAN DRX Cycle       |
| Length Coefficient \> \>                                             |
|                                                                      |
| \< **Capability Update Requirement** : \< Capability Update          |
| Requirement IE \> \>                                                 |
|                                                                      |
| *\-- RB information elements*                                        |
|                                                                      |
| { 0 \| 1 \< **Signalling RB Information to Setup list** : bit (3) \> |
|                                                                      |
| \< **Signalling RB Information to Setup** : \< Signalling RB         |
| Information to Setup IE \> \> \*(1+val(Signalling RB Information to  |
| Setup list)) }                                                       |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions : 1 bit (\*) = \< no string  |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+

Table 9.2.41.2: RRC CONNECTION SETUP information element details

  -----------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier** (2 bit field)\
  This IE is defined in sub-clause 9.3.98.

  **Activation Time** (8 bit field)\
  **This IE is defined in sub-clause 9.3**.1.

  **Initial MS Identity**\
  This IE is defined in sub-clause 9.3.35.

  **New G-RNTI**\
  This IE assigns a new G-RNTI to the MS. This IE is coded as the *G-RNTI* IE defined in sub-clause 9.3.32.

  **RRC State Indicator**\
  This IE is defined in sub-clause 9.3.97.

  **GERAN DRX Cycle Length Coefficient**\
  This IE is defined in sub-clause 9.3.29.

  **Capability Update Requirement**\
  This IE is defined in sub-clause 9.3.4.

  **Signalling RB Information to Setup list** (3 bit field)\
  This field is the binary representation of the number of SRB to setup. Range : 0 to maxSRBsetup-1.\
  \
  **Signalling RB Information to Setup**\
  This IE is present for each SRB to establish. This IE is defined in sub-clause 9.3.101.
  -----------------------------------------------------------------------------------------------------------

### 9.2.42 RRC CONNECTION SETUP COMPLETE

This message confirms the establishment of the RRC Connection by the MS.

Radio Bearer : SRB2

Direction : MS → GERAN

Table 9.2.42.1: RRC CONNECTION SETUP COMPLETE information elements

+----------------------------------------------------------------------+
| \< RRC CONNECTION SETUP COMPLETE message content \> ::=              |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **START list** : bit (2) \>                                       |
|                                                                      |
| { \< **CN Domain Identity** : \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **START** : \< START IE \> \> } \*(1+val(START List))             |
|                                                                      |
| { 0 \| 1 \< **MS GERAN Iu mode Radio Access Capability** : \< MS     |
| GERAN Iu mode Radio Access Capability IE \> \> }                     |
|                                                                      |
| \< **Inter-RAT MS Radio Access Capability** : \< Inter-RAT MS Radio  |
| Access Capability struct \> \> }                                     |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+
| \< Inter-RAT MS Radio Access Capability struct \> ::=                |
|                                                                      |
| \< Inter-RAT MS Radio Access Capability Length : bit (15) \>         |
|                                                                      |
| { 0 \| 1 \< **MS GERAN A/Gb mode Radio Access Capability** : \< **MS |
| GERAN A/Gb mode Radio Access Capability** IE \> \> }                 |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability** : \< **UE UTRAN     |
| Radio Access Capability** IE \> \> }                                 |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability Extension** : \< **UE |
| UTRAN Radio Access Capability Extension** IE \> \> }                 |
|                                                                      |
| { 0 \| 1 \< **UE CDMA2000 Radio Access Capability** : \< UE CDMA2000 |
| **Radio Access Capability** IE \> \> }                               |
|                                                                      |
| \< spare bits \>\*\*;                                                |
+----------------------------------------------------------------------+

NOTE: Inter-RAT MS radio access capability are currently included in the
MS radio access capability from 24.008. MS radio access capability
extension is currently not defined.

Table 9.2.42.2:RRC CONNECTION SETUP COMPLETE information element details

  -----------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **START List** (2 bit field)\
  This field is the binary representation of the number of CN domains for which a START value is included.\
  Range : 0 to maxCNdomains-1.

  **CN Domain Identity**\
  **This field is defined in sub-clause** 9.3.15.

  **START**\
  **This field is defined in sub-clause** 9.3.102.

  **Inter-RAT MS Radio Access Capability Length**\
  This field indicates the length of the structure excluding the 15 bits to indicate the length.\
  Range 0 -- 32768.

  **MS GERAN Iu mode Radio Access Capability**\
  **This IE is defined in sub-clause 9.3.45.**

  **MS GERAN A/Gb mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.44.

  **UE UTRAN Radio Access Capability\
  **This IE is defined in sub-clause 9.3.108

  **UE UTRAN Radio Access Capability Extension\
  **This IE is defined in sub-clause 9.3.109.

  **UE CDMA2000 Radio Access Capability**\
  This IE is defined in sub-clause 9.3.110.
  -----------------------------------------------------------------------------------------------------------

### 9.2.43 RRC STATUS

This message is sent to indicate a protocol error.

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.43.1: RRC STATUS information elements

+----------------------------------------------------------------------+
| \< RRC STATUS message content \> ::=                                 |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **Protocol Error Information** : \< Protocol Error Information    |
| IE \> \>                                                             |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Identification of Received Message** : \<              |
| Identification of Received Message struct \> \> }                    |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+
| \< Identification of Received Message struct \> ::=                  |
|                                                                      |
| \< **Received Message Type :** \< Message Type IE \> \>              |
|                                                                      |
| \< **RRC Transaction Identifier :** \< RRC Transaction Identifier IE |
| \> \> ;                                                              |
+----------------------------------------------------------------------+

Table 9.2.43.2: RRC STATUS information element details

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Protocol Error Information**\
  The *Protocol Error Information* IE is defined in sub-clause 9.3.71.

  **Integrity Check Info**\
  The Integrity Check Info IE is defined in sub-clause 9.3.36.\
  The Integrity Check Info IE is included if integrity protection is applied.

  **Identification of Received Message struct**\
  This structure is present if the *Protocol Error Cause* IE in the *Protocol Error Information* IE has any other value than \"CSN.1 violation or encoding error\" or \"Message type non-existent or not implemented\".

  **Received Message Type**\
  The Message Type IE is defined in sub-clause 9.2.1.

  **RRC Transaction Identifier**\
  The RRC Transaction Identifier IE is defined in sub-clause 9.3.98.
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.44 RRC FAILURE INFO

This message is sent between network nodes in order to provide
information about the cause for failure to perform the requested
operation.

Radio Bearer: N/A

Direction: GERAN/UTRAN→ GERAN

Table 9.2.44.1: RRC FAILURE INFO information elements

+----------------------------------------------------------------------+
| \< RRC FAILURE Info message content \> ::=                           |
|                                                                      |
| { \< **Failure cause** : 0011 \>                                     |
|                                                                      |
| \< **Protocol Error Information** : \< Protocol Error Information IE |
| \> \>                                                                |
|                                                                      |
| \| \< **Failure cause** : 0000 \| 0001 \| 0010 \| 01 bit (2) \| 1    |
| bit(3) \> }                                                          |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> ;            |
+----------------------------------------------------------------------+

Table 9.2.44.2: RRC FAILURE INFO information element details

  ----------------------------------------------------------------------------------------------------------------------------------------------------
  **Failure Cause**\
  The *Failure Cause* IE indicates the cause of the failure in order to perform the required RRC procedure. This IE is defined in sub-clause 9.3.24.

  **Protocol Error Information**\
  This IE is defined in sub-clause 9.3.71.
  ----------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.45 SECURITY MODE COMMAND

This message is sent by GERAN to start or reconfigure ciphering and/or
integrity protection parameters.

Radio Bearer : SRB2

Direction : GERAN→MS

Table 9.2.45.1: SECURITY MODE COMMAND information elements

+----------------------------------------------------------------------+
| \< SECURITY MODE COMMAND message content \> ::=                      |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| *\-- MS information elements*                                        |
|                                                                      |
| \< **RRC Transaction Identifier :** \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| \< **Integrity Check Info** : \< Integrity Check Info IE \> \>       |
|                                                                      |
| \< **Security Capability** : \< Security Capability IE \> \>         |
|                                                                      |
| { 0 \| 1 \< **Ciphering Mode Info** : \< Ciphering Mode Info IE \>   |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \< **Integrity Protection Mode Info** : \< Integrity        |
| Protection Mode Info IE \> \> }                                      |
|                                                                      |
| *\-- CN information elements*                                        |
|                                                                      |
| \< **CN Domain Identity : \<** CN Domain Identity IE \> \>           |
|                                                                      |
| *\-- other information elements*                                     |
|                                                                      |
| { 0 \| 1 \< **GSM MS Security Capability** : \< GSM MS Security      |
| Capability IE \> \> }                                                |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions : 1 bit (\*) = \< no string  |
| \> \> } ;                                                            |
+----------------------------------------------------------------------+

Table 9.2.45.2: SECURITY MODE COMMAND information element details

  ------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  The *RRC Transaction Identifier* IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  The *Integrity Check Info* IE is defined in sub-clause 9.3.36.

  **Security Capability**\
  The *Security Capability* IE is defined in sub-clause 9.3.100.

  **Ciphering Mode Info**\
  Only present if ciphering shall be controlled. The *Ciphering Mode Info* IE is defined in sub-clause 9.3.14.

  **Integrity Protection Mode Info**\
  Only present if integrity protection shall be controlled. The *Integrity Protection Mode Info* IE is defined in sub-clause 9.3.39.

  **CN Domain Identity**\
  Indicates which cipher and integrity protection keys are applicable. The *CN Domain Identity* IE is defined in sub-clause 9.3.15.

  **GSM MS Security Capability**\
  **This IE is defined in sub-clause 9.3.33.**
  ------------------------------------------------------------------------------------------------------------------------------------

### 9.2.46 SECURITY MODE COMPLETE

This message is sent by MS to confirm the reconfiguration of ciphering
and/or integrity protection.

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.46.1: SECURITY MODE COMPLETE information elements

+----------------------------------------------------------------------+
| \< SECURITY MODE COMPLETE message content \> ::=                     |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< RRC Transaction Identifier : \< RRC Transaction Identifier IE     |
| \>\>                                                                 |
|                                                                      |
| \< **Integrity Check Info** : \< Integrity Check Info IE \> \>       |
|                                                                      |
| { 0 \| 1 \< **Uplink Integrity Protection Activation Info** : \<     |
| Integrity Protection Activation Info IE \> \> }                      |
|                                                                      |
| { 0 \| 1 \< **Radio Bearer Uplink Ciphering Activation Time Info** : |
| \< RB Activation Time Info IE \> \> }                                |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.46.2: SECURITY MODE COMPLETE information element details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  The *RRC Transaction Identifier* IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  Th *Integrity Check Info* IE is defined in sub-clause 9.3.36.

  **Uplink Integrity Protection Activation Info**\
  The *Integrity Protection Activation Info* IE contains the time, in terms of RRC sequence numbers, when a new integrity protection configuration shall be activated for the signalling radio bearers. The *Integrity Protection Activation Info* IE is defined in sub-clause 9.3.37.

  **Radio Bearer Uplink Ciphering Activation Time Info**\
  **The** *RB Activation Time Info* IE **is defined in sub-clause** 9.3.77.
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.47 SECURITY MODE FAILURE

This message is sent to indicate a failure to act on a received SECURITY
MODE CONTROL message.

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.47.1: SECURITY MODE FAILURE information elements

+----------------------------------------------------------------------+
| \< SECURITY MODE FAILURE message content \> ::=                      |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC Transaction Identifier :** \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| \< **Failure Cause :** \< Failure Cause and Error Information IE \>  |
| \>                                                                   |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.47.2: SECURITY MODE COMPLETE information element details

  ------------------------------------------------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  The *RRC Transaction Identifier* IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  The *Integrity Check Info* IE is defined in sub-clause 9.3.36. Integrity Check Info is included if integrity protection is applied

  **Failure Cause**\
  The *Failure Cause* *and Error Information* IE is defined in sub-clause 9.3.25
  ------------------------------------------------------------------------------------------------------------------------------------

### 9.2.48 SIGNALLING CONNECTION RELEASE

This message is used to notify the MS that its ongoing signalling
connection to a CN domain has been released.

Radio Bearer : SRB 2

Direction : GERAN→ MS

Table 9.2.48.1: SIGNALLING CONNECTION RELEASE information elements

+----------------------------------------------------------------------+
| \< SIGNALLING CONNECTION RELEASE message content \> ::=              |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **CN Domain Identity :** \< CN Domain Identity IE \> \>           |
|                                                                      |
| \< **RRC Transaction Identifier :** \< RRC Transaction Identifier IE |
| \> \>                                                                |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info :** \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extensions : 1 bit (\*) = \< no string  |
| \> \> } ;                                                            |
+----------------------------------------------------------------------+

Table 9.2.48.2: SIGNALLING CONNECTION RELEASE information element
details

  ------------------------------------------------------------------------------------------------------------------------------------
  **CN Domain Identity**\
  The *CN Domain Identity* IE is defined in sub-clause 9.3.15.

  **RRC Transaction Identifier**\
  The *RRC Transaction Identifier* IE is defined in sub-clause 9.3.98.

  **Integrity Check Info**\
  The *Integrity Check Info* IE is defined in sub-clause 9.3.36. Integrity Check Info is included if integrity protection is applied
  ------------------------------------------------------------------------------------------------------------------------------------

### 9.2.49 SIGNALLING CONNECTION RELEASE INDICATION

This message is used by the MS to indicate to GERAN the release of an
existing signalling connection.

Radio Bearer : SRB 2

Direction : MS→GERAN

Table 9.2.49.1: SIGNALLING CONNECTION RELEASE INDICATION information
elements

+----------------------------------------------------------------------+
| \< SIGNALLING CONNECTION RELEASE INDICATION message content \> ::=   |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **CN Domain Identity :** \< CN Domain Identity IE \> \>           |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info :** \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.49.2: SIGNALLING CONNECTION RELEASE INDICATION information
element details

  ----------------------------------------------------------------------------------------------------------------------------------------
  **CN Domain Identity**\
  The *CN Domain Identity* IE is defined in sub-clause 9.3.15.

  **Integrity Check Info**\
  The Integrity Check Info IE is defined in sub-clause 9.3.36. *Integrity Check Info* IE is included if integrity protection is applied.
  ----------------------------------------------------------------------------------------------------------------------------------------

### 9.2.50 (void)

### 9.2.51 SYSTEM INFORMATION 5

This message is the same as the SYSTEM INFORMATION 5 message specified
in 3GPP TS 44.018 but shall not contain:

\- RR management Protocol Discriminator IE.

\- Skip Indicator IE.

\- L2 pseudo length IE

\- System Information Type 5 Message Type IE.

Radio Bearer : SRB 1

Direction : GERAN → MS

### 9.2.52 SYSTEM INFORMATION 5bis

This message is the same as the SYSTEM INFORMATION 5bis message
specified in 3GPP TS 44.018 but shall not contain:

\- RR management Protocol Discriminator IE.

\- Skip Indicator IE.

\- L2 pseudo length IE.

\- System Information Type 5bis Message Type IE.

Radio Bearer : SRB 1

Direction : GERAN → MS

### 9.2.53 SYSTEM INFORMATION 5ter

This message is the same as the SYSTEM INFORMATION 5ter message
specified in 3GPP TS 44.018 but shall not contain:

\- RR management Protocol Discriminator IE.

\- Skip Indicator IE..

\- L2 pseudo length IE.

\- System Information Type 5ter Message Type IE.

Radio Bearer : SRB 1

Direction : GERAN → MS

### 9.2.54 SYSTEM INFORMATION 6

This message is the same as the SYSTEM INFORMATION 6 message specified
in 3GPP TS 44.018 but shall not contain:

\- RR management Protocol Discriminator IE.

\- Skip Indicator IE..

\- L2 pseudo length IE.

\- System Information Type 6 Message Type IE.

Radio Bearer : SRB 1

Direction : GERAN → MS

### 9.2.55 (void)

### 9.2.56 UPLINK DIRECT TRANSFER

This message is used to transfer NAS messages for an existing signalling
connection.

Radio Bearer : SRB3 and SRB4

Direction : MS → GERAN

Table 9.2.56.1: UPLINK DIRECT TRANSFER information elements

+----------------------------------------------------------------------+
| \< UPLINK DIRECT TRANSFER message content \> ::=                     |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **CN Domain Identity :** \< CN Domain Identity IE \> \>           |
|                                                                      |
| \< **NAS Message** : \< NAS Message IE \> \>                         |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \> }                                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.56.2: UPLINK DIRECT TRANSFER information element details

  ----------------------------------------------------------------------------------------------------------------------------------------
  **CN Domain Identity**\
  The *CN Domain Identity* IE is defined in sub-clause 9.3.15.

  **NAS Message**\
  The *NAS Message* IE is defined in sub-clause 9.3.54.

  **Integrity Check Info**\
  The Integrity Check Info IE is defined in sub-clause 9.3.36. *Integrity Check Info* IE is included if integrity protection is applied.
  ----------------------------------------------------------------------------------------------------------------------------------------

### 9.2.57 **GERAN Iu mode DTM REQUEST**

This message is used by the MS to initiate an allocation of SBPSCH(s)
when the MS is in RRC-Cell\_Dedicated state- MAC-Dedicated state.

Radio Bearer : SRB2

Direction : MS→GERAN

Table 9.2.57.1: **GERAN Iu mode DTM REQUEST information** elements

+----------------------------------------------------------------------+
| \< **GERAN Iu mode DTM REQUEST** message content \> ::=              |
|                                                                      |
| {                                                                    |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \>}                                                                  |
|                                                                      |
| \< **START List** : bit (2) \>                                       |
|                                                                      |
| { \< **CN Domain Identity** : \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **START** : \< START IE \> \> } \* (1+val(START List))            |
|                                                                      |
| \< **Iu mode RRC Channel Request Description** : \< Iu mode Channel  |
| Request Description IE \> \>                                         |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.57.2: **GERAN Iu mode DTM REQUEST information** element
details

  ----------------------------------------------------------------------------------------------------------------------------------------------------
  **G-RNTI**\
  This IE is defined in sub-clause 9.3.32.

  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **START List** (2 bit field)\
  START value to be used in this CN domain. This field is the binary representation of the number of RB to be affected. Range : 0 to maxCNdomains-1.

  **CN Domain Identity**\
  **This IE is defined in sub-clause 9.3**.15.

  **START**\
  **This IE is defined in sub-clause 9.3**.102.

  **Iu mode RRC Channel Request Description**\
  This IE is defined in sub-clause 9.3.113.
  ----------------------------------------------------------------------------------------------------------------------------------------------------

### 9.2.58 **GERAN Iu mode DTM REJECT**

This message is used by the GERAN to reject the DTM request when the MS
is in RRC-Cell\_Dedicated state- MAC-Dedicated state.

Radio Bearer : SRB2

Direction : GERAN→MS

Table 9.2.58.1: **GERAN Iu mode DTM REJECT information** elements

+----------------------------------------------------------------------+
| \< **GERAN Iu mode DTM REJECT** message content \> ::=               |
|                                                                      |
| { \< **RRC Transaction Identifier** : \< RRC Transaction Identifier  |
| IE \> \>                                                             |
|                                                                      |
| { 0 \| 1 \< **Integrity Check Info** : \< Integrity Check Info IE \> |
| \>}                                                                  |
|                                                                      |
| \< **Failure Cause** : \< Failure Cause and Error Information IE \>  |
| \>                                                                   |
|                                                                      |
| \< **Wait Indication** : \<Wait Indication IE\>\>                    |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 9.2.58.2: **GERAN Iu mode DTM REJECT information** element details

  ------------------------------------------------------------------------------------------------------------------------
  **Integrity Check Info**\
  This IE is defined in sub-clause 9.3.36. The *Integrity Check Info* IE is included if integrity protection is applied.

  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.

  **Failure Cause**\
  This *Failure Cause and Error Information* IE is defined in sub-clause 9.3.25.

  **Wait Indication**\
  This *Wait Indication* IE is defined in sub-clause 9.3.114.
  ------------------------------------------------------------------------------------------------------------------------

9.3 Information Elements
------------------------

### 9.3.1 Activation Time

The *Activation Time* IE defines the frame number/time at which the
operation/changes caused by the related message shall take effect.

Table 9.3.1.1: *Activation Time* information elements

+----------------------------------------+
| \< Activation Time IE \> ::=           |
|                                        |
| \< **Activation Time** : bit (22) \> ; |
+----------------------------------------+

Table 9.3.1.2: *Activation Time* information element details

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Activation Time** (22 bit field)\
  The Activation Time field defines the frame number/time at which the operation/changes caused by the related message shall take effect. This field is encoded as a binary number.TDMA Frame Number is defined in 3GPP TS 45.002.

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.2 BA List Pref

The purpose of the *BA List Pref* IE is to provide the mobile station
with ARFCN information, which can be used in the cell
selection/reselection procedure. This IE is defined in 3GPP TS 44.018.

### 9.3.3 BA Range

The purpose of the *BA Range* IE is to provide the mobile station with
ARFCN range information which can be used in the cell selection
procedure.

Table 9.3.3.1: *BA Range* information elements

+--------------------------------------------------------------+
| \< BA Range IE \> ::=\                                       |
| \< **BA Range Length** : bit (8) \>                          |
|                                                              |
| \< **BA Range Value** : octet(val(BA Range Length) ) \> \> ; |
+--------------------------------------------------------------+

Table 9.3.3.2: *BA Range* information element details

  ---------------------------------------------------------------------------------------------
  **BA Range Length** (8 bit field)**\
  **This field indicates the length of BA Range value in octets as defined in 3GPP TS 44.018.

  **BA Range Value** (octet string)**\
  **This IE holds the Value part of the *BA Range* IE defined in 3GPP TS 44.018.
  ---------------------------------------------------------------------------------------------

### 9.3.4 Capability Update Requirement

The *Capability Update Requirement* IE indicates to the MS which
specific capabilities to transfer to the network.

Table 9.3.4.1: *Capability Update Requirement* information elements

+----------------------------------------------------------------------+
| \< Capability Update Requirement IE \> ::=\                          |
| \< **Capability Update Requirement length** : bit (4) \>             |
|                                                                      |
| \< **MS GERAN Iu mode radio access capability update requirement** : |
| bit (1) \>                                                           |
|                                                                      |
| \< **MS GERAN A/Gb mode radio access capability update requirement** |
| : bit (1) \>                                                         |
|                                                                      |
| \< **UE radio capability FDD** **capability update requirement** :   |
| bit (1) \>                                                           |
|                                                                      |
| \< **UE radio capability 3,84 McpsTDD** **capability update          |
| requirement** : bit(1) \>                                            |
|                                                                      |
| \< **UE radio capability 1,28 Mcps TDD** **capability update         |
| requirement** : bit (1) \>                                           |
|                                                                      |
| \< **UE CDMA2000 radio access capability update requirement** : bit  |
| (1) \>                                                               |
|                                                                      |
| \< spare bits \>\*\*;                                                |
+----------------------------------------------------------------------+

Table 9.3.4.2: *Capability Update Requirement* information element
details

+----------------------------------------------------------------------+
| **Capability Update Requirement length** (4 bit field)\              |
| This field indicates the number of capability updates requirements   |
| included in this IE in bits. It is encoded as the binary             |
| representation of the amount of capability udpates included. Its     |
| value is 6 (\'0110\') in this version of the protocol.               |
+----------------------------------------------------------------------+
| **MS GERAN Iu mode radio access capability update requirement** (1   |
| bit field)\                                                          |
| **MS GERAN A/Gb mode radio access capability update requirement** (1 |
| bit field)\                                                          |
| **UE radio capability FDD** **capability update requirement** (1 bit |
| field)\                                                              |
| **UE radio capability 3,84 McpsTDD** **capability update             |
| requirement** (1 bit field)\                                         |
| **UE radio capability 1,28 Mcps TDD capability update requirement**  |
| (1 bit field)**\                                                     |
| UE CDMA2000 radio access capability update requirement** (1 bit      |
| field)                                                               |
|                                                                      |
| Each of these fields indicates the update requirement of the         |
| associated radio access capability.                                  |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 1                                                                    |
|                                                                      |
| 0 not required                                                       |
|                                                                      |
| 1 required                                                           |
+----------------------------------------------------------------------+

### 9.3.5 CDMA2000 MS security capability

The CDMA2000 MS security capability IE indicates the MS security
capability for CDMA2000.

### 9.3.6 Cell Channel Description

The purpose of the *Cell Channel Description* IE is to provide the
reference frequency list to be used to decode the mobile allocation
information element.

Table 9.3.6.1: *Cell Channel Description* information elements

+--------------------------------------------------------------+
| \< *Cell Channel Description* IE \> ::=                      |
|                                                              |
| \< ***Cell Channel Description*** **Value :** octet (17) \>; |
+--------------------------------------------------------------+

Table 9.3.6.2: *Cell Channel Description* information element details

  -----------------------------------------------------------------------------------------------------------------------------------
  ***Cell Channel Description*** **Value (17 octet field)**\
  The *Cell Channel Description* Value is coded as the value part of the *Cell Channel Description* IE specified in 3GPP TS 44.018.

  -----------------------------------------------------------------------------------------------------------------------------------

### 9.3.7 Cell Description

The *Cell Description* IE provides a minimum description of a cell, e.g.
to allow the mobile station to use its pre-knowledge about
synchronization.

Table 9.3.7.1: *Cell Description* information elements

  --------------------------------------------------
  \< Cell Description IE \> ::=\
  \< **Cell Description Value** : octet(2) \> \> ;

  --------------------------------------------------

Table 9.3.7.2: *Cell Description* information element details

  -----------------------------------------------------------------------------------------------
  **Cell Description Value** (2 octet field)**\
  **This field indicates the Value part of the *Cell Description* IE defined in 3GPP TS 44.018.

  -----------------------------------------------------------------------------------------------

### 9.3.8 Cell Update Cause

The *Cell Update Cause* IE indicates the cause for peforming a Cell
Update.

Table 9.3.8.1: *Cell Update Cause* information elements

+--------------------------------------------+
| \< Cell Update Cause IE \> ::=             |
|                                            |
| \< **Cell Update Cause** : bit (3) \> \> ; |
+--------------------------------------------+

Table 9.3.8.2: *Cell Update Cause* information element details

+---------------------------------------+
| **Cell Update Cause** (3 bit field)   |
|                                       |
| bit\                                  |
| 3 2 1\                                |
| 0 0 0 cell reselection\               |
| 0 0 1 periodical cell update\         |
| 0 1 0 uplink data transmission\       |
| 0 1 1 paging response\                |
| 1 0 0 radio link failure\             |
| 1 0 1 RLC unrecoverable error\        |
| 1 1 0 Invalid RLC/MAC control message |
|                                       |
| All other values are reserved.        |
+---------------------------------------+

### 9.3.9 Channel Description

The *Channel Description* IE provides a description of an allocable
channel together with its SACCH.

Table 9.3.9.1: *Channel Description* information elements

+----------------------------------------------------+
| \< Channel Description IE \> ::=                   |
|                                                    |
| \< **Channel Description Value :** octet(3) \> \>; |
+----------------------------------------------------+

Table 9.3.9.2: *Channel Description* information element details

  -------------------------------------------------------------------------------------------
  **Channel Description Value\
  **This IE holds the Value part of the *Channel Description* IE defined in 3GPP TS 44.018.

  -------------------------------------------------------------------------------------------

### 9.3.10 Channel Description 2

The *Channel Description 2* IE is to provide a description of an
allocable channel configuration together.

Table 9.3.10.1: *Channel Description 2* information elements

+------------------------------------------------------+
| \< Channel Description 2 IE \> ::=                   |
|                                                      |
| \< **Channel Description 2 Value :** octet(3) \> \>; |
+------------------------------------------------------+

Table 9.3.10.2: *Channel Description 2* information element details

  -------------------------------------------------------------------------------------------
  **Channel Description 2 Value**\
  This IE holds the Value part of the *Channel Description 2* IE defined in 3GPP TS 44.018.

  -------------------------------------------------------------------------------------------

### 9.3.11 Channel Mode

The *Channel Mode* IE gives information of the mode on coding/decoding
and transcoding. The exact mode is determined by the contents of this
field and the channel type.

Table 9.3.11.1: *Channel Mode* information elements

+---------------------------------------------+
| \< Channel Mode IE \> ::=                   |
|                                             |
| \< **Channel Mode Value :** octet(1) \> \>; |
+---------------------------------------------+

Table 9.3.11.2: *Channel Mode* information element details

  ------------------------------------------------------------------------------------
  **Channel Mode** **Value\
  **This IE holds the Value part of the *Channel Mode* IE defined in 3GPP TS 44.018.

  ------------------------------------------------------------------------------------

### 9.3.12 Channel Mode 2

The *Channel Mode 2* field gives information of the mode on
coding/decoding and transcoding.

Table 9.3.12.1: *Channel Mode 2* information elements

+-----------------------------------------------+
| \< Channel Mode 2 IE \> ::=                   |
|                                               |
| \< **Channel Mode 2 Value :** octet(1) \> \>; |
+-----------------------------------------------+

Table 9.3.12.2: *Channel Mode 2* information element details

  --------------------------------------------------------------------------------------
  **Channel Mode 2 Value\
  **This IE holds the value part of the *Channel Mode 2* IE defined in 3GPP TS 44.018.

  --------------------------------------------------------------------------------------

### 9.3.13 Ciphering Algorithm

The *Ciphering Algorithm* IE indicates which type of ciphering algorithm
is used. This field is defined in 3GPP TS 33.102.

Table 9.3.13.1: *Ciphering Algorithm* information elements

+----------------------------------------------+
| \< Ciphering Algorithm IE \> ::=             |
|                                              |
| \< **Ciphering Algorithm** : bit (4) \> \> ; |
+----------------------------------------------+

Table 9.3.13.2: *Ciphering Algorithm* information element details

+---------------------------------------+
| **Ciphering Algorithm** (4 bit field) |
|                                       |
| bit                                   |
|                                       |
| 4 3 2 1                               |
|                                       |
| 0 0 0 0 UEA0 \-- *see 3GPP TS 33.102* |
|                                       |
| 0 0 0 1 UEA1 \-- *see 3GPP TS 33.102* |
|                                       |
| All other values are reserved.        |
+---------------------------------------+

### 9.3.14 Ciphering Mode Info

The *Ciphering Mode Info* IE contains the ciphering specific security
mode control information.

Table 9.3.14.1: *Ciphering Mode Info* information elements

+----------------------------------------------------------------------+
| \< Ciphering Mode Info IE \> ::=                                     |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **Ciphering Mode Command :** 0 \>                                 |
|                                                                      |
| \| \< **Ciphering Mode Command :** 1 \>                              |
|                                                                      |
| { \< **Ciphering Algorithm :** \< Ciphering Algorithm IE \> \>       |
|                                                                      |
| { 0 \| 1 \< **Ciphering Activation Time for DBPSCH :** \<            |
| **Activation Time IE** \> \> }                                       |
|                                                                      |
| { 0 \| 1 \< **RB Downlink Ciphering Activation Time Info :** \< RB   |
| Activation Time Info IE \> \> } }                                    |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 9.3.14.2: *Ciphering Mode Info* information element details

+----------------------------------------------------------------------+
| **Ciphering Mode Command** (1 bit field)                             |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 1                                                                    |
|                                                                      |
| 0 stop ciphering mode                                                |
|                                                                      |
| 1 start/restart ciphering mode                                       |
+----------------------------------------------------------------------+
| **Ciphering Algorithm** (4 bit field)\                               |
| The *Ciphering Algorithm* IE is defined in sub-clause 9.3.12         |
+----------------------------------------------------------------------+
| **Ciphering Activation Time for DBPSCH**\                            |
| The *Activation Time* IE is used for radio bearers mapped on RLC-TM. |
| This IE is defined in sub-clause 9.3.1.                              |
+----------------------------------------------------------------------+
| **RB Downlink Ciphering Activation Time info**\                      |
| The *RB Activation Time Info* IE is used for radio bearers mapped on |
| RLC-AM or RLC-UM. This IE is defiend in sub-clause 9.3.77.           |
+----------------------------------------------------------------------+

### 9.3.15 CN Domain Identity

The *CN* *Domain Identity* IE identifies the type of core network
domain.

Table 9.3.15.1: *CN Domain Identity* information elements

+------------------------------------------+
| \< CN Domain Identity IE \> ::=          |
|                                          |
| \< **CN Domain Identity** : bit (2) \> ; |
+------------------------------------------+

Table 9.3.15.2: *CN Domain Identity* information element details

+--------------------------------------+
| **CN Domain Identity** (2 bit field) |
|                                      |
| bit                                  |
|                                      |
| 2 1                                  |
|                                      |
| 0 0 CS domain                        |
|                                      |
| 0 1 PS domain                        |
|                                      |
| 1 0 Reserved                         |
|                                      |
| 1 1 Reserved.                        |
+--------------------------------------+

### 9.3.16 CN Domain Specific DRX Cycle Length Coefficient

The *CN Domain Specific DRX Cycle Length Coefficient* IE determines the
value of the CN domain specific DRX cycle length coefficient to use in
DRX computations. The discontinuous reception computations determine the
paging blocks to monitor on PCCCH for a specific MS.

Table 9.3.16.1: *CN Domain Specific DRX Cycle Length Coefficient*
information elements

+----------------------------------------------------------------------+
| \< CN Domain Specific DRX Cycle Length Coefficient IE \> ::=         |
|                                                                      |
| \< **CN Domain Specific DRX Cycle Length Coefficient** : bit (2) \>; |
+----------------------------------------------------------------------+

Table 9.3.16.2: *CN Domain Specific DRX Cycle Length Coefficient*
information element details

+----------------------------------------------------------------------+
| **CN Domain Specific DRX Cycle Length Coefficient** (2 bit field)\   |
| This field is the binary representation of the **CN domain specific  |
| DRX cycle length coefficient. Range : 6 to 9.**                      |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 2 1                                                                  |
|                                                                      |
| 0 0 CN domain specific DRX cycle length coefficient = 6              |
|                                                                      |
| 0 1 CN domain specific DRX cycle length coefficient = 7              |
|                                                                      |
| 1 0 CN domain specific DRX cycle length coefficient = 8              |
|                                                                      |
| 1 1 CN domain specific DRX cycle length coefficient = 9              |
+----------------------------------------------------------------------+

### 9.3.17 CN Information Info

The *CN Information Info* IE indicates information about the CN.

Table 9.3.17.1: *CN Information Info* information elements

+----------------------------------------------------------------------+
| \< CN Information info IE \> ::=                                     |
|                                                                      |
| { 0 \| 1 \< **PLMN Identity** : \< PLMN Identity IE \> \> }          |
|                                                                      |
| { 0 \| 1 \< **CN Domain Specific GSM-MAP NAS System Info** : \< NAS  |
| System Information GSM-MAP IE \> \> }                                |
|                                                                      |
| { 0 \| 1 \< **Length of CN Domain Related Information** : bit (2) \> |
|                                                                      |
| { \< **CN Domain Identity :** \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **CN Domain Specific GSM-MAP NAS System Info** : \< NAS System    |
| Information GSM-MAP IE \> \>                                         |
|                                                                      |
| } \*( 1 + val ( Length of CN Domain Related Information ) )          |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 9.3.17.2: *CN Information Info* information element details

  ------------------------------------------------------------------------------------------------------------
  **PLMN Identity**\
  This IE is defined in sub-clause 9.3.63.

  **CN Domain Specific GSM-MAP NAS System Info**\
  The *NAS system information GSM-MAP* IE is defined in sub-clause 9.3.56.

  **Length of CN Domain Related Information** (2 bit field)\
  This field is used to calculate the number of CN domains included in this IE. Range : 0 to MaxCNdomains-1.

  **CN Domain Identity**\
  The *CN Domain Identity* IE is defined in sub-clause 9.3.15.
  ------------------------------------------------------------------------------------------------------------

### 9.3.18 CN Information Info Full

The *CN Information Info Full* IE indicates information about the CN.

Table 9.3.18.1: *CN Information Info Full* information elements

+----------------------------------------------------------------------+
| \< CN Information Info Full IE \> ::=                                |
|                                                                      |
| { 0 \| 1 \< **PLMN Identity** : \< PLMN identity IE \> \> }          |
|                                                                      |
| { 0 \| 1 \< **CN Domain Specific GSM-MAP NAS System Info** : \< NAS  |
| System Information GSM-MAP IE \> \> }                                |
|                                                                      |
| { 0 \| 1 \< **Length Of CN Domain Related Information** : bit (2) \> |
|                                                                      |
| { \< **CN Domain Identity :** \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **CN Common GSM-MAP NAS System Info** : \< NAS System Information |
| GSM-MAP IE \> \>                                                     |
|                                                                      |
| \< **CN Domain Specific DRX Cycle Length Coefficient** : \< CN       |
| Domain Specific DRX Cycle Length Coefficient IE \> \>                |
|                                                                      |
| } \* 1 + val (Length of CN domain related information)               |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 9.3.18.2: *CN Information Info Full* information element details

  ------------------------------------------------------------------------------------------------------------
  **PLMN Identity**\
  This IE is defined in sub-clause 9.3.63.

  **CN Common GSM-MAP NAS System Info\
  **The *NAS System Information GSM-MAP* IE is defined in sub-clause 9.3.56.

  **CN Domain Specific GSM-MAP NAS System Info**\
  The *NAS System Information GSM-MAP* IE is defined in sub-clause 9.3.56.

  **Length Of CN Domain Related Information** (2 bit field)\
  This field is used to calculate the number of CN domains included in this IE. Range : 0 to MaxCNdomains-1.

  **CN Domain Identity**\
  The CN Domain Identity IE is defined in sub-clause 9.3.15.

  **CN Domain Specific DRX Cycle Length Coefficient**\
  The ***CN Domain Specific DRX Cycle Length Coefficient*** IE is defined in sub-clause 9.3.16.
  ------------------------------------------------------------------------------------------------------------

### 9.3.19 DBPSCH Description

The *DBPSCH Description* IE describes dedicated physical resources.

Table 9.3.19.1: *DBPSCH Description* information elements

+----------------------------------------------------------------------+
| \< DBPSCH Description IE \> ::=                                      |
|                                                                      |
| { \-- Common parameters                                              |
|                                                                      |
| { 0 \| 1 \< **Starting Time :** \< Starting Time IE \> \> }          |
|                                                                      |
| { 0 \| 1 \-- Conditional on presence of Mobile Allocation after time |
| or before time                                                       |
|                                                                      |
| \< **Cell Channel Description :** \< Cell Channel Description IE \>  |
| \> }                                                                 |
|                                                                      |
| { 0 \| 1 \-- Conditional on presence of Frequency Hopping in         |
| Description of the channel IEs                                       |
|                                                                      |
| { 00 \< **Frequency Short List after time** : \< Frequency Short     |
| List IE \> \>                                                        |
|                                                                      |
| \| 01 \< **Frequency List after time** : \< Frequency List IE \> \>  |
|                                                                      |
| \| 10 \< ***Frequency Channel Sequence after time** :* \< Frequency  |
| Channel Sequence IE \> \>                                            |
|                                                                      |
| \| 11 \< ***Mobile Allocation after time** :* \< Mobile Allocation   |
| IE \> \> }}                                                          |
|                                                                      |
| { 0 \| 1 \-- Conditional on Starting Time and at least one Channel   |
| Description before time                                              |
|                                                                      |
| {00 \< **Frequency Short List before time** : \< Frequency Short     |
| List IE \> \>                                                        |
|                                                                      |
| \| 01 \< **Frequency List before time** : \< Frequency List IE \> \> |
|                                                                      |
| \| 10 \< ***Frequency Channel Sequence before time** :* \< Frequency |
| Channel Sequence IE \> \>                                            |
|                                                                      |
| \| 11 \< ***Mobile Allocation before time** :* \< Mobile Allocation  |
| IE \> \> }}                                                          |
|                                                                      |
| { 0 \| 1 \-- Conditional, not used for Handover                      |
|                                                                      |
| \< **Power Command** : \< Power Command IE \> \>}                    |
|                                                                      |
| { 0 \| 1 \-- Conditional, used for Handover                          |
|                                                                      |
| \<**Handover struct** : \<Handover struct\>\>}                       |
|                                                                      |
| \-- Individual parameters                                            |
|                                                                      |
| { 00 \< **TCH** : \< TCH struct\> \>                                 |
|                                                                      |
| \| 01 \< **PDTCH** : \< PDTCH struct\> \>                            |
|                                                                      |
| \| 10 \< **FLO** : \< FLO struct \> \>                               |
|                                                                      |
| ! \< Message escape : { 11 } bit\*\* = \< no string \> \> }          |
|                                                                      |
| \-- Reserved for future use                                          |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+
| \< TCH struct \> ::=                                                 |
|                                                                      |
| {                                                                    |
|                                                                      |
| { 0 \| 1 \< **MultiRate Configuration :** \< MultiRate Configuration |
| IE \> \> }                                                           |
|                                                                      |
| \-- Description of the first channel                                 |
|                                                                      |
| \< **Description of the first channel after time :** \< Channel      |
| Description 2 IE\> \>                                                |
|                                                                      |
| { 0 \| 1 \< **Description of the First Channel before time :** \<    |
| Channel Description 2 IE\> \> }                                      |
|                                                                      |
| { 0 \| 1 \< **Mode of the Channel Set 1 :** \< Channel Mode IE \> \> |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Mode of the Channel Set 2 :** \< Channel Mode IE \> \> |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Mode of the Channel Set 3 :** \< Channel Mode IE \> \> |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Mode of the Channel Set 4 :** \< Channel Mode IE \> \> |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Mode of the Channel Set 5 :** \< Channel Mode IE \> \> |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Mode of the Channel Set 6 :** \< Channel Mode IE \> \> |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Mode of the Channel Set 7 :** \< Channel Mode IE \> \> |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Mode of the Channel Set 8 :** \< Channel Mode IE \> \> |
| }                                                                    |
|                                                                      |
| \-- Description of the second channel                                |
|                                                                      |
| { 0 \| 1 \< **Description of the Second Channel before time :** \<   |
| Channel Description IE \> \> }                                       |
|                                                                      |
| { 0 \| 1 \< **Description of the Second Channel after time** : \<    |
| Channel Description IE \> \> }                                       |
|                                                                      |
| { 0 \| 1 \< **Mode of the Second Channel :** \< Channel Mode 2 IE \> |
| \> }                                                                 |
|                                                                      |
| \-- Conditional on value in Channel Description                      |
|                                                                      |
| { 0 \| 1 \-- Conditional on the value of Channel Description IE      |
|                                                                      |
| \< **Description of the multislot configuration :** \< Multislot     |
| Allocation IE \> \> }                                                |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+
| \< PDTCH struct \> ::=                                               |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **RRC** **Packet Uplink Assignment** 2: \< RRC Packet Uplink      |
| Assignment 2 IE\> \>                                                 |
|                                                                      |
| \< **RRC Packet Downlink Assignment** 2: \< RRC Packet Downlink      |
| Assignment 2 IE\> \>                                                 |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+
| \< Handover struct \> ::=                                            |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **Handover Reference :** \< Handover Reference IE \> \>           |
|                                                                      |
| \< **Power Command And Access Type** : \< Power Command And Access   |
| Type IE \> \>                                                        |
|                                                                      |
| { 0 \| 1 \< **Dynamic ARFCN Mapping** : \< Dynamic ARFCN Mapping IE  |
| \> \>}                                                               |
|                                                                      |
| { 0 \| 1 \< **Synchronization Indication** : \< Synchronization      |
| Indication IE \> \>                                                  |
|                                                                      |
| { 0 \| 1 \-- Conditional on Synchronization Indication value         |
|                                                                      |
| { 0 \< **Real Time Difference** : \< Time Difference IE \> \>        |
|                                                                      |
| \| 1 \< **Timing Advance** : \< Timing Advance IE \> \> } } }        |
|                                                                      |
| \-- Description of the cell                                          |
|                                                                      |
| \< **Cell Description** : \< Cell Description IE \> \>               |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+
| \< FLO struct \> ::=                                                 |
|                                                                      |
| {                                                                    |
|                                                                      |
| \-- *Conditional, present in Release 6, Channel Mode IE and Channel  |
| Mode 2 IE not used*                                                  |
|                                                                      |
| { 0 \| 1 \< **FLO Basic Physical Channels Parameters** : \< FLO      |
| Basic Physical Channels Parameters struct\> \> }                     |
|                                                                      |
| \< **DL**\_**TIMESLOT\_ALLOCATION :** bit (8) \> \-- *Downlink       |
| timeslot allocation*                                                 |
|                                                                      |
| {                                                                    |
|                                                                      |
| { 0 \| 1 \< **DL TrCH information common for all transport           |
| channels** : \< DL TrCH                                              |
|                                                                      |
| Information Common For All Transport Channels IE\> \> }              |
|                                                                      |
| { 0 \| 1 \< **Deleted TrCH information list** : bit (3) \>           |
|                                                                      |
| { \< **Deleted UL TrCH information** : \< Deleted DL TrCH            |
| Information IE \> \>                                                 |
|                                                                      |
| } }\*(1 + val(Deleted TrCH information list) )                       |
|                                                                      |
| { 0 \| 1 \< **Added or Reconfigured DL TrCH information list** : bit |
| (3) \>                                                               |
|                                                                      |
| { \< **Added or Reconfigured DL TrCH information** : \< Added or     |
| Reconfigured DL TrCH Information IE \> \> } } \*(1 + val( Added or   |
| Reconfigured DL TrCH information list ) )                            |
|                                                                      |
| } \* (N) \-- *where N is the amount of downlink timeslots (i.e.      |
| amount of \'1\'s) assigned in the*                                   |
|                                                                      |
| \-- *DL\_TIMESLOT\_ALLOCATION*                                       |
|                                                                      |
| { 0 \-- *Same uplink timeslot allocation as the downlink timeslot    |
| allocation provided in*                                              |
|                                                                      |
| \-- *DL\_TIMESLOT\_ALLOCATION*                                       |
|                                                                      |
| \| 1 \< **UL**\_**TIMESLOT\_ALLOCATION :** bit (8) \> }              |
|                                                                      |
| {                                                                    |
|                                                                      |
| { 0 \| 1 \< **UL TrCH information common for all transport           |
| channels** : \< UL TrCH                                              |
|                                                                      |
| Information Common For All Transport Channels IE\> \> }              |
|                                                                      |
| { 0 \| 1 \< **Deleted TrCH Information List** : bit (3) \>           |
|                                                                      |
| { \< **Deleted UL TrCH Information** : \< Deleted UL TrCH            |
| Information IE \> \>                                                 |
|                                                                      |
| } } \*(1 + val(Deleted TrCH Information List) )                      |
|                                                                      |
| { 0 \| 1 \< **Added or Reconfigured UL TrCH Information List** : bit |
| (3) \>                                                               |
|                                                                      |
| { \< **Added or Reconfigured UL TrCH Information** : \< Added or     |
| Reconfigured UL TrCH Information IE \> \> } } \*(1 + val( Added or   |
| Reconfigured UL TrCH Information List ) )                            |
|                                                                      |
| } \* (M) \-- *where M is the amount of uplink timeslots (i.e. amount |
| of \'1\'s) assigned in the*                                          |
|                                                                      |
| \-- *UL\_TIMESLOT\_ALLOCATION, if present, else in the               |
| DL\_TIMESLOT\_ALLOCATION*                                            |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+
| \< FLO Basic Physical Channels Parameters struct \> ::=              |
|                                                                      |
| \< **Interleaving** : \< Interleaving IE \> \>                       |
|                                                                      |
| \< **Mode** : \<Mode IE \> \>                                        |
|                                                                      |
| \< **Modulation** : \<Modulation IE \> \>;                           |
+----------------------------------------------------------------------+

Table 9.3.19.2: *DBPSCH Description* information element details

+----------------------------------------------------------------------+
| **Handover struct**\                                                 |
| This structure defines the physical parameters when handover is      |
| performed.                                                           |
+----------------------------------------------------------------------+
| **Cell Description**\                                                |
| This IE is defined in sub-clause 9.3.7.                              |
+----------------------------------------------------------------------+
| **Handover Reference**\                                              |
| This IE is defined in sub-clause 9.3.4                               |
+----------------------------------------------------------------------+
| **Power Command And Access Type**\                                   |
| This IE is defined in sub-clause 9.3.65                              |
+----------------------------------------------------------------------+
| **Synchronization Indication**\                                      |
| This IE is defined in sub-clause 9.3.104                             |
+----------------------------------------------------------------------+
| **Frequency Short List after time**\                                 |
| The *Frequency Short List* IE is defined in sub-clause 9.3.28. This  |
| IE is conditional on presence of the frequency hopping in either     |
| *Channel Description* IE or *Channel Description 2* IE, as indicated |
| in 3GPP TS 44.018.                                                   |
+----------------------------------------------------------------------+
| **Real Time Difference**\                                            |
| The *Time Difference* IE is defined in sub-clause 9.3.105. This IE   |
| is conditional on value of the *Synchronization Indication* IE, as   |
| indicated in 3GPP TS 44.018.                                         |
+----------------------------------------------------------------------+
| **Timing Advance**\                                                  |
| This IE is defined in sub-clause 9.3.106. This IE is defined in      |
| sub-clause 9.3.93. This IE is conditional on value of the            |
| *Synchronization Indication* IE, as indicated in 3GPP TS 44.018.     |
+----------------------------------------------------------------------+
| **Frequency Short List before time**\                                |
| The *Frequency Short List* IE is defined in sub-clause 9.3.28. This  |
| IE is conditional on presence of the *Starting Time* IE, as          |
| indicated in 3GPP TS 44.018.                                         |
+----------------------------------------------------------------------+
| **Dynamic ARFCN Mapping**\                                           |
| This IE is defined in sub-clause 9.3.20                              |
+----------------------------------------------------------------------+
| **Description of the First Channel after time**\                     |
| The *Channel Description* *2* IE is defined in sub-clause 9.3.10.    |
+----------------------------------------------------------------------+
| **Power Command**\                                                   |
| This IE is defined in sub-clause 9.3.64                              |
+----------------------------------------------------------------------+
| **Frequency List after time**\                                       |
| The *Frequency List* IE is defined in sub-clause 9.3.27. This IE is  |
| conditional on presence of the frequency hopping in either *Channel  |
| Description* IE or *Channel Description 2* IE, as indicated in       |
| 3GPP TS 44.018.                                                      |
+----------------------------------------------------------------------+
| ***Mobile Allocation after time***\                                  |
| The *Mobile Allocation* IE is defined in sub-clause 9.3.42. The      |
| *Mobile Allocation after time* IE is conditional on presence of the  |
| frequency hopping in either *Channel Description* IE or *Channel     |
| Description 2* IE, as indicated in 3GPP TS 44.018.                   |
+----------------------------------------------------------------------+
| **Cell Channel Description**\                                        |
| This IE is defined in sub-clause 9.3.6. This IE is conditional on    |
| presence of either *Mobile Allocation before time* or *Mobile        |
| Allocation after time* IE, as indicated in 3GPP TS 44.018.           |
+----------------------------------------------------------------------+
| **Description of the Multislot Configuration**\                      |
| The *Multislot Allocation* IE is defined in sub-clause 9.3.53. .     |
+----------------------------------------------------------------------+
| **Mode of the Channel Set X**\                                       |
| The *Channel Mode* IE is defined in sub-clause 9.3.11. The channe    |
| lmode is defined for the channel set X, where X has a range from 1   |
| to 8.                                                                |
+----------------------------------------------------------------------+
| **Description of the Second Channel after time**\                    |
| The *Channel Description* IE is defined in sub-clause 9.3.9.         |
+----------------------------------------------------------------------+
| **Mode of the Second Channel**\                                      |
| The *Channel Mode2* IE is defined in sub-clause 9.3.12.              |
+----------------------------------------------------------------------+
| **Starting Time**\                                                   |
| This IE is defined in sub-clause 9.3.103.                            |
+----------------------------------------------------------------------+
| **Frequency List before time**\                                      |
| The *Frequency List* IE is defined in sub-clause 9.3.27. The         |
| *Frequency List before time* IE is conditional on presence of the    |
| *Starting Time* IE, as indicated in 3GPP TS 44.018.                  |
+----------------------------------------------------------------------+
| ***Frequency Channel Sequence before time***\                        |
| The *Frequency Channel Sequence* IE is defined in sub-clause 9.3.26. |
| The *Frequency Channel Sequence before time* IE is conditional on    |
| presence of the *Starting Time* IE, as indicated in 3GPP TS 44.018.  |
+----------------------------------------------------------------------+
| ***Mobile Allocation before time***\                                 |
| The *Mobile Allocation* IE is defined in sub-clause 9.3.42. This IE  |
| is conditional on presence of the *Starting Time* IE, as indicated   |
| in 3GPP TS 44.018.                                                   |
+----------------------------------------------------------------------+
| **Description of the First Channel before time**\                    |
| The *Channel Description 2* IE is defined in sub-clause 9.3.10.      |
+----------------------------------------------------------------------+
| **Description of the Second Channel before time**\                   |
| The *Channel Description* IE is defined in sub-clause 9.3.9.         |
+----------------------------------------------------------------------+
| **MultiRate Configuration**\                                         |
| This IE is defined in sub-clause 9.3.52.                             |
+----------------------------------------------------------------------+
| **RRC** **Packet Uplink Assignment**\                                |
| This IE is defined in sub-clause 9.3.96                              |
+----------------------------------------------------------------------+
| **RRC** **Packet Downlink Assignment**\                              |
| This IE is defined in sub-clause 9.3.95                              |
+----------------------------------------------------------------------+
| **Description of the** **Uplink Packet Channel Assignment2**\        |
| The *RRC Packet Uplink Assignment* IE is defined in sub-clause       |
| 9.3.96a.                                                             |
+----------------------------------------------------------------------+
| **Description of the** **Downlink Packet Channel Assignment2**\      |
| The *RRC Packet Downlink Assignment* IE is defined in sub-clause     |
| 9.3.95a.                                                             |
+----------------------------------------------------------------------+
| **FLO Basic Physical Channels Parameters** struct\                   |
| This structure defines the basic physical channel parameters when    |
| FLO is used.                                                         |
+----------------------------------------------------------------------+
| **Interleaving** (2 bit field )\                                     |
| This IE is defined in sub-clause 9.3.118.                            |
+----------------------------------------------------------------------+
| Mode (2 bit field)\                                                  |
| This IE is defined in sub-clause 9.3.119.                            |
+----------------------------------------------------------------------+
| Modulation (2 bit field)\                                            |
| This IE is defined in sub-clause 9.3.120.                            |
+----------------------------------------------------------------------+
| **FLO struct**\                                                      |
| This structure defines all the TrCHs parameters when FLO is          |
| configured for each timeslot.                                        |
+----------------------------------------------------------------------+
| **DL\_TIMESLOT\_ALLOCATION** (8 bit field)\                          |
| This information field indicates the assigned downlink DBPSCH(s).    |
| Bit 8 indicates the status of timeslot 0, bit 7 indicates the status |
| of timeslot 1, etc. At least one timeslot must be assigned.          |
|                                                                      |
| 0 Timeslot is not assigned\                                          |
| 1 Timeslot is assigned                                               |
+----------------------------------------------------------------------+
| **UL\_TIMESLOT\_ALLOCATION** (8 bit field)\                          |
| This information field indicates the assigned uplink DBPSCH(s). Bit  |
| 8 indicates the status of timeslot 0, bit 7 indicates the status of  |
| timeslot 1, etc. At least one timeslot must be assigned.             |
|                                                                      |
| 0 Timeslot is not assigned\                                          |
| 1 Timeslot is assigned                                               |
+----------------------------------------------------------------------+
| UL TrCH Information Common For All Transport Channels\               |
| The IE *UL TrCH Information Common For All Transport Channels* is    |
| defined in sub-clause 9.3.134.                                       |
+----------------------------------------------------------------------+
| Deleted TrCH Information List (3 bit field)\                         |
| This field is used to repeat information on each TrCH to be deleted, |
| where 0 enables one TrCH to be described. Range: 0 to maxTrCH-1.     |
+----------------------------------------------------------------------+
| Deleted UL TrCH Information\                                         |
| This IE is defined in sub-clause 9.3.124.                            |
+----------------------------------------------------------------------+
| Added or Reconfigured UL TrCH Information List (3 bit field)\        |
| This field is used to repeat information on each TrCH to be added or |
| reconfigured in UL, where 0 enables one TrCH to be described. Range: |
| 0 to maxTrCH-1.                                                      |
+----------------------------------------------------------------------+
| Added or Reconfigured UL TrCH information\                           |
| The IE *Added or Reconfigured UL TrCH Information* is defined in     |
| sub-clause 9.3.122.                                                  |
+----------------------------------------------------------------------+
| DL TrCH Information Common For All Transport Channels\               |
| The IE *DL TrCH Information Common For All Transport Channels* is    |
| defined in sub-clause 9.3.125.                                       |
+----------------------------------------------------------------------+
| Deleted DL TrCH Information\                                         |
| This IE is defined in sub-clause 9.3.123.                            |
+----------------------------------------------------------------------+
| Added or Reconfigured DL TrCH Information list (3 bit field)\        |
| This field is used to repeat information on each TrCH to be added or |
| reconfigured in DL, where 0 enables one TrCH to be described. Range: |
| 0 to maxTrCH-1.                                                      |
+----------------------------------------------------------------------+
| Added or Reconfigured DL TrCH information\                           |
| The IE *Added or Reconfigured DL TrCH Information* is defined in     |
| sub-clause 9.3.121.                                                  |
+----------------------------------------------------------------------+

### 9.3.20 Dynamic ARFCN Mapping

The purpose of the *Dynamic ARFCN Mapping* IE is to provide information
on ARFCN mapping to physical frequencies (see 3GPP TS 45.005). This IE
is coded as defined in 3GPP TS 44.018.

### 9.3.21 Establishment Cause

The *Establishment Cause* IE defines the cause for an RRC connection
establishment request.

Table 9.3.21.1: *Establishment Cause* information elements

+----------------------------------------------+
| \< Establishment Cause IE \> ::=             |
|                                              |
| \< **Establishment Cause** : bit (5) \> \> ; |
+----------------------------------------------+

Table 9.3.21.2: *Establishment Cause* information element details

+-------------------------------------------------+
| **Establishment Cause** (5 bit field)           |
|                                                 |
| bit\                                            |
| 5 4 3 2 1\                                      |
| 0 0 0 0 0 Originating Conversational Call\      |
| 0 0 0 0 1 Originating Streaming Call\           |
| 0 0 0 1 0 Originating Interactive Call\         |
| 0 0 0 1 1 Originating Background Call\          |
| 0 0 1 0 0 Originating Subscriber traffic Call\  |
| 0 0 1 0 1 Terminating Conversational Call\      |
| 0 0 1 1 0 Terminating Streaming Call\           |
| 0 0 1 1 1 Terminating Interactive Call\         |
| 0 1 0 0 0 Terminating Background Call\          |
| 0 1 0 0 1 Emergency Call\                       |
| 0 1 0 1 0 Inter-RAT cell re-selection\          |
| 0 1 0 1 1 Inter-RAT cell change order\          |
| 0 1 1 0 0 Registration\                         |
| 0 1 1 0 1 Detach\                               |
| 0 1 1 1 0 Originating High Priority Signalling\ |
| 0 1 1 1 1 Originating Low Priority Signalling\  |
| 1 0 0 0 0 Call re-establishment\                |
| 1 0 0 0 1 Terminating High Priority Signalling\ |
| 1 0 0 1 0 Terminating Low Priority Signalling\  |
| 1 0 0 1 1 Terminating -- cause unknown\         |
| 1 0 1 0 0 Inter-mode cell re-selection          |
+-------------------------------------------------+

### 9.3.22 Expiration Time Factor

The *Expiration Time Factor* IE defines the validity of physical channel
information.

Table 9.3.22.1: *Expiration Time Factor* information elements

+-------------------------------------------------+
| \< Expiration Time Factor IE \> ::=             |
|                                                 |
| \< **Expiration Time Factor** : bit (3) \> \> ; |
+-------------------------------------------------+

Table 9.3.22.2: *Expiration Time Factor* information element details

+------------------------------------------+
| **Expiration Time Factor** (3 bit field) |
|                                          |
| bit\                                     |
| 3 2 1\                                   |
| 0 0 0 2 times\                           |
| 0 0 1 4 times\                           |
| 0 1 0 8 times\                           |
| 0 1 1 16 times\                          |
| 1 0 0 32 times\                          |
| 1 0 1 64 times\                          |
| 1 1 0 128 times\                         |
| 1 1 1 256 times                          |
+------------------------------------------+

### 9.3.23 Extension

The *Extension IE* indicates possible extension for empty choice
branches.

Table 9.3.23.1: *Extension* information elements

+------------------------+
| \< Extension IE \> ::= |
|                        |
| null;                  |
+------------------------+

### 9.3.24 Failure Cause

The *Failure Cause* IE indicates the cause of the failure in order to
perform the required RRC procedure.

Table 9.3.24.1: *Failure Cause* information elements

+----------------------------------------+
| \< Failure Cause IE \> ::=             |
|                                        |
| \< **Failure Cause** : bit (4) \> \> ; |
+----------------------------------------+

Table 9.3.24.2: *Failure Cause* information element details

+---------------------------------------------------+
| **Failure Cause** (4 bit field)                   |
|                                                   |
| bit                                               |
|                                                   |
| 4 3 2 1                                           |
|                                                   |
| 0 0 0 0 configuration unsupported                 |
|                                                   |
| 0 0 0 1 physical channel failure                  |
|                                                   |
| 0 0 1 0 incompatible simultaneous reconfiguration |
|                                                   |
| 0 0 1 1 protocol error                            |
|                                                   |
| 0 1 0 0 compressed mode runtime error             |
|                                                   |
| 0 1 0 1 cell reselection                          |
|                                                   |
| 0 1 1 0 invalid configuration                     |
|                                                   |
| 0 1 1 1 configuration incomplete                  |
|                                                   |
| 1 0 0 0 unsupported measurement                   |
|                                                   |
| 1 0 0 1 Inter-mode Protocol Error                 |
|                                                   |
| All others values are reserved                    |
+---------------------------------------------------+

### 9.3.25 Failure Cause and Error Information

The *Failure Cause and Error Information* IE indicates the cause for
failure to perform the requested procedure.

Table 9.3.25.1: *Failure Cause and Error Information* information
elements

+----------------------------------------------------------------------+
| \< Failure Cause and Error Information IE \> ::=\                    |
| { \< **Failure Cause :** 0011\>                                      |
|                                                                      |
| \< **Protocol Error Information :** \< Protocol Error Information IE |
| \> \>                                                                |
|                                                                      |
| \| \< **Failure cause** : 0000 \| 0001 \| 0010 \| 01 bit (2) \| 1    |
| bit (3) \> } ;                                                       |
+----------------------------------------------------------------------+

Table 9.3.25.2: *Failure Cause and Error Information* information
element details

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Failure Cause**\
  The *Failure Cause* IE is defined in sub-clause 9.3.24.

  **Protocol Error Information**\
  The IE indicates information about the protocol error when the IE \"*Failure Cause*\" has the value \"Protocol error\". This IE is defined in sub-clause 9.3.71.
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.26 Frequency Channel Sequence

The purpose of the *Frequency Channel Sequence* IE is to provide the
absolute radio frequency channel numbers used in the mobile hopping
sequence. This information element shall only be used for radio
frequency channels in the primary GSM band (see 3GPP TS 45.005).

Table 9.3.26.1: *Frequency Channel Sequence* information elements

+---------------------------------------------------------------+
| \< Frequency Channel Sequence IE \> ::=                       |
|                                                               |
| \< **Frequency Channel Sequence** **Value** : octet(9) \> \>; |
+---------------------------------------------------------------+

Table 9.3.26.2: *Frequency Channel Sequence* information element details

  --------------------------------------------------------------------------------------------------
  **Frequency Channel Sequence** **Value\
  **This IE holds the Value part of the *Frequency Channel Sequence* IE defined in 3GPP TS 44.018.

  --------------------------------------------------------------------------------------------------

### 9.3.27 Frequency List

The purpose of the *Frequency List* IE is to provide the list of the
absolute radio frequency channel numbers used in a frequency hopping
sequence.

Table 9.3.27.1: *Frequency List* information elements

+----------------------------------------------------------------------+
| \< *Frequency List* IE \> ::=                                        |
|                                                                      |
| \< **Frequency List Length** : bit (8) \>                            |
|                                                                      |
| \< ***Frequency List*** **Value** : octet (val(Frequency List        |
| Length)) \>;                                                         |
+----------------------------------------------------------------------+

Table 9.3.27.2: *Frequency List* information element details

  ----------------------------------------------------------------------------------------
  ***Frequency List Length (8 bit field)\
  **This field indicates the length of the Frequency List Value in octets*

  ***Frequency List*** **Value\
  **This IE is holds the Value part of *Frequency List* IE as defined in 3GPP TS 44.018.
  ----------------------------------------------------------------------------------------

### 9.3.28 Frequency Short List

The purpose of the *Frequency Short List* IE is to provide the list of
the absolute radio frequency channel numbers used in a frequency hopping
sequence, in a small fixed length information element to obtain when
possible the HANDOVER COMMAND message in a single block.

Table 9.3.28.1: *Frequency Short List* information elements

+-----------------------------------------------------------+
| \< *Frequency Short List* IE \> ::=                       |
|                                                           |
| \< ***Frequency Short List*** **Value** : octet(9) \> \>; |
+-----------------------------------------------------------+

Table 9.3.28.2: *Frequency Short List* information element details

  --------------------------------------------------------------------------------------------
  ***Frequency Short List*** **Value\
  **This IE holds the Value part of the *Frequency Short List* IE defined in 3GPP TS 44.018.

  --------------------------------------------------------------------------------------------

### 9.3.29 GERAN DRX Cycle Length Coefficient

The *GERAN DRX Cycle Length Coefficient* IE determines the value of the
GERAN DRX cycle length coefficient to use in DRX computations. The
dicontinuous reception computations determine the paging blocks to
monitor on PCCCH for a specific MS.

Table 9.3.29.1: *GERAN DRX Cycle Length Coefficient* information
elements

+---------------------------------------------------------+
| \< GERAN DRX Cycle Length Coefficient IE \> ::=         |
|                                                         |
| \< **GERAN DRX Cycle Length Coefficient** : bit (3) \>; |
+---------------------------------------------------------+

Table 9.3.29.2: *GERAN DRX Cycle Length Coefficient* information element
details

+------------------------------------------------------+
| **GERAN DRX Cycle Length Coefficient** (3 bit field) |
|                                                      |
| bit\                                                 |
| 3 2 1\                                               |
| 0 0 0 GERAN DRX cycle length coefficient = 3\        |
| 0 0 1 GERAN DRX cycle length coefficient = 4\        |
| 0 1 0 GERAN DRX cycle length coefficient = 5\        |
| 0 1 1 GERAN DRX cycle length coefficient = 6\        |
| 1 0 0 GERAN DRX cycle length coefficient = 7\        |
| 1 0 1 GERAN DRX cycle length coefficient = 8\        |
| 1 1 0 GERAN DRX cycle length coefficient = 9\        |
| 1 1 1 Reserved                                       |
+------------------------------------------------------+

### 9.3.30 GRA Identity

The *GRA Identity* IE identifies a GERAN Registration Area (GRA). In
case of overlapping GRAs in the cell, it can be used to indicate to the
MS which GRA it shall use.

Table 9.3.30.1: *GRA Identity* information elements

  --------------------------------------
  \< GRA Identity IE \> ::=**\
  ** \< **GRA Identity** : bit(16) \>;

  --------------------------------------

Table 9.3.30.2: *GRA Identity* information element details

  -------------------------------------------------------------------------
  **GRA Identity** (16 bit field)\
  The GRA identity field is encoded as a binary number. Range 0 to 65535.

  -------------------------------------------------------------------------

### 9.3.31 GRA Update Cause

The *GRA Update Cause* IE indicates the cause for performing GRA Update.

Table 9.3.31.1: *GRA Update Cause* information elements

  -----------------------------------------
  \< GRA Update Cause IE \> ::=**\
  ** \< **GRA Update Cause** : bit(2) \>;

  -----------------------------------------

Table 9.3.31.2: *GRA Update Cause* information element details

+------------------------------------+
| **GRA Update Cause** (2 bit field) |
|                                    |
| bit                                |
|                                    |
| 2 1                                |
|                                    |
| 0 0 change of GRA                  |
|                                    |
| 0 1 periodic GRA updat             |
|                                    |
| All others values are reserved     |
+------------------------------------+

### 9.3.32 G-RNTI

The *G-RNTI (GERAN Radio Network Temporary Identity)* IE is allocated to
an MS having a RRC connection and identifies the MS within GERAN.

Table 9.3.32.1: *G-RNTI* information elements

  -------------------------------------------------
  \< G-RNTI IE \> ::=**\
  ** \< **Serving BSC identity** : bit (12) \>**\
  ** \< **S-RNTI** : bit (20) \>;

  -------------------------------------------------

Table 9.3.32.2: *G-RNTI* information element details

  ----------------------------------------------------------------------------
  **Serving BSC identity** (12 bit field)**\
  **This field identifies the mobile station\'s serving BSC in GERAN.

  **S-RNTI** (20 bit field)**\
  **This field identifies the mobile station in the area of its serving BSC.
  ----------------------------------------------------------------------------

### 9.3.33 GSM MS Security Capability

The *GSM MS Security Capability* IE indicates the MS security capability
for *A/Gb mode*.

Table 9.3.33.1: *GSM MS Security Capability* information elements

+-----------------------------------------+
| \< GSM MS Security Capability IE \> ::= |
|                                         |
| \< **A5/1 support :** bit (1) \>        |
|                                         |
| \< **A5/2 support :** bit (1) \>        |
|                                         |
| \< **A5/3 support :** bit (1) \>        |
|                                         |
| \< **A5/4 support :** bit (1) \>        |
|                                         |
| \< **A5/5 support :** bit (1) \>        |
|                                         |
| \< **A5/6 support :** bit (1) \>        |
|                                         |
| \< **A5/7 support :** bit (1) \>        |
|                                         |
| \< spare bit \>}; \-- *Reserved*        |
+-----------------------------------------+

Table 9.3.33.2: *GSM MS Security Capability* information element details

+----------------------------------------------------------------------+
| **A5/1 support** (1 bit field)\                                      |
| **A5/2 support** (1 bit field)\                                      |
| **A5/3 support** (1 bit field)\                                      |
| **A5/4 support** (1 bit field)\                                      |
| **A5/5 support** (1 bit field)\                                      |
| **A5/6 support** (1 bit field)\                                      |
| **A5/7 support** (1 bit field)                                       |
|                                                                      |
| These field indicates the support of the GSM encryption algorithm    |
| A5/X, where X has a range from 1 to 7.                               |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 not supported\                                                     |
| 1 supported                                                          |
+----------------------------------------------------------------------+

### 9.3.34 Handover Reference

The *Handover Reference* IE is to provide a handover reference value
used for access identification.

Table 9.3.34.1: *Handover Reference* information elements

+------------------------------------------------+
| \< Handover Reference IE \> ::=                |
|                                                |
| \< **Handover Reference Value** : octet(1) \>; |
+------------------------------------------------+

Table 9.3.34.2: *Handover Refer*ence information element details

  ---------------------------------------------------------------------------------------------------------------------
  **Handover Reference Value** (1 octet field)\
  The Handover Reference content is coded as the value part of the *Handover Reference* IE defined in 3GPP TS 44.018.

  ---------------------------------------------------------------------------------------------------------------------

### 9.3.35 Initial MS Identity

The *Initial MS Identity IE* identifies the MS at a request of an RRC
connection.

Table 9.3.35.1: *Initial MS Identity* information elements

+----------------------------------------------------------------------+
| \< Initial MS Identity IE \> ::=                                     |
|                                                                      |
| { \< **MS Identity Type** : 0000 \> *\-- GSM-MAP TMSI and LAI*       |
|                                                                      |
| \< **TMSI :** bit (32) \>                                            |
|                                                                      |
| \< **LAI :** octet (5) \>                                            |
|                                                                      |
| \| \< **MS Identity Type** : 0001 \> *\-- GSM-MAP P-TMSI and RAI*    |
|                                                                      |
| \< **PTMSI :** bit (32) \>                                           |
|                                                                      |
| \< **RAI :** octet (6) \>                                            |
|                                                                      |
| \| \< **MS Identity Type** : 0010 \> *\-- GSM-MAP IMSI or IMEI*      |
|                                                                      |
| \< **Length of Mobile Identity contents** : bit (4) \>               |
|                                                                      |
| \< **Mobile Identity** : octet (val (Length of Mobile Identity       |
| contents)) \>                                                        |
|                                                                      |
| \| \< **MS Identity Type** : 0011 \> *\-- ESN (DS-41)*               |
|                                                                      |
| \< **ESN** : bit (32) \>                                             |
|                                                                      |
| \| \< **MS Identity Type** : 0100 \> *\-- IMSI (DS-41)*              |
|                                                                      |
| \< **IMSI length** : bit (2) \> \-- *only allowed 0 - 2*             |
|                                                                      |
| \< **IMSI** : octet (5+val(IMSI Length)) \>                          |
|                                                                      |
| \| \< **MS Identity Type** : 0101 \> \-- *reserved for IMSI and ESN  |
| (DS-41)*                                                             |
|                                                                      |
| \< **IMSI length** : bit (2) \> \-- only allowed 0 - 2               |
|                                                                      |
| \< **IMSI :** octet (5+val(IMSI Length)) \>                          |
|                                                                      |
| \< **ESN** : bit (32) \>                                             |
|                                                                      |
| \| \< **MS Identity Type** : 0110 \> \-- *reserved for TMSI (DS-41)* |
|                                                                      |
| \< **TMSI length** : bit (4) \>                                      |
|                                                                      |
| \< **TMSI-DS-41** : octet (2+val(length)) \>                         |
|                                                                      |
| \| \< Message escape : { 1 bit(3) } bit\*\* = \< no string \> \> \-- |
| *reserved*                                                           |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.3.35.2: *Initial MS Identity* information element details

+----------------------------------------------------------------------+
| *GSM-MAP TMSI and LAI structure*                                     |
|                                                                      |
| **TMSI** (32 bit field)\                                             |
| The Temporary Mobile Subscriber Identity (TMSI) is associated with   |
| the mobile subscriber and defined in 3GPP TS 23.003. This field is   |
| coded as a binary number. Range 0 to 4294967295.                     |
|                                                                      |
| **LAI** (5 octet field)\                                             |
| This field is coded using the V format of the type 3 information     |
| element *Location Area Identification* defined in 3GPP TS 44.018.    |
+----------------------------------------------------------------------+
| *GSM-MAP P-TMSI and RAI structure*                                   |
|                                                                      |
| **PTMSI** (32 bit field)\                                            |
| The Packet Temporary Mobile Station Identity (PTMSI) is associated   |
| with the mobile subscriber and defined in 3GPP TS 23.003. This field |
| is encoded as a binary number. Range 0 to 4294967295.                |
|                                                                      |
| **RAI** (48 bit field)\                                              |
| This field contains the Routing Area identification. This field is   |
| described in 3GPP TS 44.018.                                         |
+----------------------------------------------------------------------+
| *GSM-MAP IMSI or IMEI*                                               |
|                                                                      |
| **Mobile Identity** (variable length octet string)\                  |
| This octet string is the representation of the Mobile Identity. The  |
| encoding of this octet string is the value part (starting with octet |
| 3) of the type 4 information element Mobile Identity defined in      |
| 3GPP TS 24.008.                                                      |
|                                                                      |
| Any value other than IMSI and IMEI for the type of identity in this  |
| octet string is spare.                                               |
+----------------------------------------------------------------------+

### 9.3.36 Integrity Check Info

The *Integrity Check Info* IE contains the RRC message sequence number
needed in the calculation of XMAC-I (see 3GPP TS 33.102) and the
calculated MAC-I.

Table 9.3.36.1: *Integrity Check Info* information elements

+----------------------------------------------------------------------+
| \< Integrity Check Info IE \> ::=                                    |
|                                                                      |
| \< **Message Authentication Code :** bit (32) \> \-- *see            |
| 3GPP TS 33.102*                                                      |
|                                                                      |
| \< **RRC Message sequence number** : bit (4) \>;                     |
+----------------------------------------------------------------------+

Table 9.3.36.2: *Integrity Check Info* information element details

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Message Authentication Code (**32 bit field)\
  This field indicates authentication code of the message. The 27 MSB of the IE shall be set to zero and the 5 LSB of the IE shall be set to the used signalling radio bearer identity when the encoded RRC message is used as the MESSAGE parameter in the integrity protection algorithm.

  **RRC Message Sequence Number** (4 bit field)\
  This field is the binary representation of the sequence number of the RRC message. Range 0 to 15.\
  This field shall be set to zero when the encoded RRC message is used as the MESSAGE parameter in the integrity protection algorithm.
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.37 Integrity Protection Activation Info

The *Integrity Protection Activation Info* IE contains the time, in
terms of RRC sequence numbers, when a new integrity protection
configuration shall be activated for the signalling radio bearers.

Table 9.3.37.1: *Integrity Protection Activation Info* information
elements

+-----------------------------------------------------------+
| \< Integrity Protection Activation Info IE \> ::=         |
|                                                           |
| \< **RRC message sequence number** : bit (4) \> \* **4;** |
+-----------------------------------------------------------+

Table 9.3.37.2: *Integrity Protection Activation Info* information
element details

  -------------------------------------------------------------------------------------------------------------------
  **RRC Message Sequence Number** (4 bit field)\
  These fields are binary representation of the RRC sequence number. Range 0 to 15.\
  The RRC sequence number shall be applied for the signalling radio bearers in the order SRB4, SRB3, SRB2 and SRB1.

  -------------------------------------------------------------------------------------------------------------------

### 9.3.38 Integrity Protection Algorithm

The *Integrity Protection Algorithm* IE indicates which type of UMTS
Integrity Algorithm is used. This field is defined in 3GPP TS 33.102.

Table 9.3.38.1: *Integrity Protection Algorithm* information elements

+---------------------------------------------------------+
| \< Integrity Protection Algorithm IE \> ::=             |
|                                                         |
| \< **Integrity Protection Algorithm** : bit (4) \>**;** |
+---------------------------------------------------------+

Table 9.3.38.2: *Integrity Protection Algorithm* information element
details

+--------------------------------------------------+
| **Integrity Protection Algorithm** (4 bit field) |
|                                                  |
| bit                                              |
|                                                  |
| 4 3 2 1                                          |
|                                                  |
| 0 0 0 1 UIA1 \-- *see 3GPP TS 33.102*            |
|                                                  |
| All other values are reserved.                   |
+--------------------------------------------------+

### 9.3.39 Integrity Protection Mode Info

The *Integrity Protection Mode Info* IE countains information about the
integrity protection.

Table 9.3.39.1: *Integrity Protection Mode Info* information elements

+----------------------------------------------------------------------+
| \< Integrity Protection Mode Info IE \> ::=                          |
|                                                                      |
| { \< **Integrity protection mode command** : 0 \>                    |
|                                                                      |
| \< **Integrity protection initialisation number** : bit (32) \>      |
|                                                                      |
| \| \< **Integrity protection mode command** : 1 \>                   |
|                                                                      |
| \< **Downlink integrity protection activation info** : \< Integrity  |
| protection activation info IE \> \>                                  |
|                                                                      |
| { 0 \| 1 \< **Integrity protection algorithm** : \< Integrity        |
| protection algorithm IE \> \> }                                      |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.3.39.2: *Integrity Protection Mode Info* information element
details

+----------------------------------------------------------------------+
| **Integrity protection mode command** (1 bit field)                  |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 start\                                                             |
| 1 modify                                                             |
+----------------------------------------------------------------------+
| **Downlink integrity protection activation info\                     |
| **The Integrity protection activation info IE is defined in          |
| sub-clause 9.3.37.                                                   |
+----------------------------------------------------------------------+
| **Integrity protection initialisation number** (32 bit field)\       |
| This field is the FRESH random value generated by the network side   |
| as it is defined in 3GPP TS 33.102.                                  |
+----------------------------------------------------------------------+
| **Integrity protection algorithm**\                                  |
| This IE is defined in sub-clause 9.3.1.16.                           |
+----------------------------------------------------------------------+

### 9.3.40 (void)

### 9.3.41 Intra Domain NAS Node Selector

This IE specifies information for routing a signalling connection to a
CN node within a CN domain.

Table 9.3.41.1: *Intra Domain NAS Node Selector* information elements

+----------------------------------------------------------------------+
| \< Intra Domain NAS Node Selector IE \> ::=                          |
|                                                                      |
| { 0 *\-- release 5*                                                  |
|                                                                      |
| { 0 *\-- GSM-MAP-type PLMN*                                          |
|                                                                      |
| *\-- Routing basis*                                                  |
|                                                                      |
| { 000 \< **Routing Parameter TMSI-PTMSI :** bit (10) \>              |
|                                                                      |
| *\-- TMSI allocated in current LA or PTMSI allocated in current RA*  |
|                                                                      |
| \| 001 \< **Routing Parameter TMSI-PTMSI :** bit (10) \>             |
|                                                                      |
| *\-- TMSI allocated in another LA of this PLMN or PTMSI allocated in |
| another RA of this PLMN*                                             |
|                                                                      |
| \| 010 \< **Routing Parameter TMSI-PTMSI :** bit (10) \>             |
|                                                                      |
| *\-- TMSI or PTMSI allocated in another PLMN*                        |
|                                                                      |
| \| 011 \< **Routing Parameter IMSI :** bit (10) \>                   |
|                                                                      |
| *\-- NAS identity is IMSI (response to IMSI paging)*                 |
|                                                                      |
| \| 100 \< **Routing Parameter IMSI :** bit (10) \>                   |
|                                                                      |
| *\-- NAS identity is IMSI (MS-inititated event)*                     |
|                                                                      |
| \| 101 \< **Routing Parameter IMEI :** bit (10) \>                   |
|                                                                      |
| *\-- NAS parameter is IMEI*                                          |
|                                                                      |
| ! \< Message escape : { 11 bit(1) } bit(10) = \< no string \> \> }   |
| \-- *Reserved*                                                       |
|                                                                      |
| \| 1 (0)\*14 } \-- ANSI-41                                           |
|                                                                      |
| ! \< Message escape : 1 bit(15) = \< no string \> \> }; \--          |
| *Reserved*                                                           |
+----------------------------------------------------------------------+

Table 9.3.41.2: *Intra Domain NAS Node Selector* information element
details

  ---------------------------------------------------------------------------------------------------------------------
  **Routing parameter TMSI-PTMSI** (10 bit field)\
  This field is the bitstring of bit(14) through bit(23) of the TMSI or PTMSI where bit(14) is the least significant.

  **Routing parameter IMSI** (10 bit field)\
  This field is the binary representation of \[(IMSI div 10) mod 1000\]. Range 0 to 999.

  **Routing parameter IMEI** (10 bit field)\
  This field is the binary representation of \[(IMEI div 10) mod 1000\]. Range 0 to 999.
  ---------------------------------------------------------------------------------------------------------------------

### 9.3.42 Mobile Allocation

This IE specifies the RF channels used in the mobile hopping sequence.

Table 9.3.42.1: *Mobile Allocation* information elements

+----------------------------------------------------------------------+
| \< Mobile Allocation IE \> ::=                                       |
|                                                                      |
| \< **Mobile Allocation Length :** bit(8) \>                          |
|                                                                      |
| \< **Mobile Allocation Value :** octet (val(Mobile Allocation        |
| Length)) \>;                                                         |
+----------------------------------------------------------------------+

Table 9.3.42.2: *Mobile Allocation* information element details

  ---------------------------------------------------------------------------------------------------------------------
  **Mobile Allocation Length (8 bit field)**\
  The Mobile Allocation Length is coded as the length part of the *Mobile Allocation* IE specified in 3GPP TS 44.018.

  **Mobile Allocation Value (octet string)**\
  The Mobile Allocation Value is coded as the value part of the *Mobile Allocation* IE specified in 3GPP TS 44.018.
  ---------------------------------------------------------------------------------------------------------------------

### 9.3.43 Mobile Time Difference

This IE encodes a time related to the synchronization difference between
the time bases of two base stations.

Table 9.3.43.1: *Mobile Time Difference* information elements

+----------------------------------------------------------------------+
| \< Mobile Allocation IE \> ::=                                       |
|                                                                      |
| \< **Mobile Time Difference Length :** bit (8) \>                    |
|                                                                      |
| \< **Mobile Time Difference Value :** octet (val(Mobile Time         |
| Difference Length)) \>;                                              |
+----------------------------------------------------------------------+

Table 9.3.43.2: *Mobile Time Difference* information element details

  -------------------------------------------------------------------------------------------------------------------------------
  **Mobile Time Difference Length (8 bit field)**\
  The Mobile Time Difference Length is coded as the length part of the *Mobile Time Difference* IE specified in 3GPP TS 44.018.

  **Mobile Time Difference Value (octet string)**\
  The Mobile Time Difference Value is coded as the value part of the *Mobile Time Difference* IE specified in 3GPP TS 44.018.
  -------------------------------------------------------------------------------------------------------------------------------

### 9.3.44 MS GERAN A/Gb mode Radio Access Capability

This Information Element contains the MS GERAN A/Gb mode radio access
capability that is structured and coded according to the specification
used for the corresponding system type.

This IE contains the Mobile station classmark 2 and 3 of the MS.

Table 9.3.44.1: *MS GERAN A/Gb mode Radio Access Ca*pability information
elements

+----------------------------------------------------------------------+
| \< MS GERAN A/Gb mode Radio Access Capability IE \> ::=              |
|                                                                      |
| { \< **Mobile Station Classmark 2 length** : bit(3) \>               |
|                                                                      |
| \< **Mobile Station Classmark 2**: octet(val (Mobile Station         |
| Classmark 2 length)) \> }                                            |
|                                                                      |
| { \< **Mobile Station Classmark 3 length** : bit(5) \>               |
|                                                                      |
| \< **Mobile Station Classmark 3**: octet (val (Mobile Station        |
| Classmark 3 length)) \> } ;                                          |
+----------------------------------------------------------------------+

Table 9.3.44.2: *MS GERAN A/Gb mode Radio Access Capability* information
element details

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Mobile Station Classmark 2 length** (3 bit field)\
  This field is the binary representation of the length of the *Mobile Station Classmark 2* IE in octets excluding the bits used for this length field. Range 0 to 7 octets

  **Mobile Station Classmark** 2\
  This IE is defined in 3GPP TS 24.008

  **Mobile Station Classmark 3 length** (5 bit field)\
  This field is the binary representation of the length of the *Mobile Station Classmark 3* IE in octets excluding the bits used for this length field. Range 0 to 31 octets

  **Mobile Station Classmark 3**\
  This IE is defined in 3GPP TS 24.008
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.45 MS GERAN Iu mode Radio Access Capability

This Information Element contains the MS GERAN Iu mode radio access
capability that is structured and coded according to the specification
used for the corresponding system type.

Table 9.3.45.1: *MS GERAN Iu mode Radio Access Capability* information
elements

+----------------------------------------------------------------------+
| \<MS GERAN Iu mode Radio Access Capability IE \> ::=                 |
|                                                                      |
| {                                                                    |
|                                                                      |
| **\< MS GERAN Iu mode Radio Access Capability length** : bit (10)\>  |
|                                                                      |
| \< **MS RF Capability GSM** : \< MS RF Capability GSM IE \> \>       |
|                                                                      |
| \< **MS GERAN Iu mode RLC Capability** : \< MS GERAN Iu Mode RLC     |
| Capability IE \> \>                                                  |
|                                                                      |
| \< **PDCP Capability** : \< PDCP Capability IE \> \>                 |
|                                                                      |
| \< **MS Multi-Mode and Multi-RAT Capability** : \< MS Multi-Mode and |
| Multi-RAT Capability IE \> \>                                        |
|                                                                      |
| \< **Security Capability** : \< Security Capability IE \> \>         |
|                                                                      |
| \< **MS Positioning Capability** : \< MS Positioning Capability IE   |
| \> \>                                                                |
|                                                                      |
| \< **MS Measurement Capability** : \< MS Measurement Capability IE   |
| \> \>                                                                |
|                                                                      |
| \< **FLO Iu Capability** : bit \> *\-- Release 6*                    |
|                                                                      |
| \< spare bit \>\*\*; *\-- Extension information may be truncated     |
| between released versions of the protocol\                           |
| \-- The receiver shall assume the value zero for any truncated bit*  |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 9.3.45.2: *MS GERAN Iu mode Radio Access Capability* information
element details

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **MS GERAN Iu mode Radio Access Capability length** (10 bit field)\
  This field is the binary representation of the length of the *MS GERAN Iu Mode Radio Access Capability* IE in bits excluding the bits used for this length field. Range: 0 to 1023.

  **MS RF Capability GSM**\
  This IE is defined in sub-clause 9.3.47.

  **MS GERAN Iu mode RLC Capability**\
  This IE is defined in sub-clause 9.3.46.

  **PDCP Capability**\
  This IE is defined in sub-clause 9.3.59.

  **MS Multi-Mode and Multi-RAT Capability**\
  This IE is defined in sub-clause 9.3.48.

  **Security Capability**\
  This IE is defined in sub-clause 9.3.100.

  **MS Positioning Capability**\
  This IE is defined in sub-clause 9.3.50.

  **MS Measurement Capability**\
  This IE is defined in sub-clause 9.3.49.

  **FLO Iu Capability (1 bit field)**\
  Bit\
  0 FLO in GERAN Iu mode not supported\
  1 FLO in GERAN Iu mode supported
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.46 MS GERAN Iu mode RLC Capability

The *MS GERAN Iu mode RLC capability* IE describes the capabilities of
the RLC layer of the MS in GERAN Iu mode.

Table 9.3.46.1: *MS GERAN Iu mode RLC Capability* information elements

+----------------------------------------------------------------------+
| \< MS GERAN Iu mode RLC Capability IE \> ::=                         |
|                                                                      |
| {                                                                    |
|                                                                      |
| **\< MS GERAN Iu mode RLC Capability Length** : bit (4)\>            |
|                                                                      |
| **\<** **Maximum number of RLC-AM entities** : bit (3) \>            |
|                                                                      |
| **\<** **Maximum number of RLC-UM entities** : bit (3) \>            |
|                                                                      |
| **\< Maximum numer of RLC-T entities : bit (3) \>**                  |
|                                                                      |
| \< spare bit \>\*\*; *\-- Extension information may be truncated     |
| between released versions of the protocol\                           |
| \-- The receiver shall assume the value zero for any truncated bit*  |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.3.46.2: *MS GERAN Iu mode RLC Capability* information element
details

+----------------------------------------------------------------------+
| **MS GERAN Iu mode RLC Capability Length** (4 bit field)\            |
| This field is the binary representation of the length of the MS      |
| GERAN Iu Mode RLC Capability IE in bits excluding the bits used for  |
| this length field. Range: 0 to 15.                                   |
+----------------------------------------------------------------------+
| **Maximum number of RLC-AM entities** (3 bits field)\                |
| This field defines the number of RLC entities operating in           |
| acknowledge mode in the MS.                                          |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 3 2 1                                                                |
|                                                                      |
| 0 0 0 3 RLC-AM entities                                              |
|                                                                      |
| 0 0 1 4 RLC-AM entities                                              |
|                                                                      |
| 0 1 0 5 RLC-AM entities                                              |
|                                                                      |
| 0 1 1 6 RLC-AM entities                                              |
|                                                                      |
| 1 0 0 8 RLC-AM entities                                              |
|                                                                      |
| All other values are reserved.                                       |
+----------------------------------------------------------------------+
| **Maximum number of RLC-UM entities** (3 bits field)\                |
| This field defines the number of RLC entities operating in           |
| unacknowledge mode in the MS.                                        |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 3 2 1                                                                |
|                                                                      |
| 0 0 0 3 RLC-UM entities                                              |
|                                                                      |
| 0 0 1 4 RLC-UM entities                                              |
|                                                                      |
| 0 1 0 5 RLC-UM entities                                              |
|                                                                      |
| 0 1 1 6 RLC-UM entities                                              |
|                                                                      |
| 1 0 0 8 RLC-UM entities                                              |
|                                                                      |
| All other values are reserved.                                       |
+----------------------------------------------------------------------+
| **Maximum number of RLC-T entities** (2 bits field)\                 |
| This field defines the number of RLC entities operating in           |
| transparent mode in the MS.                                          |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 3 2 1                                                                |
|                                                                      |
| 0 0 0 3 RLC-T entity                                                 |
|                                                                      |
| 0 0 1 4 RLC-T entities                                               |
|                                                                      |
| 0 1 0 5 RLC-T entities                                               |
|                                                                      |
| 0 1 1 6 RLC-T entities                                               |
|                                                                      |
| 1 0 0 8 RLC-T entities                                               |
|                                                                      |
| All other values are reserved.                                       |
+----------------------------------------------------------------------+

### 9.3.47 MS RF Capability GSM

The purpose of the *MS RF Capability GSM* information element is to
provide the radio part of the network with information concerning radio
aspects of the mobile station. The contents might affect the manner in
which the network handles the operation of the mobile station.

The *MS RF Capability GSM* information element is coded as shown in
table 9.3.47.1.

For the indication of the Access Technology Types the following
conditions shall apply:

\- Among the three Access Type Technologies GSM 900-P, GSM 900-E and GSM
900-R only one shall be present.

\- Due to shared radio frequency channel numbers between GSM 1800 and
GSM 1900, the mobile station should provide the relevant radio access
capability for either GSM 1800 band OR GSM 1900 band, not both.

\- The MS shall indicate its supported Access Technology Types.

For error handling the following shall apply:

\- If a received Access Technology Type is unknown to the receiver, it
shall ignore all the corresponding fields.

\- If within a known Access Technology Type a receiver recognizes an
unknown field it shall ignore it.

\- For more details about error handling of MS radio access capability
see 3GPP TS 48.018.

Table 9.3.47.1: *MS RF Capability GSM* information elements

+----------------------------------------------------------------------+
| \< MS RF Capability GSM IE \> ::=                                    |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **MS RF Capability GSM Length** : bit (8) \>                      |
|                                                                      |
| \< **RF Capability Group** : \< RF Capability Group struct \> \>     |
|                                                                      |
| { 1 \< **Additional RF Capability Group** : \< RF Capability Group   |
| struct \> \> } \*\* 0                                                |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+
| \< RF Capability Group struct \> ::=\                                |
| *\-- Access Technology using common capabilities*                    |
|                                                                      |
| \< **Access Technology Type** : bit (4) \>                           |
|                                                                      |
| { 1 \< **Additional** **Access Technology Type** : bit (4) \> } \*\* |
| 0                                                                    |
|                                                                      |
| \< **Common Access Capabilities** : \< Access Capabilities struct \> |
| \>                                                                   |
|                                                                      |
| *\-- Access Technology using individual capcabilities*               |
|                                                                      |
| { 1 \< **Additional Access Technology** : \< Additional Access       |
| Technology struct \> \> } \*\* 0 ;                                   |
+----------------------------------------------------------------------+
| \< Access Capabilities struct \> ::=                                 |
|                                                                      |
| **\< Access Capabilities length** : bit (6)\>                        |
|                                                                      |
| \< **GMSK Power Capability** : bit (3) \>                            |
|                                                                      |
| { 0 \| 1 \< **8PSK Power Capability** : bit (2) \> }                 |
|                                                                      |
| \< **Pseudo Synchronisation** : bit (1) \>                           |
|                                                                      |
| \< **Multislot capability** : \< Multislot capability struct \> \>   |
|                                                                      |
| \< spare bit \>\*\*; *\-- Extension information may be truncated     |
| between released versions of the protocol\                           |
| \-- The receiver shall assume the value zero for any truncated bit*  |
+----------------------------------------------------------------------+
| \< Additional Access Technology struct \> ::=\                       |
| **\< Additional Access Technology length** : bit (6)\>               |
|                                                                      |
| \< **Access Technology Type** : bit (4) \>\                          |
| \< **GMSK Power Class** : bit (3) \>\                                |
| \< **8PSK Power Class** : bit (2) \>\                                |
| \< spare bit \>\*\*; *\-- Extension information may be truncated     |
| between released versions of the protocol\                           |
| \-- The receiver shall assume the value zero for any truncated bit*  |
+----------------------------------------------------------------------+
| \< Multislot Capability struct \> ::=                                |
|                                                                      |
| { 0 \< **Combined GMSK and 8-PSK Multislot Class** : bit (6) \>      |
|                                                                      |
| \| 1                                                                 |
|                                                                      |
| > \< **GMSK Multislot Class** : bit (6) \>                           |
|                                                                      |
| { 0 \| 1 \< **8-PSK Multislot Class** : bit (6) \>}};                |
+----------------------------------------------------------------------+

Table 9.3.47.2: *MS RF Capability GSM* information element details

+----------------------------------------------------------------------+
| **MS RF Capability GSM Length** (8 bit field)                        |
|                                                                      |
| This field is the binary representation of the length of the MS RF   |
| Capability GSM IE in bits exluding the bits used for this length     |
| field.                                                               |
+----------------------------------------------------------------------+
| **Access Technology Type** (4 bit field)**\                          |
| **This field indicates the access technology type to be associated   |
| with the following access capabilities.                              |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 4 3 2 1                                                              |
|                                                                      |
| 0 0 0 0 GSM P                                                        |
|                                                                      |
| 0 0 0 1 GSM E \--*note that GSM E covers GSM P*                      |
|                                                                      |
| 0 0 1 0 GSM R \--*note that GSM R covers GSM E and GSM P*            |
|                                                                      |
| 0 0 1 1 GSM 1800                                                     |
|                                                                      |
| 0 1 0 0 GSM 1900                                                     |
|                                                                      |
| 0 1 0 1 GSM 450                                                      |
|                                                                      |
| 0 1 1 0 GSM 480                                                      |
|                                                                      |
| 0 1 1 1 GSM 850                                                      |
|                                                                      |
| 1 0 0 0 GSM 750                                                      |
|                                                                      |
| 1 0 0 1 GSM 710                                                      |
|                                                                      |
| 1 0 1 0 T-GSM 810                                                    |
|                                                                      |
| All other values are treated as unknown by the receiver.             |
+----------------------------------------------------------------------+
| **Common Access Capabilities**\                                      |
| This structure contains the access capabilities for the indicated    |
| access technology type and - if present - for the access             |
| technologies indicated by the optional List of additional access     |
| technologies.                                                        |
+----------------------------------------------------------------------+
| **Access Capabilities length** (6 bit field)\                        |
| This field is the binary representation of the length of the Access  |
| Capabilities struct in bits excluding the bits used for this length  |
| field. Range: 0 to 63.                                               |
+----------------------------------------------------------------------+
| **GMSK Power Capability, GMSK Power Class** (3 bit field)\           |
| This field contains the binary coding of the power class used for    |
| GMSK associated with the indicated Access Technology Type (see       |
| 3GPP TS 45.005).                                                     |
+----------------------------------------------------------------------+
| **8PSK Power Capability** (2 bit field)\                             |
| If 8-PSK modulation is supported for uplink, this field indicates    |
| the radio capability for 8‑PSK modulation. The following coding is   |
| used (see 3GPP TS 45.005):                                           |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 2 1                                                                  |
|                                                                      |
| 0 0 Reserved                                                         |
|                                                                      |
| 0 1 Power class E1                                                   |
|                                                                      |
| 1 0 Power class E2                                                   |
|                                                                      |
| 1 1 Power class E3                                                   |
+----------------------------------------------------------------------+
| **8PSK Power Class** (2 bit field)\                                  |
| This field indicates the radio capability for 8‑PSK modulation. The  |
| following coding is used (see 3GPP TS 45.005):                       |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 2 1                                                                  |
|                                                                      |
| 0 0 8-PSK modulation not supported for uplink                        |
|                                                                      |
| 0 1 Power class E1                                                   |
|                                                                      |
| 1 0 Power class E2                                                   |
|                                                                      |
| 1 1 Power class E3                                                   |
+----------------------------------------------------------------------+
| **Pseudo Synchronisation** (1 bit field)\                            |
| This field indicates the Pseudo Synchronisation (Handover)           |
| capability.\                                                         |
| 0 Pseudo Synchronisation capability not present\                     |
| 1 Pseudo Synchronisation capability present                          |
+----------------------------------------------------------------------+
| **RF Capability Group**\                                             |
| This structure contains the Common access capabilities for the       |
| indicated access technology type. These access capabilities may be   |
| extended by an optional List of additional access technologies.      |
+----------------------------------------------------------------------+
| **Additional Access Technologies\                                    |
| **This structure contains the GMSK Power Class and 8PSK Power Class  |
| for additional access technologies. All other capabilities for this  |
| indicated access technologies are the same as the capabilities as    |
| indicated by the last previously included Common access              |
| capabilities.                                                        |
+----------------------------------------------------------------------+
| **Additional Access Technology length** (6 bit field)\               |
| This field is the binary representation of the length of the         |
| Additional Access Technology struct in bits excluding the bits used  |
| for this length field. Range: 0 to 63.                               |
+----------------------------------------------------------------------+
| **Multislot Capability**\                                            |
| This structure contains the multislot capability for GMSK and 8-PSK  |
| modulations. The multislot class capability for GMSK and 8-PSK       |
| modulations can be combined or it can be defined separately for the  |
| modulations.                                                         |
+----------------------------------------------------------------------+
| **Combined GMSK and 8-PSK Multislot Class** (6 bit field)            |
|                                                                      |
| This field indicates common multislot class for both GMSK and 8-PSK  |
| modulations. The field is coded as the binary representation of the  |
| multislot class defined in 3GPP TS 45.002.                           |
+----------------------------------------------------------------------+
| **GMSK Multislot Class** (6 bit field)                               |
|                                                                      |
| This field indicates multislot class for GMSK modulation. The field  |
| is coded as the binary representation of the multislot class defined |
| in 3GPP TS 45.002.                                                   |
+----------------------------------------------------------------------+
| **8-PSK Multislot Class** (6 bit field)                              |
|                                                                      |
| This field indicates multislot clas for 8-PSK modulation. The field  |
| is coded as the binary representation of the multislot class defined |
| in 3GPP TS 45.002.                                                   |
+----------------------------------------------------------------------+

### 9.3.48 MS Multi-Mode and Multi-RAT Capability

The *MS Multi-Mode and Multi-RAT Capability* IE describes the
RLCmulti-mode and multi-RAT capabilities of the MS.

Table 9.3.48.1: *MS Multi-Mode and Multi-RAT Capability* information
elements

+-----------------------------------------------------+
| \< MS Multi-Mode and Multi-RAT Capability IE \> ::= |
|                                                     |
| \< **Support of GERAN A/Gb** : bit (1) \>           |
|                                                     |
| \< **Support of Multi-Carrier** : bit (1) \>        |
|                                                     |
| \< **Support of UMTS FDD** : bit (1) \>             |
|                                                     |
| \< **Support of UMTS 1.28 Mcps TDD** : bit (1) \>   |
|                                                     |
| \< **Support of UMTS 3.84 Mcps TDD** : bit (1) \>   |
|                                                     |
| \< **Support of CDMA2000** : bit (1) \>             |
|                                                     |
| \< spare bit \>\*10;                                |
+-----------------------------------------------------+

Table 9.3.48.2: *MS Multi-Mode and Multi-RAT Capability* information
element details

+----------------------------------------------------------------------+
| **Support of GERAN A/Gb** (1 bit field)\                             |
| **Support of Multi-Carrier** (1 bit field)\                          |
| **Support of UMTS FDD** (1 bit field)\                               |
| **Support of UMTS FDD** (1 bit field)\                               |
| **Support of UMTS 1.28 Mcps TDD** (1 bit field)\                     |
| **Support of UMTS 3.84 Mcps TDD** (1 bit field)\                     |
| **Support of CDMA2000** (1 bit field)\                               |
| These fields indicates the support of the associated                 |
| multi-mode/multi-RAT capability.\                                    |
| bit                                                                  |
|                                                                      |
| 1\                                                                   |
| 0 not supported\                                                     |
| 1 supported                                                          |
+----------------------------------------------------------------------+

### 9.3.49 MS Measurement Capability

The *MS Measurement Capability* IE describes the measurement capability
and SMS value of the MS.

Table 9.3.49.1: *MS Measurement Capability* information elements

+----------------------------------------------------------------------+
| \< MS Measurement Capability IE \> ::=                               |
|                                                                      |
| {                                                                    |
|                                                                      |
| **\< MS Measurement Capability Length** : bit (4)\>                  |
|                                                                      |
| \< **Extended Measurement Capability : bit (1) \>**                  |
|                                                                      |
| **\< SMS Value : bit (4) \>**                                        |
|                                                                      |
| **\< SM Value : bit (4) \>**                                         |
|                                                                      |
| \< spare bit \>\*\*; *\-- Extension information may be truncated     |
| between released versions of the protocol\                           |
| \-- The receiver shall assume the value zero for any truncated bit*  |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 9.3.49.2: *MS Measurement Capability* information element details

+----------------------------------------------------------------------+
| **MS Measurement Capability Length** (4 bit field)\                  |
| This field is the binary representation of the length of the MS      |
| Measurement Capability IE in bits excluding the bits used for this   |
| length field. Range: 0 to 15.                                        |
+----------------------------------------------------------------------+
| **Extended Measurement Capability** (1 bit field)**\                 |
| **These field indicates the support of Extended Measurement.\        |
| bit\                                                                 |
| 0 Extended Measurement is not supported\                             |
| 1 Extended Measurement is supported                                  |
+----------------------------------------------------------------------+
| **SMS Value (4 bit field)\                                           |
| **The SMS Value field indicates the time needed for the mobile       |
| station to switch from one radio channel to another, perform a       |
| neighbour cell power measurement, and the switch from that radio     |
| channel to another radio channel.                                    |
|                                                                      |
| bits                                                                 |
|                                                                      |
| 4 3 2 1                                                              |
|                                                                      |
| 0 0 0 0 1/4 timeslot (\~144 microseconds)                            |
|                                                                      |
| 0 0 0 1 2/4 timeslot (\~288 microseconds)                            |
|                                                                      |
| 0 0 1 0 3/4 timeslot (\~433 microseconds)                            |
|                                                                      |
| . . .                                                                |
|                                                                      |
| 1 1 1 1 16/4 timeslot (\~2307 microseconds)                          |
+----------------------------------------------------------------------+
| **SM Value (4 bit field)\                                            |
| **The SM Value field indicates the time needed for the mobile        |
| station to switch from one radio channel to another and perform a    |
| neighbour cell power measurement.                                    |
|                                                                      |
| bits                                                                 |
|                                                                      |
| 4 3 2 1                                                              |
|                                                                      |
| 0 0 0 0 1/4 timeslot (\~144 microseconds)                            |
|                                                                      |
| 0 0 0 1 2/4 timeslot (\~288 microseconds)                            |
|                                                                      |
| 0 0 1 0 3/4 timeslot (\~433 microseconds)                            |
|                                                                      |
| . . .                                                                |
|                                                                      |
| 1 1 1 1 16/4 timeslot (\~2307 microseconds)                          |
+----------------------------------------------------------------------+

### 9.3.50 MS Positioning Capability

The *MS Positioning Capability* IE describes the supported positioning
methods in GERAN *Iu mode*.

Table 9.3.50.1: *MS Positioning Capability* information elements

+----------------------------------------------------------------------+
| \< MS Positioning Capability IE \> ::=                               |
|                                                                      |
| {                                                                    |
|                                                                      |
| **\< MS Positioning Capability Length** : bit (4)\>                  |
|                                                                      |
| \< **OTD-A support** : bit (1) \>                                    |
|                                                                      |
| \< **OTD-B support** : bit (1) \>                                    |
|                                                                      |
| \< **GPS-A support** : bit (1) \>                                    |
|                                                                      |
| \< **GPS-B support** : bit (1) \>                                    |
|                                                                      |
| \< **GPS-C support** : bit (1) \>                                    |
|                                                                      |
| \< **RRLP Positioning Indication support** : bit (1) \>              |
|                                                                      |
| \< spare bit \>\*\*; *\-- Extension information may be truncated     |
| between released versions of the protocol\                           |
| \-- The receiver shall assume the value zero for any truncated bit*  |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 9.3.50.2: *MS Positioning Capability* information element details

+----------------------------------------------------------------------+
| **MS Positioning Capability Length** (4 bit field)\                  |
| This field is the binary representation of the length of the MS      |
| Positioning Capability IE in bits excluding the bits used for this   |
| length field. Range: 0 to 15.                                        |
+----------------------------------------------------------------------+
| **OTD-A support** (1 bit field)\                                     |
| MS assisted E-OTD.\                                                  |
| **OTD-B support** (1 bit field)\                                     |
| MS based E-OTD.t\                                                    |
| **GPS-A support** (1 bit field)\                                     |
| MS assisted GPS.\                                                    |
| **GPS-B support** (1 bit field)\                                     |
| MS based GPS.\                                                       |
| **GPS-C support** (1 bit field)\                                     |
| Conventional GPS.\                                                   |
| Each of these fields indicates the support of the associated         |
| positioning method.                                                  |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 not supported\                                                     |
| 1 supported                                                          |
+----------------------------------------------------------------------+
| **RRLP Positioning Indication support** (1 bit field)\               |
| This field indicates whether the MS supports transfer of its         |
| positioning capabilities using RRLP.                                 |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 not supported\                                                     |
| 1 supported                                                          |
+----------------------------------------------------------------------+

### 9.3.51 MS Timers and Constants in RRC-Connected mode

This IE specifies timer values and constant values used by the mobile
station in *RRC-Connected mode*.

Table 9.3.51.1: *MS Timers And Constants in RRC-Connected Mode*
information elements

+----------------------------------------------------------------+
| \< MS Timers and Constants in RRC-Connected mode IE \> ::=     |
|                                                                |
| \< **MS Timers and Constants** **Length** : bit (4) \>         |
|                                                                |
| { 0 \| 1 \< **T305** : ***GRA AND CELL UPDATE TIMER IE*** \> } |
|                                                                |
| { 0 \| 1 \< **T314** : bit (3) \> }                            |
|                                                                |
| { 0 \| 1 \< **T315** : bit (3) \> }                            |
|                                                                |
| \< spare bits \>\*\* } ;                                       |
+----------------------------------------------------------------+

Table 9.3.51.2: *MS Timers And Constants in RRC-Connected Mode*
information element details

+----------------------------------------------------------------------+
| **MS Timers and Constants** **Length** (4 bit field)\                |
| This field is the binary representation of the length of the *MS     |
| Timers and Constants in RRC-Connected Mode* IE in bits excluding the |
| 4 bits used for this length field.                                   |
+----------------------------------------------------------------------+
| **T305** (3 bit field)\                                              |
| This field specifies the starting value of timer T305. This IE       |
| defined in 3GPP TS 44.160, PACKET SYSTEM INFORMATION 16 message.     |
+----------------------------------------------------------------------+
| **T315** (3 bit field)\                                              |
| This field specifies the starting value of timer T315. The following |
| table specifies the coding :                                         |
|                                                                      |
| bit\                                                                 |
| 3 2 1\                                                               |
| 0 0 0 0s\                                                            |
| 0 0 1 10s\                                                           |
| 0 1 0 30s\                                                           |
| 0 1 1 60s\                                                           |
| 1 0 0 180s \--*default value*\                                       |
| 1 0 1 600s\                                                          |
| 1 1 0 1200s\                                                         |
| 1 1 1 1800s                                                          |
+----------------------------------------------------------------------+

### 9.3.52 MultiRate Configuration

This IE specifies all parameters for a multirate speechcodec.

Table 9.3.52.1: *MultiRate Configuration* information elements

+----------------------------------------------------------------------+
| \< MultiRate Configuration IE \> ::=                                 |
|                                                                      |
| \< **MultiRate Configuration Length :** bit(8) \>                    |
|                                                                      |
| \< **MultiRate Configuration Value :** octet (val(MultiRate          |
| Configuration Length)) \>;                                           |
+----------------------------------------------------------------------+

Table 9.3.52.2: *MultiRate Configuration* information element details

  -----------------------------------------------------------------------------------------------------------------------------------------------
  **MultiRate Configuration Length (8 bit field)**\
  The MultiRate Configuration Length is coded as the length part of the *MultiRate Configuration* IE specified in 3GPP TS 44.018 § 10.5.2.21aa.

  **MultiRate Configuration Value (octet string)**\
  The MultiRate Configuration Value is coded as the value part of the *MultiRate Configuration* IE specified in 3GPP TS 44.018 § 10.5.2.21aa.
  -----------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.53 Multislot Allocation

This IE specifies the downlink and uplink timeslots used in a multislot
configuration. It also groups the timeslots into channel sets.

Table 9.3.53.1: *Multislot Allocation* information elements

+----------------------------------------------------------------------+
| \< Multislot Allocation IE \> ::=                                    |
|                                                                      |
| \< **Multislot Allocation Length :** bit(8) \>                       |
|                                                                      |
| \< **Multislot Allocation Value :** octet (val(Multislot Allocation  |
| Length)) \>;                                                         |
+----------------------------------------------------------------------+

Table 9.3.53.2: *Multislot Allocation* information element details

  ---------------------------------------------------------------------------------------------------------------------------
  **Multislot Allocation Length (8 bit field)**\
  The Multislot Allocation Length is coded as the length part of the *Multislot Allocation* IE specified in 3GPP TS 44.018.

  **Multislot Allocation Value (octet string)**\
  The Multislot Allocation Value is coded as the value part of the *Multislot Allocation* IE specified in 3GPP TS 44.018.
  ---------------------------------------------------------------------------------------------------------------------------

### 9.3.54 NAS Message

The *NAS Message* IE contains a non-access stratum message to be
transferred transparently through GERAN.

Table 9.3.54.1: *NAS Message* information elements

+-----------------------------------------------------------------+
| \< NAS Message IE \> ::=                                        |
|                                                                 |
| \< **Length of NAS Message** : bit (12) \>                      |
|                                                                 |
| \< **NAS Message :** octet (1+val(Length of NAS Message) ) \> ; |
+-----------------------------------------------------------------+

Table 9.3.54.2: *NAS Message* information element details

+----------------------------------------------------------------------+
| **Length of NAS Message** (12 bit field)                             |
|                                                                      |
| This field is used to calculate the length of the *NAS Message* IE   |
| excluding the bits used for this length field. Range : 0 to 4095.    |
+----------------------------------------------------------------------+
| **NAS Message** (variable length octet string)                       |
|                                                                      |
| The first octet contains octet 1 of the NAS message, the second      |
| octet contains octet 2 of the NAS message and so on. See             |
| 3GPP TS 24.007.                                                      |
+----------------------------------------------------------------------+

### 9.3.55 NAS Synchronization Info

The *NAS Synchronization Info* IE is a container for non-access stratum
information to be transferred transparently through GERAN.

Table 9.3.55.1: *NAS Synchronization Info* information elements

+-----------------------------------------------------+
| \< **NAS Synchronization Info** IE \> ::=           |
|                                                     |
| \< **NAS Synchronization Info :** bit ( 4 ) \> \> ; |
+-----------------------------------------------------+

Table 9.3.55.2: *NAS Synchronization Info* information element details

  --------------------------------------------------------------------------------------------------------------------------------------------------------
  **NAS Synchronization Info** (4 bit field)\
  This field contains NAS information to be transferred transparently through GERAN. The bits are numbered b1-b4, where b1 is the least significant bit.

  --------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.56 NAS System Information GSM-MAP

This IE contains system information that belongs to the non-access
stratum for a GSM-MAP type of PLMN. This information is transparent to
RRC. It may contain either information specific to one CN domain (CS or
PS) or information common for both CN domains.

Table 9.3.56.1: *NAS System Information GSM-MAP* information elements

+----------------------------------------------------------------------+
| \< NAS System Information GSM-MAP IE \> ::=                          |
|                                                                      |
| \< **Length of NAS System Information GSM-MAP** : bit (3) \>         |
|                                                                      |
| \< **NAS System Information GSM-MAP :** octet (1+val(**Length of NAS |
| System Information GSM-MAP**)) \>;                                   |
+----------------------------------------------------------------------+

Table 9.3.56.2: *NAS System Information GSM-MAP* information element
details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Length of NAS System Information GSM-MAP** (3 bit field)\
  This field is used to calculate the length in octets of the ***NAS System Information GSM-MAP* IE** excluding the bits used for this length field**. Range : 0...7.**

  **NAS System Information GSM\_MAP (octet string)**\
  The first octet contains octet 1 of the NAS System Information element, the second octet contains octet 2 of the NAS system information element and so on. See 3GPP TS 24.008.
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.57 Paging Cause

The *Paging Cause* IE indicates the cause of the paging request.

Table 9.3.57.1: *Paging Cause* information elements

+-----------------------------------+
| \< Paging Cause IE \> ::=         |
|                                   |
| \< **Paging Cause** : bit (3) \>; |
+-----------------------------------+

Table 9.3.57.2: *Paging Cause* information element details

+---------------------------------------------+
| **Paging Cause** (3 bit field)              |
|                                             |
| bit\                                        |
| 3 2 1\                                      |
| 0 0 0 Terminating Conversational Call\      |
| 0 0 1 Terminating Streaming Call\           |
| 0 1 0 Terminating Interactive Call\         |
| 0 1 1 Terminating Background Call\          |
| 1 0 0 Terminating High Priority Signalling\ |
| 1 0 1 Terminating Low Priority Signalling\  |
| 1 1 0 Terminating -- cause unknown\         |
| 1 1 1 Reserved                              |
+---------------------------------------------+

### 9.3.58 Paging Record Type Identifier

The *Paging Record Type Identifier* IE indicates the identifier used in
the Core Network Paging.

Table 9.3.58.1: *Paging Record Type Identifier* information elements

+----------------------------------------------------+
| \< Paging Record Type Identifier IE \> ::=         |
|                                                    |
| \< **Paging Record Type Identifier** : bit (3) \>; |
+----------------------------------------------------+

Table 9.3.58.2: *Paging Record Type Identifier* information element
details

+-------------------------------------------------+
| **Paging Record Type Identifier** (3 bit field) |
|                                                 |
| bit\                                            |
| 3 2 1\                                          |
| 0 0 0 IMSI (GSM-MAP)\                           |
| 0 0 1 TMSI/PTMSI (GSM/MAP)\                     |
| 0 1 0 IMSI (DS-41)\                             |
| 0 1 1 TMSI (DS-41)\                             |
| 1 x x reserved                                  |
+-------------------------------------------------+

### 9.3.59 PDCP Capability

Indicates which algorithms and which value range of their parameters are
supported by the MS.

The *PDCP Capability* IE indicates the algorithms and the value range of
parameters supported by the MS PDCP.

Table 9.3.59.1: *PDCP Capability* information elements

+----------------------------------------------------------------------+
| \< PDCP Capability IE \> ::=                                         |
|                                                                      |
| {                                                                    |
|                                                                      |
| **\< PDCP Capability length** : bit (8)\>                            |
|                                                                      |
| \< **Support for lossless serving BSC relocation :** bit (1) \>      |
|                                                                      |
| { \< **Support for RFC2507** : 0 \>                                  |
|                                                                      |
| \| \< **Support for RFC2507** : 1 \>                                 |
|                                                                      |
| \< **Max HC context space :** bit (4) }                              |
|                                                                      |
| { \< **Support for RFC3095** : 0 \>                                  |
|                                                                      |
| \| \< **Support for RFC3095** : 1 \>                                 |
|                                                                      |
| { 0 \| 1 \< **Maximum number of ROHC context sessions** : bit (4) \> |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Reverse decompression depth :** bit (16) \> } }        |
|                                                                      |
| { \< **Support for RFC 3095 context relocation:** 0 \>               |
|                                                                      |
| \| \< **Support for RFC 3095 context relocation:** 1 \> } }          |
|                                                                      |
| \< spare bit \>\*\*; *\-- Extension information may be truncated     |
| between released versions of the protocol\                           |
| \-- The receiver shall assume the value zero for any truncated bit*  |
|                                                                      |
| *};*                                                                 |
+----------------------------------------------------------------------+

Table 9.3.59.2: *PDCP Capability* information element details

+----------------------------------------------------------------------+
| **PDCP Capability Length** (8 bit field)\                            |
| This field is the binary representation of the length of the *PDCP   |
| Capability* IE in bits excluding the 8 bits used for this length     |
| field. Range: 0 to 255.                                              |
+----------------------------------------------------------------------+
| **Support for lossless Serving BSC relocation** (1 bit field)        |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 **Lossless Serving BSC relocation** not supported\                 |
| 1 **Lossless Serving BSC relocation** supported                      |
+----------------------------------------------------------------------+
| **Support for RFC2507** (1 bit field)\                               |
| **Support for RFC3095** (1 bit field)                                |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 not supported\                                                     |
| 1 supported                                                          |
+----------------------------------------------------------------------+
| **Max HC context space** (4 bit field)\                              |
| This field indicates the maximum header compression context space    |
| supported by the MS, when RFC2507 is supported and is encoded as     |
| follows :                                                            |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 4 3 2 1                                                              |
|                                                                      |
| 0 0 0 0 512 bytes                                                    |
|                                                                      |
| 0 0 0 1 1024 bytes                                                   |
|                                                                      |
| 0 0 1 0 2048 bytes                                                   |
|                                                                      |
| 0 0 1 1 4096 bytes                                                   |
|                                                                      |
| 0 1 0 0 8192 bytes                                                   |
|                                                                      |
| 0 1 0 1 16384 bytes                                                  |
|                                                                      |
| 0 1 1 0 32768 bytes                                                  |
|                                                                      |
| 0 1 1 1 65536 bytes                                                  |
|                                                                      |
| 1 0 0 0 131072 bytes                                                 |
|                                                                      |
| All other values are reserved                                        |
+----------------------------------------------------------------------+
| **Maximum number of ROHC context sessions (4 bit field)\             |
| **This field indicates the maximum number of ROHC context sessions   |
| when RFC3095 is supported and is encoded as shown below. If this     |
| field is not present, the MS shall use the default value of 16 :     |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 4 3 2 1                                                              |
|                                                                      |
| 0 0 0 0 2 sessions                                                   |
|                                                                      |
| 0 0 0 1 4 sessions                                                   |
|                                                                      |
| 0 0 1 0 8 sessions                                                   |
|                                                                      |
| 0 0 1 1 12 sessions                                                  |
|                                                                      |
| 0 1 0 0 16 sessions                                                  |
|                                                                      |
| 0 1 0 1 24 sessions                                                  |
|                                                                      |
| 0 1 1 0 32 sessions                                                  |
|                                                                      |
| 0 1 1 1 48 sessions                                                  |
|                                                                      |
| 1 0 0 0 64 sessions                                                  |
|                                                                      |
| 1 0 0 1 128 sessions                                                 |
|                                                                      |
| 1 0 1 0 256 sessions                                                 |
|                                                                      |
| 1 0 1 1 512 sessions                                                 |
|                                                                      |
| 1 1 0 0 1024 sessions                                                |
|                                                                      |
| 1 1 0 1 16384 sessions                                               |
|                                                                      |
| 1 1 1 0 reserved                                                     |
|                                                                      |
| 1 1 1 1 reserved                                                     |
+----------------------------------------------------------------------+
| **Reverse decompression depth** (16 bit field)\                      |
| This field describes the reverse compression depth as an integer     |
| from 0 - 65535. If the IE is not present, the default value of 0     |
| (reverse decompression is not supported) is used.                    |
+----------------------------------------------------------------------+
| **Support for RFC 3095 context relocation** (1 bit field)            |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Support for RFC 3095 context relocation not supported\             |
| 1 Support for RFC 3095 context relocation supported                  |
+----------------------------------------------------------------------+

### 9.3.60 PDCP Info

The *PDCP Info* IE contains information about the PDCP protocol.

Table 9.3.60.1: *PDCP Info* information elements

+----------------------------------------------------------------------+
| \< PDCP Info IE \> ::=                                               |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **PDCP mode** : bit (1) \>                                        |
|                                                                      |
| { \< **Lossless Serving BSS relocation** **support** : 0 \>          |
|                                                                      |
| \| \< **Lossless Serving BSS relocation** **support** : 1 \>         |
|                                                                      |
| \< **Max PDCP SN** : bit (1) \> }                                    |
|                                                                      |
| \< **PDCP PDU header** : bit (1) \>                                  |
|                                                                      |
| { 0 \| 1 \< **Header compression information List : bit(3) \>**      |
|                                                                      |
| \< **Header compression information struct** : \< Header compression |
| information struct \> \> } } \*(1+val(**Header compression           |
| information List))**                                                 |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+
| \< Header compression information struct \> ::=                      |
|                                                                      |
| \< **Header Compression Information struct length** : bit (14) \>    |
|                                                                      |
| { 000 *\-- Header compression according to IETF standard RFC2507*    |
|                                                                      |
| \< **F\_MAX\_PERIOD** : bit (16) \>                                  |
|                                                                      |
| \< **F\_MAX\_TIME** : bit (8) \>                                     |
|                                                                      |
| \< **MAX\_HEADER** : bit (16) \>                                     |
|                                                                      |
| \< **TCP\_SPACE** : bit (8) \>                                       |
|                                                                      |
| \< **NON\_TCP\_SPACE** : bit (16) \>                                 |
|                                                                      |
| \< **EXPECT\_REORDERING** : bit (1) \> }                             |
|                                                                      |
| \| 001 *\-- Header compression according to IETF standard RFC3095*   |
|                                                                      |
| \< **Profiles List** : bit (4) \>                                    |
|                                                                      |
| \< **Profile instance** : bit (2) \> \* (1 + val (Profiles List))    |
|                                                                      |
| { 0 \| 1 \< **UPLINK**: bit (1) \>                                   |
|                                                                      |
| \< **CID inclusion info** : bit (1) \>                               |
|                                                                      |
| { 0 \| 1 \< **Max\_CID** : bit (14) \> }                             |
|                                                                      |
| { 0 \| 1 \< **MRRU** : bit (16) \> }                                 |
|                                                                      |
| \< **Packet Sizes Allowed List** : bit (4) \>                        |
|                                                                      |
| \< **PACKET\_SIZES\_ALLOWED**: bit (11) \> \* (1 + val (Packet Sizes |
| Allowed List)) }                                                     |
|                                                                      |
| { 0 \| 1 \< **DOWNLINK**: bit (1) \>                                 |
|                                                                      |
| \< **CID inclusion info** : bit (1) \>                               |
|                                                                      |
| { 0 \| 1 \< **Max\_CID** : bit (14) \> }                             |
|                                                                      |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Reverse\_Decompression\_Depth** : bit (16) \> }        |
|                                                                      |
| ! \< Message escape : { 01 bit(1) \| 1 bit (2) } bit\*\* = \< no     |
| string \> \> ;                                                       |
+----------------------------------------------------------------------+

Table 9.3.60.2: *PDCP Info* information element details

+----------------------------------------------------------------------+
| **PDCP mode** (1 bit field)\                                         |
| bit\                                                                 |
| 1\                                                                   |
| 0 non-transparent\                                                   |
| 1 transparent                                                        |
+----------------------------------------------------------------------+
| **Lossless Serving BSS relocation** **support** (1 bit field)\       |
| Lossless Serving BSC relocation is supported when both the RLC is in |
| Acknowledged mode meaning when the IE \"RLC mode\" is                |
| \"Acknowledged\" bit\                                                |
| 1\                                                                   |
| 0 **Lossless Serving BSS relocation not supported\                   |
| 1 Lossless Serving BSS relocation supported**                        |
+----------------------------------------------------------------------+
| **Max PDCP SN** (1 bit field)\                                       |
| This field indicates the maximim PDCP Sequence Number supported,     |
| when the lossless Serving BSC relocation is supported.\              |
| bit\                                                                 |
| 1\                                                                   |
| 0 255\                                                               |
| 1 65535                                                              |
+----------------------------------------------------------------------+
| **PDCP PDU header** (1 bit field)\                                   |
| bit\                                                                 |
| 1\                                                                   |
| 0 not present\                                                       |
| 1 present                                                            |
+----------------------------------------------------------------------+
| **Header compression information List (3 bit field)\                 |
| This field is the binary representaion of the number of header       |
| compression information.**                                           |
|                                                                      |
| **Range: 0 to** maxPDCPAlgoType-1.\                                  |
| NOTE: Link with the PDCP instances to be clarified in the procedure. |
+----------------------------------------------------------------------+
| **Header compression information struct\                             |
| **The Header compression information struct is repeated up to        |
| maxPDCPalgoType times.                                               |
+----------------------------------------------------------------------+
| Header Compression Information struct length (14 bit field)\         |
| **This field is the binary representaion of the length of the**      |
| Header Compression Information struct excluding the bits used for    |
| this length field**.**                                               |
|                                                                      |
| **Range: 0 to** 4095.                                                |
+----------------------------------------------------------------------+
| **F\_MAX\_PERIOD** (16 bit field)\                                   |
| This field is a binary representation of the maximum number of       |
| compressed non-TCP headers that may be sent without sending a full   |
| header.                                                              |
|                                                                      |
| Range 1 to 65535.                                                    |
+----------------------------------------------------------------------+
| **F\_MAX\_TIME** (8 bit field)\                                      |
| This field is a binary representation of the maximum time in seconds |
| that a compressed headers may not be sent after sending last full    |
| header.                                                              |
|                                                                      |
| Range 1 to 255.                                                      |
+----------------------------------------------------------------------+
| **MAX\_HEADER** (16 bit field)\                                      |
| This field is a binary representation of the largest header size in  |
| octets that may be compressed.                                       |
|                                                                      |
| Range 60 to 65535.                                                   |
+----------------------------------------------------------------------+
| **TCP\_SPACE** (8 bit field)\                                        |
| This field is a binary representation of the maximum CID value for   |
| TCP connections.                                                     |
|                                                                      |
| Range 3 to 255.                                                      |
+----------------------------------------------------------------------+
| **NON\_TCP\_SPACE** (16 bit field)\                                  |
| This field is a binary representation of the maximum CID value for   |
| non-TCP connections.                                                 |
|                                                                      |
| Range 3 to 65535.                                                    |
+----------------------------------------------------------------------+
| **EXPECT\_REORDERING** (1 bit field)\                                |
| bit\                                                                 |
| 1\                                                                   |
| 0 reordering not expected,\                                          |
| 1 reordering expected                                                |
+----------------------------------------------------------------------+
| **UPLINK** (1 bit field)\                                            |
| bit\                                                                 |
| 1\                                                                   |
| 0 does not indicate the necessary information elements for UL\       |
| 1 indicates the necessary information elements for UL                |
+----------------------------------------------------------------------+
| **DOWNLINK** (1 bit field)\                                          |
| bit\                                                                 |
| 1\                                                                   |
| 0 does not indicate the necessary information elements for DL\       |
| 1 indicates the necessary information elements for DL                |
+----------------------------------------------------------------------+
| **CID inclusion info\                                                |
| **This field configures which method shall be used to carry RFC3095  |
| CID values :                                                         |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 PDCP Header\                                                       |
| 1 RFC3095 packet format                                              |
|                                                                      |
| **Max\_CID\                                                          |
| **This field describes the highest context ID number to be used by   |
| the MS compressor. If this field is not present then the default     |
| value of 15 is used.\                                                |
| This field is encoded as a binary number.                            |
|                                                                      |
| Range 0 to 16383. A value of 0 shall be counted as reserved.         |
+----------------------------------------------------------------------+
| **Profiles List (4 bit field)\                                       |
| **This field is a binary representation of the number of ROHC        |
| profiles supported by the GERAN decompressor.                        |
|                                                                      |
| Range 0 to maxROHC-Profiles-1.                                       |
+----------------------------------------------------------------------+
| **Profile instance\                                                  |
| **This field is a binary representation of the supported profile     |
| types.                                                               |
|                                                                      |
| Range 1 to 3. Any other value received shall be treated as reserved. |
+----------------------------------------------------------------------+
| **MRRU\                                                              |
| **This field describes the Maximum Reconstructed Reception Unit.     |
| When RLC is configured in non-transparent mode, this field is set to |
| the 0 and the segmentation function of the RFC 3095 shall not be     |
| used by the MS.\                                                     |
| The filed is encoded as a binary number.                             |
|                                                                      |
| Range 0 to 65535                                                     |
+----------------------------------------------------------------------+
| **Packet Sizes Allowed List (4 bit field)\                           |
| This field is the binary representation of the list of packet sizes  |
| that are allowed to be produced by RFC 3095.**                       |
+----------------------------------------------------------------------+
| **PACKET\_SIZES\_ALLOWED** (11 bit field)**\                         |
| **This field is the binary representation of the packets sizes in    |
| octets as defined by MS compressor.                                  |
|                                                                      |
| Range 2 to 1500. Any other received values shall be treated as       |
| reserved.                                                            |
+----------------------------------------------------------------------+
| **Reverse decompression depth** (16 bit field)\                      |
| This field describes the reverse compression depth as an integer     |
| from 0 to 65535. Also it determines whether reverse decompression    |
| should be used or not and the maximum number of packets that can be  |
| reverse decompressed by the MS decompressor. If the IE is not        |
| present, the default value of 0 (reverse decompression shall not be  |
| used) is used.                                                       |
|                                                                      |
| Range 0 to 65535                                                     |
+----------------------------------------------------------------------+

### 9.3.61 PDCP SN Info

The *PDCP SN Info* IE indicates the PDCP sequence number that the sender
of the message is expecting to be received next.

Table 9.3.61.1: *PDCP SN Info* information elements

  ------------------------------------
  **\< PDCP SN Info IE \> ::=**\
  \< **PDCP SN Info : bit (16)** \>;

  ------------------------------------

Table 9.3.61.2: *PDCP SN Info* information element details

  ---------------------------------------------------------------------------
  **PDCP SN Info** (16 bit field)\
  The *PDCP SN Info* field is encoded as a binary number. Range 0 to 65535.

  ---------------------------------------------------------------------------

### 9.3.62 Physical Channel Configuration

The *Physical Channel Configuration* IE describes the dedicated and the
shared physical resources.

Table 9.3.62.1: *Physical Channel Configuration* information elements

+-------------------------------------------------------------+
| \< Physical Channel Configuration IE \> ::=                 |
|                                                             |
| { 00 *\-- no physical resource allocated*                   |
|                                                             |
| \| 01 \< **DBPSCH** : \< DBPSCH Description IE \> \>        |
|                                                             |
| \| 10 \< **SBPSCH** : \< SBPSCH Description IE \> \>        |
|                                                             |
| \|                                                          |
|                                                             |
| ! \< Message escape : { 11 } bit\*\* = \< no string \> \> } |
|                                                             |
| \-- Reserved for future use};                               |
+-------------------------------------------------------------+

Table 9.3.62.2: *Physical Channel Configuration* information element
details

  ------------------------------------------
  **DBPSCH Description**\
  This IE is defined in sub-clause 9.3.19.

  **SBPSCH Description**\
  This IE is defined in sub-clause 9.3.99.
  ------------------------------------------

### 9.3.63 PLMN Identity

The *PLMN Identity* IE identifies a Public Land Mobile Network for a
GSM-MAP type of PLMN. The PLMN identity digits are defined in
3GPP TS 23.003.

Table 9.3.63.1: *PLMN Identity* information elements

+------------------------------------------------+
| \< PLMN Identity IE \> ::=                     |
|                                                |
| \< **MCC\_digit\_1** : bit (4) \>              |
|                                                |
| \< **MCC\_digit\_2** : bit (4) \>              |
|                                                |
| \< **MCC\_digit\_3** : bit (4) \>              |
|                                                |
| \< **MNC\_digit\_1 :** bit (4) \>              |
|                                                |
| \< **MNC\_digit\_2 :** bit (4) \>              |
|                                                |
| { 0 \| 1 \< **MNC\_digit\_3 :** bit (4) \> } ; |
+------------------------------------------------+

Table 9.3.63.2: *PLMN Identity* information element details

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **MCC\_digit\_1** (4 bit field)\
  **MCC\_digit\_2** (4 bit field)\
  **MCC\_digit\_3** (4 bit field)\
  These fields are the binary representation of the MCC digit number X, where X goes from 1 to 3. Range: 0 to 9.

  **MNC\_digit\_1** (4 bit field)\
  **MNC\_digit\_2** (4 bit field)\
  **MNC\_digit\_3** (4 bit field)\
  These fields are the binary representation of the MNC digit number X, where X goes from 1 to 2 or 3. Range: 0 to 9. The presence of a third MNC digit depends on the value of the MCC.
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.64 Power Command

The *Power Command* IE is to provide the power level to be used by the
mobile station.

Table 9.3.64.1: *Power Command* information elements

+--------------------------------------------+
| \< Power Command IE \> ::=                 |
|                                            |
| \< **Power Command Value :** octet (1) \>; |
+--------------------------------------------+

Table 9.3.64.2: *Power Command* information element details

  ---------------------------------------------------------------------------------------------------------
  **Power Command** **Value** (1 octet field)\
  The Power Command Value is coded as the value part of the *Power Command* IE defined in 3GPP TS 44.018.

  ---------------------------------------------------------------------------------------------------------

### 9.3.65 Power Command and Access Type

The *Power Command and Access Type* IE is to provide the power level to
be used by the mobile station.

Table 9.3.65.1: *Power Command and Access Type* information elements

+------------------------------------------------------------+
| \< Power Command and Access Type IE \> ::=                 |
|                                                            |
| \< **Power Command and Access Type Value** : octet (1) \>; |
+------------------------------------------------------------+

Table 9.3.65.2: *Power Command and Access Type* information element
details

  -----------------------------------------------------------------------------------------------------------------------------------------
  **Power Command and Access Type Value** (1 octet field)\
  The Power Command and Access Type Value is coded as the value part of the *Power Command and Access Type* IE defined in 3GPP TS 44.018.

  -----------------------------------------------------------------------------------------------------------------------------------------

### 9.3.66 (void)

### 9.3.67 (void)

### 9.3.68 (void)

### 9.3.69 Protocol Error Cause

The *Protocol Error Cause* IE indicates the cause of the incomprehension
of a message or information.

Table 9.3.69.1: *Protocol Error Cause* information elements

  -------------------------------------------
  \< Protocol Error Cause IE **\>** ::=\
  \< **Protocol Error Cause :** bit (3) \>;

  -------------------------------------------

Table 9.3.69.2: *Protocol Error Cause* information element details

  -----------------------------------------------------
  **Protocol Error Cause** (3 bit field)\
  bit\
  3 2 1\
  0 0 0 CSN.1 violation or encoding error\
  0 0 1 Message type non-existent or not implemented\
  0 1 0 Message not compatible with receiver state\
  0 1 1 Information element value not comprehended\
  1 0 0 Message content part error\
  1 0 1 Message extension not comprehended\
  \
  All other values are reserved.

  -----------------------------------------------------

### 9.3.70 Protocol Error Indicator

The *Protocol* *Error Indicator* IE indicates whether a message was
transmitted due to a protocol error or not.

Table 9.3.70.1: *Protocol Error Indicator* information elements

  -----------------------------------------------
  \< Protocol Error Indicator IE \> ::=\
  \< **Protocol Error Indicator :** bit (1) \>;

  -----------------------------------------------

Table 9.3.70.2: *Protocol Error Indicator* information element details

  ---------------------------------------------
  **Protocol Error Indicator** (1 bit field)\
  bit\
  1\
  0 False - no protocol error occurred\
  1 True - protocol error occurred

  ---------------------------------------------

### 9.3.71 Protocol Error Information

The *Protocol Error Information* IE contains diagnostic information
returned by the receiver of a message that was not completely
understood.

Table 9.3.71.1: *Protocol Error Information* information elements

+------------------------------------------------------------------------+
| \< Protocol Error Information IE \> ::=                                |
|                                                                        |
| { 0 \< **Protocol Error Cause :** \< **Protocol Error Cause IE** \> \> |
|                                                                        |
| \| 1 } ; \-- *reserved*                                                |
+------------------------------------------------------------------------+

Table 9.3.71.2: *Protocol Error Information* information element details

  ------------------------------------------
  **Protocol Error Cause**\
  This IE is defined in sub-clause 9.3.69.

  ------------------------------------------

### 9.3.72 RAB Identity

The *RAB Identity* IE uniquely identifies a radio access bearer within a
CN domain.

Table 9.3.72.1: *RAB Identity* information elements

  -----------------------------------------------------
  \< RAB Identity IE \> ::=\
  { 0 \< **RAB\_Identity\_GSM-MAP** : bit (8) \>\
  \| 1 \< **RAB\_Identity\_ANSI-41** : bit (8) \> } ;

  -----------------------------------------------------

Table 9.3.72.2: *RAB Identity* information element details

  ------------------------------------------------------------------------------------
  **RAB\_Identity\_GSM-MAP** (8 bit field)\
  This field indicates the RAB identity with a GSM-MAP-type PLMN. See 3GPP TS 24.008

  **RAB\_Identity\_ANSI-41** (8 bit field)\
  This field indicates the RAB identity with a ANSI-41-type PLMN. See 3GPP TS 24.008
  ------------------------------------------------------------------------------------

### 9.3.73 RAB Info

The *RAB Info* IE contains information used to uniquely identify a radio
access bearer.

Table 9.3.73.1: *RAB Info* information elements

+----------------------------------------------------------------------+
| \< RAB Info IE \> ::=                                                |
|                                                                      |
| \< **RAB Identity** : \< RAB Identity IE \> \>                       |
|                                                                      |
| \< **CN Domain Identity** : \< **CN Domain Identity** IE\> \>        |
|                                                                      |
| { 0 \| 1 \< **NAS Synchronization Indicator :** \< NAS               |
| Synchronization Info IE \> \> }                                      |
|                                                                      |
| \< **Re-Establishment Timer** : \< Re-Establishment Timer IE \> \>;  |
+----------------------------------------------------------------------+

Table 9.3.73.2: *RAB Info* information element details

  --------------------------------------------------------------------
  **RAB Identity**\
  This IE is defined in sub-clause 9.3.72.

  **CN Domain Identity**\
  This IE is defined in sub-clause 9.3.15.

  **NAS Synchronization Indicator**\
  The *NAS Synchronization Info* IE is defined in sub-clause 9.3.55.

  **Re-Establishment Timer**\
  This IE is defined in sub-clause 9.3.88.
  --------------------------------------------------------------------

### 9.3.74 RAB Info Post

The *RAB Info Post* IE contains information used to uniquely identify a
radio access bearer.

Table 9.3.74.1: *RAB Info Post* information elements

+----------------------------------------------------------------------+
| \< RAB Info Post IE\> ::=                                            |
|                                                                      |
| \< **RAB Identity** : \< RAB Identity IE \> \>                       |
|                                                                      |
| \< **CN Domain Identity** : \< CN Domain Identity IE \> \>           |
|                                                                      |
| { 0 \| 1 \< **NAS Synchronization Indicator : \<** NAS               |
| Synchronization Info : bit (4) \> \> };                              |
+----------------------------------------------------------------------+

Table 9.3.74.2: *RAB Info Post* information element details

  -----------------------------------------------------------------------
  **RAB Identity**\
  This IE is defined in sub-clause 9.3.72.

  **CN Domain Identity**\
  This field is defined in sub-clause 9.3.15.

  **NAS Synchronization Indicator**\
  The *NAS Synchronization Info* field is defined in sub-clause 9.3.55.
  -----------------------------------------------------------------------

### 9.3.75 RAB Information for Setup

The *RAB Information for Setup* IE indicates the radio access bearer(s)
to setup.

Table 9.3.75.1: *RAB Information for Setup* information elements

+----------------------------------------------------------------------+
| \< RAB Information for Setup IE \> ::=                               |
|                                                                      |
| \< **RAB Info** : \< RAB info IE \> \>                               |
|                                                                      |
| \< **RB Information to Setup List** : bit (3) \>                     |
|                                                                      |
| \< **RB Information to Setup** : \< RB Information to Setup IE \> \> |
| \*(1+val(RB Information to Setup List)) };                           |
+----------------------------------------------------------------------+

Table 9.3.75.2: *RAB Information for Setup* information element details

+----------------------------------------------------------------------+
| **RAB Info**\                                                        |
| This IE is defined in sub-clause 9.3.73.                             |
+----------------------------------------------------------------------+
| **RB Information to Setup List** (3 bit field)\                      |
| This field is the binary representation of the number of RB to setup |
| in a RAB. Range : 0 to maxRBperRAB-1.                                |
|                                                                      |
| **RB Information to Setup**\                                         |
| This IE is defined in sub-clause 9.3.84. This IE can be repeated up  |
| to maxRBperRAB times within one RAB information for setup IE.        |
+----------------------------------------------------------------------+

### 9.3.76 RAB Information to Reconfigure

The *RAB Information to Reconfigure* IE indicates the radio access
bearer(s) to reconfigure.

Table 9.3.76.1: *RAB Information to Reconfigure* information elements

+----------------------------------------------------------------------+
| \< RAB Information to Reconfigure IE \> ::=                          |
|                                                                      |
| \< **RAB Identity** : \< RAB Identity IE \> \>                       |
|                                                                      |
| \< **CN Domain Identity** : \< **CN Domain Identity IE** \> \>       |
|                                                                      |
| \< **NAS Synchronization Indicator :** \< NAS synchronization Info : |
| bit (4) \> \>;                                                       |
+----------------------------------------------------------------------+

Table 9.3.76.2: *RAB Information to Reconfigure* information element
details

  --------------------------------------------------------------------
  **RAB Identity**\
  This IE is defined in sub-clause 9.3.72.

  **CN Domain Identity**\
  This IE is defined in sub-clause 9.3.15.

  **NAS Synchronization Indicator**\
  The *NAS Synchronization Info* IE is defined in sub-clause 9.3.55.
  --------------------------------------------------------------------

### 9.3.77 RB Activation Time Info

The *RB Activation Time Info* IE contains the time, in terms of RLC
sequence numbers, when a certain configuration shall be activated, for a
number of radio bearers.

Table 9.3.77.1: *RB Activation Time Info* information elements

+----------------------------------------------------------------------+
| \< RB Activation Time Info IE \> ::=                                 |
|                                                                      |
| { 0 \| 1 \< **Repeated** **Radio Bearer Activation Time list : bit   |
| (5) \>**                                                             |
|                                                                      |
| \< **Repeated** **Radio Bearer Activation Time** : \< Radio Bearer   |
| Activation Time struct \> \> } \*(1+val(**Repeated Radio Bearer      |
| Activation Time list**)) } ;                                         |
+----------------------------------------------------------------------+
| \< Repeated Radio Bearer Activation Time struct \> ::=               |
|                                                                      |
| { \< **RB Identity** : \< **RB Identity IE \>** \>                   |
|                                                                      |
| { 0 \| 1 { 00 \< **GPRS RLC Sequence Number** : bit (7) \>           |
|                                                                      |
| \| 01 \< **EGPRS RLC Sequence Number** : bit (11) \>                 |
|                                                                      |
| \| 10 \< **DCCH TBF mode RLC Sequence Number** : bit (4) \>          |
|                                                                      |
| \| 11 \< **TCH TBF** **RLC Sequence Number** : bit (8) \> }          |
|                                                                      |
| }                                                                    |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 9.3.77.2: *RB Activation Time Info* information element details

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Repeated radio bearer activation time list (5 bit field)**\
  This field is the binary representation of the number of RBs. Range : 0 to maxRB-1.

  **Repeated radio bearer activation time struct**\
  The Repeated radio bearer activation time struct is repeated up to maxRB times.

  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.

  **GPRS RLC Sequence Number** (7 bit field)\
  This field indicates the RLC send state variable for GPRS MS with radio bearers mapped on RLC AM and UM. This field is encoded as a binary number. Range : 0 to 127.

  **EGPRS RLC Sequence Number** (11 bit field)\
  This field indicates the RLC send state variable for EGPRS MS with radio bearers mapped on RLC AM and UM. This field is encoded as a binary number. Range : 0 to 2047.

  **DCCH TBF RLC Sequence Number** (4 bit field)\
  This field indicates the RLC send state variable for DCCH TBF mode MS (see 3GPP TS 44.160) with radio bearers mapped on RLC AM and UM. This field is encoded as a binary number. Range : 0 to 15.

  **TCH TBF RLC Sequence Number** (8 bit field)\
  This field indicates the RLC send state variable for TCH TBF mode MS (see 3GPP TS 44.160) with radio bearers mapped on RLC AM and UM. This field is encoded as a binary number. Range : 0 to 255.
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.78 RB COUNT-C Information

The *RB COUNT-C Information* IE indicates RB COUNT-C values for a radio
bearer.

Table 9.3.78.1: *RB COUNT-C Information* information elements

+---------------------------------------------------+
| \< RB COUNT-C Information IE \> ::=\              |
| \< **RB Identity** : \< **RB Identity IE \>** \>\ |
| \< **COUNT-C-Uplink** : bit (32) \>               |
|                                                   |
| \< **COUNT-C-Downlink** : bit (32) \>;            |
+---------------------------------------------------+

Table 9.3.78.2: *RB COUNT-C Information* information element details

  -----------------------------------------------------------------------------------------------------
  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.

  **COUNT-C-Uplink** (32 bit field)\
  This field is the binary representation of the amount of data sent in Uplink. See 3GPP TS 33.102.

  **COUNT-C-Downlink** (32 bit field)\
  This field is the binary representation of the amount of data sent in Downlink. See 3GPP TS 33.102.
  -----------------------------------------------------------------------------------------------------

### 9.3.79 RB COUNT-C MSB Information

The *RB COUNT-C MSB Information* IE indicates the MSB of the COUNT-C
values of the radio bearer.

Table 9.3.79.1: *RB COUNT-C MSB Information* information elements

+--------------------------------------------+
| \< RB COUNT-C MSB Information IE \> ::=\   |
| \< **RB Identity** : bit (5) \>\           |
| \< **COUNT-C-MSB-Uplink** : bit (25) \>    |
|                                            |
| \< **COUNT-C-MSB-Downlink** : bit (25) \>; |
+--------------------------------------------+

Table 9.3.79.2: *RB COUNT-C MSB Information* information element details

  ---------------------------------------------------------------------------------------------------
  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.

  **COUNT-C-MSB-Uplink** (25 bit field)\
  This field indicates 25 MSBs from the COUNT-C-uplink associated to this RB. See 3GPP TS 33.102.

  **COUNT-C-MSB-Downlink** (25 bit field)\
  This field indicates 25 MSBs from the COUNT-C-downlink associated to this RB. See 3GPP TS 33.102.
  ---------------------------------------------------------------------------------------------------

### 9.3.80 RB Identity

The *RB Identity* IE indicates the identification number for the radio
bearer affected by a certain message.

Table 9.3.80.1: *RB Identity* information elements

  ----------------------------------
  \< **RB Identity** IE \> ::=\
  \< **RB Identity** : bit (5) \>;

  ----------------------------------

Table 9.3.80.2: *RB Identity* information element details

  ------------------------------------------------------------------------------------------------------------------------------------
  **RB Identity** (5 bit field)\
  The *RB Identity* field is encoded as a binary number. Range: 0 to 31. Values 0-4 shall only be used for signalling radio bearers.

  ------------------------------------------------------------------------------------------------------------------------------------

### 9.3.81 RB Information to Be Affected

The *RB Information to Be Affected* IE indicates identity of the RB to
be affected by the message.

Table 9.3.81.1: *RB Information to Be Affected* information elements

  ---------------------------------------------------
  \< RB Information to Be Affected IE \> ::=\
  \< **RB Identity** : \< **RB Identity IE \>** \>;

  ---------------------------------------------------

Table 9.3.81.2: *RB Information to Be Affected* information element
details

  ---------------------------------------------
  **RB Identity** (5 bit field)\
  This field is defined in sub-clause 9.3.80.

  ---------------------------------------------

### 9.3.82 RB Information to Reconfigure

The *RB Information to Reconfigure* IE indicates the radio bearer to
reconfigure.

Table 9.3.82.1: *RB Information to Reconfigure* information elements

+----------------------------------------------------------------------+
| \< RB Information to Reconfigure IE \> ::=                           |
|                                                                      |
| \< **RB Information to Reconfigure** **length** : bit ( 11 ) \>      |
|                                                                      |
| \< **RB Identity** : \< RB Identity IE \> \>                         |
|                                                                      |
| { 0 \| 1 \< **PDCP Info** : \< PDCP Info IE \> \> }                  |
|                                                                      |
| { 0 \| 1 \< **PDCP SN Info** : \< PDCP SN Info \> \> }               |
|                                                                      |
| { 0 \| 1 \< **RLC Info** : \< RLC info IE\> \> }                     |
|                                                                      |
| { 0 \| 1 \< **RB Stop/Continue** : bit (1) \> }                      |
|                                                                      |
| { 0 \| 1 \< **RB Mapping Info :** \< **RB Mapping Info** IE \> \> }  |
| \-- *Release 6* extension                                            |
|                                                                      |
| \< spare bits\> \*\*; \-- reserved for future use                    |
+----------------------------------------------------------------------+

Table 9.3.82.2: *RB Information to Reconfigure* information element
details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RB Information to Reconfigure** **length** (11 bit field)\
  This field is the binary representation of the length of the IE *RB Information to Reconfigure* in bits excluding the bits used for this length field. Range: 0 to 2047.

  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.

  **PDCP Info**\
  This IE is defined in sub-clause 9.3.60.

  **PDCP SN Info**\
  This IE is defined in sub-clause 9.3.61. The PDCP sequence number info from the network is present only in case of lossless SRNS relocation.

  **RLC Info**\
  This IE is defined in sub-clause 9.3.91.

  **RB Stop/Continue** (1 bit field)\
  bit\
  1\
  0 stop RB\
  1 continue RB

  **RB Mapping Info**\
  This IE is defined in sub-clause 9.3.117.
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.83 RB Information to Release

The *RB Information to Release* IE indicates identity of the RB to be
released.

Table 9.3.83.1: *RB Information to Release* information elements

  ---------------------------------------------------
  \< RB Information to Release IE \> ::=\
  \< **RB Identity :** \< **RB Identity IE \>** \>;

  ---------------------------------------------------

Table 9.3.83.2: *RB Information to Release* information element details

  ---------------------------------------------
  **RB Identity**\
  This field is defined in sub-clause 9.3.80.

  ---------------------------------------------

### 9.3.84 RB Information to Setup

The *RB Information to Setup* IE contains information about the RB to
setup.

Table 9.3.84.1: *RB Information to Setup* information elements

+----------------------------------------------------------------------+
| \< RB Information to Setup IE \> ::=                                 |
|                                                                      |
| \< **RB Information to Setup length** : bit (11) \>                  |
|                                                                      |
| \< **RB Identity :** \< RB Identity IE \> \>                         |
|                                                                      |
| { 0 \| 1 \< **PDCP Info :** \< PDCP Info IE \> \> }                  |
|                                                                      |
| {0 \| 1 \< **RLC Info :** \< RLC Info IE \> \> }                     |
|                                                                      |
| {0 \| 1 \< **RB Mapping Info :** \< **RB Mapping Info** IE \> \> }   |
| \-- *Release 6* extension                                            |
|                                                                      |
| \< spare bits\> \*\*; \-- reserved for future use                    |
+----------------------------------------------------------------------+

Table 9.3.84.2: *RB Information to Setup* information element details

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RB Information to Setup length** (11 bit field)\
  This field is the binary representation of the length of the IE *RB Information to Setup* in bits excluding the bits used for this length field. Range: 0 to 2047.

  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.

  **PDCP Info**\
  This IE is defined in sub-clause 9.3.60.

  **RLC Info**\
  This IE is defined in sub-clause 9.3.91.

  **RB Mapping Info**\
  This IE is defined in sub-clause 9.3.117.
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.85 RB Timer Indicator

This *RB Timer Indicator* IE indicates to GERAN if the timers T314 and
T315 have expired in the MS.

Table 9.3.85.1: *RB Timer Indicator* information elements

  ------------------------------------
  \< RB Timer Indicator IE \> ::=\
  \< **T314 Expired** : bit (1) \>\
  \< **T315 Expired** : bit (1) \> ;

  ------------------------------------

Table 9.3.85.2: *RB Timer Indicator* information element details

  ------------------------------------------------------------
  **T314 Expired** (1 bit field)\
  bit\
  1\
  0 False - the timer has not expired\
  1 True - the timer has expired or the stored value is zero

  **T315 Expired** (1 bit field)\
  bit\
  1\
  0 False - the timer has not expired\
  1 True - the timer has expired or the stored value is zero
  ------------------------------------------------------------

### 9.3.86 RB with PDCP Information

The *RB with PDCP Information* IE identifies the RB and provides the
PDCP sequence number info from the sender of the message for lossless
Serving BSC relocation.

Table 9.3.86.1: *RB with PDCP Information* information elements

  -----------------------------------------------
  \< RB with PDCP Information IE \> ::=\
  \< **RB Identity** : \< RB Identity IE \> \>\
  \< **PDCP SN Info** : \< PDCP SN Info \> \>;

  -----------------------------------------------

Table 9.3.86.2: *RB with PDCP Information* information element details

  ----------------------------------------------------------------------------------------------------------------------------------------
  **RB Identity**\
  This IE is defined in sub-clause 9.3.80.

  **PDCP SN Info**\
  This IE is defined in sub-clause 9.3.61. PDCP sequence number info from the sender of the message for lossless Serving BSC relocation.
  ----------------------------------------------------------------------------------------------------------------------------------------

### 9.3.87 (void)

### 9.3.88 Re-Establishment timer

This *Re-Establishment Timer* IE indicates which timer to associate with
RAB.

Table 9.3.88.1: *Re-Establishment Timer* information elements

  ---------------------------------------------
  \< Re-Establishment timer IE \> ::=\
  \< **Re-Establishment timer** : bit (1) \>;

  ---------------------------------------------

Table 9.3.88.2: *Re-Establishment Timer* information element details

  -------------------------------------------
  **Re-Establishment Timer** (1 bit field)\
  bit\
  1\
  0 use T314\
  1 use T315

  -------------------------------------------

### 9.3.89 Rejection Cause

The *Rejection Cause* IE indicates the cause for rejection of RRC
connection establishment request.

Table 9.3.89.1: *Rejection Cause* information elements

  --------------------------------------
  \< Rejection Cause IE \> ::=\
  \< **Rejection Cause** : bit (1) \>;

  --------------------------------------

Table 9.3.89.2: *Rejection Cause* information element details

  ------------------------------------
  **Rejection Cause** (1 bit field)\
  bit\
  1\
  0 congestion\
  1 unspecified

  ------------------------------------

### 9.3.90 Release Cause

The *Release Cause* IE indicates the cause for releasing the RRC
connection.

Table 9.3.90.1: *Release Cause* information elements

  ------------------------------------
  \< Release Cause IE \> ::=\
  \< **Release Cause** : bit (3) \>;

  ------------------------------------

Table 9.3.90.2: *Release Cause* information element details

  --------------------------------------------------------
  **Release Cause** (3 bit field)\
  bit\
  3 2 1\
  0 0 0 normal event\
  0 0 1 unspecified\
  0 1 0 pre-emptive release\
  0 1 1 congestion\
  1 0 0 re-establishment reject\
  1 0 1 directed signalling connection re-establishment\
  1 1 0 user inactivity\
  1 1 1 reserved

  --------------------------------------------------------

### 9.3.91 RLC Info

The *RLC Info* IE contains information about the RLC protocol.

Table 9.3.91.1: *RLC Info* information elements

+----------------------------------------------------------------------+
| \< RLC Info IE \> ::=                                                |
|                                                                      |
| \< **RLC Info length** : bit (5) \>                                  |
|                                                                      |
| { 00 *\-- RLC in Acknowledged mode*                                  |
|                                                                      |
| {0\|1 \< **Resegment** : bit (1) \>}                                 |
|                                                                      |
| { 0 \| 1 \< **Transmission RLC Discard** : \< Transmission RLC       |
| Discard IE \> \>}                                                    |
|                                                                      |
| { 0 \| 1 \< **EGPRS window size** : bit (5) \> }                     |
|                                                                      |
| \| 01 *\-- RLC in Unacknowledged mode*                               |
|                                                                      |
| {0 \| 1 \< **EGPRS Window Size** : bit (5) \> }                      |
|                                                                      |
| ! \< Message escape : { 1 bit (1) } bit\*\*= \< no string \> \> } ;  |
| \-- *reserved*                                                       |
+----------------------------------------------------------------------+

Table 9.3.91.2: *RLC Info* information element details

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RLC Info length** (5 bit field)\
  This field is the binary representation of the RLC Info IE excluding the 5 bits used to define this field. Range 0 to 31.

  **Resegment**\
  bit\
  1\
  0 Retransmitted RLC data blocks shall not be resegmented\
  1 Retransmitted RLC data blocks shall be resegmented according to commanded MCS

  **Transmission RLC Discard**\
  This IE is defined in sub-clause 9.3.95.

  **EGPRS Window Size**\
  This information element defines the window size to be used in an EGPRS TBF. The network sets the window size according to the number of timeslots allocated in the direction of the TBF. This Field is coded as defined in 3GPP TS 44.060.
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.92 RLC HFN IE

This IE contains the RLC HFN used in ciphering for EGPRS, GPRS or UTRAN
in AM or UM RLC.

Table 9.3.92.1: *RLC HFN* information elements

+----------------------------------------------------------------------+
| \< RLC HFN IE \>::=                                                  |
|                                                                      |
| \< **RLC HFN length** : bit (5) \>                                   |
|                                                                      |
| { 000 \< **RLC HFN** : bit (20) \> \-- *Used in the case of EGPRS    |
| and UTRAN AM RLC*                                                    |
|                                                                      |
| \| 001 \< **RLC HFN** : bit (24) \> \-- *Used in the case of GPRS*   |
|                                                                      |
| \| 010 \< **RLC HFN** : bit (25) \> \-- *Used in the case of UTRAN   |
| UM RLC*                                                              |
|                                                                      |
| \| 011 \< **RLC HFN** : bit (27) \> \-- *Used in the case of GERAN   |
| DBPSCH*                                                              |
|                                                                      |
| *\-- Release 6 RLC HFN \--*                                          |
|                                                                      |
| \| 100 \< **RLC HFN** : bit (21) \> \-- *Used in the case of GERAN   |
| DBPSCH,* *AM RLC* *UDCH TBF mode*                                    |
|                                                                      |
| \| 101 \< **RLC HFN** : bit (27) \> \-- *Used in the case of GERAN   |
| DBPSCH,* *UM RLC* *UDCH TBF mode*                                    |
|                                                                      |
| \| 110 \< **RLC HFN** : bit (27) \> \-- *Used in the case of GERAN   |
| DBPSCH,* *AM RLC CDCH TBF mode*                                      |
|                                                                      |
| ! \< Message escape : {111 } bit\*\*= \< no string \> \> } ;         |
+----------------------------------------------------------------------+

Table 9.3.92.2: *RLC HFN* information element details

  -------------------------------------------------------------------------------------------------------------------------------
  **RLC HFN Length\
  **This field is the binary representation of the length in bits of the RLC HFN field in this IE. Range: 1+val(RLC HFN length)

  **RLC HFN** (20..27 bit field)\
  This field defines the RLC HFN used in the ciphering procedure at RLC/MAC. See 3GPP TS 44.160
  -------------------------------------------------------------------------------------------------------------------------------

### 9.3.93 RPLMN Information

Table 9.3.93.1: *RPLMN Information* information elements

+----------------------------------------------------------------------+
| \< RPLMN Information IE \> ::=                                       |
|                                                                      |
| {                                                                    |
|                                                                      |
| *\-- GSM parameters, lower bound and upper bound of GSM BA freqs*    |
|                                                                      |
| { 0\|1 \< **GSM BA Range** : bit (6) \>                              |
|                                                                      |
| { \<**GSM Lower Range**:bit (14)\>                                   |
|                                                                      |
| \<**GSM Upper Range** : bit(14) \>                                   |
|                                                                      |
| \<**UARFCN** : bit(14) \> } \* (1+val(GSM BA Range))}}               |
|                                                                      |
| { 0\|1 \< **CDMA2000 UMTS Frequency list** : bit (3) \>              |
|                                                                      |
| { \< **BAND\_CLASS** : bit(5)\>                                      |
|                                                                      |
| \< **CDMA\_FREQ** : bit(11)\> } \* (1+val(CDMA2000 UMTS Frequency    |
| list))}}                                                             |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.3.93.2: *RPLMN Information* information element details

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------
  **GSM BA Range** (6 bit field)\
  This field is the binary representation of maximum number of GSM Frequency Ranges to store. Range 0 to maxNumGSMFreqRanges-1.

  **GSM Lower Range** (14 bit field)\
  This field is the binary representation of lower bound for range of GSM BA frequencies, lower bound.

  **GSM Upper Range** (14 bit field)\
  This field is the binary representation of lower bound for range of GSM BA frequencies, upper bound.

  **UARFCN** (14 bit field)\
  This field is defined in 3GPP TS 25.102.

  **CDMA2000 UMTS** **Frequency list** (3 bit field)\
  This field is the binary representation of maximum number of CDMA Frequency Ranges to store. Range 0 to maxNumCDMA2000FreqRanges-1.

  **BAND\_CLASS** (5 bit field)\
  This field is the bit string representation of TIA/EIA/IS-2000 BAND\_CLASS. The bits are numbered b0 to b4, where b0 is the least significant bit.

  **CDMA\_FREQ** (11 bit field)\
  This field is the bit string representation of CDMA\_FREQ TIA/EIA/IS-2000. The CDMA\_FREQ bits are numbered b0 to b10, where b0 is the least significant bit.
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.94 RRC Cause

The *RRC Cause* IE is to provide the reason for failure of the physical
channel setup, reconfiguration, release or the reason for completion of
handover.

Table 9.3.94.1: *RRC Cause* information elements

  --------------------------------
  \< RRC Cause IE \> ::=\
  \< **RRC Cause** : bit (8) \>;

  --------------------------------

Table 9.3.94.2: *RRC Cause* information element details

  -------------------------------------------------------------------------
  **RRC Cause** (8 field)\
  \
  Bits\
  8 7 6 5 4 3 2 1\
  0 0 0 0 0 0 0 0 Normal event\
  0 0 0 0 0 0 0 1 Abnormal release, unspecified\
  0 0 0 0 0 0 1 0 Abnormal release, channel unacceptable\
  0 0 0 0 0 0 1 1 Abnormal release, timer expired\
  0 0 0 0 0 1 0 0 Abnormal release, no activity on the radio path\
  0 0 0 0 0 1 1 0 UTRAN configuration unknown\
  0 0 0 0 1 0 0 0 Handover impossible, timing advance out of range\
  0 0 0 0 1 0 0 1 Channel mode unacceptable\
  0 0 0 0 1 0 1 0 Frequency not implemented\
  0 0 0 0 1 1 0 0 Lower layer failure\
  0 1 0 0 0 0 0 1 Call already cleared\
  0 1 0 1 1 1 1 1 Semantically incorrect message\
  0 1 1 0 0 0 0 0 Invalid mandatory information\
  0 1 1 0 0 0 0 1 Message type non-existent or not implemented\
  0 1 1 0 0 0 1 0 Message type not compatible with protocol state\
  0 1 1 0 0 1 0 0 Conditional IE error\
  0 1 1 0 0 1 0 1 No cell allocation available\
  0 1 1 0 1 1 1 1 Protocol error unspecified\
  All other cause values shall be treated as 0000 0000, \'normal event\'.

  -------------------------------------------------------------------------

### 9.3.95 RRC Packet Downlink Assignment

The *RRC Packet Downlink Assignment* IE is sent by the network to the
mobile station to indicate the assigned downlink resources. The *RRC
Packet Downlink Assignment* IE is coded as shown in 3GPP TS 44.018.

Table 9.3.95.1: *RRC Packet Downlink Assignment* information elements

+----------------------------------------------------------------------+
| \< RRC Packet Downlink Assignment IE \> ::=                          |
|                                                                      |
| \< **LENGTH\_IN\_OCTETS** : bit (8) \>                               |
|                                                                      |
| \< **MAC\_MODE** : bit (2) \>                                        |
|                                                                      |
| \< **RLC\_MODE** : bit (1) \>                                        |
|                                                                      |
| \< **TIMESLOT\_ALLOCATION :** bit (8) \>                             |
|                                                                      |
| \< **Packet Timing Advance :** \< Packet Timing Advance IE \> \>     |
|                                                                      |
| { 0 \| 1 \< **P0** : bit (4) \>                                      |
|                                                                      |
| \< **BTS\_PWR\_CTRL\_MODE** : bit (1) \>                             |
|                                                                      |
| \< **PR\_MODE** : bit (1) \>}                                        |
|                                                                      |
| { 0 \| 1 \< **Power Control Parameters** : \< Power Control          |
| Parameters IE \> \> }                                                |
|                                                                      |
| { 0 \| 1 \< **DOWNLINK\_TFI\_ASSIGNMENT** : bit (5) \> }             |
|                                                                      |
| { 0 \| 1 \< **MEASUREMENT\_STARTING\_TIME :** bit (16) \>            |
|                                                                      |
| \< **MEASUREMENT\_INTERVAL :** bit (5) \>                            |
|                                                                      |
| \< **MEASUREMENT\_BITMAP :** bit (8) \> }                            |
|                                                                      |
| { 0 \| 1 *\-- indicates EGPRS TBF mode, see* 3GPP TS *44.060*        |
|                                                                      |
| \< **EGPRS Window Size** : \< EGPRS Window Size IE \> \>             |
|                                                                      |
| \< **LINK\_QUALITY\_MEASUREMENT\_MODE** : bit (2)\>}                 |
|                                                                      |
| { 0 \| 1 \< **BEP\_PERIOD2** : bit (4) \> } }                        |
|                                                                      |
| { 0 \| 1 **\<Packet Extended timing Advance :** bit (2) \> } ;       |
+----------------------------------------------------------------------+

Table 9.3.95.2: *RRC Packet Downlink Assignment* information element
details

+----------------------------------------------------------------------+
| **LENGTH\_IN\_OCTETS** (8 bit field)**\                              |
| **This field encodes (in binary) the number that is equal to one     |
| eighth of the number of bits in the *RR Packet Downlink Assignment*  |
| information element that follow the end of this field.               |
+----------------------------------------------------------------------+
| **MAC\_MODE** (2 bit field)**\                                       |
| **This field is encoded as the MAC\_MODE information field in the    |
| PACKET DOWNLINK ASSIGNMENT message in 3GPP TS 44.060.                |
+----------------------------------------------------------------------+
| **RLC\_MODE** (1 bit field)\                                         |
| This field is encoded as the RLC\_MODE field in the PACKET DOWNLINK  |
| ASSIGNMENT message in 3GPP TS 44.060.                                |
+----------------------------------------------------------------------+
| **TIMESLOT\_ALLOCATION** (8 bit field)**\                            |
| **This field is encoded as the TIMESLOT\_ALLOCATION field in the     |
| PACKET DOWNLINK ASSIGNMENT message in 3GPP TS 44.060.                |
+----------------------------------------------------------------------+
| **Packet Timing Advance IE**\                                        |
| This field is encoded as the *Packet Timing Advance* IE in the       |
| PACKET DOWNLINK ASSIGNMENT message in 3GPP TS 44.060.                |
+----------------------------------------------------------------------+
| *P0, BTS\_PWR\_CTRL\_MODE and PR\_MODE fields\                       |
| *These fields are optional downlink power control parameters and are |
| encoded as in the PACKET UPLINK ASSIGNMENT message in                |
| 3GPP TS 44.060.                                                      |
+----------------------------------------------------------------------+
| **Power Control Parameters IE**\                                     |
| This field is encoded as the Power Control Parameters IE in the      |
| PACKET DOWNLINK ASSIGNMENT message in 3GPP TS 44.060.                |
+----------------------------------------------------------------------+
| **DOWNLINK\_TFI\_ASSIGNMENT** (5 bit field)\                         |
| If present, this field is encoded as the DOWNLINK\_TFI\_ASSIGNMENT   |
| information element in the PACKET DOWNLINK ASSIGNMENT message in     |
| 3GPP TS 44.060.                                                      |
+----------------------------------------------------------------------+
| **MEASUREMENT\_STARTING\_TIME** (16 bit field)\                      |
| If present, this field is encoded as the 16-bit *value part* of the  |
| *Starting Time* IE defined in sub-clause 10.5.2.38 (starting with    |
| bit 8 of octet 2 and ending with bit 1 of octet 3 of the *Starting   |
| Time* IE).MEASUREMENT\_STARTING\_TIME field in the PACKET DOWNLINK   |
| ASSIGNMENT message in 3GPP TS 44.060.                                |
|                                                                      |
| The frame number shall be aligned to a PDTCH block period according  |
| to the requirements defined for the \'Absolute Frame Number          |
| Encoding\' in the \'*Starting Time Frame Number Description\'* IE    |
| defined in 3GPP TS 44.060.                                           |
+----------------------------------------------------------------------+
| **MEASUREMENT\_BITMAP** (8 bit field)\                               |
| If present, this field is encoded as the MEASUREMENT BITMAP          |
| information field in the PACKET DOWNLINK ASSIGNMENT message in       |
| 3GPP TS 44.060.                                                      |
+----------------------------------------------------------------------+
| **MEASUREMENT\_INTERVAL** (5 bit field)\                             |
| If present, this field is encoded as the MEASUREMENT\_INTERVAL field |
| in the PACKET DOWNLINK ASSIGNMENT message in 3GPP TS 44.060.         |
+----------------------------------------------------------------------+
| **EGPRS Window Size IE\                                              |
| **This field is encoded as the *EGPRS Window Size* IE in the PACKET  |
| UPLINK ASSIGNMENT message in 3GPP TS 44.060.                         |
+----------------------------------------------------------------------+
| **LINK\_QUALITY\_MEASUREMENT\_MODE** (2 bit field)\                  |
| This field is encoded as the LINK\_QUALITY\_MEASUREMENT\_MODE in the |
| PACKET DOWNLINNK ASSIGNMENT message in 3GPP TS 44.060.               |
+----------------------------------------------------------------------+
| **Packet Extended Timing Advance** (2 bit field)\                    |
| This bit field is used for support of Extended Timing Advance.\      |
| Bit\                                                                 |
| 1 bit 7 of the *Timing Advance* IE defined in sub-clause 10.5.2.40\  |
| 2 bit 8 of the *Timing Advance* IE defined in sub-clause 10.5.2.40   |
+----------------------------------------------------------------------+
| **BEP\_PERIOD2 (4 bit field)\                                        |
| This field is described in 3GPP TS 44.060.**                         |
+----------------------------------------------------------------------+

### 9.3.95a RRC Packet Downlink Assignment 2

The *RRC Packet Downlink Assignment 2* IE is sent by the network to the
mobile station to indicate the assigned downlink resources. The *RRC
Packet Downlink Assignment 2* IE is coded as shown in the table below.

Table 9.3.95a.1: *RRC Packet Downlink Assignment* information elements

+---------------------------------------------------------------+
| \< RRC Packet Downlink Assignment 2 IE \> ::=                 |
|                                                               |
| \< **LENGTH\_IN\_OCTETS** : bit (8) \>                        |
|                                                               |
| { 0 \| 1 *\-- indicates EGPRS TBF mode, see* 3GPP TS *44.060* |
|                                                               |
| \< **EGPRS Window Size** : \< EGPRS Window Size IE \> \>      |
|                                                               |
| \< **LINK\_QUALITY\_MEASUREMENT\_MODE** : bit (2)\>           |
|                                                               |
| { 0 \| 1 \< **BEP\_PERIOD2** : bit (4) \> }};                 |
+---------------------------------------------------------------+

Table 9.3.95a.2: *RRC Packet Downlink Assignment 2* information element
details

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **LENGTH\_IN\_OCTETS** (8 bit field)**\
  **This field encodes (in binary) the number that is equal to one eighth of the number of bits in the *RR Packet Downlink Assignment 2 information* element that follow the end of this field.

  **EGPRS Window Size IE\
  **This field is encoded as the *EGPRS Window Size* IE in the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.

  **LINK\_QUALITY\_MEASUREMENT\_MODE** (2 bit field)\
  This field is encoded as the LINK\_QUALITY\_MEASUREMENT\_MODE in the PACKET DOWNLINK ASSIGNMENT message in 3GPP TS 44.060.
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.96 RRC Packet Uplink Assignment

The *RRC Packet Uplink Assignment* IE is sent by the network to the
mobile station to indicate the assigned uplink resources. The *RRC
Packet Uplink Assignment* IE is coded as shown in 3GPP TS 44.018.

Table 9.3.96.1: *RRC Packet Uplink Assignment* information elements

+----------------------------------------------------------------------+
| \< RRC Packet Uplink Assignment IE \> ::=\                           |
| \< **LENGTH\_IN\_OCTETS** : bit (8) \>                               |
|                                                                      |
| \< **G-RNTI\_BLOCK\_CHANNEL\_CODING** : bit (1) \>                   |
|                                                                      |
| \< **Packet Timing Advance** : \< Packet Timing Advance IE \> \>     |
|                                                                      |
| \< **Allocation** : \< Allocation struct \> \>                       |
|                                                                      |
| { 0 *\-- for MS operating in GPRS*                                   |
|                                                                      |
| \< **CHANNEL\_CODING\_COMMAND** : bit (2) \>                         |
|                                                                      |
| \| 1 \-- for MS operating in EGPRS                                   |
|                                                                      |
| \< **EGPRS\_MCS\_MODE** : bit (4) \>                                 |
|                                                                      |
| \< **RESEGMENT** : bit (1) \>                                        |
|                                                                      |
| \< **EGPRS Window Size** : \< EGPRS Window Size IE \> \>}            |
|                                                                      |
| { 0 \| 1 \< **Packet Extended Timing Advance** : bit (2) \> } ;      |
+----------------------------------------------------------------------+
| \< Allocation struct \> ::=                                          |
|                                                                      |
| { 00 \< **Dynamic Allocation** : \< Dynamic Allocation struct\> \>   |
|                                                                      |
| \| 01 \< **Single Block Allocation** : \< Single Block Allocation    |
| struct \> \>                                                         |
|                                                                      |
| ! \< Message escape : { 1 bit (1) } bit\*\*= \< no string \> \> }    |
+----------------------------------------------------------------------+
| \< Dynamic Allocation struct \> ::=                                  |
|                                                                      |
| \< **Extended Dynamic Allocation** : bit (1) \>                      |
|                                                                      |
| { 0 \| 1 \< **P0** : bit (4) \>                                      |
|                                                                      |
| \< **PR\_MODE** : bit (1) \> }                                       |
|                                                                      |
| \< **USF\_GRANULARITY** : bit (1) \>                                 |
|                                                                      |
| { 0 \| 1 \< **UPLINK\_TFI\_ASSIGNMENT** : bit (5) \> }               |
|                                                                      |
| { 0 \| 1 \< **RLC\_DATA\_BLOCKS\_GRANTED :** bit (8) \> }            |
|                                                                      |
| { 0 \-- Timeslot Allocation                                          |
|                                                                      |
| { 0 \| 1 \< **USF\_TN0 :** bit (3) \>}                               |
|                                                                      |
| { 0 \| 1 \< **USF\_TN1 :** bit (3) \>}                               |
|                                                                      |
| { 0 \| 1 \< **USF\_TN2 :** bit (3) \>}                               |
|                                                                      |
| { 0 \| 1 \< **USF\_TN3 :** bit (3) \>}                               |
|                                                                      |
| { 0 \| 1 \< **USF\_TN4 :** bit (3) \>}                               |
|                                                                      |
| { 0 \| 1 \< **USF\_TN5 :** bit (3) \>}                               |
|                                                                      |
| { 0 \| 1 \< **USF\_TN6 :** bit (3) \>}                               |
|                                                                      |
| { 0 \| 1 \< **USF\_TN7 :** bit (3) \>}                               |
|                                                                      |
| \| 1 *\-- Timeslot Allocation with Power Control Parameters*         |
|                                                                      |
| \< **ALPHA :** bit (4) \>                                            |
|                                                                      |
| { 0 \| 1 \< **USF\_TN0 :** bit (3) \>                                |
|                                                                      |
| \< **GAMMA\_TN0 :** bit (5) \> }                                     |
|                                                                      |
| { 0 \| 1 \< **USF\_TN1 :** bit (3) \>                                |
|                                                                      |
| \< **GAMMA\_TN1** : bit (5) \> }                                     |
|                                                                      |
| { 0 \| 1 \< **USF\_TN2 :** bit (3) \>                                |
|                                                                      |
| \< **GAMMA\_TN2** : bit (5) \> }                                     |
|                                                                      |
| { 0 \| 1 \< **USF\_TN3 :** bit (3) \>                                |
|                                                                      |
| \< **GAMMA\_TN3** : bit (5) \> }                                     |
|                                                                      |
| { 0 \| 1 \< **USF\_TN4 :** bit (3) \>                                |
|                                                                      |
| \< **GAMMA\_TN4** : bit (5) \> }                                     |
|                                                                      |
| { 0 \| 1 \< **USF\_TN5 :** bit (3) \>                                |
|                                                                      |
| \< **GAMMA\_TN5** : bit (5) \> }                                     |
|                                                                      |
| { 0 \| 1 \< **USF\_TN6 :** bit (3) \>                                |
|                                                                      |
| \< **GAMMA\_TN6** : bit (5) \> }                                     |
|                                                                      |
| { 0 \| 1 \< **USF\_TN7 :** bit (3) \>                                |
|                                                                      |
| \< **GAMMA\_TN7** : bit (5) \> } };                                  |
+----------------------------------------------------------------------+
| \< Single Block Allocation struct \> ::=                             |
|                                                                      |
| \< **TIMESLOT\_NUMBER :** bit (3) \>                                 |
|                                                                      |
| { 0 \| 1 \< **ALPHA :** bit (4) \>                                   |
|                                                                      |
| \< **GAMMA\_TN :** bit (5) \>}                                       |
|                                                                      |
| { 0 \| 1 \< **P0** : bit (4) \>                                      |
|                                                                      |
| \< **BTS\_PWR\_CTRL\_MODE** : bit (1) \>                             |
|                                                                      |
| \< **PR\_MODE** : bit (1) \> };                                      |
+----------------------------------------------------------------------+

Table 9.3.96.2: *RRC Packet Uplink Assignment* information element
details

+----------------------------------------------------------------------+
| **LENGTH\_IN\_OCTETS** (8 bit field)**\                              |
| **This field is the binary representation of the length of the *RR   |
| Packet Uplink Assignment IE* value part in octets. Range: 0 to 255   |
+----------------------------------------------------------------------+
| **CHANNEL\_CODING\_COMMAND** (2 bit field)\                          |
| This field is encoded as the CHANNEL\_CODING\_COMMAND field in the   |
| PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.                  |
+----------------------------------------------------------------------+
| **TLLI\_BLOCK\_CHANNEL\_CODING** (1 bit field)\                      |
| This field is encoded as the TLLI\_BLOCK\_CHANNEL\_CODING field in   |
| the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.              |
+----------------------------------------------------------------------+
| **Packet Timing Advance IE**\                                        |
| This field is encoded as the *Packet Timing Advance* IE in the       |
| PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.                  |
+----------------------------------------------------------------------+
| **Allocation struct\                                                 |
| This structure indicates the type of** radio resources **allocation  |
| used and the parameters** necessary to define the radio resources.   |
+----------------------------------------------------------------------+
| **EGPRS\_MCS\_MODE** (4 bit field)\                                  |
| This field is coded as the EGPRS Modulation and Coding Scheme IE in  |
| the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.              |
+----------------------------------------------------------------------+
| **RESEGMENT** (1 bit field)\                                         |
| This field is coded as the RESEGMENT bit in the PACKET UPLINK        |
| ASSIGNMENT message in 3GPP TS 44.060.                                |
+----------------------------------------------------------------------+
| **EGPRS Window Size IE\                                              |
| **This field is encoded as the *EGPRS window size* IE in the PACKET  |
| DOWNLINK ASSIGNMENT message in 3GPP TS 44.060.                       |
+----------------------------------------------------------------------+
| **TIMESLOT\_ALLOCATION** (8 bit field)**\                            |
| **This field is encoded as the TIMESLOT\_ALLOCATION field in the     |
| PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.                  |
+----------------------------------------------------------------------+
| **Dynamic Allocation struct\                                         |
| **This structure contains parameters necessary to define the radio   |
| resources of a dynamic allocation or an extended dynamic allocation. |
+----------------------------------------------------------------------+
| **Extended Dynamic Allocation** (1 bit field)\                       |
| This information field indicates the medium access mode to be used   |
| during the TBF.\                                                     |
| 0 Dynamic Allocation\                                                |
| 1 Extended Dynamic Allocation                                        |
+----------------------------------------------------------------------+
| **UPLINK\_TFI\_ASSIGNMENT** (5 bit field)\                           |
| This field is encoded as the UPLINK\_TFI\_ASSIGNMENT information     |
| element in the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.   |
+----------------------------------------------------------------------+
| **Power Control Parameters IE**\                                     |
| This field is encoded as the *Power Control Parameters* IE in the    |
| PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.                  |
+----------------------------------------------------------------------+
| **RLC\_DATA\_BLOCKS\_GRANTED** (8 bit field)\                        |
| This field is encoded as the RLC\_DATA\_BLOCKS\_GRANTED field in the |
| PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.                  |
+----------------------------------------------------------------------+
| **USF for Timeslot Number 0 (TN0)** (3 bit field)\                   |
| **USF for Timeslot Number 1 (TN1)** (3 bit field)\                   |
| **USF for Timeslot Number 2 (TN2)** (3 bit field)\                   |
| **USF for Timeslot Number 3 (TN3)** (3 bit field)\                   |
| **USF for Timeslot Number 4 (TN4)** (3 bit field)\                   |
| **USF for Timeslot Number 5 (TN5)** (3 bit field)\                   |
| **USF for Timeslot Number 6 (TN6)** (3 bit field)\                   |
| **USF for Timeslot Number 7 (TN7)** (3 bit field)\                   |
| These fields are encoded as the USF for Timeslot Number X field      |
| (where 0=\<X\<7) in the PACKET UPLINK ASSIGNMENT message in          |
| 3GPP TS 44.060.                                                      |
+----------------------------------------------------------------------+
| **Single Block Allocation struct\                                    |
| **This structure contains parameters necessary to define the radio   |
| resources of a Single Block allocation. For example for sending of a |
| PACKET RESOURCE REQUEST message in a two phase access or a           |
| Measurement report.                                                  |
+----------------------------------------------------------------------+
| **ALPHA** (4 bit field)\                                             |
| The ALPHA Power control parameter field is coded according to the    |
| following table :                                                    |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 4 3 2 1                                                              |
|                                                                      |
| 0 0 0 0 α = 0.0                                                      |
|                                                                      |
| 0 0 0 1 α = 0.1                                                      |
|                                                                      |
| : :                                                                  |
|                                                                      |
| 1 0 0 1 α = 0.9                                                      |
|                                                                      |
| 1 0 1 0 α = 1.0                                                      |
|                                                                      |
| All other values are reserved in this version of the protocol and    |
| shall be interpreted by the mobile station as α = 1.0.               |
+----------------------------------------------------------------------+
| **TIMESLOT\_NUMBER** (3 bit field)\                                  |
| If present, this field is encoded as the TIMESLOT\_NUMBER field in   |
| the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.              |
+----------------------------------------------------------------------+
| **GAMMA\_TN** (5 bit field)\                                         |
| The GAMMA\_TN field is the binary representation of the parameter    |
| Γ~CH~ for MS output power control in units of 2 dB, see              |
| 3GPP TS 45.008.                                                      |
+----------------------------------------------------------------------+
| ***P0, BTS\_PWR\_CTRL\_MODE and PR\_MODE fields\                     |
| ***These fields are optional downlink power control parameters and   |
| are encoded as in the PACKET UPLINK ASSIGNMENT message in            |
| 3GPP TS 44.060.                                                      |
+----------------------------------------------------------------------+

### 9.3.96a RRC Packet Uplink Assignment 2

The *RRC Packet Uplink Assignment 2* IE is sent by the network to the
mobile station to indicate the assigned uplink PDCTH on DBPSCH. The *RRC
Packet Uplink Assignment 2* IE is coded as shown in the table below.

Table 9.3.96a.1: *RRC Packet Uplink Assignment 2* information elements

+----------------------------------------------------------------+
| \< RRC Packet Uplink Assignment 2 IE \> ::=\                   |
| \< **LENGTH\_IN\_OCTETS** : bit (8) \>                         |
|                                                                |
| \< **Dynamic Allocation** : \< Dynamic Allocation struct \> \> |
|                                                                |
| { 0 *\-- for MS operating in GPRS*                             |
|                                                                |
| \< **CHANNEL\_CODING\_COMMAND** : bit (2) \>                   |
|                                                                |
| \| 1 \-- for MS operating in EGPRS                             |
|                                                                |
| \< **EGPRS\_MCS\_MODE** : bit (4) \>                           |
|                                                                |
| \< **RESEGMENT** : bit (1) \>                                  |
|                                                                |
| \< **EGPRS Window Size** : \< EGPRS Window Size IE \> \>};     |
+----------------------------------------------------------------+
| \< Dynamic Allocation struct \> ::=                            |
|                                                                |
| \< **Extended Dynamic Allocation** : bit (1) \>                |
|                                                                |
| \< **USF\_GRANULARITY** : bit (1) \>                           |
|                                                                |
| { 0 \| 1 \< **USF\_TN0 :** bit (3) \>}                         |
|                                                                |
| { 0 \| 1 \< **USF\_TN1 :** bit (3) \>}                         |
|                                                                |
| { 0 \| 1 \< **USF\_TN2 :** bit (3) \>}                         |
|                                                                |
| { 0 \| 1 \< **USF\_TN3 :** bit (3) \>}                         |
|                                                                |
| { 0 \| 1 \< **USF\_TN4 :** bit (3) \>}                         |
|                                                                |
| { 0 \| 1 \< **USF\_TN5 :** bit (3) \>}                         |
|                                                                |
| { 0 \| 1 \< **USF\_TN6 :** bit (3) \>}                         |
|                                                                |
| { 0 \| 1 \< **USF\_TN7 :** bit (3) \>};                        |
+----------------------------------------------------------------+

Table 9.3.96a.2: *RRC Packet Uplink Assignment* information element
details

  ---------------------------------------------------------------------------------------------------------------------------------------------
  **LENGTH\_IN\_OCTETS** (8 bit field)**\
  **This field is the binary representation of the length of the *RR Packet Uplink Assignment IE* value part in octets. Range: 0 to 255

  **CHANNEL\_CODING\_COMMAND** (2 bit field)\
  This field is encoded as the CHANNEL\_CODING\_COMMAND field in the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.

  **EGPRS\_MCS\_MODE** (4 bit field)\
  This field is coded as the EGPRS Modulation and Coding Scheme IE in the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.

  **RESEGMENT** (1 bit field)\
  This field is coded as the RESEGMENT bit in the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.

  **EGPRS Window Size IE\
  **This field is encoded as the *EGPRS window size* IE in the PACKET DOWNLINK ASSIGNMENT message in 3GPP TS 44.060.

  **Dynamic Allocation struct\
  **This structure contains parameters necessary to define the radio resources of a dynamic allocation or an extended dynamic allocation.

  **Extended Dynamic Allocation** (1 bit field)\
  This information field indicates the medium access mode to be used during the TBF.\
  0 Dynamic Allocation\
  1 Extended Dynamic Allocation

  **USF for Timeslot Number 0 (TN0)** (3 bit field)\
  **USF for Timeslot Number 1 (TN1)** (3 bit field)\
  **USF for Timeslot Number 2 (TN2)** (3 bit field)\
  **USF for Timeslot Number 3 (TN3)** (3 bit field)\
  **USF for Timeslot Number 4 (TN4)** (3 bit field)\
  **USF for Timeslot Number 5 (TN5)** (3 bit field)\
  **USF for Timeslot Number 6 (TN6)** (3 bit field)\
  **USF for Timeslot Number 7 (TN7)** (3 bit field)\
  These fields are encoded as the USF for Timeslot Number X field (where 0=\<X\<7) in the PACKET UPLINK ASSIGNMENT message in 3GPP TS 44.060.
  ---------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.97 RRC State Indicator

The *RRC State Indicator* IE is indicates to a MS the RRC state to be
entered.

Table 9.3.97.1: *RRC State Indicator* information elements

  ------------------------------------------
  \< RRC State Indicator IE \> ::=\
  \< **RRC State Indicator** : bit (2) \>;

  ------------------------------------------

Table 9.3.97.2: *RRC State Indicator* information element details

+---------------------------------------+
| **RRC State Indicator** (2 bit field) |
|                                       |
| bit                                   |
|                                       |
| 2 1                                   |
|                                       |
| 0 0 RRC-Cell \_Dedicated state        |
|                                       |
| 0 1 RRC-Cell\_Shared state            |
|                                       |
| 1 0 RRC-GRA\_PCH state                |
|                                       |
| 1 1 Reserved                          |
+---------------------------------------+

### 9.3.98 RRC Transaction Identifier

The *RRC Transaction Identifier* IE identifies the RRC procedure
transaction for the message this IE was included within.

Table 9.3.98.1: *RRC Transaction Identifier* information elements

  -------------------------------------------------
  \< RRC Transaction Identifier IE \> ::=\
  \< **RRC Transaction Identifier** : bit (2) \>;

  -------------------------------------------------

Table 9.3.98.2: *RRC Transaction Identifier* information element details

  -------------------------------------------------------------------------------------------
  **RRC Transaction Identifier**\
  This field is the binary representation of the RRC Transaction Identifier . Range: 0 to 3

  -------------------------------------------------------------------------------------------

### 9.3.99 SBPSCH Description

The *SBPSCH Description* IE describes shared physical resources.

Table 9.3.99.1: *SBPSCH Description* information elements

+----------------------------------------------------------------------+
| \< SBPSCH Description IE \> ::=                                      |
|                                                                      |
| {                                                                    |
|                                                                      |
| { 0 \| 1 \< **Frequency Parameters** : \< Frequency Parameters IE \> |
| \> }                                                                 |
|                                                                      |
| { 1 \< **TBF Information**: \< TBF Information struct \> \> } \*\* 0 |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+
| \< TBF Information struct \> ::=                                     |
|                                                                      |
| { \< **TBF Starting Time :** \< Starting Time IE \> \>               |
|                                                                      |
| { 0 \< **Description of the** **Uplink Packet Channel Assignment** : |
| \< RRC Packet Uplink Assignment IE\> \>                              |
|                                                                      |
| \| 1 \< **Description of the** **Downlink Packet Channel             |
| Assignment** : \< RRC Packet Downlink Assignment IE\> \>             |
|                                                                      |
| { 0 \| 1 \< **HFN\_LSB** : bit(1) \> } }                             |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.3.99.2: *SBPSCH Description* information element details

+----------------------------------------------------------------------+
| **Frequency Parameters**\                                            |
| This IE is defined in **TS 3GPP 44.060 sub-clause 12.8.**            |
+----------------------------------------------------------------------+
| **TBF Information struct**\                                          |
| This structure describe the information for a TBF. This structure    |
| may be repeated up to maxTBF times.                                  |
+----------------------------------------------------------------------+
| **TBF Starting Time**\                                               |
| The *Starting Time* IE is defined in sub-clause 9.3.103.             |
+----------------------------------------------------------------------+
| **Description of the** **Uplink Packet Channel Assignment**\         |
| The *RRC Packet Uplink Assignment* IE is defined in sub-clause       |
| 9.3.96.                                                              |
+----------------------------------------------------------------------+
| **Description of the** **Downlink Packet Channel Assignment**\       |
| The *RRC Packet Downlink Assignment* IE is defined in sub-clause     |
| 9.3.95.                                                              |
+----------------------------------------------------------------------+
| **HFN\_LSB (1 bit field)**                                           |
|                                                                      |
| This field contains the least significant bit of the HFN of the      |
| radio bearer for which the TBF is assigned, in the direction of the  |
| TBF.                                                                 |
+----------------------------------------------------------------------+

### 9.3.100 Security Capability

The *Security Capability* IE indicates the security capablities of the
MS.

Table 9.3.100.1: *Security Capability* information elements

+----------------------------------------------------------------------+
| \< Security Capability IE \> ::=                                     |
|                                                                      |
| **\< Security Capability Length** : bit (7)\>                        |
|                                                                      |
| \< **Iu mode Ciphering algorithm capability** : \< Iu mode Ciphering |
| algorithm capability struct \> \>                                    |
|                                                                      |
| \< **Iu mode Integrity protection algorithm capability** : \< Iu     |
| mode Integrity protection algorithm capability struct \> \>;         |
|                                                                      |
| \< spare bit \>\*\*; \-- *Extension information may be truncated     |
| between released versions of the protocol*                           |
|                                                                      |
| *\-- The receiver shall assume the value zero for any truncated bit* |
+----------------------------------------------------------------------+
| \< Iu mode Ciphering algorithm capability struct \> ::=              |
|                                                                      |
| \< **UEA0 support** : bit (1) \>                                     |
|                                                                      |
| \< **UEA1 support** : bit (1) \>                                     |
|                                                                      |
| \< spare bit \> \*14;                                                |
+----------------------------------------------------------------------+
| \< Iu mode Integrity protection algorithm capability struct \> ::=   |
|                                                                      |
| \< **UIA1 support** : bit (1) \>                                     |
|                                                                      |
| \< spare bit \> \*15;                                                |
+----------------------------------------------------------------------+

Table 9.3.100.2: *Security Capability* information element details

+----------------------------------------------------------------------+
| **Security Capability Length** (7 bit field)\                        |
| This field is the binary representation of the length of the         |
| Security Capability IE in bits excluding the bits used for this      |
| length field. Range: 0 to 127.                                       |
+----------------------------------------------------------------------+
| **Iu mode Ciphering algorithm capability struct**\                   |
| This structure indicates the ciphering algorithms supported by the   |
| MS.\                                                                 |
| **UEA0 support** (1 bit field)\                                      |
| **UEA1 support** (1 bit field) **\                                   |
| **\                                                                  |
| These fields indicate the support of the UEA encryption algorithm    |
| UEAx, where X has a range from 1 to 2. At least one Ciphering        |
| algorithm must be supported.\                                        |
| bit\                                                                 |
| 0 Ciphering algorithm is not supported\                              |
| 1 Ciphering algorithm is supported                                   |
+----------------------------------------------------------------------+
| **Iu mode Integrity protection algorithm capability struct**\        |
| This structure indicates the Integrity protection algorithms         |
| supported by the MS.                                                 |
+----------------------------------------------------------------------+
| **UIA1 support** (1 bit field)**\                                    |
| **These field indicates the support of the UIA integrity protection  |
| algorithm UIAx, where X has a range from 1 to 1. At least one        |
| integrity protection algorithm must be supported.                    |
|                                                                      |
| bit\                                                                 |
| 0 Integrity protection algorithm is not supported\                   |
| 1 Integrity protection algorithm is supported                        |
+----------------------------------------------------------------------+

### 9.3.101 Signalling RB Information To Setup

The *Signalling RB Information To Setup* IE indicates information for
setting up SRBs.

Table 9.3.101.1: *Signalling RB Information To Setup* information
elements

+----------------------------------------------------------------------+
| \< Signalling RB Information To Setup IE \> ::=\                     |
| \< **Signalling RB Information to Setup length** : bit (8) \>        |
|                                                                      |
| \< **SRB Identity** : bit (2) \>                                     |
|                                                                      |
| { 0 \| 1 \< **RB Mapping Info :** \< **RB Mapping Info** IE \> \> }  |
| \-- *Release 6* *extension*                                          |
|                                                                      |
| \< spare bits\> \*\*; \-- reserved for future use                    |
+----------------------------------------------------------------------+

Table 9.3.101.2: *Signalling RB Information To Setup* information
element details

+----------------------------------------------------------------------+
| **SRB Identity** (2 bit field)                                       |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 2 1                                                                  |
|                                                                      |
| 0 0 SRB1                                                             |
|                                                                      |
| 0 1 SRB2                                                             |
|                                                                      |
| 1 0 SRB3                                                             |
|                                                                      |
| 1 1 SRB4                                                             |
+----------------------------------------------------------------------+
| **Signalling RB Information To Setup** **length** (8 bit field)\     |
| This field is the binary representation of the length of the IE      |
| *Signalling RB Information To Setup* in bits excluding the bits used |
| for this length field. Range: 0 to 255.                              |
+----------------------------------------------------------------------+
| **RB Mapping Info**\                                                 |
| This IE is defined in sub-clause 9.3.117.                            |
+----------------------------------------------------------------------+

### 9.3.102 START

Ths *START* IE contains the START value used to initialise the 20 most
significant bits of all hyper frame numbers (MAC HFN, RLC UM HFN, RLC AM
HFN, RRC HFN) for a CN domain. This field is defined in 3GPP TS 33.102.

Table 9.3.102.1: *START* information elements

+-----------------------------+
| \< START IE \> ::=          |
|                             |
| \< **START :** bit(20) \> ; |
+-----------------------------+

Table 9.3.102.2: *START* information element details

  ----------------------------------------------------------------------------
  **START** (20 bit field)\
  The START bits are numbered b0-b19, where b0 is the least significant bit.

  ----------------------------------------------------------------------------

### 9.3.103 Starting Time

The *Starting Time* IE provides the start TDMA frame number, FN modulo
42432.

Table 9.3.103.1: *Starting Time* information elements

+--------------------------------------------+
| \< Starting Time IE \> ::=                 |
|                                            |
| \< **Starting Time Value : octet(2) \> ;** |
+--------------------------------------------+

Table 9.3.103.2: *Starting Time* information element details

  -----------------------------------------------------------
  **Starting Time Value\
  This field is encoded as defined in** 3GPP TS **44.018.**

  -----------------------------------------------------------

### 9.3.104 Synchronization Indication

The *Synchronization Indication* IE is to indicate which type of
handover is to be performed.

Table 9.3.104.1: *Synchronization Indication* information elements

+-------------------------------------------------------+
| \< Synchronization Indication IE \> ::=               |
|                                                       |
| \< **Synchronization Indication Value**: bit (4) \> ; |
+-------------------------------------------------------+

Table 9.3.104.2: *Synchronization Indication* information element
details

  -----------------------------------------------------------
  **Synchronization Indication Value** **\
  This field is encoded as defined in** 3GPP TS **44.018.**

  -----------------------------------------------------------

### 9.3.105 Time Difference

The *Time Difference* IE is to provide information about the
synchronization difference between the time bases of two Base Stations.
This type of information element is used in relation with the
pseudo-synchronization scheme, see 3GPP TS 45.010. The *Time Difference*
IE is coded as shown in 3GPP TS 44.018.

Table 9.3.105.1: *Time Difference* information elements

  --------------------------------------------
  \< Time Difference IE \> ::=\
  \< **Time Difference Value** : bit (8) \>;

  --------------------------------------------

Table 9.3.105.2: *Time Difference* information element details

  ------------------------------------------
  **Time Difference Value** (8 bit field)\
  This field is defined in 3GPP TS 44.018.

  ------------------------------------------

### 9.3.106 Timing Advance

This *Timing Advance* IE is to provide the timing advance value.

The *Timing Advance* IE is coded as shown in
Figure 10.5.2.40.1/3GPP TS 44.018 and Table 10.5.2.40.1/3GPP TS 44.018.

Table 9.3.106.1: *Timing Advance* information elements

+-------------------------------------------+
| \< Timing Advance IE \> ::=               |
|                                           |
| \< **Timing Advance Value** : bit (8) \>; |
+-------------------------------------------+

Table 9.3.106.2: *Timing Advance* information element details

  ---------------------------------------------
  **Timing Advance** **Value** (8 bit field)\
  This field is defined in 3GPP TS 44.018.

  ---------------------------------------------

### 9.3.107 Transmission RLC Discard

The *Transmission RLC Discard* IE indicates SDU Discard mode.

Table 9.3.107.1: *Transmission RLC Discard* information elements

+-----------------------------------------------+
| \< Transmission RLC Discard IE \> ::=         |
|                                               |
| \< **Transmission RLC Discard** : bit (1) \>; |
+-----------------------------------------------+

Table 9.3.107.2: *Transmission RLC Discard* information element details

+----------------------------------------------------------------------+
| **Transmission RLC Discard** (1 bit field)\                          |
| This field indicates whether the discharge of RLC buffer on the      |
| transmitter side can occur. For UM RLC or TM RLC, RLC discard shall  |
| not be used for that radio bearer.                                   |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 no discharge of the transmission RLC buffer\                       |
| 1 discharge of the transmission RLC buffer based on timer            |
+----------------------------------------------------------------------+

### 9.3.108 UE UTRAN Radio Access Capability

This IE indicates the UTRAN radio access capability of the MS.

Table 9.3.108.1: *UE UTRAN Radio Access Capability* information elements

+----------------------------------------------------------------------+
| \< UE UTRAN Radio Access Capability IE \> ::=                        |
|                                                                      |
| { \< **UE UTRAN Radio Access Capability length** : bit(14) \>        |
|                                                                      |
| \< **UE UTRAN Radio Access Capability** : bit (1+val( UE UTRAN Radio |
| Access Capability length)) \> } ;                                    |
+----------------------------------------------------------------------+

Table 9.3.108.2: *UE UTRAN Radio Access Capability* information element
details

  ----------------------------------------------------------------------------------
  **UE UTRAN Radio Access Capability length**\
  This field indicates the length of the UE Radio Access capability field in bits.

  **UE UTRAN Radio Access Capability**\
  This field is encoded as the UE Radio Access capability IE in 3GPP TS 25.331.
  ----------------------------------------------------------------------------------

### 9.3.108a **UE UTRAN Predefined Configuration Status Information**

This IE is valid only for UTRAN capable mobiles. The IE indicates UTRAN
predefined configuration status information /UECapability/UTRANClassmark
information. The IE includes the INTER RAT HANDOVER INFO (defined in
3GPP TS 25.331) which may give UTRAN related information to the network
(target system) for intersystem handover.The INTER-RAT HANDOVER INFO
message contains following information:

\- The Pre-defined configuration status information; and/or

\- Security information to be used after handover to UTRAN, see
3GPP TS 31.102; and/or

\- The UTRAN Capabilities of the MS.

None, one, two or three of these three information may be present. The
security information present in the message should be ignored.

Table 9.3.108a.1: ***UE UTRAN Predefined Configuration Status
Information*** information elements

+----------------------------------------------------------------------+
| \< **UE UTRAN Predefined configuration status information** IE \>    |
| ::=                                                                  |
|                                                                      |
| { \< **UE UTRAN Predefined Configuration Status Information length** |
| : bit(14) \>                                                         |
|                                                                      |
| \< **UE UTRAN Predefined Configuration Status Information** : bit    |
| (1+val( **UE UTRAN Predefined configuration status information**     |
| length)) \> } ;                                                      |
+----------------------------------------------------------------------+

Table 9.3.108a.2: ***UE UTRAN Predefined Configuration Status
Information*** information element details

  ----------------------------------------------------------------------------------------------------------------
  **UE UTRAN Predefined Configuration Status Information length**\
  This field indicates the length of the **UE UTRAN Predefined Configuration Status Information** field in bits.

  **UE UTRAN Predefined Configuration Status Information**\
  This value part of this field is the INTER RAT HANDOVER INFO message as defined in 3GPP TS 25.331.
  ----------------------------------------------------------------------------------------------------------------

### 9.3.109 UE UTRAN Radio Access Capability Extension

This IE indicates the UTRAN radio access capability extension of the MS.

Table 9.3.109.1: *UE UTRAN Radio Access Capability Extension*
information elements

+----------------------------------------------------------------------+
| \< UE UTRAN Radio access capability extension IE \> ::=              |
|                                                                      |
| { \< **UE** **UTRAN Radio Access Capability Extension length :       |
| bit(10) \>**                                                         |
|                                                                      |
| \< **UE** **UTRAN Radio Access Capability Extension** : bit (1+val(  |
| UE UTRAN Radio Access Capability Extension length)) \> };            |
+----------------------------------------------------------------------+

Table 9.3.109.2: *UE UTRAN Radio Access Capability Extension*
information element details

  --------------------------------------------------------------------------------------------------
  **UE UTRAN Radio Access Capability length**\
  This field indicates the length of the UE UTRAN Radio access capability extension field in bits.

  **UE UTRAN Radio Access Capability Extension**\
  This IE is defined in 3GPP TS 25.331 as Radio access capability extension.
  --------------------------------------------------------------------------------------------------

### 9.3.110 UE CDMA2000 Radio Access Capability

This Information Element contains the UE CDMA2000 radio access
capability that is structured and coded according to the specification
used for the corresponding system type.

Table 9.3.110.1: *UE CDMA2000 Radio Access Capability* information
elements

+----------------------------------------------------------------------+
| \< UE CDMA2000 Radio Access Capability IE \> ::=                     |
|                                                                      |
| \< **CDMA2000 Information length** : bit(12) \>                      |
|                                                                      |
| \< **CDMA2000 Information** : bit(1+val(CDMA2000 Information         |
| length)) \> ;                                                        |
+----------------------------------------------------------------------+

Table 9.3.110.2: *UE CDMA2000 Radio Access Capability* information
element details

  -----------------------------------------------------------------------------------------------------------------------------------------------------------
  **CDMA2000 Information length** (12 bit field)\
  This field indicates the length of the CDMA2000 Information field in bits.

  **CDMA2000 Information**\
  This field is encoded as the *CDMA2000 Radio Access Capability* IE defined in TIA/EIA/IS-2000 or later, TIA/EIA/IS-833 or later, TIA/EIA/IS-834 or later.
  -----------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.111 UTRAN Freq List

This variable length IE is coded as defined in 3GPP TS 44.018.

### 9.3.112 Wait Time

The *Wait Time* IE defines the time period the MS has to wait before
repeating the rejected procedure.

Table 9.3.112.1: *Wait Time* information elements

+--------------------------------+
| \< Wait Time IE \> ::=         |
|                                |
| \< **Wait Time** : bit (4) \>; |
+--------------------------------+

Table 9.3.112.2: *Wait Time* *Capability* information element details

+-----------------------------------------+
| **Wait Time** (4 bit field)             |
|                                         |
| bit                                     |
|                                         |
| 4 3 2 1                                 |
|                                         |
| 0 0 0 0 \-- *repetition is not allowed* |
|                                         |
| 0 0 0 1 1s                              |
|                                         |
| 0 0 1 0 2s                              |
|                                         |
| :                                       |
|                                         |
| :                                       |
|                                         |
| 1 1 1 0 14s                             |
|                                         |
| 1 1 1 1 15s                             |
+-----------------------------------------+

### 9.3.113 Iu mode Channel Request Description

The *Iu mode Channel Request Description* IE is used by the mobile
station to request uplink resources.

Table 9.3.113.1: *Iu mode Channel Request Description* information
elements

+----------------------------------------------------------------------+
| \< Iu mode Channel Request Description IE \> ::=\                    |
| \< **LENGTH\_IN\_OCTETS** : bit(8) \> \-- *Remaining length*         |
|                                                                      |
| \< **PACKET\_ESTABLISHMENT\_CAUSE** : bit(2) \>                      |
|                                                                      |
| \< **Iu mode** **RRC Channel Request Description : Iu mode** Channel |
| Request Description IE *\> \-- Defined in 3GPP TS 44.060*            |
|                                                                      |
| { 0 \| 1 \< **HFN\_LSB** : bit(1) \> }                               |
|                                                                      |
| \< spare bit \>\*\*;                                                 |
+----------------------------------------------------------------------+

Table 9.3.113.2: *Iu mode Channel Request Description* information
element details

+----------------------------------------------------------------------+
| **PACKET\_ESTABLISHMENT\_CAUSE** (2 bit field)**\                    |
| **This field indicates the reason for requesting the access.         |
|                                                                      |
| Bit                                                                  |
|                                                                      |
| 2 1                                                                  |
|                                                                      |
| 0 0 User Data                                                        |
|                                                                      |
| 0 1 Page Response                                                    |
|                                                                      |
| 1 0 Cell Update                                                      |
|                                                                      |
| 1 1 Mobility Management procedure                                    |
+----------------------------------------------------------------------+
| **Iu mode Channel Request Description**\                             |
| This IE is defined in 3GPP TS 44.060.                                |
+----------------------------------------------------------------------+
| **HFN\_LSB (1 bit field)\                                            |
| **This field contains the least significant bit of the HFN of the    |
| radio bearer for which the TBF is established, in the direction of   |
| the TBF.                                                             |
+----------------------------------------------------------------------+

### 9.3.114 Wait Indication

The *Wait Indication* IE element is used by the network to indicate the
time the mobile station shall wait before attempting another channel
request after the **GERAN Iu mode DTM REJECT message is received.**

Table 9.3.106.1: *Wait Indication* information elements

+--------------------------------------+
| \< Wait Indication IE \> ::=         |
|                                      |
| \< **Wait Indication** : bit (8) \>; |
+--------------------------------------+

Table 9.3.106.2: *Wait Indication* information element details

  -------------------------------------------------------------------------------------------------------------------------------
  **Wait Indication Value** (8 bit field)\
  This field is coded as the binary representation of the T3142 timeout value in seconds. This IE is defined in 3GPP TS 44.018.

  -------------------------------------------------------------------------------------------------------------------------------

### 9.3.115 (void)

### 9.3.116 PDCP Context Relocation Info

The *PDCP Context Relocation Info IE* indicates that the header
compression context relocation is to be performed during SBSS relocation
for the given radio bearer.

Table 9.3.116.1: *PDCP Context Relocation Info* elements

+------------------------------------------------------------------+
| \< PDCP Context Relocation Info IE \> ::=                        |
|                                                                  |
| **\<** PDCP Context Relocation Info length: bit (2) \>           |
|                                                                  |
| { \< **Downlink RFC3095 Context Relocation Indication**: 0 \>    |
|                                                                  |
| \| \< **Downlink RFC3095 Context Relocation Indication**: 1 \> } |
|                                                                  |
| { \< **Uplink RFC3095 Context Relocation Indication**: 0 \>      |
|                                                                  |
| \| \< **Uplink RFC3095 Context Relocation Indication**: 1 \>}    |
|                                                                  |
| ;                                                                |
+------------------------------------------------------------------+

Table 9.3.116.2: *PDCP Context Relocation Info* information elements
details

+------------------------------------------------------------------+
| **Downlink RFC3095 Context Relocation Indication** (1 bit field) |
|                                                                  |
| bit\                                                             |
| 1\                                                               |
| 0 RFC3095 context relocation is not performed in downlink\       |
| 1 RFC3095 context relocation is performed in downlink            |
+------------------------------------------------------------------+
| **Uplink RFC3095 Context Relocation Indication** (1 bit field)   |
|                                                                  |
| bit\                                                             |
| 1\                                                               |
| 0 RFC3095 context relocation is not performed in uplink\         |
| 1 RFC3095 context relocation is performed in uplink              |
+------------------------------------------------------------------+

### 9.3.117 RB mapping info

The IE includes the transport channel information on which the RB can be
mapped.

Table 9.3.117.1: *RB Mapping Info* information element

+----------------------------------------------------------------------+
| \< RB Mapping Info IE \> ::=                                         |
|                                                                      |
| \< **RB Mapping Info** **length** : bit (8) \>                       |
|                                                                      |
| { 00 \-- *Uplink information*                                        |
|                                                                      |
| **\< Uplink Transport Channel Type** : bit (1)\>                     |
|                                                                      |
| **\<** **UL Transport Channel Identity** : \< Transport Channel      |
| Identity IE \> \>                                                    |
|                                                                      |
| { 00 *\-- All; RLC Sizes listed in TFS IE*                           |
|                                                                      |
| \| 01 *\-- Configured; RLC Sizes listed in TFS*                      |
|                                                                      |
| \| 10 *\-- RLC explicit List*                                        |
|                                                                      |
| \< **RLC Size Index List** : bit (11) \>                             |
|                                                                      |
| \< **RLC Size Index**: bit (11) \> } \* (1+val(RLC Size Index List)  |
| )                                                                    |
|                                                                      |
| ! \< Message escape : { 11 } bit\*\* = \< no string \> \> }          |
|                                                                      |
| \| 01 \-- *Downlink information*                                     |
|                                                                      |
| \< **Downlink Transport Channel Type** : bit (1) \>                  |
|                                                                      |
| \< **DL TrCH Identity** : \< Transport Channel Identity IE \> \>     |
|                                                                      |
| ! \< Message escape : { 10 \| 11 } bit\*\* = \< no string \> \> }    |
|                                                                      |
| \<spare bits\>\*\* ; \-- *Reserved for future use*                   |
+----------------------------------------------------------------------+

Table 9.3.117.2: *RB Mapping Info* information element details

+----------------------------------------------------------------------+
| **RB Mapping Info** **length** (8 bit field)\                        |
| This field is the binary representation of the length of the IE *RB  |
| Mapping Info* in bits excluding the bits used for this length field. |
| Range: 0 to 256.                                                     |
+----------------------------------------------------------------------+
| **Downlink Transport Channel Type** (1 bit field)**\                 |
| **This field is used to indicate the binary representation of the    |
| number of downlink TrCH used.                                        |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 DCH\                                                               |
| All the other values are reserved                                    |
+----------------------------------------------------------------------+
| **DL Transport Channel Identity\                                     |
| **The IE *Transport Channel Identity* is defined in sub-clause       |
| 9.3.130.                                                             |
+----------------------------------------------------------------------+
| **TFS\                                                               |
| **The IE *Transport Format Set* is defined in sub-clause 9.3.133.    |
+----------------------------------------------------------------------+
| **Uplink Transport Channel Type** (1 bit field)**\                   |
| **This field is used to indicate the binary representation of the    |
| number of uplink TrCH used.                                          |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 DCH\                                                               |
| All the other values are reserved.                                   |
+----------------------------------------------------------------------+
| **UL Transport Channel Identity\                                     |
| **The IE *Transport Channel Identity* is defined in sub-clause       |
| 9.3.130.                                                             |
+----------------------------------------------------------------------+
| **RLC Size Index List** (11 bit field)**\                            |
| **This field is used to indicate the binary representation of the    |
| number RLC size. The integer number is a reference to the *RLC size* |
| that arrived at that position in the IE *Transport Format Set.*      |
+----------------------------------------------------------------------+
| **RLC Size Index** (11 bit field)**\                                 |
| **The integer number is a reference to the *RLC size* position in    |
| the IE *Transport Format Set.*                                       |
+----------------------------------------------------------------------+

### 9.3.118 Interleaving

The IE includes the information about interleaving used for FLO
configuration on the basic physical channels.

Table 9.3.118.1: *Interleaving* information elements

+-----------------------------------+
| \< Interleaving IE \> ::=         |
|                                   |
| \< **Interleaving**: bit (2) \> ; |
+-----------------------------------+

Table 9.3.118.2: *Interleaving* information element details

+------------------------------------+
| **Interleaving** (2 bit field)\    |
| Bit                                |
|                                    |
| 21\                                |
| 00 20 ms rectangular\              |
| 01 40 ms diagonal\                 |
| All the other values are reserved. |
+------------------------------------+

### 9.3.119 Mode 

The IE includes the information about mode used for FLO configuration on
the basic physical channels.

Table 9.3.119.1: *Mode* information elements

+----------------------------+
| \< Mode IE \> ::=          |
|                            |
| \< **Mode** : bit (2) \> ; |
+----------------------------+

Table 9.3.119.2: *Mode* information element details

+----------------------------------------------------------------------+
| **Mode** (2 bit field)\                                              |
| This is the binary representation of the mode used for FLO           |
| configuration.                                                       |
|                                                                      |
| bit\                                                                 |
| 21\                                                                  |
| 00 FR\                                                               |
| 01 HR.                                                               |
|                                                                      |
| All the other values are reserved.                                   |
+----------------------------------------------------------------------+

### 9.3.120 Modulation

The IE includes the information about modulation used for FLO
configuration on the basic physical channels.

Table 9.3.119.1: *Modulation* information elements

+----------------------------------+
| \< Modulation IE \> ::=          |
|                                  |
| \< **Modulation** : bit (2) \> ; |
+----------------------------------+

Table 9.3.119.2: *Modulation* information element details

+----------------------------------------------------------------------+
| **Modulation** (2 bit field)\                                        |
| This is the binary representation of the modulation used for FLO     |
| configuration.                                                       |
|                                                                      |
| bit\                                                                 |
| 21\                                                                  |
| 00 GMSK\                                                             |
| 01 GMSK and 8PSK\                                                    |
| All the other values are reserved.                                   |
+----------------------------------------------------------------------+

### 9.3.121 Added or Reconfigured DL TrCH information

Table 9.3. 121.1: *Added or Reconfigured DL TrCH Information*
information elements

+----------------------------------------------------------------------+
| \< Added or Reconfigured DL TrCH Information IE \> ::=               |
|                                                                      |
| **\< Downlink Transport Channel Type :** bit (1)\>                   |
|                                                                      |
| **\<** **DL Transport Channel Identity** : \< Transport Channel      |
| Identity IE \> \>                                                    |
|                                                                      |
| { 0 *\-- Explicit*                                                   |
|                                                                      |
| \< **TFS** : \< Transport Format Set IE\> \>                         |
|                                                                      |
| \| 1 *\-- SameAsUL*                                                  |
|                                                                      |
| **\<** **UL Transport Channel Identity** : \< Transport Channel      |
| Identity IE \> \>} ;                                                 |
+----------------------------------------------------------------------+

Table 9.3. 121.2: *Added or Reconfigured DL TrCH Information*
information element details

+----------------------------------------------------------------------+
| **Downlink Transport Channel Type** (1 bit field)**\                 |
| **This field is used to indicate the binary representation of the    |
| number of downlink TrCH used.                                        |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 DCH\                                                               |
| All the other values are reserved.                                   |
+----------------------------------------------------------------------+
| **DL Transport Channel Identity\                                     |
| **The IE *Transport Channel Identity* is defined in sub-clause       |
| 9.3.130.                                                             |
+----------------------------------------------------------------------+
| **UL Transport Channel Identity\                                     |
| **The IE *Transport Channel Identity* is defined in sub-clause       |
| 9.3.130.                                                             |
+----------------------------------------------------------------------+
| **TFS\                                                               |
| **The IE *Transport Format Set* is defined in sub-clause 9.3.133.    |
+----------------------------------------------------------------------+

### 9.3.122 Added or Reconfigured UL TrCH information

Table 9.3.122.1: *Added or Reconfigured UL TrCH information* information
element

+----------------------------------------------------------------------+
| \< Added or Reconfigured UL TrCH information IE \> ::=               |
|                                                                      |
| **\< Uplink Transport Channel Type** : bit (1)\>                     |
|                                                                      |
| **\<** **UL Transport Channel Identity** : \< Transport Channel      |
| Identity IE \> \>                                                    |
|                                                                      |
| \< **TFS** : \< Transport Format Set IE\> \>;                        |
+----------------------------------------------------------------------+

Table 9.3.122.2: *Added or Reconfigured UL TrCH information* information
element details

+----------------------------------------------------------------------+
| **Uplink Transport Channel Type** (1 bit field)**\                   |
| **This field is used to indicate the binary representation of the    |
| number of uplink TrCH used.                                          |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 DCH\                                                               |
| All the other values are reserved                                    |
+----------------------------------------------------------------------+
| **UL Transport Channel Identity\                                     |
| **The *Transport Channel Identity IE* is defined in sub-clause       |
| 9.3.130.                                                             |
+----------------------------------------------------------------------+
| **TFS\                                                               |
| **The IE *Transport Format Set* is defined in sub-clause 9.3.133.    |
+----------------------------------------------------------------------+

### 9.3.123 Deleted DL TrCH information

Table 9.3.123.1: *Deleted DL TrCH Information* information element

+----------------------------------------------------------------------+
| \< Deleted DL TrCH Information IE \> ::=                             |
|                                                                      |
| **\< Downlink Transport Channel Type :** bit (1)\>                   |
|                                                                      |
| **\<** **DL Transport Channel Identity** : \< Transport Channel      |
| Identity IE \> \>;                                                   |
+----------------------------------------------------------------------+

Table 9.3. 123.2: *Deleted DL TrCH Information* information element
details

+----------------------------------------------------------------------+
| **Downlink Transport Channel Type** (1 bit field)**\                 |
| **This field is used to indicate the binary representation of the    |
| number of downlink TrCH used.                                        |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 DCH\                                                               |
| All the other values are reserved                                    |
+----------------------------------------------------------------------+
| **DL Transport Channel Identity\                                     |
| **The *Transport Channel Identity IE* is defined in sub-clause       |
| 9.3.130.                                                             |
+----------------------------------------------------------------------+

### 9.3.124 Deleted UL TrCH information

Table 9.3.124.1: *Deleted UL TrCH Information* information element

+----------------------------------------------------------------------+
| \< Deleted UL TrCH Information IE \> ::=                             |
|                                                                      |
| **\< Uplink Transport Channel Type :** bit (1)\>                     |
|                                                                      |
| **\<** **UL Transport Channel Identity** : \< Transport Channel      |
| Identity IE \> \>;                                                   |
+----------------------------------------------------------------------+

Table 9.3.124.2: *Deleted UL TrCH Information* information element
details

+----------------------------------------------------------------------+
| **Uplink Transport Channel Type** (1 bit field)**\                   |
| **This field is used to indicate the binary representation of the    |
| number of uplink TrCH used.                                          |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 DCH\                                                               |
| All the other values are reserved                                    |
+----------------------------------------------------------------------+
| **UL Transport Channel Identity\                                     |
| **The IE *Transport Channel Identity* is defined in sub-clause       |
| 9.3.130.                                                             |
+----------------------------------------------------------------------+

### 9.3.125 DL TrCH Information Common For All Transport Channels

Table 9.3.125.1: *DL TrCH Information Common For All Transport Channels*
information elements

+--------------------------------------------------------------------+
| \< DL TrCH Information Common For All Transport Channels IE \> ::= |
|                                                                    |
| { 0 *\-- Explicit*                                                 |
|                                                                    |
| \< **DL DCH TFCS**: \< Transport Format Combination Set IE\> \>    |
|                                                                    |
| \| 1 }; \-- *SameAsUL-no data*                                     |
+--------------------------------------------------------------------+

Table 9.3.125.2: *DL TrCH Information Common For All Transport Channels*
information element details

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **DL DCH TFCS\
  **The IE *Transport Format Combination Set* is defined in sub-clause 9.3.132. This IE is used when the choice is to define the DL TrCH information common for all transport channels is \"Explicit\".

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.126 Semi-static Transport Format Information

Table 9.3.123.1: *Semi-static Transport Format Information* information
element

+-------------------------------------------------------+
| \< Semi-static Transport Format Information IE \> ::= |
|                                                       |
| \< **Rate Matching Attribute**: bit (8) \>            |
|                                                       |
| \< **CRC Size** : bit (3) \>;                         |
+-------------------------------------------------------+

Table 9.3.126.2: *Semi-static Transport Format Information* information
element details

  ----------------------------------------------------------------------------------------
  **Rate Matching Attribute** ( 8 bit field )**\
  **This field is the binary representation of the RMA attribute sent. Range : 1 to 256.

  **CRC size** (3 bit field )**\
  **bit\
  3 2 1\
  0 0 0 0 bits\
  0 0 1 6 bits\
  0 1 0 12 bits\
  0 1 1 18 bits\
  All the other values are reserved
  ----------------------------------------------------------------------------------------

### 9.3.127 TFCS Explicit Configuration

This IE indicates the explicit configuration of TFCS sent for the TrCH.

Table 9.3.127.1: *TFCS Explicit Configuration* information elements

+----------------------------------------------------------------------+
| \< TFCS Explicit Configuration IE \> ::=                             |
|                                                                      |
| { 00 *\-- complete configuration*                                    |
|                                                                      |
| \< **TFCS Complete Reconfiguration Information** : \< TFCS           |
| Reconfiguration/Addition Information IE\> \>                         |
|                                                                      |
| \| 01 *\-- Addition*                                                 |
|                                                                      |
| \< **TFCS Addition Information** : \< TFCS Reconfiguration/Addition  |
| Information IE\> \>                                                  |
|                                                                      |
| \| 10 *\-- Removal*                                                  |
|                                                                      |
| { \< **TFCS Removal Information** : \< TFCS Removal Information IE\> |
| \>                                                                   |
|                                                                      |
| { 0 Compression Algorithm : 0                                        |
|                                                                      |
| \| 1 Compression Algorithm : 1 } }                                   |
|                                                                      |
| \| 11 *\-- Replace*                                                  |
|                                                                      |
| \< **TFCS Removal Information** : \< TFCS Removal Information IE\>   |
| \>                                                                   |
|                                                                      |
| \< **TFCS Addition Information** : \< TFCS Reconfiguration/Addition  |
| Information IE\> \>                                                  |
|                                                                      |
| };                                                                   |
+----------------------------------------------------------------------+

Table 9.3.127.2: *TFCS Explicit Configuration* information element
details

  ------------------------------------------------------------------------------------------
  **TFCS Complete Reconfiguration Information\
  **The *TFCS Reconfiguration/Addition Information IE* is defined in sub-clause 9.3.128.

  **TFCS Addition Information\
  **The *TFCS Reconfiguration/Addition Information IE* is defined in sub-clause 9.3.128.

  **TFCS Removal Information\
  **The *TFCS Removal Information IE* is defined in sub-clause 9.3.129.

  **Compression Algorithm\
  **This flag indicates if the compression algorithm can be applied. The value is boolean.
  ------------------------------------------------------------------------------------------

### 9.3.128 TFCS Reconfiguration/Addition Information

Table 9.3.128.1: *TFCS Reconfiguration/Addition Information* information
elements

+----------------------------------------------------------------------+
| \< TFCS Reconfiguration/Addition Information IE \> ::=               |
|                                                                      |
| \< **TFCS Reconfiguration/Addition Information length** : bit (3) \> |
|                                                                      |
| { 000 *\-- 2bit CTFC*                                                |
|                                                                      |
| { \< **Length of CTFC Information**: bit (5) \>                      |
|                                                                      |
| \< **2 bit CTFC** : \< bit (2) \> \>                                 |
|                                                                      |
| } \*( 1 + val ( Length of CTFC Information ) )                       |
|                                                                      |
| \| 001 *\-- 4bit CTFC*                                               |
|                                                                      |
| { \< **Length of CTFC Information**: bit (5) \>                      |
|                                                                      |
| \< **4 bit CTFC** : \< bit (4) \> \>                                 |
|                                                                      |
| } \*( 1 + val ( Length of CTFC Information ) )                       |
|                                                                      |
| \| 010 *\-- 6bit CTFC*                                               |
|                                                                      |
| { \< **Length of CTFC Information**: bit (5) \>                      |
|                                                                      |
| \< **6 bit CTFC** : \< bit (6) \> \>                                 |
|                                                                      |
| } \*( 1 + val ( Length of CTFC Information ) )                       |
|                                                                      |
| \| 011 *\-- 8bit CTFC*                                               |
|                                                                      |
| { \< **Length of CTFC Information**: bit (5) \>                      |
|                                                                      |
| \< **8 bit CTFC** : \< bit (8) \> \>                                 |
|                                                                      |
| } \*( 1 + val ( Length of CTFC Information ) )                       |
|                                                                      |
| \| 100 *\--12bit CTFC*                                               |
|                                                                      |
| { \< **Length of CTFC Information**: bit (5) \>                      |
|                                                                      |
| \< **12 bit CTFC** : \< bit (12) \> \>                               |
|                                                                      |
| } \*( 1 + val ( Length of CTFC Information ) )                       |
|                                                                      |
| \| 101 *\--16bit CTFC*                                               |
|                                                                      |
| { \< **Length of CTFC Information**: bit (5) \>                      |
|                                                                      |
| \< **16 bit CTFC** : \< bit (16) \> \>                               |
|                                                                      |
| } \*( 1 + val ( Length of CTFC Information ) )                       |
|                                                                      |
| ! \< Message escape : { 110 \| 111 } bit\*\* = \<no string\>\> };    |
+----------------------------------------------------------------------+

Table 9.3.128.2: *TFCS Reconfiguration/Addition Information* information
element details

  --------------------------------------------------------------------------------------------------
  **Length of CTFC Information** (5 bit field)**\
  **This field is a binary representation of the CTFC Information. Range 0 to maxTFC-1.

  **2 bit CTFC** (2 bit field)**\
  **This field is a binary representation of the CTFC when it is chosen 2 bits representation.**\
  **Range 0 to 3.

  **4 bit CTFC** (4 bit field)**\
  **This field is a binary representation of the CTFC when it is chosen 4 bits representation.**\
  **Range 0 to 15.

  **6 bit CTFC** (6 bit field)**\
  **This field is a binary representation of the CTFC when it is chosen 6 bits representation. **\
  **Range 0 to 255.

  **8 bit CTFC** (8 bit field)**\
  **This field is a binary representation of the CTFC when it is chosen 8 bits representation. **\
  **Range 0 to 63.

  **12 bit CTFC** (12 bit field)**\
  **This field is a binary representation of the CTFC when it is chosen 12 bits representation.**\
  **Range 0 to 4095.

  **16 bit CTFC** (16 bit field)**\
  **This field is a binary representation of the CTFC when it is chosen 16 bits representation.**\
  **Range 0 to 65535.
  --------------------------------------------------------------------------------------------------

### 9.3.129 TFCS Removal Information

Table 9.3.129.1: *TFCS Removal Information* information elements

+----------------------------------------------------------------------+
| \< TFCS Removal Information IE \> ::=                                |
|                                                                      |
| **\< Removal TFCI Information** : bit (5) \>                         |
|                                                                      |
| { \< **TFCI** : \< Transport Format Combination IE\>} \*( 1 + val (  |
| TFCS Removal Information ) );                                        |
+----------------------------------------------------------------------+

Table 9.3.129.2: *TFCS Removal Information* information element details

  -----------------------------------------------------------------------------------
  **Removal TFCI information**\
  This field is a binary representation of the removal of TFCs. Range: 1 to maxTFC.

  **TFCI**\
  The IE *Transport Format Combination* is defined in 9.3.131.
  -----------------------------------------------------------------------------------

### 9.3.130 Transport Channel Identity

This IE is used to distinguish transport channels. This also holds for
uplink and downlink transport channel identities (i.e. for DCH).
Depending on in which context a transport channel identity *n* that is
sent, it will have different meaning.

Table 9.3.130.1: *Transport Channel Identity* information element

  ------------------------------------
  \< **TrCH Identity** IE \> ::=\
  \< **TrCH Identity** : bit (3) \>;

  ------------------------------------

Table 9.3.130.2: *Transport Channel Identity* information element
details

  ---------------------------------------------------------------------------------------------------------------------------
  **TrCH Identity** (3 bit field)\
  The *Transport Channel Identity* field is encoded as a binary number. Range: 0 to maxTrCH-1. 0 enables the TrCH number 1.

  ---------------------------------------------------------------------------------------------------------------------------

### 9.3.131 TFC

Table 9.3.131.1: *Transport Format Combination* information element

  ---------------------------------------------------
  \< Transport Format Combination IE \> ::=\
  \< **Transport Format Combination** : bit (5) \>;

  ---------------------------------------------------

Table 9.3.131.2: *Transport Format Combination* information element
details

  -----------------------------------------------------------------------------------------------
  **Transport Format Combination** (5 bit field)\
  The *Transport Format Combination* field is encoded as a binary number. Range: 0 to maxTFC-1.

  -----------------------------------------------------------------------------------------------

### 9.3.132 Transport Format Combination Set

This IE indicates the allowed combinations of already defined transport
formats and the mapping between these allowed TFCs and the corresponding
TFCI values.

Table 9.3.132.1: *Transport Format Combination Set* information elements

+----------------------------------------------------------------------+
| \< Transport Format Combination Set IE \> ::=                        |
|                                                                      |
| \< **TFCI Field Information** : \< TFCS Explicit Configuration IE\>  |
| \>**;**                                                              |
+----------------------------------------------------------------------+

Table 9.3.132.2: *Transport Format Combination Set* information element
details

  -------------------------------------------------------------
  **TFCI Field Information**\
  The *TFCS Explicit Configuration* IE is defined in 9.3.127.

  -------------------------------------------------------------

### 9.3.133 Transport Format Set

Table 9.3.133.1: *Transport Format Set* information elements

+----------------------------------------------------------------------+
| \< Transport Format Set IE \> ::=                                    |
|                                                                      |
| \< **Transport Format Set length**: bit (4) \>                       |
|                                                                      |
| \-- *Transport Channel type;* *Dedicated transport channels*         |
|                                                                      |
| { \< **Dynamic Transport Format Information List**: bit (5) \>       |
|                                                                      |
| \< **RLC Size** : bit (11 ) \>                                       |
|                                                                      |
| \< **Transport Block Size** : bit (11) \> } \* (1+val(Dynamic        |
| Transport Format Information List) )                                 |
|                                                                      |
| \< **Semi-static Transport Format Information** : \< Semi-static     |
| Transport Format Information IE \> \>                                |
|                                                                      |
| \<spare bits\> \*\*; \--*reserved*                                   |
+----------------------------------------------------------------------+

Table 9.3.133.2: *Transport Format Set* information element details

  ----------------------------------------------------------------------------------------------------------------------------------------------------
  **Dynamic Transport Format Information list** (5 bit field)\
  This is the binary representation of the dynamic attribute of the transport channel that is configured with the TFS for the DCH. Range 1 to maxTF.

  **RLC Size** (11 bit field)\
  This is the binary representation of the RLC size needed to configure layer 2. Range 1 to maxRLCSize.

  **Transport Block Size** (11 bits field)\
  This is the binary representation of the transport block size corresponding to the RLC size. Range 1 to maxTBSize.

  **Semi-static Transport Format Information**\
  This IE is described in sub-clause 9.3.126.
  ----------------------------------------------------------------------------------------------------------------------------------------------------

### 9.3.134 UL TrCH Information Common For All Transport Channels

Table 9.3.134.1: *UL TrCH Information Common For All Transport Channels*
information elements

+----------------------------------------------------------------------+
| \< UL TrCH Information Common For All Transport Channels IE \> ::=   |
|                                                                      |
| \< **UL DCH TFCS** : \< Transport Formation Combination Set IE\> \>; |
+----------------------------------------------------------------------+

Table 9.3.134.2: *UL TrCH Information Common For All Transport Channels*
information element details

  -----------------------------------------------------------------------------
  **DL DCH TFCS**\
  The IE *Transport Format Combination Set* is defined in sub-clause 9.3.132.

  -----------------------------------------------------------------------------

9.3a Information element definitions
------------------------------------

InformationElements DEFINITIONS AUTOMATIC TAGS ::=

\--
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

\--

\-- CORE NETWORK INFORMATION ELEMENTS (9.3)

\--

\--
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

BEGIN

IMPORTS

maxCNdomains,

maxRBallRABs,

maxRB

FROM Constant-definitions;

\-- NOTE : for ActivationTime, value \'now\' always appear as default,
and is encoded

\-- by absence of the field

ActivationTime ::= BIT STRING (SIZE (22))

CN-DomainIdentity ::= ENUMERATED {

cs-domain,

ps-domain }

CN-InformationInfo ::= SEQUENCE {

plmn-Identity PLMN-Identity OPTIONAL,

cn-DomainGSM-MAP-NAS-SysInfo NAS-SystemInformationGSM-MAP OPTIONAL,

cn-DomainRelInfo CN-DomainRelInfo OPTIONAL

}

CN-DomainRelInfo ::= SEQUENCE {

cn-DomainIdentity CN-DomainIdentity,

cn-DomainGSM-MAP-NAS-SysInfo NAS-SystemInformationGSM-MAP

}

CellUpdateCause ::= ENUMERATED {

cellReselection,

periodicalCellUpdate,

uplinkDataTransmission,

geran-pagingResponse,

radiolinkFailure,

rlc-unrecoverableError,

invalidRLC-MACcontrolmessage,

spare1 }

CipheringModeInfo ::= SEQUENCE {

\-- NOTE: The ciphering algorithm is included in the
CipheringModeCommand.

cipheringModeCommand CipheringModeCommand,

**cipheringActivationTimeforDBPSCH** ActivationTime OPTIONAL,

rb-DL-CiphActivationTimeInfo RB-ActivationTimeInfoList OPTIONAL

}

CipheringModeCommand ::= CHOICE {

startRestart CipheringAlgorithm,

spare NULL

}

CipheringAlgorithm ::= BIT STRING {

\-- For each bit value \"0\" means false/ not supported

spare15(0),

spare14(1),

spare13(2),

spare12(3),

spare11(4),

spare10(5),

spare9(6),

spare8(7),

spare7(8),

spare6(9),

spare5(10),

spare4(11),

spare3(12),

spare2(13),

uea1(14),

uea0(15)

} (SIZE (16))

DL-CounterSynchronisationInfo ::= SEQUENCE {

rb-WithPDCP-InfoList RB-WithPDCP-InfoList OPTIONAL,

rb-PDCPContextRelocationList RB-PDCPContextRelocationList OPTIONAL

}

Digit ::= INTEGER (0..9)

FailureCauseWithProtErrTrId ::= SEQUENCE {

rrc-TransactionIdentifier RRC-TransactionIdentifier,

failureCause FailureCauseWithProtErr

}

FailureCauseWithProtErr ::= CHOICE {

configurationUnsupported NULL,

physicalChannelFailure NULL,

incompatibleSimultaneousReconfiguration

NULL,

protocolError ProtocolErrorInformation,

cellUpdateOccurred NULL,

invalidConfiguration NULL,

configurationIncomplete NULL,

spare7 NULL,

spare6 NULL,

spare5 NULL,

spare4 NULL,

spare3 NULL,

spare2 NULL,

spare1 NULL

}

GRA-Identity ::= BIT STRING (SIZE (16))

GRA-UpdateCause ::= ENUMERATED {

changeOfGRA,

periodicGRAUpdate,

spare2,

spare1 }

GERAN-DRX-CycleLengthCoefficient ::= INTEGER (3..9)

G-RNTI ::= SEQUENCE {

sbsc-Identity SBSC-Identity,

s-RNTI S-RNTI

}

IntegrityCheckInfo ::= SEQUENCE {

\-- RRC-MessageSequenceNumberList includes RRC-MessageSequenceNumber.

messageAuthenticationCode MessageAuthenticationCode,

rrc-MessageSequenceNumberList RRC-MessageSequenceNumberList

}

IntegrityProtActivationInfo ::= SEQUENCE {

\-- RRC-MessageSequenceNumberList includes RRC-MessageSequenceNumber

rrc-MessageSequenceNumberList RRC-MessageSequenceNumberList

}

IntegrityProtectionAlgorithm ::= ENUMERATED {

\-- For each NULL means false/ not supported

uia1 BIT STRING (SIZE (16)),

spare1 NULL,

spare2 NULL,

spare3 NULL,

spare4 NULL,

spare5 NULL,

spare6 NULL,

spare7 NULL,

spare8 NULL,

spare9 NULL,

spare10 NULL,

spare11 NULL,

spare12 NULL,

spare13 NULL,

spare14 NULL,

spare15 NULL

}

IntegrityProtectionModeCommand ::= CHOICE {

startIntegrityProtection SEQUENCE {

integrityProtInitNumber IntegrityProtInitNumber

},

modify SEQUENCE {

dl-IntegrityProtActivationInfo IntegrityProtActivationInfo

}

}

IntegrityProtInitNumber ::= BIT STRING (SIZE (32))

IntegrityProtectionModeInfo ::= SEQUENCE {

\-- NOTE: DL integrity protection activation info and Integrity

\-- protection intialisation number have been nested inside

\-- IntegrityProtectionModeCommand.

integrityProtectionModeCommand IntegrityProtectionModeCommand,

integrityProtectionAlgorithm IntegrityProtectionAlgorithm OPTIONAL

}

MessageAuthenticationCode ::= BIT STRING (SIZE (32))

MCC ::= SEQUENCE (SIZE (3)) OF

Digit

MNC ::= SEQUENCE (SIZE (2..3)) OF

Digit

NAS-SystemInformationGSM-MAP ::= OCTET STRING (SIZE (1..8))

PLMN-Identity ::= SEQUENCE {

mcc MCC,

mnc MNC

}

PDCP-SN-Info ::= INTEGER (0..65535)

RB-PDCPContextRelocation ::= SEQUENCE {

dl-RFC3095-Context-Relocation BOOLEAN,

ul-RFC3095-Context-Relocation BOOLEAN

}

RB-PDCPContextRelocationList ::= SEQUENCE (SIZE (1..maxRBallRABs)) OF

RB-PDCPContextRelocation

ProtocolErrorCause ::= ENUMERATED {

csn1-ViolationOrEncodingError,

messageTypeNonexistent,

messageNotCompatibleWithReceiverState,

ie-ValueNotComprehended,

informationElementMissing,

messageContentPartError,

messageExtensionNotComprehended,

spare2, spare1 }

ProtocolErrorIndicator ::=

CHOICE {

noError NULL,

errorOccurred SEQUENCE {

rrc-TransactionIdentifier RRC-TransactionIdentifier,

protocolErrorInformation ProtocolErrorInformation

}

}

ProtocolErrorInformation ::= SEQUENCE {

diagnosticsType CHOICE {

type1 SEQUENCE {

protocolErrorCause ProtocolErrorCause

},

spare NULL

}

}

Rb-timer-indicator ::= SEQUENCE {

t314-expired BOOLEAN,

t315-expired BOOLEAN }

RB-ActivationTimeInfoList ::= SEQUENCE (SIZE (1..maxRB)) OF

RB-ActivationTimeInfo

RB-ActivationTimeInfo ::= SEQUENCE {

rb-Identity RB-Identity,

rlc-SequenceNumber RLC-SequenceNumber }

RLC-SequenceNumber :: = CHOICE {

rlc-GPRS-SequenceNumber BIT STRING (SIZE (7)),

rlc-EGPRS-SequenceNumber BIT STRING (SIZE (11)),

rlc-DCCH-TBFMode-SequenceNumber BIT STRING (SIZE (4)),

rlc-TCH-TBF-SequenceNumber BIT STRING (SIZE (8))

}

RB-Identity ::= INTEGER (1..32)

RB-WithPDCP-Info ::= SEQUENCE {

rb-Identity RB-Identity,

pdcp-SN-Info PDCP-SN-Info

}

RB-WithPDCP-InfoList ::= SEQUENCE (SIZE (1..maxRBallRABs)) OF

RB-WithPDCP-Info

RRC-MessageSequenceNumber ::= INTEGER (0..15)

RRC-MessageSequenceNumberList ::= SEQUENCE (SIZE (4..5)) OF

RRC-MessageSequenceNumber

RRC-TransactionIdentifier ::= INTEGER (0..3)

RRC-StateIndicator ::= ENUMERATED {

rrc-Cell-Dedicated, rrc-Cell-Shared, rrc-GRA-PCH}

SBSC-Identity ::= BIT STRING (SIZE (12))

S-RNTI ::= BIT STRING (SIZE (20))

START-Value ::= BIT STRING (SIZE (20))

STARTList ::= SEQUENCE (SIZE (1..maxCNdomains)) OF

STARTSingle

STARTSingle ::= SEQUENCE {

cn-DomainIdentity CN-DomainIdentity,

start-Value START-Value

}

END

9.4 Multiplicity values and type constraint values
--------------------------------------------------

The following table includes constants that are either used as multi
bounds (name starting with \"max\") or as high or low value in a type
specification (name starting with \"lo\" or \"hi\"). Constants are
specified only for values appearing more than once in the RRC
specification. In case a constant is related to one or more other
constants, an expression is included in the \"value\" column instead of
the actual value.

Table 9.4.1: Multiplicity values and type constraint values

  ----------------------------------- -------------------------------------------------------------------------------------------------------------------------- -----------------
  Constant                            Explanation                                                                                                                Value
  **CN information**                                                                                                                                             
  maxCNdomains                        Maximum number of CN domains                                                                                               4
  **MS information**                                                                                                                                             
  maxTransactions                     Maximum number of parallel RRC transactions in downlink                                                                    25
  maxPDCPalgoType                     Maximum number of PDCP algorithm types                                                                                     8
  maxSystemCapability                 Maximum number of system specific capabilities that can be requested in one message.                                       16
  maxTBF                              Maximum nuber of TBFs                                                                                                      8
  **GERAN mobility information**                                                                                                                                 
  maxRAT                              Maximum number of Radio Access Technologies                                                                                maxOtherRAT + 1
  maxOtherRAT                         Maximum number of other Radio Access Technologies                                                                          15
  maxGRA                              Maximum number of GRAs in a cell                                                                                           8
  maxInterSysMessages                 Maximum number of Inter System Messages                                                                                    4
  maxRABsetup                         Maximum number of RABs to be established                                                                                   16
  **RB information**                                                                                                                                             
  maxRB                               Maximum number of RBs                                                                                                      32
  maxRBallRABs                        Maximum number of non signalling RBs                                                                                       27
  maxRBperRAB                         Maximum number of RBs per RAB                                                                                              8
  maxSRBsetup                         Maximum number of signalling RBs to be established                                                                         8
  maxRFC3095-CID                      Maximum number of available CID values per radio bearer                                                                    16384
  **Transport Channel Information**                                                                                                                              
  maxTrCH                             Maximum number of transport channels                                                                                       8
  maxTF                               Maximum number of different transport formats that can be included in the Transport format set for one transport channel   32
  maxTFC                              Maximum number of Transport Format Combinations                                                                            32
  maxTBSize                           Maximum number of Transport Block Size                                                                                     1370
  maxRLCSize                          Maximum number of RLC Size                                                                                                 1370
  N                                   Maximum number of Timeslot Number in DL                                                                                    8
  M                                   Maximum number of Timeslot Number in UL                                                                                    8
  **Other information**                                                                                                                                          
  maxNumGSMFreqRanges                 Maximum number of GSM Frequency Ranges to store                                                                            32
  maxNumFDDFreqs                      Maximum number of FDD centre frequencies to store                                                                          8
  maxNumTDDFreqs                      Maximum number of TDD centre frequencies to store                                                                          8
  maxNumCDMA200Freqs                  Maximum number of CDMA2000 centre frequencies to store                                                                     8
  ----------------------------------- -------------------------------------------------------------------------------------------------------------------------- -----------------

9.4a Constant definitions
-------------------------

Constant-definitions DEFINITIONS AUTOMATIC TAGS ::=

BEGIN

maxCNdomains INTEGER ::= 4

maxRBallRABs INTEGER ::= 27

maxRB INTEGER ::= 32

END

10 Protocol timers, counters, other parameters and default configurations
=========================================================================

10.1 Timers for MS
------------------

Table 10.1.1: Timers for MS

+-------+-------------------+-------------------+-------------------+
| Timer | Start             | Stop              | At expiry         |
+-------+-------------------+-------------------+-------------------+
| T300  | Started when the  | Reception of RRC  | Retransmit RRC    |
|       | transmission of   | CONNECTION SETUP  | CONNECTION        |
|       | RRC CONNECTION    |                   | REQUEST if V300   |
|       | REQUEST is        |                   | =\< N300, else go |
|       | indicated as      |                   | to Idle mode. Its |
|       | successfully      |                   | value is 7s.      |
|       | delivered by RLC  |                   |                   |
+-------+-------------------+-------------------+-------------------+
| T302  | Started when the  | Reception of CELL | Retransmit CELL   |
|       | transmission of   | UPDATE            | UPDATE/GRA UPDATE |
|       | CELL UPDATE/GRA   | CONFIRM/URA       | if V302 =\< N302, |
|       | UPDATE is         | UPDATE CONFIRM    | else, go to Idle  |
|       | indicated as      |                   | mode. Its value   |
|       | successfully      |                   | is 7s.            |
|       | delivered by RLC  |                   |                   |
+-------+-------------------+-------------------+-------------------+
| T304  | Started when the  | Reception of MS   | Retransmit MS     |
|       | transmission of   | CAPABILITY        | CAPABILITY        |
|       | MS CAPABILITY     | INFORMATION       | INFORMATION if    |
|       | INFORMATION is    | CONFIRM           | V304 =\< N304,    |
|       | indicated as      |                   | else initiate a   |
|       | successfully      |                   | cell update       |
|       | delivered by RLC  |                   | procedure. Its    |
|       |                   |                   | value is 7s.      |
+-------+-------------------+-------------------+-------------------+
| T305  | Entering RRC-     | Entering another  | Transmit CELL     |
|       | CELL\_Shared or   | state.            | UPDATE or GRA     |
|       | GRA\_PCH          |                   | UPDATE. See       |
|       | Reception of CELL |                   | sub-clause 7.8    |
|       | UDPATE            |                   |                   |
|       | CONFIRM/URA       |                   |                   |
|       | UPDATE CONFIRM.   |                   |                   |
+-------+-------------------+-------------------+-------------------+
| T314  | When the criteria | When the Cell     | See sub-clause    |
|       | for radio link    | Update procedure  | 7.8.              |
|       | failure are       | has been          |                   |
|       | fulfilled.        | completed.        |                   |
|       |                   |                   |                   |
|       | The timer is      |                   |                   |
|       | started only if   |                   |                   |
|       | radio bearer(s)   |                   |                   |
|       | that are          |                   |                   |
|       | associated with   |                   |                   |
|       | T314 exist.       |                   |                   |
+-------+-------------------+-------------------+-------------------+
| T315  | When the criteria | When the Cell     | See sub-clause    |
|       | for radio link    | Update procedure  | 7.8.              |
|       | failure are       | has been          |                   |
|       | fulfilled.        | completed.        |                   |
|       |                   |                   |                   |
|       | The timer is      |                   |                   |
|       | started only if   |                   |                   |
|       | radio bearer(s)   |                   |                   |
|       | that are          |                   |                   |
|       | associated with   |                   |                   |
|       | T315 exist.       |                   |                   |
+-------+-------------------+-------------------+-------------------+
| T3124 | At the start      | When PHYSICAL     | Its value is set  |
|       | point of the      | INFORMATION       | to 675 ms if the  |
|       | timeslot in which | message has been  | channel type of   |
|       | the HANDOVER      | received          | the channel       |
|       | ACCESS message is |                   | allocated in the  |
|       | sent the first    |                   | RADIO BEARER      |
|       | time              |                   | RECONFIGURATION   |
|       |                   |                   | COMPLETE message  |
|       |                   |                   | is a DBPSCH/S;    |
|       |                   |                   | otherwise its     |
|       |                   |                   | value is set to   |
|       |                   |                   | 320 ms.           |
+-------+-------------------+-------------------+-------------------+
| T3148 | Started after the | When the RADIO    | Its value is 4    |
|       | GERAN Iu mode DTM | BEARER            | seconds. At       |
|       | REQUEST message   | RECONFIGURATION   | expiry the mobile |
|       | transmission is   | message or GERAN  | station shall     |
|       | indicated as      | Iu mode DTM       | reinitiate DTM    |
|       | successfully      | REJECT message is | Request           |
|       | delivered by RLC  | received          | procedure.        |
+-------+-------------------+-------------------+-------------------+

10.1a Timers on the network side
--------------------------------

Table 10.1a.1: Timers on the network side

  ------- ------------------------------------------------------------ ---------------------------------------------------------------- ----------------------------------------------------------------------------- --------------------------------
  Timer   Start                                                        Stop                                                             Action at expiry                                                              Typical Value
  T3143   After having sent the sent of PHYSICAL INFORMATION message   Reception of the RADIO BEARER RECONFIGURATION COMPLETE message   Indicate to the RLC sublayer to send once more PHYSICAL INFORMATION message   Its value is network dependent
  ------- ------------------------------------------------------------ ---------------------------------------------------------------- ----------------------------------------------------------------------------- --------------------------------

10.2 Counters for MS
--------------------

Table 10.2.1: Counters for MS

  --------- ------------------------------------------------------------ ---------------------- --------------------------------------------------------------
  Counter   Reset                                                        Incremented            When reaching max value
  V300      When initiating the procedure RRC connection establishment   Upon expiry of T300.   When V300 \> N300, the MS enters on RRC-Idle mode.
  V302      When initiating the procedure Cell update or GRA update      Upon expiry of T302    When V302 \> N302 the MS enters in RRC-Idle mode.
  V304      When sending the first MS CAPABILITY INFORMATION message.    Upon expiry of T304    When V304 \> N304 the MS initiates the Cell update procedure
  --------- ------------------------------------------------------------ ---------------------- --------------------------------------------------------------

10.3 MS constants and parameters
--------------------------------

Table 10.3.1: MS constants and parameters

  ---------- ---------------------------------------------------------------------------------------------
  Constant   Usage

  N300       Maximum number of retransmissions of the RRC CONNECTION REQUEST message.\
             Its value is 3.

  N302       Maximum number of retransmissions of the CELL UPDATE / URA UPDATE message.\
             Its value is 3.

  N304       Maximum number of retransmissions of the MS CAPABILITY INFORMATION message. Its value is 2.
  ---------- ---------------------------------------------------------------------------------------------

10.3a Network constants and parameters
--------------------------------------

Table 10.3a.1: Network constants and parameters

  ---------- -----------------------------------------------------------------------
  Constant   Usage
  N3143      Maximum number of retransmissions of the PHYSICAL INFORMATION message
  ---------- -----------------------------------------------------------------------

10.4 MS variables 
-----------------

### 10.4.0 General

Table 10.4.0.1: MS variables

  ----------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Name of the Variable                            Usage
  CELL\_UPDATE\_STARTED                           This variable indicates whether a cell update or GRA update procedure is in progress.
  CIPHERING\_STATUS                               This variable contains information about the current status of ciphering in the MS.
  ESTABLISHED\_SIGNALLING\_CONNECTIONS            This variable is used to store information about established signalling connections.
  ESTABLISHMENT\_CAUSE                            This variable is used to store the cause for establishment of a signalling connection received by upper layers, to be used at RRC connection establishment.
  ESTABLISHED\_RABS                               This variable is used to store information about the established radio access bearers and signalling radio bearers in the MS.
  FAILURE\_CAUSE                                  This variable contains the cause for failure of a MS initiated procedure, to be reported in a retransmitted message.
  FAILURE\_INDICATOR                              This variable indicates whether the procedure has failed for a MS initiated procedure.
  GRA\_IDENTITY                                   This variable stores the assigned GRA identity for this MS when in RRC-GRA\_PCH state.
  G\_RNTI                                         This variable stores the assigned G-RNTI for this MS.
  INITIAL\_MS\_IDENTITY                           In this variable the identity used by the MS when establishing an RRC connection is stored.
  INCOMPATIBLE\_SECURITY\_RECONFIGURATION         This variable indicates whether an incompatible simultaneous reconfiguration of a security function has been received
  INTEGRITY\_PROTECTION\_ACTIVATION\_INFO         This variable contains information to be sent to GERAN about when a new integrity protection configuration shall be activated in the uplink for signalling radio bearers in case of modification of integrity protection.
  INTEGRITY\_PROTECTION\_INFO                     This variable contains information about the current status of the integrity protection in the MS.
  LATEST\_CONFIGURED\_CN\_DOMAIN                  This variable stores the CN-domain that was most recently configured to be used for ciphering and integrity protection.
  MS\_CAPABILITY\_REQUESTED                       This variable stores information about the MS capabilities that have been requested by GERAN but that have not yet been transferred to GERAN
  INVALID\_CONFIGURATION                          This variable indicates whether a received message contained an invalid configuration, by means of invalid values or invalid combinations of information elements
  MS\_CAPABILITY\_TRANSFERRED                     This variable stores information about which UE capabilities that have been transferred to GERAN.
  ORDERED\_RECONFIGURATION                        This variable stores information about an ongoing Reconfiguration procedure.
  PDCP\_SN\_INFO                                  This variable contains PDCP receive sequence numbers for one or several radio bearers to be included in a response message to GERAN.
  PROTOCOL\_ERROR\_INDICATOR                      This variable indicates whether there exist a protocol error that is to be reported to GERAN.
  PROTOCOL\_ERROR\_INFORMATION                    This variable contains diagnostics to be reported to GERAN for a message that was not completely understood.
  PROTOCOL\_ERROR\_REJECT                         This variable indicates whether there has occurred a severe protocol error causing the ongoing procedure to fail.
  RB\_TIMER\_INDICATOR                            This variable contains information to be sent to GERAN if any of the timers T314 or T315 has expired when the MS sends a cell update with cause RL failure.
  RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO   This variable contains information to be sent to GERAN about when a new ciphering configuration shall be activated in the uplink for radio bearers using RLC-AM or RLC-UM.
  SECURITY\_MODIFICATION                          This variable contains information on which CN domain is affected by the ongoing security reconfiguration.
  START\_THRESHOLD                                This variable contains information about the maximum allowed value of the START for a CN domain.
  START\_VALUE\_TO\_TRANSMIT                      This variable contains the value of START for new radio bearer(s) to be transmitted in a response message
  TRANSACTIONS                                    This variable stores the identifications of the ongoing RRC procedure transactions.
  TIMERS\_AND\_CONSTANTS                          This variable contains the values for all timers and constants used in RRC-Connected mode.
  UNSUPPORTED\_CONFIGURATION                      This variable indicates whether a received message contained a configuration that is not supported by the MS.
  ----------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 10.4.1 CELL\_UPDATE\_STARTED

This variable indicates whether a cell update or GRA update procedure is
in progress.

Table 10.4.1.1: CELL\_UPDATE\_STARTED Variable

  -------------------------------------------
  \< CELL\_UPDATE\_STARTED VAR \> ::=\
  \< **Cell Update Started** : bit (1) \> ;

  -------------------------------------------

Table 10.4.1.2: CELL\_UPDATE\_STARTED Variable details

+------------------------------------------------------------+
| **Cell Update Started** (1 bit field)                      |
|                                                            |
| bit\                                                       |
| 1\                                                         |
| 0 False - when leaving or entering the RRC Connected Mode\ |
| 1 True - a Cell or GRA Update procedure is in progress     |
+------------------------------------------------------------+

### 10.4.2 CIPHERING\_STATUS

This variable contains information about the current status of ciphering
in the MS. When performing handover or cell reselection to UTRAN the
value of this variable is transferred to the corresponding UTRAN
variable*.* When performing handover or cell reselection from UTRAN the
value of this variable is transferred from the corresponding UTRAN
variable*.*

Table 10.4.2.1: CIPHERING\_STATUS Variable

+--------------------------------------------------------------+
| \< CIPHERING\_STATUS VAR \> ::=\                             |
| \< **CN Domain Related Information List** : bit (2) \>       |
|                                                              |
| { \< **CN Domain Identity** : \< CN Domain Identity IE \> \> |
|                                                              |
| \< **Status** : bit (1) \>                                   |
|                                                              |
| \< **Reconfiguration** : bit (1) \>                          |
|                                                              |
| } \* (1+val(CN Domain Related Information List)) ;           |
+--------------------------------------------------------------+

Table 10.4.2.2: CIPHERING\_STATUS Variable details

+----------------------------------------------------------------------+
| **CN Domain Related Information List** (2 bit field)\                |
| This field is used to repeat information for each CN Domain. Range : |
| 0 to maxCNdomains-1, where 0 enables one CN domain to be described.  |
+----------------------------------------------------------------------+
| **CN Domain Identity**\                                              |
| The *CN Domain Identity* IE is defined in sub-clause 9.3.15.         |
+----------------------------------------------------------------------+
| **Status** (1 bit field)                                             |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Not Started - when leaving the RRC-Connected mode\                 |
| 1 Started - when entering the RRC-Connected mode                     |
+----------------------------------------------------------------------+
| **Reconfiguration** (1 bit field)                                    |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 False - when leaving or entering the RRC Connected Mode\           |
| 1 True - an RRC procedure performing reconfiguration of ciphering is |
| ongoing                                                              |
+----------------------------------------------------------------------+

### 10.4.3 ESTABLISHED\_SIGNALLING\_CONNECTIONS

This variable is used to store information about established signalling
connections. This variable is cleared when entering the RRC Connected
Mode when not otherwise stated in the procedure or when leaving the RRC
Connected Mode. When performing handover or cell reselection to UTRAN
the value of this variable is transferred to the corresponding UTRAN
variable*.* When performing handover or cell reselection from UTRAN the
value of this variable is transferred from the corresponding UTRAN
variable*.*

Table 10.4.3.1: ESTABLISHED\_SIGNALLING\_CONNECTIONS Variable

+----------------------------------------------------------------------+
| \< ESTABLISHED\_SIGNALLING\_CONNECTIONS VAR \> ::=\                  |
| { 0 \| 1 \< **Signalling Connection List** : bit (2) \>              |
|                                                                      |
| \< **CN Domain Identity** : \< CN Domain Identity IE \> \> \* (1+    |
| val(Signalling Connection List))                                     |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 10.4.3.2: ESTABLISHED\_SIGNALLING\_CONNECTIONS Variable details

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Signalling Connection List** (2 bit field)\
  This field is used to repeat the CN domain identity of CN domains with established signalling connection. Range : 0 to maxCNdomains-1, where 0 enables one CN domain with established signalling connection to be described.

  **CN Domain Identity**\
  The *CN Domain Identity* IE is defined in sub-clause 9.3.15.
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 10.4.4 ESTABLISHMENT\_CAUSE

This variable is used to store the cause for establishment of a
signalling connection received by upper layers, to be used at RRC
connection establishment. This variable is cleared when entering or
leaving the RRC Connected Mode.

Table 10.4.4.1: ESTABLISHMENT\_CAUSE Variable

  ---------------------------------------------------------------------------
  \< ESTABLISHMENT\_CAUSE VAR \> ::=\
  { 0 \| 1 \< **Establishment Cause : \< Establishment Cause IE \> \> }** ;

  ---------------------------------------------------------------------------

Table 10.4.4.2: ESTABLISHMENT\_CAUSE Variable details

  ------------------------------------------
  **Establishment Cause**\
  This IE is defined in sub-clause 9.3.21.

  ------------------------------------------

### 10.4.5 ESTABLISHED\_RABS

This variable is used to store information about the established radio
access bearers and signalling radio bearers in the MS. This variable is
cleared when entering or leaving the RRC Connected Mode. When performing
handover or cell reselection to UTRAN the value of this variable is
transferred to the corresponding UTRAN variable*.* When performing
handover or cell reselection from UTRAN the value of this variable is
transferred from the corresponding UTRAN variable*.*

Table 10.4.5.1: ESTABLISHED\_RABS Variable

+----------------------------------------------------------------------+
| \< ESTABLISHED\_RABS VAR \> ::=\                                     |
| {                                                                    |
|                                                                      |
| { 0 \-- Not present when entering or leaving the RRC-Connected mode  |
| when not otherwise stated in the procedure                           |
|                                                                      |
| \| 1 \< **RAB Information List :bit (4) \>**                         |
|                                                                      |
| { \< **RAB Info :** \< RAB Info IE \> \>                             |
|                                                                      |
| \< **RB Information List** : bit (3) \>                              |
|                                                                      |
| { \< **RB Identity** : \< **RB Identity IE \>** \>                   |
|                                                                      |
| \< **RB Started** : bit (1) \> } \* (1+val(RB Information List))     |
|                                                                      |
| } \* (1+val (RAB Information List))                                  |
|                                                                      |
| }                                                                    |
|                                                                      |
| { 0 \-- Not present when leaving RRC-Connected mode                  |
|                                                                      |
| \| 1 \< **Signalling RB Information List** : bit (3) \>              |
|                                                                      |
| \< **Signalling RB Started** : bit (1) \>\* (1+val(Signalling RB     |
| Information List)) }                                                 |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 10.4.5.2: ESTABLISHED\_RABS Variable details

+----------------------------------------------------------------------+
| **RAB Information List** (4 bit field)\                              |
| This field is used to repeat information for each RAB established.   |
| Range : 0 to maxRABsetup-1, where 0 eanbles one established RAB to   |
| be described.                                                        |
+----------------------------------------------------------------------+
| **RAB Info**\                                                        |
| The *RAB Info* IE is defined in sub-clause 9.3.73.                   |
+----------------------------------------------------------------------+
| **RB Information List** (3 bit field)\                               |
| This field is used to repeat information for each RB of the RAB.     |
| Range : 0 to maxRBperRAB-1, where 0 enables one RB to be described.  |
+----------------------------------------------------------------------+
| **RB Identity**\                                                     |
| This IE is defined in sub-clause 9.3.80.                             |
+----------------------------------------------------------------------+
| **RB Started** ( 1 bit field)                                        |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Stopped\                                                           |
| 1 Started -- default value                                           |
+----------------------------------------------------------------------+
| **Signalling RB Information List** (3 bit field)\                    |
| This field is used to repeat information for each SRB. Range : 0 to  |
| maxSRBsetup-1, where 0 enables one SRB to be described.              |
+----------------------------------------------------------------------+
| **Signalling RB Started** (1 bit field)\                             |
| Field repeated in the order of Signalling RB1 and upwards.           |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Stopped\                                                           |
| 1 Started -- default value.                                          |
+----------------------------------------------------------------------+

### 10.4.6 FAILURE\_CAUSE

This variable contains the cause for failure of a MS initiated
procedure, to be reported in a retransmitted message. This variable is
cleared when entering or leaving the RRC Connected Mode.

Table 10.4.6.1: FAILURE\_CAUSE Variable

  -------------------------------------------------------------------
  \< FAILURE\_CAUSE VAR \> ::=\
  { 0 \| 1 \< **Failure Cause : \<** Failure Cause **IE \> \> }** ;

  -------------------------------------------------------------------

Table 10.4.6.2: FAILURE\_CAUSE Variable details

  ---------------------------------------------------------
  **Failure Cause**\
  The *Failure Cause* IE is defined in sub-clause 9.3.24.

  ---------------------------------------------------------

### 10.4.7 FAILURE\_INDICATOR

This variable indicates whether the procedure has failed for a MS
initiated procedure.

Table 10.4.7.1: FAILURE\_INDICATOR Variable

  ----------------------------------------
  \< FAILURE\_INDICATOR VAR \> ::=\
  \< **Failure Indicator : bit(1) \>** ;

  ----------------------------------------

Table 10.4.7.2: FAILURE\_INDICATOR Variable details

+-------------------------------------------------------------+
| **Failure Indicator** ( 1 bit field)                        |
|                                                             |
| bit\                                                        |
| 1\                                                          |
| 0 False - when entering or leaving the RRC-Connected mode.\ |
| 1 True - Procedure has failed.                              |
+-------------------------------------------------------------+

### 10.4.8 GRA\_IDENTITY

This variable stores the assigned GRA identity for this MS when in
RRC-GRA\_PCH state. This variable is cleared when entering or leaving
the RRC Connected Mode.

Table 10.4.8.1: GRA\_IDENTITY Variable

  ---------------------------------------------------------------------
  \< GRA\_IDENTITY VAR \> ::=\
  { 0 \| 1 \< **GRA Identity** **: \<** GRA Identity **IE \> \> }** ;

  ---------------------------------------------------------------------

Table 10.4.8.2: GRA\_IDENTITY Variable details

  ------------------------------------------
  **GRA Identity**\
  This IE is defined in sub-clause 9.3.30.

  ------------------------------------------

### 10.4.9 G\_RNTI

This variable stores the assigned G-RNTI for this MS. Thie variable is
cleared when leaving the RRC-Connected mode.

Table 10.4.9.1: G\_RNTI Variable

  -----------------------------------------------------
  \< G\_RNTI VAR \> ::=\
  { 0 \| 1 \< **G-RNTI** : \< G-RNTI IE \> \> **}** ;

  -----------------------------------------------------

Table 10.4.9.2: G\_RNTI Variable details

  -------------------------------------------------------------------------------------------
  **G-RNTI**\
  This IE is defined in sub-clause 9.3.32. Not present when leaving the RRC-Connected mode.

  -------------------------------------------------------------------------------------------

### 10.4.10 INITIAL\_MS\_IDENTITY

In this variable the identity used by the MS when establishing an RRC
connection is stored.

Table 10.4.10.1: INITIAL\_MS\_IDENTITY Variable

  -------------------------------------------------------------------------------
  \< INITIAL\_MS\_IDENTITY VAR \> ::=\
  { 0 \| 1 \< **Initial MS Identity** : \< Initial MS Identity IE \> \> **}** ;

  -------------------------------------------------------------------------------

Table 10.4.10.2: INITIAL\_MS\_IDENTITY Variable details

  -------------------------------------------------------------------------------------------
  **Initial MS Identity**\
  This IE is defined in sub-clause 9.3.35. Not present when leaving the RRC-Connected mode.

  -------------------------------------------------------------------------------------------

### 10.4.11 INCOMPATIBLE\_SECURITY\_RECONFIGURATION

This variable indicates whether an incompatible simultaneous
reconfiguration of a security function has been received.

Table 10.4.11.1: INCOMPATIBLE\_SECURITY\_RECONFIGURATION Variable

  ------------------------------------------------------------
  \< INCOMPATIBLE\_SECURITY\_RECONFIGURATION VAR \> ::=\
  \< **Incompatible Security Reconfiguration : bit(1) \>** ;

  ------------------------------------------------------------

Table 10.4.11.2: INCOMPATIBLE\_SECURITY\_RECONFIGURATION Variable
details

+----------------------------------------------------------------------+
| **Incompatible Security Reconfiguration** (1 bit field)              |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 False - when entering or leaving the RRC-Connected mode.\          |
| 1 True -- when an incompatible simultaneous security reconfiguration |
| has been detected.                                                   |
+----------------------------------------------------------------------+

### 10.4.12 INTEGRITY\_PROTECTION\_ACTIVATION\_INFO

This variable contains information to be sent to GERAN about when a new
integrity protection configuration shall be activated in the uplink for
signalling radio bearers in case of modification of integrity
protection. This variable is cleared when entering or leaving the
RRC-Connected mode. When performing handover to UTRAN the value of this
variable is transferred to the corresponding UTRAN variable*.* When
performing handover from UTRAN the value of this variable is transferred
from the corresponding UTRAN variable*.*

Table 10.4.12.1: INTEGRITY\_PROTECTION\_ACTIVATION\_INFO Variable

  ------------------------------------------------------------------------------------------------------------------------
  \< INTEGRITY\_PROTECTION\_ACTIVATION\_INFO VAR \> ::=\
  { 0 \| 1 \< **Uplink Integrity Protection Activation Info** : \< Integrity Protection Activation Info IE \> \> **}** ;

  ------------------------------------------------------------------------------------------------------------------------

Table 10.4.12.2: INTEGRITY\_PROTECTION\_ACTIVATION\_INFO Variable
details

  -------------------------------------------
  **Integrity Protection Activation Info**\
  This IE is defined in sub-clause 9.3.37.

  -------------------------------------------

### 10.4.13 INTEGRITY\_PROTECTION\_INFO

This variable contains information about the current status of the
integrity protection in the MS. When performing handover or cell
reselection to UTRAN the value of this variable is transferred to the
corresponding UTRAN variable*.* When performing handover or cell
reselection from UTRAN the value of this variable is transferred from
the corresponding UTRAN variable*.*

Table 10.4.13.1: INTEGRITY\_PROTECTION\_INFO Variable

+----------------------------------------------------------------------+
| \< INTEGRITY\_PROTECTION\_INFO VAR \> ::=\                           |
| {                                                                    |
|                                                                      |
| \< **Historical Status** : bit (1) \>                                |
|                                                                      |
| \< **Status** : bit (1) \>                                           |
|                                                                      |
| \< **Reconfiguration** : bit (1) \>                                  |
|                                                                      |
| { 0 \-- Cleared when entering or leaving the RRC-Connected mode      |
|                                                                      |
| \| 1 \< **Signalling RB Specific Integrity Protection Information    |
| List** : bit (3) \>                                                  |
|                                                                      |
| { \-- Signalling SRB1 and upwards                                    |
|                                                                      |
| \< **Uplink RRC HFN** : bit (28) \>                                  |
|                                                                      |
| \< **Downlink RRC HFN** : bit (28) \>                                |
|                                                                      |
| \< **Uplink RRC Message Sequence Number** : bit (4) \>               |
|                                                                      |
| { 0 \| 1 \< **Downlink RRC Message Sequence Number** : bit (4) \> }  |
|                                                                      |
| } \* (1+val(Signalling RB Specific Integrity Protection Information  |
| List))                                                               |
|                                                                      |
| }                                                                    |
|                                                                      |
| } ;                                                                  |
+----------------------------------------------------------------------+

Table 10.4.13.2: INTEGRITY\_PROTECTION\_INFO Variable details

+----------------------------------------------------------------------+
| **Historical Status** (1 bit field)                                  |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Never been active -- set when entering the RRC-Connected mode\     |
| 1 Has been active                                                    |
+----------------------------------------------------------------------+
| **Status** (1 bit field)                                             |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Not Started - when leaving the RRC-Connected mode\                 |
| 1 Started - when entering the RRC-Connected mode                     |
+----------------------------------------------------------------------+
| **Reconfiguration** (1 bit field)                                    |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 False - when leaving or entering the RRC Connected Mode\           |
| 1 True - an RRC procedure performing reconfiguration of ciphering is |
| ongoing                                                              |
+----------------------------------------------------------------------+
| **Signalling RB Specific Integrity Protection Information** **List** |
| (3 bit field)\                                                       |
| This field is used to repeat information for each SRB with specific  |
| integrity protection information. Range : 0 to maxSRBsetup-1, where  |
| 0 enables one SRB with specific integrity protection informationto   |
| be described.                                                        |
+----------------------------------------------------------------------+
| **Uplink RRC HFN** (28 bit field)\                                   |
| **Downlink RRC HFN** (28 bit field)\                                 |
| The field indicates the RRC HFN.                                     |
+----------------------------------------------------------------------+
| **Uplink RRC Message Sequence Number** (4 bit field)\                |
| **Downlink RRC Message Sequence Number** (4 bit field)\              |
| This field is the binary representation of the sequence number of    |
| the RRC message. Range 0 to 15.                                      |
+----------------------------------------------------------------------+

### 10.4.14 INVALID\_CONFIGURATION

This variable indicates whether a received message contained an invalid
configuration, by means of invalid values or invalid combinations of
information elements.

Table 10.4.14.1: INVALID\_CONFIGURATION Variable

  --------------------------------------------
  \< INVALID\_CONFIGURATION VAR \> ::=\
  \< **Invalid Configuration : bit(1) \>** ;

  --------------------------------------------

Table 10.4.14.2: INVALID\_CONFIGURATION Variable details

+-------------------------------------------------------------+
| **Invalid Configuration** (1 bit field)                     |
|                                                             |
| bit\                                                        |
| 1\                                                          |
| 0 False - when entering or leaving the RRC-Connected mode.\ |
| 1 True -- an invalid configuration has been detected        |
+-------------------------------------------------------------+

### 10.4.14a LATEST\_CONFIGURED\_CN\_DOMAIN

This variable stores the CN-domain that was most recently configured to
be used for ciphering and integrity protection. When performing handover
or cell reselection to UTRAN the value of this variable is transferred
to the corresponding UTRAN variable*.* When performing handover or cell
reselection from UTRAN the value of this variable is transferred from
the corresponding UTRAN variable

Table 10.4.14a.1: LATEST\_CONFIGURED\_CN\_DOMAIN Variable

  --------------------------------------------------------------------------------------
  \< LATEST\_CONFIGURED\_CN\_DOMAIN VAR \> ::=\
  { 0 \| 1 \< **Latest configured CN domain** : \< CN Domain Identity IE \> \> **}** ;

  --------------------------------------------------------------------------------------

Table 10.4.14a.2: LATEST\_CONFIGURED\_CN\_DOMAIN Variable details

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Latest configured CN domain**\
  The *CN Domain Identity* IE is defined in sub-clause 9.3.15. The variable is cleared when entering GERAN RRC connected mode when not stated otherwise in the procedure or when leaving GERAN RRC connected mode.

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 10.4.15 MS\_CAPABILITY\_REQUESTED

This variable stores information about the MS/UE capabilities that have
been requested by GERAN but that have not yet been transferred to GERAN.
This variable is cleared when entering or leaving the RRC-Connected
mode.

Table 10.4.15.1: MS\_CAPABILITY\_REQUESTED Variable

+----------------------------------------------------------------------+
| \< MS\_CAPABILITY\_REQUESTED VAR \> ::=\                             |
| \< **MS GERAN Iu mode Radio Access Capability** : \< MS GERAN Iu     |
| mode Radio Access Capability IE \> \>                                |
|                                                                      |
| { 0 \| 1 \< **MS GERAN A/Gb mode Radio Access Capability** : \< MS   |
| GERAN A/Gb mode Radio Access Capability IE \> \>}                    |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability**: \< UE UTRAN Radio  |
| Access Capability IE \> \>}                                          |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability Extension**: \< UE    |
| UTRAN Radio Access Capability Extension IE \> \>}                    |
|                                                                      |
| { 0 \| 1 \< **UE CDMA2000 Radio Access Capability** : \< UE CDMA2000 |
| Radio Access Capability IE \> \>} ;                                  |
+----------------------------------------------------------------------+

Table 10.4.15.2: MS\_CAPABILITY\_REQUESTED Variable details

  -----------------------------------------------
  **MS GERAN Iu mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.45.

  **MS GERAN A/Gb mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.44.

  **UE UTRAN Radio Access Capability\
  **This IE is defined in sub-clause 9.3.108.

  **UE UTRAN Radio Access Capability Extension\
  **This IE is defined in sub-clause 9.3.109.

  **UE CDMA2000 Radio Access Capability\
  **This IE is defined in sub-clause 9.3.110.
  -----------------------------------------------

### 10.4.16 MS\_CAPABILITY\_TRANSFERRED

This variable stores information about which UE/MS capabilities that
have been transferred to GERAN. This variable is cleared when entering
or leaving the RRC-Connected mode when not stated otherwise in the
procedure. When performing handover or cell reselection to UTRAN the
value of this variable is transferred to the corresponding UTRAN
variable*.* When performing handover or cell reselection from UTRAN the
value of this variable is transferred from the corresponding UTRAN
variable*.*

Table 10.4.16.1: MS\_CAPABILITY\_TRANSFERRED Variable

+----------------------------------------------------------------------+
| \< MS\_CAPABILITY\_TRANSFERRED VAR \> ::=\                           |
| \< **MS GERAN Iu mode Radio Access Capability** : \< MS GERAN Iu     |
| mode Radio Access Capability IE \> \>                                |
|                                                                      |
| { 0 \| 1 \< **MS GERAN A/Gb mode Radio Access Capability** : \< MS   |
| GERAN A/Gb mode Radio Access Capability IE \> \>}                    |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability**: \< UE UTRAN Radio  |
| Access Capability IE \> \>}                                          |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability Extension**: \< UE    |
| UTRAN Radio Access Capability Extension IE \> \>}                    |
|                                                                      |
| { 0 \| 1 \< **UE CDMA2000 Radio Access Capability** : \< UE CDMA2000 |
| Radio Access Capability IE \> \>} ;                                  |
+----------------------------------------------------------------------+

Table 10.4.16.2: MS\_CAPABILITY\_TRANSFERRED Variable details

  -----------------------------------------------
  **MS GERAN Iu mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.45.

  **MS GERAN A/Gb mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.44.

  **UE UTRAN Radio Access Capability\
  **This IE is defined in sub-clause 9.3.108.

  **UE UTRAN Radio Access Capability Extension\
  **This IE is defined in sub-clause 9.3.109.

  **UE CDMA2000 Radio Access Capability\
  **This IE is defined in sub-clause 9.3.110.
  -----------------------------------------------

### 10.4.17 ORDERED\_RECONFIGURATION

This variable stores information about an ongoing Reconfiguration
procedure.

Table 10.4.17.1: ORDERED\_RECONFIGURATION Variable

  ---------------------------------------------------
  \< ORDERED\_RECONFIGURATION VAR \> ::=\
  \< **Ordered reconfiguration** **: bit (1) \>** ;

  ---------------------------------------------------

Table 10.4.17.2: ORDERED\_RECONFIGURATION Variable details

+-------------------------------------------------------------+
| **Ordered reconfiguration** (1 bit field)                   |
|                                                             |
| bit\                                                        |
| 1\                                                          |
| 0 False - when entering or leaving the RRC-Connected mode.\ |
| 1 True -- reconfiguration procedure is ongoing.             |
+-------------------------------------------------------------+

### 10.4.18 PDCP\_SN\_INFO

This variable contains PDCP receive sequence numbers for one or several
radio bearers to be included in a response message to GERAN. This
variable is cleared when entering or leaving the RRC-Connected mode.

Table 10.4.18.1: PDCP\_SN\_INFO Variable

+----------------------------------------------------------------------+
| \< PDCP\_SN\_INFO VAR \> ::=\                                        |
| { 0 \| 1 \< **RB with PDCP Information List** : bit (5) \>           |
|                                                                      |
| \< **RB with PDCP Information** : \< RB with PDCP Information IE \>  |
| \> \* (1 + val(RB with PDCP Information List) ) };                   |
+----------------------------------------------------------------------+

Table 10.4.18.2: PDCP\_SN\_INFO Variable details

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **RB with PDCP Information List** (5 bit field)\
  This field used to repeat information for each RB with PDCP Information. Range : 0 to maxRBallRABs-1, where 0 enables one RB with PDCP Information to be described. Other values are reserved.

  **RB with PDCP Information**\
  This IE is defined in sub-clause 9.3.86.
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 10.4.19 PROTOCOL\_ERROR\_INDICATOR

This variable indicates whether there exist a protocol error that is to
be reported to GERAN. This variable is cleared when entering or leaving
the RRC-Connected mode.

Table 10.4.19.1: PROTOCOL\_ERROR\_INDICATOR Variable

  ------------------------------------------------------------------------------
  \< PROTOCOL\_ERROR\_INDICATOR VAR \> ::=\
  \< **Protocol Error Indicator : \<** Protocol Error Indicator IE **\> \>** ;

  ------------------------------------------------------------------------------

Table 10.4.19.2: PROTOCOL\_ERROR\_INDICATOR Variable details

  ------------------------------------------
  **Protocol Error Indicator**\
  This IE is defined in sub-clause 9.3.70.

  ------------------------------------------

### 10.4.20 PROTOCOL\_ERROR\_INFORMATION

This variable contains diagnostics to be reported to GERAN for a message
that was not completely understood. This variable is cleared when
entering or leaving the RRC-Connected mode.

Table 10.4.20.1: PROTOCOL\_ERROR\_INFORMATION Variable

  --------------------------------------------------------------------------------------------
  \< PROTOCOL\_ERROR\_INFORMATION VAR \> ::=\
  { 0 \| 1 \< **Protocol Error Information: \<** Protocol Error Information IE **\> \> }** ;

  --------------------------------------------------------------------------------------------

Table 10.4.20.2: PROTOCOL\_ERROR\_INFORMATION Variable details

  ------------------------------------------
  **Protocol Error Information**\
  This IE is defined in sub-clause 9.3.71.

  ------------------------------------------

### 10.4.21 PROTOCOL\_ERROR\_REJECT

This variable indicates whether there has occurred a severe protocol
error causing the ongoing procedure to fail.

Table 10.4.21.1: PROTOCOL\_ERROR\_REJECT Variable

  -------------------------------------------------
  \< PROTOCOL\_ERROR\_REJECT VAR \> ::=\
  \< **Protocol Error Reject** **: bit (1) \>** ;

  -------------------------------------------------

Table 10.4.21.2: PROTOCOL\_ERROR\_REJECT Variable details

+-------------------------------------------------------------+
| **Protocol Error Reject** (1 bit field)                     |
|                                                             |
| bit\                                                        |
| 1\                                                          |
| 0 False - when entering or leaving the RRC-Connected mode.\ |
| 1 True - a severe protocol error has occurred.              |
+-------------------------------------------------------------+

### 10.4.22 RB\_TIMER\_INDICATOR

This variable contains information to be sent to GERAN if any of the
timers T314 or T315 has expired when the MS sends a cell update with
cause RL failure. This variable is cleared when entering or leaving the
RRC-Connected mode.

Table 10.4.22.1: RB\_TIMER\_INDICATOR Variable

  ---------------------------------------------------------------------------------
  \< RB\_TIMER\_INDICATOR VAR \> ::=\
  { 0 \| 1 \< **RB Timer Indicator** **: \<** RB Timer Indicator IE **\> \> }** ;

  ---------------------------------------------------------------------------------

Table 10.4.22.2: RB\_TIMER\_INDICATOR Variable details

  ------------------------------------------
  **RB Timer Indicator**\
  This IE is defined in sub-clause 9.3.85.

  ------------------------------------------

### 10.4.23 RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO

This variable contains information to be sent to GERAN about when a new
ciphering configuration shall be activated in the uplink for radio
bearers using RLC-AM or RLC-UM. This variable is cleared when entering
or leaving the RRC-Connected mode.

Table 10.4.23.1: RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO Variable

  -----------------------------------------------------------------------------------------------------------------------------
  \< RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO VAR \> ::=\
  { 0 \| 1 \< **RB Uplink Ciphering Activation Time Info** **: \<** RB Uplink Ciphering Activation Time Info IE **\> \> }** ;

  -----------------------------------------------------------------------------------------------------------------------------

Table 10.4.23.2: RB\_UPLINK\_CIPHERING\_ACTIVATION\_TIME\_INFO Variable
details

  -----------------------------------------------
  **RB Uplink Ciphering Activation Time Info**\
  This IE is defined in sub-clause 9.3.77.

  -----------------------------------------------

### 10.4.24 START\_THRESHOLD

This variable contains information about the maximum allowed value of
the START for a CN domain. This variable is cleared when entering or
leaving the RRC-Connected mode. When performing handover or cell
reselction to UTRAN the value of this variable is transferred to the
corresponding UTRAN variable*.* When performing handover or cell
reselction from UTRAN the value of this variable is transferred from the
corresponding UTRAN variable

Table 10.4.24.1: START\_THRESHOLD Variable

  ---------------------------------------------
  \< START\_THRESHOLD VAR \> ::=\
  { 0 \| 1 \< **Threshold : bit (20) \> }** ;

  ---------------------------------------------

Table 10.4.24.2: START\_THRESHOLD Variable details

  ---------------------------------------------------------------------------------------------------------------------
  **Threshold** (20 bit field)\
  This field is the binary representation of maximum allowed value of the START for a CN domain. Range: 0 to 1048575.

  ---------------------------------------------------------------------------------------------------------------------

### 10.4.25 START\_VALUE\_TO\_TRANSMIT

This variable contains the value of START for new radio bearer(s) to be
transmitted in a response message. This variable is cleared when
entering or leaving the RRC-Connected mode. When performing handover or
cell reselction to UTRAN the value of this variable is transferred to
the corresponding UTRAN variable. When performing handover or cell
reselection from UTRAN the value of this variable is transferred from
the corresponding UTRAN variable

Table 10.4.25.1: START\_VALUE\_TO\_TRANSMIT Variable

  -------------------------------------------------------
  \< START\_VALUE\_TO\_TRANSMIT VAR \> ::=\
  { 0 \| 1 \< **START** **: \<** START **IE \> \> }** ;

  -------------------------------------------------------

Table 10.4.25.2: START\_VALUE\_TO\_TRANSMIT Variable details

  -------------------------------------------
  **START**\
  This IE is defined in sub-clause 9.3.102.

  -------------------------------------------

### 10.4.26 TRANSACTIONS

This variable stores the identifications of the ongoing RRC procedure
transactions. This variable is cleared when leaving the RRC Connected
mode.

Table 10.4.26.1: TRANSACTIONS Variable

+----------------------------------------------------------------------+
| \< TRANSACTIONS VAR \> ::=\                                          |
| { 0 \| 1 \< **Accepted Transactions List** **: bit (5) \>**          |
|                                                                      |
| { \< **Message Type** : \< Message Type IE \> **\>**                 |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> **\>**                                                            |
|                                                                      |
| **} \* (1+val(**Accepted Transactions List))                         |
|                                                                      |
| }                                                                    |
|                                                                      |
| { 0 \| 1 \< **Rejected Transactions List** **: bit (5) \>**          |
|                                                                      |
| { \< **Message Type** : \< Message Type IE \> **\>**                 |
|                                                                      |
| \< **RRC Transaction Identifier** : \< RRC Transaction Identifier IE |
| \> **\>**                                                            |
|                                                                      |
| **} \* (1+val(**Rejected Transactions List))                         |
|                                                                      |
| **}** ;                                                              |
+----------------------------------------------------------------------+

Table 10.4.26.2: TRANSACTIONS Variable details

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Accepted Transactions List** (5 bit field)\
  **Rejected Transactions List** (5 bit field)\
  These fields are used to repeat information for each accepted or rejected transations respectively. Range: 0 to maxTransactions-1, where 0 enables one transaction to be described.

  **Message Type** \
  This IE is defined in sub-clause 9.2.1.

  **RRC Transaction Identifier**\
  This IE is defined in sub-clause 9.3.98.
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 10.4.27 TIMERS\_AND\_CONSTANTS

This variable contains the values for all timers and constants used in
RRC-Connected mode.

Table 10.4.27.1: TIMERS\_AND\_CONSTANTS Variable

  ------------------------------------------------------------------------------------------------------------
  \< TIMERS\_AND\_CONSTANTS VAR \> ::=\
  \< **MS Timers and Constants In Connected Mode** : \< MS Timers and Constants In Connected Mode IE \> \> ;

  ------------------------------------------------------------------------------------------------------------

Table 10.4.27.2: TIMERS\_AND\_CONSTANTS Variable details

  --------------------------------------------------------------------------------------------------------------------------------
  **MS Timers and Constants In Connected Mode**\
  This IE is defined in sub-clause 9.3.51. All parameters are set to the default value when leaving the GERAN Iu to another RAT.

  --------------------------------------------------------------------------------------------------------------------------------

### 10.4.28 UNSUPPORTED\_CONFIGURATION

This variable indicates whether a received message contained a
configuration that is not supported by the MS.

Table 10.4.27.1: UNSUPPORTED\_CONFIGURATION Variable

  -------------------------------------------------
  \< UNSUPPORTED\_CONFIGURATION VAR \> ::=\
  \< **Unsupported Configuration** : bit (1) \> ;

  -------------------------------------------------

Table 10.4.27.2: UNSUPPORTED\_CONFIGURATION Variable details

+-------------------------------------------------------------+
| **Unsupported Configuration**                               |
|                                                             |
| bit\                                                        |
| 1\                                                          |
| 0 False - when entering or leaving the RRC-Connected mode.\ |
| 1 True - an unsupported configuration has been detected.    |
+-------------------------------------------------------------+

### 10.4.29 SECURITY\_MODIFICATION

This variable contains information on which CN domain is affected by the
ongoing security reconfiguration.When performing handover to UTRAN the
value of this variable is transferred to the corresponding UTRAN
variable*.* When performing handover from UTRAN the value of this
variable is transferred from the corresponding UTRAN variable*.*

Table 10.4.29.1: SECURITY\_MODIFICATION Variable

+-----------------------------------------------------------------+
| \< SECURITY\_MODIFICATION VAR \> ::=\                           |
| { 0 \| 1 \< **Status for each CN domain : bit (2) \>**          |
|                                                                 |
| { \< **CN Domain Identity**: \< CN Domain Identity IE \> **\>** |
|                                                                 |
| \< **Status** : bit (1) **\>**                                  |
|                                                                 |
| **} \* (1+val(**Status for each CN domain**))**                 |
|                                                                 |
| } ;                                                             |
+-----------------------------------------------------------------+

Table 10.4.29.2: SECURITY\_MODIFICATION Variable details

+----------------------------------------------------------------------+
| **Status for each CN domain** (2 bit field)**\                       |
| **This field is used to repeat the status for each CN domain. Range  |
| : 0 to maxCNdomains-1, where 0 enables one status of CN domain to be |
| described.                                                           |
+----------------------------------------------------------------------+
| **CN Domain Identity**\                                              |
| This IE is defined in sub-clause 9.3.15.                             |
+----------------------------------------------------------------------+
| **Status** (1 bit field)                                             |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 Not affected\                                                      |
| 1 Affected                                                           |
+----------------------------------------------------------------------+

11 Specific functions
=====================

11.1 Provision and reception of RRC information between network nodes
---------------------------------------------------------------------

### 11.1.1 General

In certain cases, e.g., when performing handover to GERAN or when
performing SBSS relocation, RRC information may need to be transferred
between GERAN nodes, between GERAN and another RAT, between nodes within
another RAT or between the MS and another RAT.

The RRC information exchanged between network nodes or between the MS
and another RAT is typically transferred by means of RRC information
containers. An RRC information container is a self-contained and
extensible RRC information unit that may be used to transfer a number of
different RRC messages, one at a time. As stated before, RRC information
containers may be used to transfer RRC messages across interfaces other
than the Um interface. The RRC messages that may be included in RRC
information containers have similar characteristics as the RRC messages
that are transferred across the Um interface.

The RRC messages tht are sent to/ from the MS, e.g RADIO BEARER
RECONFIGURATION, INTER SYSTEM TO UTRAN HANDOVER COMMAND HANDOVER FROM
GERAN Iu MODE COMMAND are covered by (sub)clauses 7 and 9 of this
specification. The following sub-clauses concern RRC messages exchanged
between network nodes.

In future versions of this specification, it is possible to extend the
RRC messages transferred across interfaces other than Um. For these RRC
messages the same extension mechanism applies as defined for RRC
messages transferred across the Um interface, as is specified in
sub-clause 9, i.e., both critical and non-critical extensions may be
added.

The transfer syntax for RRC information containers and RRC messages
transferred between network nodes is derived from the description used
in the target node. The resulting bit or octet string is, carried in a
container, transferred between the network nodes.

When using a separate RRC information container for each endpoint, the
receiving RRC protocol entity is able to interpret the received
container; this means that the receiver need not take into account
information about the (network interface) message used in transferring
the container.

### 11.1.2 General error handling for RRC messages exchanged between network nodes

The error handling for RRC messages that are exchanged between network
nodes applies the same principles as defined for other RRC messages.

Although the same principles apply for network nodes receiving unknown,
unforeseen and erroneous RRC messages received in RRC information
containers, the notification of the error should be done in a different
manner, as specified in the following:

The network node receiving an invalid RRC message from another network
node should:

1\> if the received RRC message was unknown, unforeseen or erroneous:

2\> prepare an RRC FAILURE INFO message, including the IE \"*Failure
Cause*\" set to \"Protocol error\" and the IE \"Protocol error
information\" including an IE \"*Protocol Error Cause*\" which should be
set as follows:

3\> to \"CSN.1 violation or encoding error\" upon receiving an RRC
message for which the encoded message does not result in any valid c
syntax value;

3\> to \"Message type non-existent or not implemented\" upon receiving
an unknown RRC message type;

3\> to \"Message extension not comprehended\" upon receiving an RRC
message including an undefined critical message extension;

3\> to \"Information element value not comprehended\" upon receiving an
RRC message including an mandatory IE for which no default value is
defined and for which either the value is set to spare or for which the
encoded IE does not result in a valid transfer syntax. The same applies
for conditional IEs, for which the conditions for presence are met, the
IE is present but has a value set to spare or for which the encoded IE
does not result in a valid transfer syntax;

3\> to \"Information element missing\" upon receiving an RRC information
container with an absent conditional IE for which the conditions for
presence are met.

1\> if there was another failure to perform the operation requested by
the received RRC message:

2\> prepare an RRC FAILURE INFO message, including the IE \"*Failure
Cause*\" set to a value that reflects the failure cause.

1\> send the RRC FAILURE INFO message to the network node from which the
invalid RRC protocol information was received.

NOTE 1: The appropriate (failure) messages used across the network
interfaces may not support the inclusion of a RRC information container.
In this case, the information contained in the RRC FAILURE INFO message
may need to be transferred otherwise e.g. by mapping to a cause value
(e.g. a cause value in the RR-HANDOVER FAILURE message when there is a
error associated with the RRC-RADIO BEAERER RECONFIGURATION message).

NOTE 2 In case the RRC procedure used to perform SBSS relocation fails
e.g. due to non comprehension, the source BSS may notify the target BSS
by including the diagnostics information (IEs \"Protocol error\" and
\"Protocol error information\") in the \"RRC message \"SBSS Relocation\"
Info sent in the RRC information container\" used for a subsequent
relocation request.

### 11.1.3 RRC Information to target GERAN Iu mode BSS

The RRC information container \"RRC Information to target GERAN Iu mode
BSS\" may either be sent from source GERAN Iu mode BSS or from another
RAT. In case of Handover to GERAN, this information originates from
another RAT, while in case of SBSS relocation the RRC information
originates from the source BSS. In case of handover to GERAN, the RRC
information transferred may provide GERAN specific information, as
defined in the INTER RAT HANDOVER INFO WITH INTER RAT CAPABILITIES
message, that the target BSS needs when preparing the handover command
message. In case of SBSS relocation, the RRC information transferred
specifies the configuration of RRC and the lower layers it controls,
e.g., including the radio bearer and RLC configuration. It is used by
the target BSS to initialise RRC and the lower layer protocols to
facilitate SBSS relocation in a manner transparent to the MS.

Table 11.1.3.1: RRC INFORMATION TO TARGET GERAN IU MODE BSS information
elements

+----------------------------------------------------------------------+
| \< RRC INFORMATION TO TARGET GERAN IU MODE BSS message content \>    |
| ::=                                                                  |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| {                                                                    |
|                                                                      |
| { 00 \<**Handover to GERAN**: \< INTER RAT or MODE HANDOVER INFO     |
| WITH MS CAPABILITIES Message \> \>                                   |
|                                                                      |
| \| 01 \< **SBSS Relocation** : \< SBSS RELOCATION INFO \> \>         |
|                                                                      |
| \| 10 \< **RFC3095 Context Info** : \< RFC3095 CONTEXT INFO \>       |
|                                                                      |
| ! \< Message escape : { 11 } bit\*\* = \< no string \> \> } \--      |
| *reserved for future extension*                                      |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+

Table 11.1.3.2: RRC INFORMATION TO TARGET GERAN IU MODE BSS information
element details

  -----------------------------------------------------------
  **INTER RAT or MODE HANDOVER INFO WITH MS CAPABILITIES**\
  This message is defined in sub-clause 11.1.5.

  **SBSS RELOCATION INFO**\
  This message is defined in sub-clause 11.1.5.

  **RFC3095 CONTEXT INFO**\
  This message is defined in sub-clause 11.1.5.3
  -----------------------------------------------------------

### 11.1.4 RRC information, target BSS to source BSS

There are 2 possible cases for BSS relocation:

1 The MS is already under control of target BSS; and

2 The SBSS Relocation with Handover (MS still under control of SBSS),
but MS is moving to a location controlled by the target BSS (based on
measurement information).

In case 1 the relocation is transparent to the MS and there is no
\"reverse\" direction container. The SBSS just assigns the \'serving\'
function to the target BSS, which then becomes the Serving BSS.

In case 2 the relocation is initiated by SBSS, which also provides the
RRC INFORMATION TO TARGET GERAN IU MODE BSS Container to the target BSS.
Based upon this information, the target BSS prepares the RADIO BEARER
RECONFIGURATION Message.

The source BSS then transmits the Handover Message to the MS, which then
performs the handover.

In the successful case, the MS transmits a RADIO BEARER RECONFIGURATION
COMPLETE message, using the new configuration, to the target BSS.

In case of failure, the MS transmits an RADIO BEARER RECONFIGURATION
FAILURE, using the old configuration, to the source BSS and the RRC
context remains unchanged (has to be confirmed and checked with the SBSS
relocation procedure).

Table 11.1.4.1: RRC Information Target BSS To Souce BSS information
elements

+----------------------------------------------------------------------+
| \< RRC Information Target BSS To Souce BSS message content \> ::=    |
|                                                                      |
| { 0 \-- *critical extension escape available*                        |
|                                                                      |
| { 00 \< **RADIO BEARER RECONFIGURATION** : \< RADIO BEARER           |
| RECONFIGURATION message \> \>                                        |
|                                                                      |
| \| 01 \< **RRC FAILURE INFO** : \< RRC FAILURE INFO message \> \>    |
|                                                                      |
| ! \< Message escape : {10 \| 11} bit (\*) = \<no string\> \> } \--   |
| *reserved for future extension*                                      |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> }            |
|                                                                      |
| ! \< Message escape critical extension : 1 bit (\*) = \< no string   |
| \> \>} ;                                                             |
+----------------------------------------------------------------------+

Table 11.1.4.2: RRC Information Target BSS To Souce BSS information
element details

  ----------------------------------------------
  **RADIO BEARER RECONFIGURATION**\
  This message is defined in sub-clause 9.3.28

  **RRC FAILURE INFO**\
  This message is defined in sub-clause 9.3.44
  ----------------------------------------------

### 11.1.5 RRC messages exchanged between network nodes

#### 11.1.5.0 RADIO BEARER RECONFIGURATION

This RRC message is sent between network nodes to transfer the actual
RADIO BEARER RECONFIGURATION message including the details of the radio
configuration to be used upon handover to GERAN as compiled by the
target BSS.

Direction: target BSS →source RAT

The message is exactly the same as the RADIO BEARER RECONFIGURATION
defined in sub-clause 9.2.29.

#### 11.1.5.1 INTER RAT or MODE HANDOVER INFO WITH MS CAPABILITIES

This RRC message is sent between network nodes when preparing for an
inter RAT handover to GERAN.

Direction: source RAT→target BSS

Table 11.1.5.1.1: INTER RAT or MODE HANDOVER INFO WITH MS CAPABILITIES
elements

+----------------------------------------------------------------------+
| \< INTER RAT or MODE HANDOVER INFO WITH MS CAPABILITIES message      |
| content \> ::=                                                       |
|                                                                      |
| {                                                                    |
|                                                                      |
| *\-- MS Information Elements*                                        |
|                                                                      |
| { 0 \| 1 \< **MS GERAN Iu mode Radio Access Capability** : \< **MS   |
| GERAN Iu mode radio access capability** IE \> \> }                   |
|                                                                      |
| { 0 \| 1 \< **MS GERAN A/Gb mode Radio Access Capability** : \< **MS |
| GERAN A/Gb mode radio access capability** IE \> \> }                 |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability** : \< **UE UTRAN     |
| radio access capability** IE \> \> }                                 |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability Extension** : \< **UE |
| UTRAN radio access capability extension** IE \>\> }                  |
|                                                                      |
| { 0 \| 1 \< **UE CDMA2000 Radio Access Capability** : \< UE CDMA2000 |
| **radio access capability** IE \> \> }                               |
|                                                                      |
| { 0 \| 1 \< **Failure Cause and Error Information** : \< Failure     |
| Cause and Error Information IE \> \> }                               |
|                                                                      |
| { 0 \| 1 \< **Multirate configuration** : \< Multirate configuration |
| IE \> \> }                                                           |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 11.1.5.1.2: INTER RAT or MODE HANDOVER INFO WITH MS CAPABILITIES
element details

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **MS GERAN Iu mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.45.

  **MS GERAN A/Gb mode Radio Access Capability\
  **This IE is defined in sub-clause 9.3.44.

  **UE UTRAN Radio Access Capability\
  **This IE is defined in sub-clause 9.3.108.

  **UE UTRAN Radio Access Capability Extension\
  **This IE is defined in sub-clause 9.3.109.

  **UE CDMA2000 Radio Access Capability**\
  This IE is defined in sub-clause 9.3.110.

  **MultiRate configuration IE\
  **This IE is defined in sub-clause 9.3.52. If the present speech codec is a multi-rate speech codec, the old BSS may inform the new BSS of the current multi-rate codec configuration by including the MultiRate configuration information element in the RRC INFORMATION TO TARGET GERAN IU MODE BSS message.
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#### 11.1.5.2 SBSS RELOCATION INFO

This RRC message is sent between network nodes when preparing for an
SBSS relocation or a handover from UTRAN to GERAN *Iu mode*.

Direction: source RAT→target BSS.

Table 11.1.5.2.1: SBSS RELOCATION INFO information elements

+----------------------------------------------------------------------+
| \< SBSS Relocation Information message content \> ::=                |
|                                                                      |
| {                                                                    |
|                                                                      |
| *\-- MS Information Elements*                                        |
|                                                                      |
| \< **RRC State Indicator** : \< RRC **State Indicator** IE \> \>     |
|                                                                      |
| \< **State of RRC procedure** : bit (4) \>                           |
|                                                                      |
| *\-- Ciphering related information*                                  |
|                                                                      |
| { 00 \< **GERAN A/Gb Security Info** : \< GERAN A/Gb Security Info   |
| IE \> \>                                                             |
|                                                                      |
| \| 01 \< **GERAN Iu Security Info** : \< GERAN Iu Security Info IE   |
| \> \>                                                                |
|                                                                      |
| \| 10 \< Extension : \< Extension IE \> \>                           |
|                                                                      |
| \| 11 \< Extension : \< Extension IE \> \>}                          |
|                                                                      |
| \< **G-RNTI** : \< G-RNTI IE \> \>\                                  |
| \< **START** : \< START IE \> \>\                                    |
| { 0 \| 1 \< **MS GERAN Iu mode Radio Access Capability** : \< **MS   |
| GERAN Iu mode Radio Access Capability** IE \> \> }                   |
|                                                                      |
| { 0 \| 1 \< **MS GERAN A/Gb mode Radio Access Capability** : \< **MS |
| GERAN A/Gb mode Radio Access Capability** IE \> \> }                 |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability** : \< **UE UTRAN     |
| Radio Access Capability** IE \> \> }                                 |
|                                                                      |
| { 0 \| 1 \< **UE UTRAN Radio Access Capability Extension** : \< **UE |
| UTRAN Radio Access Capability Extension** IE \>\> }                  |
|                                                                      |
| { 0 \| 1 \< **UE CDMA2000 Radio Access Capability** : \< UE CDMA2000 |
| **Radio Access Capability** IE \> \> }                               |
|                                                                      |
| \< **GRA Id** : \< GRA Id \> \>                                      |
|                                                                      |
| \< **CN Common GSM-MAP NAS System Info** : \< NAS System Information |
| GSM-MAP IE \> \>                                                     |
|                                                                      |
| \< **Length of CN Domain Related Information** : bit (2) \>          |
|                                                                      |
| { \< **CN Domain Identity :** \< CN Domain Identity IE \> \>         |
|                                                                      |
| \< **CN Domain Specific GSM-MAP NAS System Info** : \< NAS System    |
| Information GSM-MAP IE \> \>                                         |
|                                                                      |
| \< **CN Domain Specific DRX Cycle Length Coefficient** : \< CN       |
| Domain Specific DRX Cycle Length Coefficient IE \> \> }              |
|                                                                      |
| { 0 \| 1 \< **Signalling RB Information to Setup List :** bit (3) \> |
|                                                                      |
| \< **Signalling RB Information to Setup** : \< Signalling RB         |
| Information to Setup IE \> \> \*(1+val(Signalling RB Information to  |
| Setup List))                                                         |
|                                                                      |
| { 0 \| 1 \< **RAB Information for Setup List** : bit (4) \>          |
|                                                                      |
| \< **RAB Information for Setup** : \< RAB Information for Setup IE   |
| \> \> \*(1+val(RAB Information for Setup List)) }                    |
|                                                                      |
| { 0 \| 1 \< **RAB Information to Reconfigure List** : bit (4) \>     |
|                                                                      |
| \< **RAB Information to Reconfigure** : \< RAB Information to        |
| Reconfigure IE \> \>\*(1+val(RAB Information to Reconfigure List)) } |
|                                                                      |
| { 0 \| 1 \< **RB Information to Reconfigure List** : bit (5) \>      |
|                                                                      |
| \< **RB Information to Reconfigure** : \< RB Information to          |
| Reconfigure IE \> \> }\*(1+val(RB Information to Reconfigure List))  |
|                                                                      |
| { 0 \| 1 \< **Multirate configuration** : \< Multirate Configuration |
| IE \> \> }                                                           |
|                                                                      |
| { 0 \| 1 \< **TDMAFN** : \< bit(22) \> }                             |
|                                                                      |
| { 0 \| 1 \< **Failure Cause and Error Information** : \< Failure     |
| Cause and Error Information IE \> \> }                               |
|                                                                      |
| { null \| 0 bit\*\* = \< no string \>                                |
|                                                                      |
| \| 1\--*Release* 6 additions, non-critical extention                 |
|                                                                      |
| {                                                                    |
|                                                                      |
| { 0 \| 1 \< **UL TrCH Information Common For All Transport           |
| Channels** : \< UL TrCH Information Common For All Transport         |
| Channels IE\> \> }                                                   |
|                                                                      |
| { 0 \| 1 \< **Added or Reconfigured UL TrCH Information List** : bit |
| (3) \>                                                               |
|                                                                      |
| { \< **Added or Reconfigured UL TrCH Information** : \< Added or     |
| Reconfigured UL TrCH Information IE \> \> } }\*(1 + val( Added or    |
| Reconfigured UL TrCH information list ) )                            |
|                                                                      |
| { 0 \| 1 \< **DL TrCH Information Common For All Transport           |
| Channels** : \< DL TrCH Information Common For All Transport         |
| Channels IE\> \> }                                                   |
|                                                                      |
| { 0 \| 1 \< **Added or Reconfigured DL TrCH Information List** : bit |
| (3) \>                                                               |
|                                                                      |
| { \< **Added or Reconfigured DL TrCH Information** : \< Added or     |
| Reconfigured DL TrCH Information IE \> \> } }\*(1 + val( Added or    |
| Reconfigured DL TrCH information list ) )                            |
|                                                                      |
| } };                                                                 |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 11.1.5.2.2: SBSS RELOCATION INFO information element details

+-----------------------------------------------------------------+---+
| **RRC State Indicator**\                                        |   |
| This IE is defined in sub-clause 9.3.97.                        |   |
+-----------------------------------------------------------------+---+
| **State of RRC procedure (4 bit field)\                         |   |
| This IE describes the state of the RRC procedure started in the |   |
| source cell (i.e. RB reconfiguration) as follows:**             |   |
|                                                                 |   |
| bit                                                             |   |
|                                                                 |   |
| 4 3 2 1                                                         |   |
|                                                                 |   |
| 0 0 0 0 Await no RRC message                                    |   |
|                                                                 |   |
| 0 0 0 1 Complete                                                |   |
|                                                                 |   |
| 0 0 1 0 Await RB Setup Complete                                 |   |
|                                                                 |   |
| 0 0 1 1 Await RB Reconfiguration Complete                       |   |
|                                                                 |   |
| 0 1 0 0 Await RB Release Complete                               |   |
|                                                                 |   |
| 0 1 0 1 Send Cell Update Confirm                                |   |
|                                                                 |   |
| 0 1 1 0 Send URA Update Confirm                                 |   |
|                                                                 |   |
| All other values are reserved                                   |   |
+-----------------------------------------------------------------+---+
| **GERAN A/Gb Security Info\                                     |   |
| **This IE is defined in sub-clause 11.2.                        |   |
+-----------------------------------------------------------------+---+
| **GERAN Iu or UTRAN Security Info\                              |   |
| **This IE is defined in sub-clause 11.2.                        |   |
+-----------------------------------------------------------------+---+
| **MS GERAN Iu mode Radio Access Capability\                     |   |
| **This IE is defined in sub-clause 9.3.45.                      |   |
+-----------------------------------------------------------------+---+
| **MS GERAN A/Gb mode Radio Access Capability\                   |   |
| **This IE is defined in sub-clause 9.3.44.                      |   |
+-----------------------------------------------------------------+---+
| **UE UTRAN Radio Access Capability\                             |   |
| **This IE is defined in sub-clause 9.3.108.                     |   |
+-----------------------------------------------------------------+---+
| **UE UTRAN Radio Access Capability Extension\                   |   |
| **This IE is defined in sub-clause 9.3.109.                     |   |
+-----------------------------------------------------------------+---+
| **UE CDMA2000 Radio Access Capability**\                        |   |
| This IE is defined in sub-clause 9.3.110.                       |   |
+-----------------------------------------------------------------+---+
| **Ciphering status for each CN domain** (2 bit field)\          |   |
| This field is the binary representation of the number of CN     |   |
| domains. Range : 0 to maxCNdomains-1.                           |   |
+-----------------------------------------------------------------+---+
| **Ciphering Status** (1 bit field)\                             |   |
| This field indicates the status of ciphering for the CN domain\ |   |
| bit\                                                            |   |
| 1\                                                              |   |
| 1 Ciphering started\                                            |   |
| 0 Ciphering not started.                                        |   |
+-----------------------------------------------------------------+---+
| **START**\                                                      |   |
| This IE is defined in sub-clause 9.3.102.                       |   |
+-----------------------------------------------------------------+---+
| **TDMAFN** (22 bit field)\                                      |   |
| This field is the binary representation of the TDMA Frame       |   |
| Number. The description of the TDMA Frame Number is in          |   |
| 3GPP TS 45.002.                                                 |   |
+-----------------------------------------------------------------+---+
| **CN Domain Identity**\                                         |   |
| This IE is defined in sub-clause 9.3.15.                        |   |
+-----------------------------------------------------------------+---+
| **Calculation time for ciphering related information** (??? bit |   |
| field)\                                                         |   |
| This field contains the time when the ciphering information of  |   |
| the message were calculated, relative to the intended target    |   |
| cell of the target BSS                                          |   |
+-----------------------------------------------------------------+---+
| **G-RNTI IE\                                                    |   |
| **This IE is defined in sub-clause 9.3.32.                      |   |
+-----------------------------------------------------------------+---+
| **GRA Identity**\                                               |   |
| This IE indicates the GRA ID as defined in sub-clause 9.3.30.   |   |
+-----------------------------------------------------------------+---+
| **CN Common GSM-MAP NAS System Info**\                          |   |
| The *NAS System Information GSM-MAP* IE is defined in           |   |
| sub-clause 9.3.55.                                              |   |
+-----------------------------------------------------------------+---+
| **Length of CN Domain Related Information** (2 bit field)\      |   |
| This field is used to calculate the number of CN domains        |   |
| included in this IE. Range : 0 to MaxCNdomains-1.               |   |
+-----------------------------------------------------------------+---+
| **CN Domain Specific GSM-MAP NAS System Info**\                 |   |
| The *NAS System Information GSM-MAP* IE is defined in           |   |
| sub-clause 9.3.55.                                              |   |
+-----------------------------------------------------------------+---+
| **CN Domain Specific DRX Cycle Length Coefficient\              |   |
| **The ***CN Domain Specific DRX Cycle Length Coefficient*** IE  |   |
| is defined in sub-clause 9.3.16.                                |   |
+-----------------------------------------------------------------+---+
| **Signalling RB Information to Setup List** (3 bit field)\      |   |
| This field is the binary representation of the number of SRB to |   |
| setup. Range : 0 to maxSRBsetup-1.                              |   |
+-----------------------------------------------------------------+---+
| **Signalling RB Information to Setup**\                         |   |
| This IE is present for each SRB to establish. This IE is        |   |
| defined in sub-clause 9.3.101.                                  |   |
+-----------------------------------------------------------------+---+
| **RAB Information for Setup List** (4 bit field)\               |   |
| This field is the binary representation of the number of RAB to |   |
| setup. Range : 0 to maxRABsetup-1.                              |   |
+-----------------------------------------------------------------+---+
| **RAB Information for Setup**\                                  |   |
| This IE is present for each signalling RAB to establish. This   |   |
| IE is defined in sub-clause 9.3.75.                             |   |
+-----------------------------------------------------------------+---+
| **RAB Information to Reconfigure List** (4 bit field)\          |   |
| This field is the binary representation of the number of RAB to |   |
| reconfigure. Range : 0 to maxRABsetup-1.                        |   |
+-----------------------------------------------------------------+---+
| **RAB Information to Reconfigure**\                             |   |
| This IE is defined in sub-clause 9.3.76.                        |   |
+-----------------------------------------------------------------+---+
| **RB Information to Reconfigure List** (5 bit field)\           |   |
| This field is the binary representation of the number of RB to  |   |
| reconfigure. Range : 0 to maxRB-1.                              |   |
+-----------------------------------------------------------------+---+
| **RB Information to Reconfigure**\                              |   |
| This IE is defined in sub-clause 9.3.82.                        |   |
+-----------------------------------------------------------------+---+
| **MultiRate Configuration IE\                                   |   |
| **This IE is defined in sub-clause 9.3.52. If the present       |   |
| speech codec is a multi-rate speech codec, the old BSS may      |   |
| inform the new BSS of the current multi-rate codec              |   |
| configuration by including the MultiRate configuration          |   |
| information Field Element in the RRC INFORMATION TO TARGET      |   |
| GERAN IU MODE BSS message.                                      |   |
+-----------------------------------------------------------------+---+
| **Failure Cause and Error Information**\                        |   |
| The *Failure Cause and Error Information* IE is defined in      |   |
| sub-clause 9.3.25.                                              |   |
+-----------------------------------------------------------------+---+
| **UL TrCH Information Common For All Transport Channels\        |   |
| **The IE *UL TrCH Information Common For All Transport          |   |
| Channels* is defined in sub-clause 9.3.134.                     |   |
+-----------------------------------------------------------------+---+
| **Added or Reconfigured UL TrCH information List** (3 bit       |   |
| field)**\                                                       |   |
| **This field is used to repeat information on each TrCH to be   |   |
| added or reconfigured in UL. Range: 0 to maxTrCH-1, where 0     |   |
| enables one TrCH to be described.                               |   |
+-----------------------------------------------------------------+---+
| **Added or Reconfigured UL TrCH Information\                    |   |
| **The IE *Added or Reconfigured UL TrCH information* IE is      |   |
| defined in sub-clause 9.3.122.                                  |   |
+-----------------------------------------------------------------+---+
| **DL TrCH Information Common For All Transport Channels\        |   |
| **The IE *DL TrCH Information Common For All Transport          |   |
| Channels* is defined in sub-clause 9.3.125.                     |   |
+-----------------------------------------------------------------+---+
| **Added or Reconfigured DL TrCH information List** (3 bit       |   |
| field)**\                                                       |   |
| **This field is used to repeat information on each TrCH to be   |   |
| added or reconfigured in DL. Range: 0 to maxTrCH-1, where 0     |   |
| enables one TrCH to be described.                               |   |
+-----------------------------------------------------------------+---+
| **Added or Reconfigured DL TrCH Information\                    |   |
| **The IE *Added or Reconfigured DL TrCH information* is defined |   |
| in sub-clause 9.3.121.                                          |   |
+-----------------------------------------------------------------+---+

#### 11.1.5.3 RFC 3095 CONTEXT INFO

This RRC message is sent between network nodes in SBSS/SRNS or SBSS/SBSS
relocation. It is used to transfer the compressor and decompressor
context information of the RFC 3095 protocol.

Direction: source BSS →target BSS/RNC

Table 11.1.5.3.1: RFC 3095 CONTEXT INFO information elements

+-------------------------------------------------------+
| \< RFC 3095 Context Info IE \> ::=                    |
|                                                       |
| \< **RB with RFC 3095 Context List** : bit(5) \>      |
|                                                       |
| { \< **RB Identity** : \< RB Identity IE \> \>        |
|                                                       |
| \< **RFC 3095 Context List** : bit(14) \>             |
|                                                       |
| {                                                     |
|                                                       |
| { 0 \| 1 \-- Downlink RFC 3095 context                |
|                                                       |
| \< **Downlink RFC 3095 Context Identity**: bit(14) \> |
|                                                       |
| \< **DL\_MODE**: bit(2) \>                            |
|                                                       |
| \< **REF\_IR**: octet(3000) \>                        |
|                                                       |
| { 0 \| 1 \< **REF\_TIME**: bit(32) \> }               |
|                                                       |
| { 0 \| 1 \< **SYN\_OFFSET\_ID** : bit(16) \> }        |
|                                                       |
| { 0 \| 1 \< **SYN\_SLOPE\_TS** : bit(32) \> }         |
|                                                       |
| { \< **DYN\_CHANGED** **:** 0 \>                      |
|                                                       |
| \| \< **DYN\_CHANGED** **:** 1 \> }                   |
|                                                       |
| }                                                     |
|                                                       |
| { 0 \| 1 \-- Uplink RFC 3095 context                  |
|                                                       |
| \< **Uplink RFC 3095 Context Identity**: bit(14) \>   |
|                                                       |
| \< **UL\_MODE**: bit(2) \>                            |
|                                                       |
| \< **REF\_IR**: octet(3000) \>                        |
|                                                       |
| { 0 \| 1 \< **REF\_TIME**: bit(32) \> }               |
|                                                       |
| { 0 \| 1 \< **SYN\_OFFSET\_ID** : bit(16) \> }        |
|                                                       |
| { 0 \| 1 \< **SYN\_SLOPE\_TS** : bit(32) \> }         |
|                                                       |
| { 0 \| 1 \< **REF\_SN\_1** **:** bit(15) \> }         |
|                                                       |
| }                                                     |
|                                                       |
| }\*(1 + val(RFC 3095 Context List))                   |
|                                                       |
| }\*(1 + val(RB with RFC 3095 Context List));          |
+-------------------------------------------------------+

Table 11.1.5.3.2: RFC 3095 CONTEXT INFO information elements details

+----------------------------------------------------------------------+
| **RB with RFC 3095 Context List** (5 bit field)\                     |
| This field is the binary representation of the number of Radio       |
| Bearers with RFC 3095 context information.                           |
|                                                                      |
| Range: 0 to maxRBallRABs - 1.                                        |
+----------------------------------------------------------------------+
| **RB Identity**\                                                     |
| This IE is defined in sub-clause 9.3.80.                             |
+----------------------------------------------------------------------+
| **RFC 3095 Context List** (14 bit field)\                            |
| This field is the binary representation of the number of the RFC     |
| 3095 contexts for this Radio Bearer.                                 |
|                                                                      |
| Range: 0 to maxRFC3095-CID - 1.                                      |
+----------------------------------------------------------------------+
| **Downlink RFC 3095 Context Identity** (14 bit field)\               |
| **Uplink RFC 3095 Context Identity** (14 bit field)\                 |
| This field represents the identity of the RFC 3095 in respectively   |
| Downlink and Uplink.                                                 |
+----------------------------------------------------------------------+
| **REF\_IR (**3000 octet string field**)\                             |
| **This field corresponds to the RTP IR header (see sub-clause 5.7.7  |
| of RFC3095 for detailed format) corresponding to the oldest header   |
| in the compressor sliding window.                                    |
+----------------------------------------------------------------------+
| **RF\_TIME** (32 bit field)**\                                       |
| **This field corresponds to the arrival time (at the compressor) of  |
| REF\_IR in milliseconds. See sub-clauses 4.5.4 and 6.5.1 of IETF     |
| RFC3095.                                                             |
+----------------------------------------------------------------------+
| **SYN\_SLOPE\_TS** (32 bit field)**\                                 |
| **This field corresponds to the last synchronized slope of TS. See   |
| sub-clauses 5.5.1.2 and 5.7 of IETF RFC3095. In SO state, TS(n) =    |
| TS(m) + (n-m) \* SYN\_SLOPE\_TS, where n and m is the RTP SN of      |
| current packet and the reference packet. Note that the unit of       |
| SYN\_SLOPE\_TS depends on whether TS is scaled before compression or |
| not.                                                                 |
+----------------------------------------------------------------------+
| **DYN\_CHANGED** (1 bit field)\                                      |
| This field corresponds to the information whether dynamic fields     |
| other than RTP SN, RTP TS and IP-ID have changed in the headers that |
| are stored in the sliding window. Set to TRUE if changed and FALSE   |
| if not changed.                                                      |
|                                                                      |
| bit\                                                                 |
| 1\                                                                   |
| 0 DYN\_CHANGED not supported\                                        |
| 1 DYN\_CHANGED supported                                             |
+----------------------------------------------------------------------+
| **SYN\_OFFSET\_ID** (16 bit field)**\                                |
| **This field corresponds to the corresponds to the RTP Sequence      |
| Number of the predecessor of the latest RTP packet. This could be    |
| used to perform local repair of context by decompressor in U or O    |
| mode (see \"ref - 1\" in sub-clause 5.3.2.2.5 in IETF RFC3095 for    |
| further explanation).                                                |
+----------------------------------------------------------------------+
| **DL\_MODE** (2 bit field)**\                                        |
| UL\_MODE** (2 bit field)**\                                          |
| **This field represents the RFC 3095 mode in respectively Downlink   |
| and Uplink before the SBSS relocation. The optimal mode to operate   |
| in depends on the characteristics of the environment of the          |
| compression protocol, such as feedback abilities, error              |
| probabilities and distributions, effects of header size variation,   |
| etc.                                                                 |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 1 0                                                                  |
|                                                                      |
| 0 0 U-mode \-- Unidirectional mode                                   |
|                                                                      |
| 0 1 O-mode \-- Bidirectional Optimistic mode                         |
|                                                                      |
| 1 0 R-mode \-- Bidirectional Reliable mode                           |
|                                                                      |
| 1 1 reserved                                                         |
+----------------------------------------------------------------------+

11.2 Provision and reception of RRC security information between network nodes
------------------------------------------------------------------------------

### 11.2.1 General

In certain cases, e.g., when performing handover or when performing SBSS
relocation, RRC security related information shall be transferred
between other RATs and GERAN or between GERAN nodes within GERAN.

The lengths of the RLC counters of non-transparent radio bearers are
different between GPRS (24bits) and EGPRS (20bits). The BSC shall set
the HFN values according the source cell (GPRS or EGPRS) and independent
from the target cell (UTRAN, GPRS or EGPRS).

In the following, the RRC security information to be transferred is
separeted into the three scenarious:

\- GERAN *A/Gb mode* to GERAN *Iu mode*.

\- GERAN *Iu mode* to GERAN *Iu mode* or UTRAN to GERAN *Iu mode*.

### 11.2.2 RRC Security Information, from GERAN-A/Gb to GERAN-Iu

The START value is used to initialise the most significant bits of all
the HFN counters (MAC HFN, RLC AM HFN, RLC UM HFN, RRC HFN).

Direction: source: GERAN *A/Gb mode* BSC →target GERAN *Iu mode* BSC

Table 11.2.2.1: *GERAN A/Gb Security* *Info* information elements

+-------------------------------------------------------------+
| \< GERAN A/Gb Security Info IE \>::=                        |
|                                                             |
| {                                                           |
|                                                             |
| \< **Start-CS** : \< START IE \> \>                         |
|                                                             |
| \< **Start-PS** : \< START IE \> \>                         |
|                                                             |
| ! \< Content part error : bit (\*) = \< no string \> \> } ; |
+-------------------------------------------------------------+

Table 11.2.2.2: *GERAN A/Gb Security* *Info* information element details

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **Start-CS**\
  The *START* IE is used to intialise the most significant bits of all the HFN counters (MAC HFN, RLC AM HFN, RLC UM HFN, RRC HFN) for the CS domain. The *START* IE is defined in sub-clause 9.3.102.

  **Start-PS**\
  The *START* IE is used to intialise the most significant bits of all the HFN counters (MAC HFN, RLC AM HFN, RLC UM HFN, RRC HFN) for the PS domain. The *START* IE is defined in sub-clause 9.3.102.
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 11.2.3 RRC Security Information, from GERAN Iu mode/UTRAN to GERAN Iu mode

This IE contains security information required for continued
communication between the MS and GERAN after a handover or SRNS/SBSS
relocation

Direction: source: BSC/RNC →target BSC

Table 11.2.3.1: *GERAN Iu or UTRAN Security Info* information elements

+----------------------------------------------------------------------+
| \< GERAN Iu or UTRAN Security Info IE \>::=                          |
|                                                                      |
| {                                                                    |
|                                                                      |
| \< **Ciphering status for each CN domain** : bit (2) \>              |
|                                                                      |
| { \< **CN domain identity** : \< CN domain identity \> \>            |
|                                                                      |
| \< **Ciphering Status** : bit (1) \> }\*(1+val(Ciphering status for  |
| each CN domain))                                                     |
|                                                                      |
| \< **Latest configured CN Domain** : bit (2) \>                      |
|                                                                      |
| \< **Ciphering info for transparent RB** : bit (2) \>                |
|                                                                      |
| { \< **CN domain identity** : \< CN domain identity \> \>            |
|                                                                      |
| \< **MAC-HFN** : bit (11) \> } \*(1+val(Ciphering info for           |
| transparent RB))                                                     |
|                                                                      |
| \< **Ciphering info for non-transparent RB** : bit (5) \>            |
|                                                                      |
| { \< **RB Id** : \< RB Identity IE \> \>                             |
|                                                                      |
| \< **DL HFN** : \< RLC HFN IE \> \>                                  |
|                                                                      |
| \< **UL HFN** : \< RLC HFN IE \> \> }\*(1+val(Ciphering info for     |
| non-transparent RB))                                                 |
|                                                                      |
| { \< **Integrity Protection status** : 1 \>                          |
|                                                                      |
| { \< **SRB-Id** : bit (2) \>                                         |
|                                                                      |
| \< **UL RRC HFN** : bit (28) \>                                      |
|                                                                      |
| \< **DL RRC HFN** : bit (28) \>                                      |
|                                                                      |
| \< **Uplink RRC Message Sequence number** : bit (4) \> }\*4          |
|                                                                      |
| \< **Downlink RRC Message Sequence number** : bit (4) \> }\*4        |
|                                                                      |
| \| \< **Integrity Protection status** : 0 \> }                       |
|                                                                      |
| ! \< Content part error : bit (\*) = \< no string \> \> } ;          |
+----------------------------------------------------------------------+

Table 11.2.3.2: *GERAN Iu or UTRAN Security Info* information element
details

+----------------------------------------------------------------------+
| **Ciphering status for each CN domain** (2 bit field)**\             |
| **This field is the binary representation of the number of repeated  |
| groups of fields and IEs. Range : 0 to maxCNdomains-1.               |
+----------------------------------------------------------------------+
| **CN Domain Identity**\                                              |
| **This IE is defined in sub-clause 9.3**.115.                        |
+----------------------------------------------------------------------+
| **Ciphering status** (1 bit field)\                                  |
| This field indicates the ciphering status of the indicated CN        |
| Domain.\                                                             |
| Bit\                                                                 |
| 1\                                                                   |
| 0 Ciphering not started\                                             |
| 1 Ciphering started                                                  |
+----------------------------------------------------------------------+
| **Last Configuered CN Domain** (2 bit field)\                        |
| This field indicates the last configured CN Domain. This field is    |
| encoded as the CN Domain Identity in sub-clause 9.3.15               |
+----------------------------------------------------------------------+
| **Ciphering info for transparent RB** (2 bit field)**\               |
| **This field is the binary representation of the number of instances |
| of ciphering info which is provided for transparent mode RLC RBs.    |
| Range : 0 to maxCNDomains-1.                                         |
+----------------------------------------------------------------------+
| **MAC-HFN** (11 bit field)\                                          |
| This field contains the MAC-HFN. The MAC-HFN is defined as the 11    |
| MSB of the COUNT-C value.                                            |
+----------------------------------------------------------------------+
| **Ciphering info for non-transparent RB** (5 bit field)\             |
| This field is the binary representation of the number of             |
| non-transparent mode RLC RBs for which ciphering info is provided.   |
| Range : 0 to maxRB-1.                                                |
+----------------------------------------------------------------------+
| **DL HFN / UL HFN\                                                   |
| **The *RLC HFN* IE is defined in 9.3.92.                             |
+----------------------------------------------------------------------+
| **Integrity Protection status** (1 bit field)**\                     |
| **This field indicates the status of integrity protection in the     |
| current cell. The field is encoded:\                                 |
| Bit\                                                                 |
| 1\                                                                   |
| 0 Integrity Protection not started\                                  |
| 1 Integrity Protection started.                                      |
+----------------------------------------------------------------------+
| **SRB-Id** (2 bit field)\                                            |
| This field defines the SRB Id for which the following integrity      |
| protection information applies:                                      |
|                                                                      |
| bit                                                                  |
|                                                                      |
| 2 1                                                                  |
|                                                                      |
| 0 0 SRB1                                                             |
|                                                                      |
| 0 1 SRB2                                                             |
|                                                                      |
| 1 0 SRB3                                                             |
|                                                                      |
| 1 1 SRB4.                                                            |
+----------------------------------------------------------------------+
| **UL / DL RRC HFN** (28 bit field)\                                  |
| This field contains the RRC HFN in the indicated direction. For each |
| SRB, in case the activation times for the next Integrity Protection  |
| configuration to be applied on this SRB have already been reached,   |
| this IE corresponds to the last value used. Else this value          |
| corresponds to the value the source would have initalized the HFN to |
| at the activation time. Increment of HFN due to RRC SN roll over is  |
| taken care of by target based on the value sent by the source        |
+----------------------------------------------------------------------+
| **Uplink RRC Message Sequence Number** (4 bit field)\                |
| This field is the binary representation of the RRC Sequence number   |
| for the indicated SRB. For each SRB, this IE corresponds to the last |
| value received or in case the activation time was not reached for a  |
| configuration the value equals (activation time -1). Range 0-15.     |
+----------------------------------------------------------------------+
| **Downlink RRC Message Sequence Number** (4 bit field)\              |
| This field is the binary representation of the RRC Sequence number   |
| for the indicated SRB. For each SRB, this IE corresponds to the last |
| value used or in case the activation time was not reached for a      |
| configuration, to the value (activation time -1). In particular, for |
| SRB2, this IE should not take into account the RRC message that will |
| trigger the relocation Range 0-15.                                   |
+----------------------------------------------------------------------+

### 11.2.4 RRC Security Information, from GERAN Iu to UTRAN

NOTE: This information should be specified in 25.331 since UTRAN is the
target RAT.

11.3 HFN mapping rules for radio bearer using non-transparent mode RLC
----------------------------------------------------------------------

The length of RLC counters in UTRAN (RLC-AM 20bits, RLC-UM 25bits) and
GERAN-Iu are different. In GERAN-Iu there are additional differences
between GPRS (RLC-AM and RLC-UM 24bits) and EGPRS (RLC-AM and RLC-UM
20bits).

The network nodes shall use the following HFN mapping rules when sending
or receiving HFN values within the RRC information containers:

1\> the source network node shall set the HFN value as used in the
source cell,

1\> if the target network node receives an HFN value with the same
length as used in the target cell;

2\> increment this HFN by 1; and

2\> use this value as HFN in the target cell;

1\> if the target network node receives an HFN which is longer than the
one used in the target cell;

2\> take the MSBs as needed for the target cell;

2\> increment this value by 1; and

2\> use this value as HFN in the target cell;

1\> if the target network node receives an HFN which is shorter than the
one used in the target cell;

2\> increment this HFN by 1;

2\> add a number of least significant zero bits as needed; and

2\> use this value as HFN in the target cell.

11.4 Calculated Transport Format Combination
--------------------------------------------

The CTFCs are used to signal the transport format combination set. Every
possible transport format combination shall uniquely be identified by
one CTFC, including transport format combinations, which are not members
of the transport format combination set.

Two formulas shall be used to define the CTFC. Let *I* be the number of
transport channels that shall be included in the transport format
combination. Each transport channel TrCH*~i~*, *i* = 1, 2,..., *I*,
shall have *L~i~* transport formats, i.e. the transport format indicator
*TFIN~i~* can take *L~i~* values,
$\text{TFIN}_{i} \in \left\{ 0,1,2,\text{.}\text{.}\text{.},L_{i} - 1 \right\}$.
For each transport channel, the transport format such that *TFIN~i~* = 0
is the empty transport format.

*Define* $P_{i} = \prod_{j = 0}^{i - 1}L_{j}$*, where i = 1, 2, ..., I,
and L~0~ = 1*

Let *TFC*(*TFIN~1~*, *TFIN~2~*, ..., *TFIN~I~)* be the transport format
combination for which TrCH*~1~* shall transport format *TFIN~1~*,
TrCH~2~ shall transport format *TFIN~2~*, etc. The corresponding
*CTFC*(*TFIN~1~*, *TFIN~2~*, ..., *TFIN~I~*) is then computed as:

$\text{CTFC}(\text{TFIN}_{1},\text{TFIN}_{2},\ldots,\text{TFIN}_{I}) = \sum_{i = 1}^{I}\text{TFIN}_{i} \cdot P_{i}$

The transport format combination such that CTFC = 0 is the empty
transport format combination.

After computing the CTFC value for all allowed transport format
combinations (a CTFC is defined for all transport format combinations,
but it is only necessary to compute the CTFC for the allowed transport
format combinations), the CTFCs are signalled in order. The TFCIs are
then assigned in the same order, i.e. the first TFC signalled by its
CTFC will correspond to TFCI = 0, the next corresponds to TFCI = 1, etc.

In a Layer 3 signalling message, the CTFC values shall be encoded using
a variable size field, the size of which is the same for all values and
depends on the highest value to be signalled. The possible sizes are: 2
bits, 4 bits, 6 bits, 8 bits, 12 bits and 16 bits. The size of the
fields is signalled in the Layer 3 message.

11.5 Signalling TFC
-------------------

One TFC shall be defined that shall be used for SRB data transfer and
layer 2 signalling (see 3GPP TS 44.160). That TFC shall be the first one
in the TFCS, for which the TFCI equals 0. In that TFC, only one TrCH
shall be active and shall have the following transport format:

\- 184 bits transport blocks;

\- 18 bits CRC;

\- 256 for the RMA.

NOTE: The value of the RMA does not matter since there is only one
active TrCH.

######## Annex A (informative): Change History

  -------------------- ------------- ---------- -------- --------- --------- ----------------------------------------------------- -----------------
  **Change history**                                                                                                               
  **Date**             **Meeting**   **TDoc**   **CR**   **Rev**   **Cat**   **Subject/Comment**                                   **New version**
  2016-01                            \-         \-       \-        \-        Release 13 version created based on version 12.0.0    13.0.0
  2017-03              RP-75         \-         \-       \-        \-        Release 14 version created based on version 13.0.0    14.0.0
  2018-06              RP-80         \-         \-       \-        \-        Release 15 version created based on version 14.0.0    15.0.0
  2020-07              RP-88e        \-         \-       \-        \-        Upgrade to Rel-16 version without technical change)   **16.0.0**
  -------------------- ------------- ---------- -------- --------- --------- ----------------------------------------------------- -----------------
