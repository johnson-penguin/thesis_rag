![](media/image1.jpeg){width="7.086111111111111in"
height="1.136111111111111in"}

Contents {#contents .TT}
========

[4](#foreword)

[5](#scope)

[5](#references)

[5](#definitions-and-abbreviations)

[5](#definitions)

[5](#abbreviations)

[6](#c-code-structure)

[6](#contents-of-the-c-source-code)

[6](#program-execution)

[7](#coding-style)

[7](#code-hierarchy)

[11](#variables-constants-and-tables)

[11](#description-of-constants-used-in-the-c-code)

[11](#description-of-fixed-tables-used-in-the-c-code)

[13](#static-variables-used-in-the-c-code)

[17](#homing-procedure)

[23](#file-formats)

[23](#speech-file-encoder-input-decoder-output)

[23](#mode-control-file-encoder-input)

[23](#parameter-bitstream-file-encoder-output-decoder-input)

[25](#annex-a-informative-change-history)Foreword 1 Scope 2 References 3
Definitions and abbreviations 3.1 Definitions 3.2 Abbreviations 4 C code
structure 4.1 Contents of the C source code 4.2 Program execution 4.3
Coding style 4.4 Code hierarchy 4.5 Variables, constants and tables
4.5.1 Description of constants used in the C-code 4.5.2 Description of
fixed tables used in the C-code 4.5.3 Static variables used in the
C-code 5 Homing procedure 6 File formats 6.1 Speech file (encoder input
/ decoder output) 6.2 Mode control file (encoder input) 6.3 Parameter
bitstream file (encoder output / decoder input) Annex A (informative):
Change History

Foreword
========

This Technical Specification (TS) has been produced by the 3^rd^
Generation Partnership Project (3GPP).

The contents of the present document are subject to continuing work
within the TSG and may change following formal TSG approval. Should the
TSG modify the contents of the present document, it will be re-released
by the TSG with an identifying change of release date and an increase in
version number as follows:

Version x.y.z

where:

x the first digit:

1 presented to TSG for information;

2 presented to TSG for approval;

3 or greater indicates TSG approved document under change control.

y the second digit is incremented for all changes of substance, i.e.
technical enhancements, corrections, updates, etc.

z the third digit is incremented when editorial only changes have been
incorporated in the document.

1 Scope
=======

The present document contains an electronic copy of the ANSI‑C code for
the Adaptive Multi-Rate codec. The ANSI‑C code is necessary for a bit
exact implementation of the Adaptive Multi Rate speech transcoder
(TS 26.090 \[2\]), Voice Activity Detection (TS 26.094 \[6\]), comfort
noise (TS 26.092 \[4\]), source controlled rate operation (TS
26.093 \[5\]) and example solutions for substituting and muting of lost
frames (TS 26.091 \[3\]).

2 References
============

The following documents contain provisions which, through reference in
this text, constitute provisions of the present document.

\- References are either specific (identified by date of publication,
edition number, version number, etc.) or non‑specific.

\- For a specific reference, subsequent revisions do not apply.

\- For a non-specific reference, the latest version applies.

\[1\] 3GPP TS 26.074: \"AMR Speech Codec; Test sequences\".

\[2\] 3GPP TS 26.090: \"AMR Speech Codec; Speech transcoding\".

\[3\] 3GPP TS 26.091: \"AMR Speech Codec; Substitution and muting of
lost frames\".

\[4\] 3GPP TS 26.092: \"AMR Speech Codec; Comfort noise aspects\".

\[5\] 3GPP TS 26.093: \"AMR Speech Codec; Source controlled rate
operation\".

\[6\] 3GPP TS 26.094: \"AMR Speech Codec; Voice Activity Detection\".

\[7\] RFC 3267: \"A Real-Time Transport Protocol (RTP) Payload Format
and File Storage Format for Adaptive Multi-Rate (AMR) and Adaptive
Multi-Rate Wideband (AMR-WB) Audio Codecs\", June 2002.

3 Definitions and abbreviations
===============================

3.1 Definitions
---------------

Definition of terms used in the present document, can be found in
TS 06.090  \[2\], TS 06.091  \[3\], TS 06.092  \[4\], TS 06.093  \[5\]
and TS 06.094  \[6\].

3.2 Abbreviations
-----------------

For the purpose of the present document, the following abbreviations
apply:

ANSI American National Standards Institute

ETS European Telecommunication Standard

GSM Global System for Mobile communications

I/O Input/Output

RAM Random Access Memory

ROM Read Only Memory

4 C code structure
==================

This clause gives an overview of the structure of the bit‑exact C code
and provides an overview of the contents and organization of the C code
attached to this document.

The C code has been verified on the following systems:

\- Sun Microsystems workstations and GNU gcc compiler;

\- DEC Alpha workstations and GNU gcc compiler;

\- IBM PC/AT compatible computers with Linux operating system and GNU
gcc compiler.

ANSI‑C 9899 was selected as the programming language because portability
was desirable.

4.1 Contents of the C source code
---------------------------------

The C code distribution has all files in the root level.

The distributed files with suffix \"c\" contain the source code and the
files with suffix \"h\" are the header files. The ROM data is contained
mostly in files with suffix \"tab\".

The C code distribution also contains one speech coder installation
verification data file, \"spch\_dos.inp\". The reference encoder output
file is named \"spch\_dos.cod\", the reference decoder input file is
named \"spch\_dos.dec\" and the reference decoder output file is named
\"spch\_dos.out\". These four files are formatted such that they are
correct for an IBM PC/AT compatible computer. The same files with
reversed byte order of the 16 bit words are named \"spch\_unx.inp\",
\"spch\_unx.cod\", \"spch\_unx.dec\" and \"spch\_unx.out\",
respectively.

Final verification is to be performed using the GSM Adaptive Multi-Rate
test sequences described in GSM 06.74  \[2\].

Makefiles are provided for the platforms in which the C code has been
verified (listed above). Once the software is installed, this directory
will have a compiled version of *encoder* and *decoder* (the bit-exact C
executables of the speech codec) and all the object files.

4.2 Program execution
---------------------

The GSM Adaptive Multi-Rate codec is implemented in two programs:

*-* (*encoder*) speech encoder;

*-* (*decoder*) speech decoder.

The programs should be called like:

\- encoder \[encoder options\] \<speech input file\> \<parameter file\>;

\- decoder \[decoder options\] \<parameter file\> \<speech output
file\>.

The speech files contain 16-bit linear encoded PCM speech samples and
the parameter files contain encoded speech data and some additional
flags.

The encoder and decoder options will be explained by running the
applications with option --h. See the file readme.txt for more
information on how to run the *encoder* and *decoder* programs.

4.3 Coding style
----------------

The C code is written according to the following structuring
conventions. Each function func() that needs static variables is
considered a module. A module consists of:

\- a \'state structure\' (struct) combining the static variables of the
module;

\- three auxiliary functions func\_init(), func\_reset(), and
func\_exit();

\- the processing function func() itself.

The initialization function func\_init() allocates (from the heap) a new
state structure, calls the func\_reset() function, stores the pointer to
the newly allocated structure in its first function parameter, and
returns with a value of 0 if completed successful or a value of 1
otherwise.

The reset function func\_reset() takes a pointer to the state structure
and resets all members of the structure to a predefined value
(\'homing\').

The exit function func\_exit() performs any necessary cleanup and frees
the state structure memory.

The processing function func() also takes a pointer to the state
structure as well as all other necessary parameters and performs its
task using (and possibly modifying) the values in the state structure.

If a module calls other modules, the higher level state structure
contains a pointer to the lower level state structures, and the init,
reset, and exit functions recursively call the corresponding lower level
functions.

By this convention, the code becomes \"instantiable\" (more than one
copy of a module can be used in the same program) and the static data
hierarchy is clearly visible in the code.

4.4 Code hierarchy
------------------

Figures 1 to 4 are call graphs that show the functions used in the
speech codec, including the functions of VAD, DTX, and comfort noise
generation.

Each column represents a call level and each cell a function. The
functions contain calls to the functions in rightwards neighbouring
cells. The time order in the call graphs is from the top downwards as
the processing of a frame advances. All standard C functions: printf(),
fwrite(), etc. have been omitted. Also, no basic operations (add(),
L\_add(), mac(), etc.) or double precision extended operations (e.g.
L\_Extract()) appear in the graphs. The initialization of the static RAM
(i.e. calling the \_init functions) is also omitted.

The basic operations are not counted as extending the depth, therefore
the deepest level in this software is level 7.

The encoder call graph is broken down into three separate call graphs,
Table 1 to 3.

Table 1: Speech encoder call structure

  ----------------------- -------------- ----------------------- ----------------------- -------------------------------------- -----------------------------------
  Speech\_Encode\_Frame   Pre\_Process                                                                                          
                          cod\_amr       Copy                                                                                   
                                         Vad1[^1]                filter\_bank            first\_filter\_stage                   
                                                                                         filter5                                
                                                                                         filter3                                
                                                                                         level\_calculation                     
                                                                 vad\_decision           complex\_estimate\_adapt               
                                                                                         complex\_vad                           
                                                                                         noise\_estimate\_update                update\_cntrl
                                                                                         hangover\_addition                     
                                         Vad2**1**               block\_norm                                                    
                                                                 r\_fft                  c\_fft                                 
                                                                 fn10Log10               Log2                                   Log2\_norm
                                                                 Pow2                                                           
                                         tx\_dtx\_handler                                                                       
                                         lpc                     Autocorr                                                       
                                                                 Lag\_window                                                    
                                                                 Levinson                                                       
                                         lsp                     Az\_lsp                 Chebps                                 
                                                                 Q\_plsf\_5              Lsp\_lsf                               
                                                                                         Lsf\_wt                                
                                                                                         Vq\_subvec                             
                                                                                         Vq\_subvec\_s                          
                                                                                         Reorder\_lsf                           
                                                                                         Lsf\_lsp                               
                                                                 Int\_lpc\_1and3\_2      Lsp\_az                                Get\_lsp\_pol
                                                                 Int\_lpc\_1and3         Lsp\_az                                Get\_lsp\_pol
                                                                 Q\_plsf\_3              Lsp\_lsf                               
                                                                                         Lsf\_wt                                
                                                                                         Copy                                   
                                                                                         Vq\_subvec3                            
                                                                                         Vq\_subvec4                            
                                                                                         Reorder\_lsf                           
                                                                                         Lsf\_lsp                               
                                                                 Int\_lpc\_1to3\_2       Lsp\_az                                Get\_lsp\_pol
                                                                 Int\_lpc\_1to3          Lsp\_az                                Get\_lsp\_pol
                                                                 Copy                                                           
                                         dtx\_buffer             Copy                                                           
                                                                 Log2                    Log2\_norm                             
                                         dtx\_enc                Lsp\_lsf                                                       
                                                                 Reorder\_lsf                                                   
                                                                 Lsf\_lsp                                                       
                                         Set\_zero                                                                              
                                         lsp\_reset              Copy                                                           
                                                                 Q\_plsf\_reset                                                 
                                         cl\_ltp\_reset          Pitch\_fr\_reset                                               
                                         check\_lsp                                                                             
                                         pre\_big                Weight\_Ai                                                     
                                                                 Residu                                                         
                                                                 Syn\_filt                                                      
                                         ol\_ltp                 Pitch\_ol               vad\_tone\_detection\_update[^2]       
                                                                                         Lag\_max                               vad\_tone\_detection**2**
                                                                                                                                Inv\_sqrt
                                                                                         comp\_corr**2**                        
                                                                                         hp\_max**2**                           
                                                                                         vad\_complex\_detection\_update**2**   
                                                                 Pitch\_ol\_wgh          comp\_corr**2**                        
                                                                                         Lag\_max**2**                          vad\_tone\_detection\_update**2**
                                                                                                                                vad\_tone\_detection**2**
                                                                                         gmed\_n                                
                                                                                         hp\_max**2**                           
                                                                                         vad\_complex\_detection\_update**2**   
                                         vad\_pitch\_detection   LTP\_flag\_update[^3]                                          
                                         subframePreProc         Weight\_Ai                                                     
                                                                 Syn\_filt                                                      
                                                                 Residu                                                         
                                                                 Copy                                                           
                                         cl\_ltp                 Pitch\_fr               getRange                               
                                                                                         Norm\_Corr                             Convolve
                                                                                                                                Inv\_sqrt
                                                                                         searchFrac                             Interpol\_3or6
                                                                                         Enc\_lag3                              
                                                                                         Enc\_lag6                              
                                                                                                                                
  (continued)                                                                                                                   
  ----------------------- -------------- ----------------------- ----------------------- -------------------------------------- -----------------------------------

Table 1 (concluded): Speech encoder call structure

  -- ---------- ---------------------- --------------------- -- --
                                       Pred\_lt\_3or6           
                                       Convolve                 
                                       G\_pitch                 
                                       check\_gp\_clipping      
                                       q\_gain\_pitch           
                cbsearch               see Table 2              
                gainQuant              see Table 3              
                update\_gp\_clipping   Copy                     
                subframePostProc       Syn\_filt                
                Pred\_lt\_3or6                                  
                Convolve                                        
     Prm2bits   Int2bin                                         
  -- ---------- ---------------------- --------------------- -- --

Table 2: cbsearch call structure

  ---------- --------------------- ------------------- ------------ -- --
  cbsearch   code\_2i40\_9bits     cor\_h\_x                           
                                   set\_sign                           
                                   cor\_h              Inv\_sqrt       
                                   search\_2i40                        
                                   build\_code                         
             code\_2i40\_11bits    cor\_h\_x                           
                                   set\_sign                           
                                   cor\_h              Inv\_sqrt       
                                   search\_2i40                        
                                   build\_code                         
             code\_3i40\_14bits    cor\_h\_x                           
                                   set\_sign                           
                                   cor\_h              Inv\_sqrt       
                                   search\_3i40                        
                                   build\_code                         
             code\_4i40\_17bits    cor\_h\_x                           
                                   set\_sign                           
                                   cor\_h              Inv\_sqrt       
                                   search\_4i40                        
                                   build\_code                         
             code\_8i40\_31bits    cor\_h\_x                           
                                   set\_sign12k2       Inv\_sqrt       
                                   cor\_h              Inv\_sqrt       
                                   search\_10and8i40                   
                                   build\_code                         
                                   compress\_code      compress10      
             code\_10i40\_35bits   cor\_h\_x                           
                                   set\_sign12k2       Inv\_sqrt       
                                   cor\_h              Inv\_sqrt       
                                   search\_10and8i40                   
                                   build\_code                         
                                   q\_p                                
  ---------- --------------------- ------------------- ------------ -- --

Table 3: gainQuant call structure

  ----------- -------------------------- ------------------------------- ------------------ ------------
  gainQuant   gc\_pred\_copy             Copy                                               
              gc\_pred                   Log2                            Log2\_norm         
                                         Log2\_norm                                         
              calc\_filt\_energies                                                          
              calc\_target\_energy                                                          
              MR475\_update\_unq\_pred   gc\_pred\_update                                   
              MR475\_gain\_quant         MR475\_quant\_store\_results    Log2               Log2\_norm
                                                                         gc\_pred\_update   
                                         gc\_pred                        Log2               Log2\_norm
                                                                         Log2\_norm         
              G\_code                                                                       
              q\_gain\_code              Pow2                                               
              MR795\_gain\_quant         q\_gain\_pitch                                     
                                         MR795\_gain\_code\_quant3                          
                                         calc\_unfilt\_energies          Log2               Log2\_norm
                                         gain\_adapt                     gmed\_n            
                                         MR795\_gain\_code\_quant\_mod   sqrt\_l\_exp       
              Qua\_gain                  Pow2                                               
              gc\_pred\_update                                                              
  ----------- -------------------------- ------------------------------- ------------------ ------------

Table 4: Speech decoder call structure

  ----------------------- --------------- ---------------------------- ---------------------------- --------------- ------------
  Speech\_Decode\_Frame   Bits2prm        Bin2int                                                                   
                          Decoder\_amr    rx\_dtx\_handler                                                          
                                          Decoder\_amr\_reset          lsp\_avg\_reset                              
                                                                       D\_plsf\_reset                               
                                                                       ec\_gain\_pitch\_reset                       
                                                                       ec\_gain\_code\_reset                        
                                                                       gc\_pred\_reset                              
                                                                       Bgn\_scd\_reset              Set\_zero       
                                                                       ph\_disp\_reset                              
                                                                       dtx\_dec\_reset              Copy            
                                                                                                    Set\_zero       
                                          dtx\_dec                     Copy                                         
                                                                       Lsf\_lsp                                     
                                                                       Init\_D\_plsf\_3             Copy            
                                                                       D\_plsf\_3                   Reorder\_lsf    
                                                                                                    Copy            
                                                                                                    Lsf\_lsp        
                                                                       pseudonoise                                  
                                                                       Lsp\_lsf                                     
                                                                       Reorder\_lsf                                 
                                                                       Lsp\_Az                      Get\_lsp\_pol   
                                                                       A\_Refl                                      
                                                                       Log2                         Log2\_norm      
                                                                       Build\_CN\_code              pseudonoise     
                                                                       Syn\_filt                                    
                                          Lsf\_lsp                                                                  
                                          lsp\_avg                                                                  
                                          Copy                                                                      
                                          D\_plsf\_3                   Reorder\_lsf                                 
                                                                       Copy                                         
                                                                       Lsf\_lsp                                     
                                          Int\_lpc\_1to3               Lsp\_Az                      Get\_lsp\_pol   
                                          D\_plsf\_5                   Reorder\_lsf                                 
                                                                       Copy                                         
                                                                       Lsf\_lsp                                     
                                          Int\_lpc\_1and3              Lsp\_Az                      Get\_lsp\_pol   
                                          Dec\_lag3                                                                 
                                          Pred\_lt\_3or6                                                            
                                          Dec\_lag6                                                                 
                                          decode\_2i40\_9bits                                                       
                                          decode\_2i40\_11bits                                                      
                                          decode\_3i40\_14bits                                                      
                                          decode\_4i40\_17bits                                                      
                                          decode\_8i40\_31bits         decompress\_code             decompress10    
                                          ec\_gain\_pitch              gmed\_n                                      
                                          d\_gain\_pitch                                                            
                                          ec\_gain\_pitch\_update                                                   
                                          decode\_10i40\_35bits                                                     
                                          Dec\_gain                    Log2                         Log2\_norm      
                                                                       gc\_pred                     Log2            Log2\_norm
                                                                                                    Log2\_norm      
                                                                       Pow2                                         
                                                                       gc\_pred\_update                             
                                          ec\_gain\_code               gmed\_n                                      
                                                                       gc\_pred\_average\_limeted                   
                                                                       gc\_pred\_update                             
                                          ec\_gain\_code\_update                                                    
                                          d\_gain\_code                gc\_pred                     Log2            Log2\_norm
                                                                                                    Log2\_norm      
                                                                       Pow2                                         
                                                                       gc\_pred\_update                             
                                          Int\_lsf                                                                  
                                          Cb\_gain\_average                                                         
                                          ph\_disp\_release                                                         
                                          ph\_disp\_lock                                                            
                                          ph\_disp                                                                  
                                          sqrt\_l\_exp                                                              
                                          Ex\_ctrl                     gmed\_n                                      
                                          agc2                         Inv\_sqrt                                    
                                          Syn\_filt                                                                 
                                          Bgn\_scd                     gmed\_n                                      
                                          dtx\_dec\_activity\_update   Copy                                         
                                                                       Log2                         Log2\_norm      
                                          lsp\_avg                                                                  
                          Post\_Filter    Copy                                                                      
                                          Weight\_Ai                                                                
                                          Residu                                                                    
                                          Set\_zero                                                                 
                                          Syn\_filt                                                                 
                                          Preemphasis                                                               
                                          agc                          energy\_old                                  
                                                                       energy\_new                  energy\_old     
                                                                       Inv\_sqrt                                    
                          Post\_Process                                                                             
  ----------------------- --------------- ---------------------------- ---------------------------- --------------- ------------

4.5 Variables, constants and tables
-----------------------------------

The data types of variables and tables used in the fixed point
implementation are signed integers in 2\'s complement representation,
defined by:

**- Word16** 16 bit variable;

**- Word32** 32 bit variable.

Furthermore some **enum** types are used, all possible to represent with
one byte, and a Boolean **Flag**.

### 4.5.1 Description of constants used in the C-code

This subclause contains a listing of all global constants defined in
cnst.h.

Table 5: Global constants

  ----------------------- ----------- ---------------------------------------------------------------------------------------
  **Constant**            **Value**   **Description**
  L\_TOTAL                320         total size of speech buffer.
  L\_WINDOW               240         window size in LP analysis
  L\_FRAME                160         frame size
  L\_FRAME\_BY2           80          frame size divided by 2
  L\_SUBFR                40          subframe size
  L\_CODE                 40          codevector length
  NB\_TRACK               5           number of tracks
  STEP                    5           codebook step size
  NB\_TRACK\_MR102        4           number of tracks mode mr102
  STEP\_MR102             4           codebook step size mode mr102
  M                       10          order of LP filter
  MP1                     (M+1)       order of LP filter + 1
  LSF\_GAP                205         minimum distance between LSF after quantization; 50 Hz = 205
  LSP\_PRED\_FAC\_MR122   21299       MR122 LSP prediction factor (0.65 Q15)
  AZ\_SIZE                44          size of array of LP filters in 4 subframes (4\*M+4)
  PIT\_MIN\_MR122         18          minimum pitch lag (MR122 mode)
  PIT\_MIN                20          minimum pitch lag (all other modes)
  PIT\_MAX                143         maximum pitch lag
  L\_INTERPOL             (10+1)      length of filter for interpolation
  L\_INTER\_SRCH          4           length of filter for CL LTP search interpolation
  MU                      26214       factor for tilt compensation filter 0,8
  AGC\_FAC                29491       factor for automatic gain control 0,9
  L\_NEXT                 40          overhead in LP analysis
  SHARPMAX                13017       maximum value of pitch sharpening
  SHARPMIN                0           minimum value of pitch sharpening
  MAX\_PRM\_SIZE          57          max. num. of params
  MAX\_SERIAL\_SIZE       244         max. num. of serial bits
  GP\_CLIP                15565       pitch gain clipping = 0.95
  N\_FRAME                7           old pitch gains in average calculation
  EHF\_MASK               8           16 bit representation of all samples in the encoder homing frame (left justification)
  ----------------------- ----------- ---------------------------------------------------------------------------------------

### 4.5.2 Description of fixed tables used in the C-code

This section contains a listing of all fixed tables sorted by source
file name and table name. All table data is declared as **Word16**.

Table 6: Fixed tables

  --------------- ------------------------ -------- ---------------------------------------------------------------------------------------------------
  File            Table name               Length   Description
  c2\_9pf.c       trackTable               4\*5     track table for algebraic code book search (MR475, MR515)
  cod\_amr.c      gamma1                   10       spectral expansion factors
  cod\_amr.c      gamma1\_12k2             10       spectral expansion factors
  cod\_amr.c      gamma2                   10       spectral expansion factors
  dtx\_dec.c      lsf\_hist\_mean\_scale   10       initialization values for DTX lsf parameters
  dtx\_dec.c      dtx\_log\_en\_adjust     9        level adjustments for ech mode
  ec\_gains.c     cdown                    7        attenuation factors for codebook gain
  ec\_gains.c     pdown                    7        attenuation factors for adaptive codebook gain
  gc\_pred.c      pred                     4        algebraic code book gain MA predictor coefficients
  gc\_pred.c      pred\_MR122              4        algebraic code book gain MA predictor coefficients (MR122)
  pitch\_fr.c     mode\_dep\_parm          72       parameters defining the adaptive codebook search per mode
  post\_pro.c     a                        3        HP filter coefficients (denominator) in Post\_Process
  post\_pro.c     b                        3        HP filter coefficients (numerator) in Post\_Process
  pre\_proc.c     a                        3        HP filter coefficients (denominator) in Pre\_Process
  pre\_proc.c     b                        3        HP filter coefficients (numerator) in Pre\_Process
  pred\_lt.c      inter\_6                 61       interpolation filter coefficients
  pstfilt.c       gamma3\_MR122            10       spectral expansion factors
  pstfilt.c       gamma3                   10       spectral expansion factors
  pstfilt.c       gamma4\_MR122            10       spectral expansion factors
  pstfilt.c       gamma4                   10       spectral expansion factors
  bitno.tab       prmno                    9        number of bits for each mode
  bitno.tab       prmnofsf                 8        number of parameters for LPC and first subframe for each mode (used for decoder homing procedure)
  bitno.tab       bitno                    9        pointers to the bitno\_MR\... tables
  bitno.tab       bitno\_MR475             17       number of bits per parameter to transmit (MR475)
  bitno.tab       bitno\_MR515             19       number of bits per parameter to transmit (MR515)
  bitno.tab       bitno\_MR59              19       number of bits per parameter to transmit (MR59)
  bitno.tab       bitno\_MR67              19       number of bits per parameter to transmit (MR67)
  bitno.tab       bitno\_MR74              19       number of bits per parameter to transmit (MR74)
  bitno.tab       bitno\_MR795             23       number of bits per parameter to transmit (MR795)
  bitno.tab       bitno\_MR102             39       number of bits per parameter to transmit (MR102)
  bitno.tab       bitno\_MR122             57       number of bits per parameter to transmit (MR122)
  bitno.tab       bitno\_MRDTX             5        number of bits per parameter to transmit (MRDTX)
  c2\_11pf.tab    startPos1                2        track start search position for first pulse
  c2\_11pf.tab    startPos2                4        track start search position for second pulse
  c2\_9pf.tab     startPos                 16       track start search position
  corrwght.tab    corrweight               251      weighting of the correlation function in open loop LTP search (MR102)
  d\_homing.tab   dhf                      8        pointers to the dhf\_MR... tables
  d\_homing.tab   dhf\_MR475               17       parameter values for the decoder homing frame (MR475)
  d\_homing.tab   dhf\_MR515               19       parameter values for the decoder homing frame (MR515)
  d\_homing.tab   dhf\_MR59                19       parameter values for the decoder homing frame (MR59)
  d\_homing.tab   dhf\_MR67                19       parameter values for the decoder homing frame (MR67)
  d\_homing.tab   dhf\_MR74                19       parameter values for the decoder homing frame (MR74)
  d\_homing.tab   dhf\_MR795               23       parameter values for the decoder homing frame (MR795)
  d\_homing.tab   dhf\_MR102               39       parameter values for the decoder homing frame (MR102)
  d\_homing.tab   dhf\_MR122               57       parameter values for the decoder homing frame (MR122)
  gains.tab       qua\_gain\_pitch         16       adaptive codebook gain quantization table (MR122, MR795)
  gains.tab       qua\_gain\_code          96       fixed codebook gain quantization table (MR122, MR795)
  gray.tab        gray                     8        gray coding table
  gray.tab        dgray                    8        gray decoding table
  grid.tab        grid                     61       grid points at wich Chebyshev polynomials are evaluated
  inter\_36.tab   inter\_6                 25       interpolation filter coefficients
  inv\_sqrt.tab   table                    49       table used in inverse square root computation
  lag\_wind.tab   lag\_h                   10       high part of the lag window table
  lag\_wind.tab   lag\_l                   10       low part of the lag window table
  (continued)                                       
  --------------- ------------------------ -------- ---------------------------------------------------------------------------------------------------

Table 6 (concluded): Fixed tables

  ---------------- ------------------------ -------- -------------------------------------------------------------------
  File             Table name               Length   Description
  log2.tab         table                    33       table used inbase 2 logharithm computation
  lsp.tab          lsp\_init\_data          10       initialization table for lsp history in DTX
  lsp\_lsf.tab     table                    65       table to compute cos(x) in Lsf\_lsp()
  lsp\_lsf.tab     slope                    64       table to compute acos(x) in Lsp\_lsf()
  ph\_disp.tab     ph\_imp\_low\_MR795      40       phase dispersion impulse response (MR795)
  ph\_disp.tab     ph\_imp\_mid\_MR795      40       phase dispersion impulse response (MR795)
  ph\_disp.tab     ph\_imp\_low             40       phase dispersion impulse response (MR475 - MR67)
  ph\_disp.tab     ph\_imp\_mid             40       phase dispersion impulse response (MR475 - MR67)
  pow2.tab         table                    33       table used in 2 to the power computation
  q\_plsf\_3.tab   past\_rq\_init           80       initialization table for the MA predictor in DTX
  q\_plsf\_3.tab   mean\_lsf                10       LSF means (not in MR122)
  q\_plsf\_3.tab   pred\_fac                10       LSF prediction factors (not in MR122)
  q\_plsf\_3.tab   dico1\_lsf               3\*256   1^st^ LSF quantizer (not in MR122 and MR795)
  q\_plsf\_3.tab   dico2\_lsf               3\*512   2^nd^ LSF quantizer (not in MR122)
  q\_plsf\_3.tab   dico3\_lsf               4\*512   3^rd^ LSF quantizer (not in MR122, MR515 and MR475)
  q\_plsf\_3.tab   mr515\_3\_lsf            4\*128   3^rd^ LSF quantizer (MR515 and MR475)
  q\_plsf\_3.tab   mr795\_1\_lsf            3\*512   1^st^ LSF quantizer (MR795)
  q\_plsf\_5.tab   mean\_lsf                10       LSF means (MR122)
  q\_plsf\_5.tab   dico1\_lsf               4\*128   1^st^ LSF quantizer (MR122)
  q\_plsf\_5.tab   dico2\_lsf               4\*256   2^nd^ LSF quantizer (MR122)
  q\_plsf\_5.tab   dico3\_lsf               4\*256   3^rd^ LSF quantizer (MR122)
  q\_plsf\_5.tab   dico4\_lsf               4\*256   4^th^ LSF quantizer (MR122)
  q\_plsf\_5.tab   dico5\_lsf               4\*64    5^th^ LSF quantizer (MR122)
  qgain475.tab     table\_gain\_MR475       4\*256   gain quantization table (MR475)
  qua\_gain.tab    table\_gain\_highrates   128\*4   gain quantization table (MR67, MR74 and MR102)
  qua\_gain.tab    table\_gain\_lowrates    64\*4    gain quantization table (MR515 and MR59)
  R\_fft.c         phs\_tbl                 128      sine/cosine phase table
  R\_fft.c         ii\_table                8        indexing table
  sqrt\_l          table                    49       table to compute sqrt(x)
  Vad1.c           ch\_tbl                  2\*16    channel energy combination table
  Vad1.c           ch\_tbl\_sh              16       channel energy scaling table
  Vad1.c           vm\_tbl                  90       voice metric table
  Vad1.c           hangover\_table          20       used to determine hangover as a function of SNR
  Vad1.c           burstcount\_table        20       used to determine burst count threshold as a function of SNR
  Vad1.c           vm\_thresh\_table        20       used to determine the voice metric threshold as a function of SNR
  Vad1.c           energy state tables      2\*6     constants as a function of scaling state
  window.tab       window\_200\_40          240      LP analysis window (not in MR122)
  window.tab       window\_160\_80          240      1^st^ LP analysis window (MR122)
  window.tab       window\_232\_8           240      2^nd^ LP analysis window (MR122)
  ---------------- ------------------------ -------- -------------------------------------------------------------------

### 4.5.3 Static variables used in the C-code

In this section two tables that specify the static variables for the
speech encoder and decoder respectively are shown. All static variables
are declared within a C **struct.**

Table 7: Speech encoder static variables

  ------------------- ----------------------- ------------------- -------------------------------------------------------------------------
  Struct name         Variable                Type\[Length\]      Description

  Speech\_Encode\_\   cod\_amr\_state         cod\_amrState       see below in this table
  FrameState                                                      

                      pre\_state              Pre\_ProcessState   see below in this table

                      dtx                     Flag                Is set if DTX functionality is used

                      complexityCounter       int                 Used for wMOPS counting

  Pre\_ProcessState   y2\_hi                  Word16              filter state, upper word

                      y2\_lo                  Word16              filter state, lower word

                      y1\_hi                  Word16              filter state, upper word

                      y1\_lo                  Word16              filter state, lower word

                      x0                      Word16              filter state

                      x1                      Word16              filter state

  cod\_amrState       old\_speech             Word16\[320\]       speech buffer

                      speech                  Word16\*            pointer to current frame in old\_speech

                      p\_window               Word16\*            pointer to LPC analysis window in old\_speech

                      p\_window\_12k2         Word16\*            pointer to LPC analysis window with no lookahead in old\_speech (MR122)

                      new\_speech             Word16\*            pointer to the last 160 speech samples in old\_speech

                      old\_wsp                Word16\[303\]       buffer holding spectral weighted speech

                      wsp                     Word16\*            pointer to the current frame in old\_wsp

                      old\_lags               Word16\[5\]         open loop LTP states

                      ol\_gain\_flg           Word16\[2\]         enables open loop pitch lag weighting (MR102)

                      old\_exc                Word16\[314\]       excitation vector

                      exc                     Word16\*            current excitation

                      ai\_zero                Word16\[51\]        history of weighted synth. filter followed by zero vector

                      zero                    Word16\*            zero vector

                      h1                      Word16\*            impulse response of weighted synthesis filter

                      hvec                    Word16\[80\]        zero vector followed by impulse response

                      lpcSt                   lpcState            see below in this table

                      lspSt                   lspState            see below in this table

                      clLtpSt                 clLtpState          see below in this table

                      gainQuantSt             gainQuantState      see below in this table

                      pitchOLWghtSt           pitchOLWghtState    see below in this table

                      tonStabSt               tonStabState        see below in this table

                      vadSt                   vadState1           see below in this table

                      vadSt                   vadState2           see below in this table

                      dtx                     Flag                is set if DTX functionality is used

                      dtx\_encSt              dtx\_encState       see below in this table

                      mem\_syn                Word16\[10\]        synthesis filter memory

                      mem\_w0                 Word16\[10\]        weighting filter memory (applied to error signal)

                      mem\_w                  Word16\[10\]        weighting filter memory (applied to input signal)

                      mem\_err                Word16\[50\]        filter memory for production of error vector

                      error                   Word16\*            error signal (input minus synthesized speech)

                      sharp                   Word16              pitch sharpening gain

  vadState1           bckr\_est               Word16\[9\]         background noise estimate

                      ave\_level              Word16\[9\]         averaged input components for stationary estimation

                      old\_level              Word16\[9\]         input levels of the previous frame

                      sub\_level              Word16\[9\]         input levels calculated at the end of a frame (lookahead)

                      a\_data5                Word16\[6\]         memory for the filter bank

                      a\_data3                Word16\[5\]         memory for the filter bank

                      burst\_count            Word16              counts length of a speech burst

                      hang\_count             Word16              hangover counter

                                                                  

                      stat\_count             Word16              stationary counter

                      vadreg                  Word16              15 flags for intermediate VAD decisions

                      pitch                   Word16              15 flags for pitch detection

                      tone                    Word16              15 flags for tone detection

                      complex\_high           Word16              flags for complex detection

                      complex\_low            Word16              flags for complex detection

                      oldlag\_count           Word16              variables for pitch detection

                      oldlag                  Word16              variables for pitch detection

                      complex\_hang\_count    Word16              complex hangover counter, used by VAD

                      complex\_hang\_timer    Word16              hangover initiator, used by CAD

                                                                  

                      best\_corr\_hp          Word16              filtered value

                      speech\_vad\_decision   Word16              final decision

                      complex\_warning        Word16              complex background warning

                      sp\_burst\_count        Word16              counts length of a speech burst incl HO addition

                      corr\_hp\_fast          Word16              filtered value

  vadState2           pre\_emp\_mem           Word16              input pre-emphasis memory

                      update\_cnt             Word16              noise update counter

                      hyster\_cnt             Word16              hysteresis counter

                      last\_update\_cnt       Word16              noise update counter value for last frame

                      ch\_enrg\_long\_db      Word16\[16\]        long term channel energy in dB

                      Lframe\_cnt             Word32              10 ms frame counter

                      Lch\_enrg               Word32\[16\]        channel energy estimate

                      Lch\_noise              Word32\[16\]        channel noise estimate

                      last\_normb\_shift      Word16              block shift factor for last frame, used for pre\_emp\_mem

                      tsnr                    Word16              total estimated peak SNR in dB

                      hangover                Word16              VAD hangover

                      burstcount              Word16              number of consecutive voice active frames

                      fupdate\_flag           Word16              A flag to control a forced update of the noise estimate

                      negSNRvar               Word16              SNR variability

                      negSNRbias              Word16              sensitivity bias

                      shift\_state            Word16              indicates scaling state of channel energy estimate

                      L\_R0                   Word32              LTP energy

                      L\_Rmax                 Word32              LTP max correlation

                      LTP\_flag               Flag                set when open loop pitch prediction gain \> threshold

  dtx\_encState       lsp\_hist               Word16\[80\]        LSP history (8 frames)

                      log\_en\_hist           Word16\[8\]         logarithmic frame energy history (8 frames)

                      hist\_ptr               Word16              pointer to the cyclic history vectors

                      log\_en\_index          Word16              Index for logarithmic energy

                                                                  

                      init\_lsf\_vq\_index    Word16              initial index for lsf predictor

                      lsp\_index              Word16\[3\]         lsp indecies to the three code books

                      dtxHangoverCount        Word16              is decreased in DTX hangover period

                      decAnaElapsedCount      Word16              counter for elapsed speech frames in DTX

  lpcState            LevinsonSt              LevinsonState       see below

  LevinsonState       old\_A                  Word16\[11\]        last frames direct form coefficients

  lspState            lsp\_old                Word16\[10\]        old LSP vector

                      lsp\_old\_q             Word16\[10\]        old quantized LSP vector

                      qSt                     Q\_plsfState        see below in this table

  Q\_plsfState        past\_rq                Word16\[10\]        past quantized LSF prediction error

  clLtpState          pitchSt                 Pitch\_frState      see below in this table

  tonStabState        count                   Word16              count consecutive (potential) resonance frames

                      gp                      Word16\[7\]         pitch gain history

  Pitch\_frState      T0\_prev\_subframe      Word16              integer. pitch lag of previous subframe

  gainQuantState      sf0\_exp\_gcode0        Word16              subframe 0/2 codebook gain exponent

                      sf0\_frac\_gcode0       Word16              subframe 0/2 codebook gain fraction

                      sf0\_exp\_target\_en    Word16              subframe 0/2 target energy exponent

                      sf0\_frac\_target\_en   Word16              subframe 0/2 target energy fraction

                      sf0\_exp\_coeff         Word16\[5\]         subframe 0/2 energy coefficient exponents

                      sf0\_frac\_coeff        Word16\[5\]         subframe 0/2 energy coefficient fractions

                      gain\_idx\_ptr          Word16\*            pointer to gain index value in parameter frame

                      gc\_predSt              gc\_predState       see below in this table

                      gc\_predUncSt           gc\_predState       see below in this table

                      adaptSt                 GainAdaptState      see below in this table

  gc\_predState       past\_qua\_en           Word16\[4\]         MA predictor memory (20\*log10(pred. error))

                      past\_qua\_en\_MR122    Word16\[4\]         MA predictor memory, 12.2 style (log2(pred. error))

  GainAdaptState      onset                   Word16              onset counter

                      prev\_alpha             Word16              previous adaptor output

                      prev\_gc                Word16              previous codebook gain

                      ltpg\_mem               Word16\[5\]         pitch gain history

  pitchOLWghtState    old\_T0\_med            Word16              weighted open loop pitch lag

                      ada\_w                  Word16              weigthing level depeding on open loop pitch gain

                      wght\_flg               Word16              switches lag weighting on and off
  ------------------- ----------------------- ------------------- -------------------------------------------------------------------------

Table 8: Speech decoder static variables

  ---------------------------- ------------------------ ------------------------ -------------------------------------------------
  Struct name                  Variable                 Type\[Length\]           Description
  Speech\_Decode\_FrameState   decoder\_amrState        Decoder\_amrState        see below in this table
                               post\_state              Post\_FilterState        see below in this table
                               postHP\_state            Post\_ProcessState       see below in this table
                                                                                 
                               ComplexityCounter        int                      Used for wMOPS counting
  Decoder\_amrState            old\_exc                 Word16\[194\]            excitation vector
                               exc                      Word16\*                 current excitation
                               lsp\_old                 Word16\[10\]             LSP vector of previous frame
                               mem\_syn                 Word16\[10\]             synthesis filter memory
                               sharp                    Word16                   pitch sharpening gain
                               old\_T0                  Word16                   pitch sharpening lag
                               prev\_bf                 Word16                   previous value of \"bad frame\" flag
                                                                                 
                               prev\_pdf                Word16                   previous value of \"pot. dangerous frame\" flag
                               state                    Word16                   ECU state (0..6)
                               excEnergyHist            Word16\[9\]              excitation energy history
                               T0\_lagBuff              Word16                   received pitch lag for ECU
                               inBackgroundNoise        Word16                   background noise flag
                               voicedHangover           Word16                   hangover flag
                               ltpGainHistory           Word16\[9\]              pitch gain history
                               background\_state        Bgn\_scdState            see below in this table
                               Cb\_gain\_averState      Cb\_gain\_averageState   see below in this table
                               lsp\_avg\_st             lsp\_avgState            see below in this table
                               lsfState                 D\_plsfState             see below in this table
                               ec\_gain\_p\_st          ec\_gain\_pitchState     see below in this table
                               ec\_gain\_c\_st          ec\_gain\_codeState      see below in this table
                               pred\_state              gc\_predState            see table 7
                               nodataSeed               Word16                   seed for CN generator
                               ph\_disp\_st             ph\_dispState            see below in this table
                               dtxDecoderState          dtx\_decState            see below in this table
  dtx\_decState                since\_last\_sid         Word16                   number of frames since last SID frame
                               true\_sid\_period\_inv   Word16                   inverse of true SID update rate
                               log\_en                  Word16                   logarithmic frame energy
                               old\_log\_en             Word16                   previous value of log\_en
                               L\_pn\_seed\_rx          Word32                   random number generator seed
                               lsp                      Word16\[10\]             LSP vector
                               lsp\_old                 Word16\[10\]             previous LSP vector
                               lsf\_hist                Word16\[80\]             LSF vector history (8 frames)
                               lsf\_hist\_ptr           Word16                   index to beginning of LSF history
                               lsf\_hist\_mean          Word16\[80\]             mean-removed LSF history (8 frames)
                                                                                 
                               log\_pg\_mean            Word16                   mean-removed logarithmic prediction gain
                               log\_en\_hist            Word16\[8\]              logarithmic frame energy history
                               log\_en\_hist\_ptr       Word16                   index to beginning of log, frame energy history
                               log\_en\_adjust          Word16                   mode-dependent frame energy adjustment
                               dtxHangoverCount         Word16                   counts down in hangover period
                               decAnaElapsedCount       Word16                   counts elapsed speech frames after DTX
                               sid\_frame               Word16                   flags SID frames
                               valid\_data              Word16                   flags SID frames containing valid data
                               dtxHangoverAdded         Word16                   flags hangover period at end of speech
                               dtxGlobalState           enum DTXStateType        DTX state flags
                               data\_updated            Word16                   flags CNI updates
  Bgn\_scdState                frameEnergyHist          Word16\[60\]             history of synthesis frame energy
                               bgHangover               Word16                   number of frames since last speech frame
  Cb\_gain\_averageState       cbGainHistory            Word16\[7\]              codebook gain history
                               hangVar                  Word16                   counts length of talkspurt in subframes
                               hangCount                Word16                   number of subframes since last talkspurt
  lsp\_avgState                lsp\_meanSave            Word16\[10\]             averaged LSP vector
  D\_plsfState                 past\_r\_q               Word16\[10\]             past quantized LSF prediction vector
                               past\_lsf\_q             Word16\[10\]             past dequantized LSF vector
  ec\_gain\_pitchState         pbuf                     Word16\[5\]              pitch gain history
                               past\_gain\_pit          Word16                   previous pitch gain (limited to 1.0)
                               prev\_gp                 Word16                   previous good pitch gain
  ec\_gain\_codeState          gbuf                     Word16\[5\]              codebook gain history
                               past\_gain\_code         Word16                   previous codebook gain
                               prev\_gc                 Word16                   previous good codebook gain
  ph\_dispState                gainMem                  Word16\[5\]              pitch gain history
                               prevState                Word16                   previously used impulse response
                               prevCbGain               Word16                   previous codebook gain
                               lockFull                 Word16                   force maximum phase dispersion
                               onset                    Word16                   onset counter
  Post\_FilterState            res2                     Word16\[40\]             LP residual
                               mem\_syn\_pst            Word16\[10\]             synthesis filter memory
                               synth\_buf               Word16\[170\]            synthesis filter work area
                               agc\_state               agcState                 see below in this table
                               preemph\_state           preemphasisState         see below in this table
  agcState                     past\_gain               Word16                   past agc gain
  preemphasisState             mem\_pre                 Word16                   filter state
  Post\_ProcessState           y2\_hi                   Word16                   filter state, upper word
                               y2\_lo                   Word16                   filter state, lower word
                               y1\_hi                   Word16                   filter state, upper word
                               y1\_lo                   Word16                   filter state, lower word
                               x0                       Word16                   filter state
                               x1                       Word16                   filter state
  ---------------------------- ------------------------ ------------------------ -------------------------------------------------

5 Homing procedure
==================

The principles of the homing procedures are described in \[2\]. This
specification only includes a detailed description of the 8 decoder
homing frames. For each AMR codec mode, the corresponding decoder homing
frame has a fixed set of speech parameters shown in table 9a-9h. The bit
allocation within these parameters is identical to the corresponding bit
allocation of the source encoder output parameters given in \[2\].

In the following tables, the following naming convention is used for the
individual parameters. Letters in *italics* indicate numbers.

> LPC\_*n* index of *n*th LSF submatrix.
>
> LTP-LAG *m* adaptive codebook index for subframe *m.*
>
> LTP-GAIN *m* adaptive codebook gain index in subframe *m.*
>
> FCB-GAIN *m* fixed codebook gain index in subframe *m.*
>
> GAIN\_VQ *m* codebook gain VQ index in subframe *m* (subframe *m* and
> *m+1* for MR475).
>
> POS *m*\_*n* position index of *n*th pulse in subframe m.
>
> POS *m*\_*n*\_*k* position index of *n*th and *k*th pulse in subframe
> *m.*
>
> POS *m*\_*n\_k\_l\_j* position index of *n*th, *k*th, *l*th, and *j*th
> pulse in subframe *m.*
>
> SIGN *m*\_*n*\_*k* sign information for *n*th and *k*th pulse in
> subframe *m.*
>
> SIGN *m*\_ *n\_k\_l\_j* sign information for *n*th, *k*th, *l*th, and
> *j*th pulse in subframe *m.*
>
> SIGN\_*m\_n\_k*\_POS\_*m\_n* sign information for *n*th and *k*th
> pulse and position index for *n*th pulse in subframe *m.*

Table 9a: Parameter values for the decoder homing frame (MR475)

  --------------- --------------------
  **Parameter**   **Value (LSB=b0)**
  LPC 1           0x00F8
  LPC 2           0x009D
  LPC 3           0x001C
  LTP-LAG 1       0x0066
  POS 1\_1\_2     0x0000
  SIGN\_1\_1\_2   0x0003
  GAIN-VQ 1       0x0028
  LTP-LAG 2       0x000F
  POS 2\_1\_2     0x0038
  SIGN\_2\_1\_2   0x0001
  LTP-LAG 3       0x000F
  POS 3\_1\_2     0x0031
  SIGN\_3\_1\_2   0x0002
  GAIN-VQ 3       0x0008
  LTP-LAG 4       0x000F
  POS 4\_1\_2     0x0026
  SIGN\_4\_1\_2   0x0003
  --------------- --------------------

Table 9b: Parameter values for the decoder homing frame (MR515)

  --------------- --------------------
  **Parameter**   **Value (LSB=b0)**
  LPC 1           0x00F8
  LPC 2           0x009D
  LPC 3           0x001C
  LTP-LAG 1       0x0066
  POS 1\_1\_2     0x0000
  SIGN\_1\_1\_2   0x0003
  GAIN-VQ 1       0x0037
  LTP-LAG 2       0x000F
  POS 2\_1\_2     0x0000
  SIGN\_2\_1\_2   0x0003
  GAIN-VQ 2       0x0005
  LTP-LAG 3       0x000F
  POS 3\_1\_2     0x0037
  SIGN\_3\_1\_2   0x0003
  GAIN-VQ 3       0x0037
  LTP-LAG 4       0x000F
  POS 4\_1\_2     0x0023
  SIGN\_4\_1\_2   0x0003
  GAIN-VQ 4       0x001F
  --------------- --------------------

Table 9c: Parameter values for the decoder homing frame (MR59)

  --------------- --------------------
  **Parameter**   **Value (LSB=b0)**
  LPC 1           0x00F8
  LPC 2           0x00E3
  LPC 3           0x002F
  LTP-LAG 1       0x00BD
  POS 1\_1\_2     0x0000
  SIGN\_1\_1\_2   0x0003
  GAIN-VQ 1       0x0037
  LTP-LAG 2       0x000F
  POS 2\_1\_2     0x0001
  SIGN\_2\_1\_2   0x0003
  GAIN-VQ 2       0x000F
  LTP-LAG 3       0x0060
  POS 3\_1\_2     0x00F9
  SIGN\_3\_1\_2   0x0003
  GAIN-VQ 3       0x0037
  LTP-LAG 4       0x000F
  POS 4\_1\_2     0x0000
  SIGN\_4\_1\_2   0x0003
  GAIN-VQ 4       0x0037
  --------------- --------------------

Table 9d: Parameter values for the decoder homing frame (MR67)

  ------------------ --------------------
  **Parameter**      **Value (LSB=b0)**
  LPC 1              0x00F8
  LPC 2              0x00E3
  LPC 3              0x002F
  LTP-LAG 1          0x00BD
  POS 1\_1\_2\_3     0x0002
  SIGN\_1\_1\_2\_3   0x0007
  GAIN-VQ 1          0x0000
  LTP-LAG 2          0x000F
  POS 2\_1\_2\_3     0x0098
  SIGN\_2\_1\_2\_3   0x0007
  GAIN-VQ 2          0x0061
  LTP-LAG 3          0x0060
  POS 3\_1\_2\_3     0x05C5
  SIGN\_3\_1\_2\_3   0x0007
  GAIN-VQ 3          0x0000
  LTP-LAG 4          0x000F
  POS 4\_1\_2\_3     0x0318
  SIGN\_4\_1\_2\_3   0x0007
  GAIN-VQ 4          0x0000
  ------------------ --------------------

Table 9e: Parameter values for the decoder homing frame (MR74)

  --------------------- --------------------
  **Parameter**         **Value (LSB=b0)**
  LPC 1                 0x00F8
  LPC 2                 0x00E3
  LPC 3                 0x002F
  LTP-LAG 1             0x00BD
  POS 1\_1\_2\_3\_4     0x0006
  SIGN\_1\_1\_2\_3\_4   0x000F
  GAIN-VQ 1             0x0000
  LTP-LAG 2             0x001B
  POS 2\_1\_2\_3\_4     0x0208
  SIGN\_2\_1\_2\_3\_4   0x000F
  GAIN-VQ 2             0x0062
  LTP-LAG 3             0x0060
  POS 3\_1\_2\_3\_4     0x1BA6
  SIGN\_3\_1\_2\_3\_4   0x000F
  GAIN-VQ 3             0x0000
  LTP-LAG 4             0x001B
  POS 4\_1\_2\_3\_4     0x0006
  SIGN\_4\_1\_2\_3\_4   0x000F
  GAIN-VQ 4             0x0000
  --------------------- --------------------

Table 9f: Parameter values for the decoder homing frame (MR795)

  --------------------- --------------------
  **Parameter**         **Value (LSB=b0)**
  LPC 1                 0x00C2
  LPC 2                 0x00E3
  LPC 3                 0x002F
  LTP-LAG 1             0x00BD
  POS\_1\_1\_2\_3\_4    0x0006
  SIGN\_1\_1\_2\_3\_4   0x000F
  LTP-GAIN 1            0x000A
  FCB-GAIN 1            0x0000
  LTP-LAG 2             0x0039
  POS\_2\_1\_2\_3\_4    0x1C08
  SIGN\_2\_1\_2\_3\_4   0x0007
  LTP-GAIN 2            0x000A
  FCB-GAIN 2            0x000B
  LTP-LAG 3             0x0063
  POS\_3\_1\_2\_3\_4    0x11A6
  SIGN\_3\_1\_2\_3\_4   0x000F
  LTP-GAIN 3            0x0001
  FCB-GAIN 3            0x0000
  LTP-LAG 4             0x0039
  POS\_4\_1\_2\_3\_4    0x09A0
  SIGN\_4\_1\_2\_3\_4   0x000F
  LTP-GAIN 4            0x0002
  FCB-GAIN 4            0x0001
  --------------------- --------------------

Table 9g: Parameter values for the decoder homing frame (MR102)

  ----------------- --------------------
  **Parameter**     **Value (LSB=b0)**
  LPC 1             0x00F8
  LPC 2             0x00E3
  LPC 3             0x002F
  LTP-LAG 1         0x0045
  SIGN\_1\_1\_5     0x0000
  SIGN\_1\_2\_6     0x0000
  SIGN\_1\_3\_7     0x0000
  SIGN\_1\_4\_8     0x0000
  POS\_1\_1\_2\_5   0x0000
  POS\_1\_3\_6\_7   0x0000
  POS\_1\_4\_8      0x0000
  GAIN-VQ\_1        0x0000
  LTP-LAG 2         0x001B
  SIGN\_2\_1\_5     0x0000
  SIGN\_2\_2\_6     0x0001
  SIGN\_2\_3\_7     0x0000
  SIGN\_2\_4\_8     0x0001
  POS\_2\_1\_2\_5   0x0326
  POS\_2\_3\_6\_7   0x00CE
  POS\_2\_4\_8      0x007E
  GAIN-VQ\_2        0x0051
  LTP-LAG 3         0x0062
  SIGN\_3\_1\_5     0x0000
  SIGN\_3\_2\_6     0x0000
  SIGN\_3\_3\_7     0x0000
  SIGN\_3\_4\_8     0x0000
  POS\_3\_1\_2\_5   0x015A
  POS\_3\_3\_6\_7   0x0359
  POS\_3\_4\_8      0x0076
  GAIN-VQ\_3        0x0000
  LTP-LAG 4         0x001B
  SIGN\_4\_1\_5     0x0000
  SIGN\_4\_2\_6     0x0000
  SIGN\_4\_3\_7     0x0000
  SIGN\_4\_4\_8     0x0000
  POS\_4\_1\_2\_5   0x017C
  POS\_4\_3\_6\_7   0x0215
  POS\_4\_4\_8      0x0038
  GAIN-VQ\_4        0x0030
  ----------------- --------------------

Table 9h: Parameter values for the decoder homing frame (MR122)

  --------------------------- --------------------
  **Parameter**               **Value (LSB=b0)**
  LPC1                        0x0004
  LPC2                        0x002A
  LPC3                        0x00DB
  LPC4                        0x0096
  LPC5                        0x002A
  LTP-LAG 1                   0x0156
  LTP-GAIN 1                  0x000B
  SIGN\_1\_1\_6\_POS\_1\_1    0x0000
  SIGN\_1\_2\_7\_POS\_1\_2    0x0000
  SIGN\_1\_3\_8\_POS\_1\_3    0x0000
  SIGN\_1\_4\_9\_POS\_1\_4    0x0000
  SIGN\_1\_5\_10\_POS\_1\_5   0x0000
  POS 1\_6                    0x0000
  POS 1\_7                    0x0000
  POS 1\_8                    0x0000
  POS 1\_9                    0x0000
  POS 1\_10                   0x0000
  FCB-GAIN 1                  0x0000
  LTP-LAG 2                   0x0036
  LTP-GAIN 2                  0x000B
  SIGN\_2\_1\_6\_POS\_2\_1    0x0000
  SIGN\_2\_2\_7\_POS\_2\_2    0x000F
  SIGN\_2\_3\_8\_POS\_2\_3    0x000E
  SIGN\_2\_4\_9\_POS\_2\_4    0x000C
  SIGN\_2\_5\_10\_POS\_2\_5   0x000D
  POS 2\_6                    0x0000
  POS 2\_7                    0x0001
  POS 2\_8                    0x0005
  POS 2\_9                    0x0007
  POS 2\_10                   0x0001
  FCB-GAIN 2                  0x0008
  LTP-LAG 3                   0x0024
  LTP-GAIN 3                  0x0000
  SIGN\_3\_1\_6\_POS\_3\_1    0x0001
  SIGN\_3\_2\_7\_POS\_3\_2    0x0000
  SIGN\_3\_3\_8\_POS\_3\_3    0x0005
  SIGN\_3\_4\_9\_POS\_3\_4    0x0006
  SIGN\_3\_5\_10\_POS\_3\_5   0x0001
  POS 3\_6                    0x0002
  POS 3\_7                    0x0004
  POS 3\_8                    0x0007
  POS 3\_9                    0x0004
  POS 3\_10                   0x0002
  FCB-GAIN 3                  0x0003
  LTP-LAG 4                   0x0036
  LTP-GAIN 4                  0x000B
  SIGN\_4\_1\_6\_POS\_4\_1    0x0000
  SIGN\_4\_2\_7\_POS\_4\_2    0x0002
  SIGN\_4\_3\_8\_POS\_4\_3    0x0004
  SIGN\_4\_4\_9\_POS\_4\_4    0x0000
  SIGN\_4\_5\_10\_POS\_4\_5   0x0003
  POS 4\_6                    0x0006
  POS 4\_7                    0x0001
  POS 4\_8                    0x0007
  POS 4\_9                    0x0006
  POS 4\_10                   0x0005
  FCB-GAIN 4                  0x0000
  --------------------------- --------------------

6 File formats
==============

This section describes the file formats used by the encoder and decoder
programs. The test sequences defined in \[1\] also use the file formats
described here.

6.1 Speech file (encoder input / decoder output)
------------------------------------------------

Speech files read by the encoder and written by the decoder consist of
16-bit words where each word contains a 13-bit, left aligned speech
sample. The byte order depends on the host architecture (e.g. MSByte
first on SUN workstations, LSByte first on PCs etc.). Both the encoder
and the decoder program process complete frames (of 160 samples) only.

This means that the encoder will only process *n* frames if the length
of the input file is *n\*160 + k* words, while the files produced by the
decoder will always have a length of *n\*160* words.

6.2 Mode control file (encoder input)
-------------------------------------

The encoder program can optionally read in a mode control file which
specifies the encoding mode for each frame of speech processed. The file
is a text file containing one line per speech frame. Each line contains
one of the mode names from the list {MR475, MR515, MR59, MR67, MR74,
MR795, MR102, MR122}.

6.3 Parameter bitstream file (encoder output / decoder input)
-------------------------------------------------------------

The files produced by the speech encoder/expected by the speech decoder
contain an arbitrary number of frames in the following format.

  ------------- ---- ---- ----- ------ ------------ ----------- ----- -----------
  FRAME\_TYPE   B1   B2   ...   B244   MODE\_INFO   *unused1*   ...   *unused4*
  ------------- ---- ---- ----- ------ ------------ ----------- ----- -----------

Each box corresponds to one Word16 value in the bitstream file, for a
total of 250 words or 500 bytes per frame. The fields have the following
meaning:

FRAME\_TYPE transmit frame type, which is one of\
TX\_SPEECH (0x0000)\
TX\_SID\_FIRST (0x0001)\
TX\_SID\_UPDATE (0x0002)\
TX\_NO\_DATA (0x0003)

B0...B244 speech encoder parameter bits (i.e. the bitstream itself).
Each B*x* either has the value 0x0000 or 0x0001. Only mode MR122 really
uses all 244 bits; for the other modes, only the first *n* bits are used
(35 ≤ n ≤ 204). The remaining bits are unused (written as 0x0000)

MODE\_INFO encoding mode information, which is one of\
MR475 (0x0000)\
MR515 (0x0001)\
MR59 (0x0002)\
MR67 (0x0003)\
MR74 (0x0004)\
MR795 (0x0005)\
MR102 (0x0006)\
MR122 (0x0007)

*unused1...4* unused, written as 0x0000

As indicated in section 6.1 above, the byte order depends on the host
architecture.

By using a preprocessor definition the encoder output and decoder input
can optionally use format described in \[7\], sections 5.1 and 5.3.

######## Annex A (informative): Change History

+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SMG\# | Tdoc  | Spec  | CR   | Cat | PH    | Vers  | New\  | Su    |
|       | SMG   |       |      |     |       |       | Ve    | bject |
|       |       |       |      |     |       |       | rsion |       |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA6   | [SP   | 2     |      |     |       |       | 3.0.0 | App   |
|       | -9956 | 6.073 |      |     |       |       |       | roved |
|       | 0](.. |       |      |     |       |       |       | at    |
|       | /../. |       |      |     |       |       |       | TSG-  |
|       | ./../ |       |      |     |       |       |       | SA\#6 |
|       | ../.. |       |      |     |       |       |       |       |
|       | /../. |       |      |     |       |       |       |       |
|       | ./../ |       |      |     |       |       |       |       |
|       | DOCUM |       |      |     |       |       |       |       |
|       | E~1/u |       |      |     |       |       |       |       |
|       | sai/L |       |      |     |       |       |       |       |
|       | OCALS |       |      |     |       |       |       |       |
|       | ~1/Te |       |      |     |       |       |       |       |
|       | mp/zi |       |      |     |       |       |       |       |
|       | p/SP- |       |      |     |       |       |       |       |
|       | 99560 |       |      |     |       |       |       |       |
|       | .zip) |       |      |     |       |       |       |       |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA7   | SP-0  | 2     | 001  | A   | R99   | 3.0.0 | 3.1.0 | Avoi  |
|       | 00025 | 6.073 |      |     |       |       |       | dance |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | pulse |
|       |       |       |      |     |       |       |       | ca    |
|       |       |       |      |     |       |       |       | ncell |
|       |       |       |      |     |       |       |       | ation |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | FCB   |
|       |       |       |      |     |       |       |       | excit |
|       |       |       |      |     |       |       |       | ation |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 003  | A   | R99   | 3.1.0 | 3.2.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | pote  |
|       |       |       |      |     |       |       |       | ntial |
|       |       |       |      |     |       |       |       | bug   |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
|       |       |       |      |     |       |       |       | due   |
|       |       |       |      |     |       |       |       | to    |
|       |       |       |      |     |       |       |       | usage |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | sta   |
|       |       |       |      |     |       |       |       | ndard |
|       |       |       |      |     |       |       |       | C     |
|       |       |       |      |     |       |       |       | abs() |
|       |       |       |      |     |       |       |       | fun   |
|       |       |       |      |     |       |       |       | ction |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 005  | A   | R99   | 3.1.0 | 3.2.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | co    |
|       |       |       |      |     |       |       |       | mfort |
|       |       |       |      |     |       |       |       | noise |
|       |       |       |      |     |       |       |       | para  |
|       |       |       |      |     |       |       |       | meter |
|       |       |       |      |     |       |       |       | int   |
|       |       |       |      |     |       |       |       | erpol |
|       |       |       |      |     |       |       |       | ation |
|       |       |       |      |     |       |       |       | bug   |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 007  | A   | R99   | 3.1.0 | 3.2.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | mode  |
|       |       |       |      |     |       |       |       | state |
|       |       |       |      |     |       |       |       | bug   |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 009  | A   | R99   | 3.1.0 | 3.2.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | TX\   |
|       |       |       |      |     |       |       |       | _TYPE |
|       |       |       |      |     |       |       |       | and   |
|       |       |       |      |     |       |       |       | RX\   |
|       |       |       |      |     |       |       |       | _TYPE |
|       |       |       |      |     |       |       |       | i     |
|       |       |       |      |     |       |       |       | denti |
|       |       |       |      |     |       |       |       | fiers |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 011  | A   | R99   | 3.1.0 | 3.2.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | pote  |
|       |       |       |      |     |       |       |       | ntial |
|       |       |       |      |     |       |       |       | bug   |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
|       |       |       |      |     |       |       |       | due   |
|       |       |       |      |     |       |       |       | to    |
|       |       |       |      |     |       |       |       | the   |
|       |       |       |      |     |       |       |       | usage |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | sta   |
|       |       |       |      |     |       |       |       | ndard |
|       |       |       |      |     |       |       |       | C     |
|       |       |       |      |     |       |       |       | abs() |
|       |       |       |      |     |       |       |       | fun   |
|       |       |       |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | (VAD  |
|       |       |       |      |     |       |       |       | optio |
|       |       |       |      |     |       |       |       | n\_2) |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 004  | A   | Rel-4 | 3.1.0 | 4.0.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | pote  |
|       |       |       |      |     |       |       |       | ntial |
|       |       |       |      |     |       |       |       | bug   |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
|       |       |       |      |     |       |       |       | due   |
|       |       |       |      |     |       |       |       | to    |
|       |       |       |      |     |       |       |       | usage |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | sta   |
|       |       |       |      |     |       |       |       | ndard |
|       |       |       |      |     |       |       |       | C     |
|       |       |       |      |     |       |       |       | abs() |
|       |       |       |      |     |       |       |       | fun   |
|       |       |       |      |     |       |       |       | ction |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 006  | A   | Rel-4 | 3.1.0 | 4.0.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | co    |
|       |       |       |      |     |       |       |       | mfort |
|       |       |       |      |     |       |       |       | noise |
|       |       |       |      |     |       |       |       | para  |
|       |       |       |      |     |       |       |       | meter |
|       |       |       |      |     |       |       |       | int   |
|       |       |       |      |     |       |       |       | erpol |
|       |       |       |      |     |       |       |       | ation |
|       |       |       |      |     |       |       |       | bug   |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 008  | A   | Rel-4 | 3.1.0 | 4.0.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | mode  |
|       |       |       |      |     |       |       |       | state |
|       |       |       |      |     |       |       |       | bug   |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 010  | A   | Rel-4 | 3.1.0 | 4.0.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | TX\   |
|       |       |       |      |     |       |       |       | _TYPE |
|       |       |       |      |     |       |       |       | and   |
|       |       |       |      |     |       |       |       | RX\   |
|       |       |       |      |     |       |       |       | _TYPE |
|       |       |       |      |     |       |       |       | i     |
|       |       |       |      |     |       |       |       | denti |
|       |       |       |      |     |       |       |       | fiers |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA11  | SP-0  | 2     | 012  | A   | Rel-4 | 3.1.0 | 4.0.0 | Corre |
|       | 10100 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | pote  |
|       |       |       |      |     |       |       |       | ntial |
|       |       |       |      |     |       |       |       | bug   |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
|       |       |       |      |     |       |       |       | due   |
|       |       |       |      |     |       |       |       | to    |
|       |       |       |      |     |       |       |       | the   |
|       |       |       |      |     |       |       |       | usage |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | sta   |
|       |       |       |      |     |       |       |       | ndard |
|       |       |       |      |     |       |       |       | C     |
|       |       |       |      |     |       |       |       | abs() |
|       |       |       |      |     |       |       |       | fun   |
|       |       |       |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | (VAD  |
|       |       |       |      |     |       |       |       | optio |
|       |       |       |      |     |       |       |       | n\_2) |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA14  | SP-0  | 2     | 014  | A   | Rel-4 | 4.0.0 | 4.1.0 | Corre |
|       | 10696 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | R     |
|       |       |       |      |     |       |       |       | X-DTX |
|       |       |       |      |     |       |       |       | han   |
|       |       |       |      |     |       |       |       | dling |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | NO\   |
|       |       |       |      |     |       |       |       | _DATA |
|       |       |       |      |     |       |       |       | f     |
|       |       |       |      |     |       |       |       | rames |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA14  | SP-0  | 2     | 016  | A   | Rel-4 | 4.0.0 | 4.1.0 | Corre |
|       | 10697 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | de    |
|       |       |       |      |     |       |       |       | coder |
|       |       |       |      |     |       |       |       | to    |
|       |       |       |      |     |       |       |       | avoid |
|       |       |       |      |     |       |       |       | div   |
|       |       |       |      |     |       |       |       | ision |
|       |       |       |      |     |       |       |       | by    |
|       |       |       |      |     |       |       |       | zero  |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | R     |
|       |       |       |      |     |       |       |       | X-DTX |
|       |       |       |      |     |       |       |       | Han   |
|       |       |       |      |     |       |       |       | dling |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA16  |       |       |      |     | Rel-5 | 4.1.0 | 5.0.0 | Ve    |
|       |       |       |      |     |       |       |       | rsion |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | Re    |
|       |       |       |      |     |       |       |       | lease |
|       |       |       |      |     |       |       |       | 5     |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA19  | SP-0  | 2     | 017  |     | Rel-5 | 5.0.0 | 5.1.0 | MMS   |
|       | 30085 | 6.073 |      |     |       |       |       | compa |
|       |       |       |      |     |       |       |       | tible |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | put/o |
|       |       |       |      |     |       |       |       | utput |
|       |       |       |      |     |       |       |       | o     |
|       |       |       |      |     |       |       |       | ption |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA21  | SP-0  | 2     | 018  |     | Rel-5 | 5.1.0 | 5.2.0 | Corre |
|       | 30444 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | the   |
|       |       |       |      |     |       |       |       | MM    |
|       |       |       |      |     |       |       |       | S\_IO |
|       |       |       |      |     |       |       |       | flag  |
|       |       |       |      |     |       |       |       |       |
|       |       |       |      |     |       |       |       | Note. |
|       |       |       |      |     |       |       |       | The   |
|       |       |       |      |     |       |       |       | foll  |
|       |       |       |      |     |       |       |       | owing |
|       |       |       |      |     |       |       |       | line  |
|       |       |       |      |     |       |       |       | (mi   |
|       |       |       |      |     |       |       |       | ssing |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | the   |
|       |       |       |      |     |       |       |       | app   |
|       |       |       |      |     |       |       |       | roved |
|       |       |       |      |     |       |       |       | CR)   |
|       |       |       |      |     |       |       |       | was   |
|       |       |       |      |     |       |       |       | added |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | the   |
|       |       |       |      |     |       |       |       | A     |
|       |       |       |      |     |       |       |       | NSI-C |
|       |       |       |      |     |       |       |       | code  |
|       |       |       |      |     |       |       |       | to    |
|       |       |       |      |     |       |       |       | co    |
|       |       |       |      |     |       |       |       | mpile |
|       |       |       |      |     |       |       |       | corre |
|       |       |       |      |     |       |       |       | ctly: |
|       |       |       |      |     |       |       |       |       |
|       |       |       |      |     |       |       |       | +     |
|       |       |       |      |     |       |       |       | const |
|       |       |       |      |     |       |       |       | char  |
|       |       |       |      |     |       |       |       | sp\_e |
|       |       |       |      |     |       |       |       | nc\_i |
|       |       |       |      |     |       |       |       | d\[\] |
|       |       |       |      |     |       |       |       | =     |
|       |       |       |      |     |       |       |       | \     |
|       |       |       |      |     |       |       |       | "@(\# |
|       |       |       |      |     |       |       |       | )\$Id |
|       |       |       |      |     |       |       |       | \$\"  |
|       |       |       |      |     |       |       |       | s     |
|       |       |       |      |     |       |       |       | p\_en |
|       |       |       |      |     |       |       |       | c\_h; |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA23  | SP-0  | 2     | 019  |     | Rel-5 | 5.2.0 | 5.3.0 | Corre |
|       | 40197 | 6.073 |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | DTX   |
|       |       |       |      |     |       |       |       | fun   |
|       |       |       |      |     |       |       |       | ction |
|       |       |       |      |     |       |       |       | ality |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA26  |       |       |      |     | Rel-6 | 5.3.0 | 6.0.0 | Ve    |
|       |       |       |      |     |       |       |       | rsion |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | Re    |
|       |       |       |      |     |       |       |       | lease |
|       |       |       |      |     |       |       |       | 6     |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA36  | SP-0  | 2     | 0020 | 1   | Rel-7 | 6.0.0 | 7.0.0 | Bit   |
|       | 70321 | 6.073 |      |     |       |       |       | order |
|       |       |       |      |     |       |       |       | of    |
|       |       |       |      |     |       |       |       | Mode  |
|       |       |       |      |     |       |       |       | Indic |
|       |       |       |      |     |       |       |       | ation |
|       |       |       |      |     |       |       |       | in    |
|       |       |       |      |     |       |       |       | AMR   |
|       |       |       |      |     |       |       |       | co    |
|       |       |       |      |     |       |       |       | mfort |
|       |       |       |      |     |       |       |       | noise |
|       |       |       |      |     |       |       |       | f     |
|       |       |       |      |     |       |       |       | rames |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA42  |       |       |      |     | Rel-8 | 7.0.0 | 8.0.0 | Ve    |
|       |       |       |      |     |       |       |       | rsion |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | Re    |
|       |       |       |      |     |       |       |       | lease |
|       |       |       |      |     |       |       |       | 8     |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA46  |       |       |      |     | Rel-9 | 8.0.0 | 9.0.0 | Ve    |
|       |       |       |      |     |       |       |       | rsion |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | Re    |
|       |       |       |      |     |       |       |       | lease |
|       |       |       |      |     |       |       |       | 9     |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA51  |       |       |      |     | R     | 9.0.0 | 1     | Ve    |
|       |       |       |      |     | el-10 |       | 0.0.0 | rsion |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | Re    |
|       |       |       |      |     |       |       |       | lease |
|       |       |       |      |     |       |       |       | 10    |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA57  |       |       |      |     | R     | 1     | 1     | Ve    |
|       |       |       |      |     | el-11 | 0.0.0 | 1.0.0 | rsion |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | Re    |
|       |       |       |      |     |       |       |       | lease |
|       |       |       |      |     |       |       |       | 11    |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA65  |       |       |      |     | R     | 1     | 1     | Ve    |
|       |       |       |      |     | el-12 | 1.0.0 | 2.0.0 | rsion |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | Re    |
|       |       |       |      |     |       |       |       | lease |
|       |       |       |      |     |       |       |       | 12    |
+-------+-------+-------+------+-----+-------+-------+-------+-------+
| SA70  |       |       |      |     | R     | 1     | 1     | Ve    |
|       |       |       |      |     | el-13 | 2.0.0 | 3.0.0 | rsion |
|       |       |       |      |     |       |       |       | for   |
|       |       |       |      |     |       |       |       | Re    |
|       |       |       |      |     |       |       |       | lease |
|       |       |       |      |     |       |       |       | 13    |
+-------+-------+-------+------+-----+-------+-------+-------+-------+

  -------------------- ------------- ---------- -------- --------- --------- -------------------------------- -----------------
  **Change history**                                                                                          
  **Date**             **Meeting**   **TDoc**   **CR**   **Rev**   **Cat**   **Subject/Comment**              **New version**
  2017-03              75                                                    Version for Release 14           14.0.0
  2018-06              80                                                    Version for Release 15           15.0.0
  2020-07              \-            \-         \-       \-        \-        Update to Rel-16 version (MCC)   **16.0.0**
  -------------------- ------------- ---------- -------- --------- --------- -------------------------------- -----------------

[^1]: **^1^** Option to call one or the other VAD option

[^2]: **^2^** Specific to VAD option 1

[^3]: **^3^** Specific to VAD option 2
