+---------------------------------------------+-----------------------+
| 3GPP TS 23.015 V16.1.0 (2021-03)            |                       |
+=============================================+=======================+
| Technical Specification                     |                       |
+---------------------------------------------+-----------------------+
| 3rd Generation Partnership Project;         |                       |
|                                             |                       |
| Technical Specification Group Core Network  |                       |
| and Terminals;                              |                       |
|                                             |                       |
| Technical realization of Operator           |                       |
| Determined Barring (ODB);                   |                       |
|                                             |                       |
| (Release 16)                                |                       |
+---------------------------------------------+-----------------------+
|                                             |                       |
+---------------------------------------------+-----------------------+
| ![](media/image1.jpeg)                      | ![](media/image2.png) |
+---------------------------------------------+-----------------------+
|                                             |                       |
+---------------------------------------------+-----------------------+
| The present document has been developed     |                       |
| within the 3rd Generation Partnership       |                       |
| Project (3GPP ^TM^) and may be further      |                       |
| elaborated for the purposes of 3GPP.\       |                       |
| The present document has not been subject   |                       |
| to any approval process by the 3GPP         |                       |
| Organizational Partners and shall not be    |                       |
| implemented.\                               |                       |
| This Specification is provided for future   |                       |
| development work within 3GPP only. The      |                       |
| Organizational Partners accept no liability |                       |
| for any use of this Specification.\         |                       |
| Specifications and Reports for              |                       |
| implementation of the 3GPP ^TM^ system      |                       |
| should be obtained via the 3GPP             |                       |
| Organizational Partners\' Publications      |                       |
| Offices.                                    |                       |
+---------------------------------------------+-----------------------+

+----------------------------------------------------------------------+
|                                                                      |
+======================================================================+
| > ***3GPP***                                                         |
| >                                                                    |
| > Postal address                                                     |
| >                                                                    |
| > 3GPP support office address                                        |
| >                                                                    |
| > 650 Route des Lucioles - Sophia Antipolis                          |
| >                                                                    |
| > Valbonne - FRANCE                                                  |
| >                                                                    |
| > Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16                     |
| >                                                                    |
| > Internet                                                           |
| >                                                                    |
| > http://www.3gpp.org                                                |
+----------------------------------------------------------------------+
| ***Copyright Notification***                                         |
|                                                                      |
| No part may be reproduced except as authorized by written            |
| permission.\                                                         |
| The copyright and the foregoing restriction extend to reproduction   |
| in all media.                                                        |
|                                                                      |
| © 2021, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, |
| TTA, TTC).                                                           |
|                                                                      |
| All rights reserved.                                                 |
|                                                                      |
| UMTS™ is a Trade Mark of ETSI registered for the benefit of its      |
| members                                                              |
|                                                                      |
| 3GPP™ is a Trade Mark of ETSI registered for the benefit of its      |
| Members and of the 3GPP Organizational Partners\                     |
| LTE™ is a Trade Mark of ETSI registered for the benefit of its       |
| Members and of the 3GPP Organizational Partners                      |
|                                                                      |
| GSM® and the GSM logo are registered and owned by the GSM            |
| Association                                                          |
+----------------------------------------------------------------------+

 Contents {#contents .TT}
========

Foreword 5

1 Scope 6

1.1 Normative references 6

1.2 Definitions and abbreviations 6

2 Method of realisation 7

2.1 Barring of Outgoing Calls or Mobile Originated Short Messages 7

2.1.1 Application or Change of Barring in the HLR 7

2.1.2 Invocation of Barring 7

2.2 Barring of Incoming Calls or Mobile Terminated Short Messages 9

2.2.1 Application or Change of Barring in the HLR 9

2.2.2 Invocation of Barring 9

2.3 Barring of Roaming 11

2.3.1 Application or Change of Barring in the HLR/HSS/UDM 11

2.3.2 Invocation of Barring 11

2.4 Barring of Supplementary Services Access 13

2.4.1 Application or Change of Barring in the HLR 14

2.4.2 Invocation of Barring 14

2.4.3 Operator Determined Barring of access to supplementary service not
supported in VLR 15

2.5 Barring of MS initiated PDP context activation 16

2.5.1 Application or Change of Barring in the HLR 16

2.5.2 Invocation of Barring 17

2.5A Barring of EPS Bearer context establishment 17

2.5A.1 Application or Change of Barring in the HSS 17

2.5A.2 Invocation of Barring 18

2.5B Barring of PDU Session establishment 19

2.5B.1 Application or Change of Barring in the UDM 19

2.5B.2 Invocation of Barring 19

2.6 Barring of Network initiated PDP context activation 20

2.6.1 Application or Change of Barring in the HLR 20

2.6.2 Invocation of Barring 20

2.6A Barring of existing PDP contexts 21

2.6A.1 Application or Change of Barring in the HLR 21

2.6A.2 Invocation of Barring 22

2.6B Barring of existing EPS Bearer contexts 22

2.6B.1 Application or Change of Barring in the HSS 22

2.6B.2 Invocation of Barring 22

2.6C Barring of existing PDU Sessions 23

2.6C.1 Application or Change of Barring in the UDM 23

2.6C.2 Invocation of Barring 23

2.7 Interactions of Operator Determined Barring with Supplementary
Services 24

2.7.1 Call Forwarding 24

2.7.2 Closed User Group 25

2.7.3 Call Barring 25

2.8 Barring of services in I-WLAN 25

2.8.1 Change of Barring in the HSS 26

2.8.2 Barring of interworked packet services in I-WLAN 26

2.8.3 Barring of W-APN Activation in I-WLAN 27

2.8.4 Barring of public Internet access in I-WLAN 27

2.9 Barring of Access to All Except Some Specific DNNs/APNs 27

2.9.1 General 27

2.9.2 Application or Change of Barring in the UDM/HSS/HLR 28

2.9.3 Invocation of Barring 28

3 Information stored in location registers 28

3.1 Information stored in the HLR/HSS 28

3.1A Information stored in the UDM/UDR 30

3.2 Information stored in the VLR 31

3.3 Information stored in the SGSN 32

3.3A Information stored in the MME 32

3.4 Transfer of Subscription Information from HLR to VLR 33

3.5 Transfer of Subscription Information from HLR to SGSN 33

3.5A Transfer of Subscription Information from HSS to MME 33

3.6 I-WLAN Information stored in the HSS 34

3.7 Transfer of User Profile Data from HSS to 3GPP AAA Server 34

3.8 Information stored in the AMF/SMF 34

3.9 Transfer of Subscription Information from UDM to AMF/SMF 34

Annex A: Change History 36

 Foreword
========

This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).

The contents of the present document are subject to continuing work
within the TSG and may change following formal TSG approval. Should the
TSG modify the contents of the present document, it will be re-released
by the TSG with an identifying change of release date and an increase in
version number as follows:

Version x.y.z

where:

x the first digit:

1 presented to TSG for information;

2 presented to TSG for approval;

3 or greater indicates TSG approved document under change control.

y the second digit is incremented for all changes of substance, i.e.
technical enhancements, corrections, updates, etc.

z the third digit is incremented when editorial only changes have been
incorporated in the document.

In the present document, modal verbs have the following meanings:

**shall** indicates a mandatory requirement to do something

**shall not** indicates an interdiction (prohibition) to do something

The constructions \"shall\" and \"shall not\" are confined to the
context of normative provisions, and do not appear in Technical Reports.

The constructions \"must\" and \"must not\" are not used as substitutes
for \"shall\" and \"shall not\". Their use is avoided insofar as
possible, and they are not used in a normative context except in a
direct citation from an external, referenced, non-3GPP document, or so
as to maintain continuity of style when extending or modifying the
provisions of such a referenced document.

**should** indicates a recommendation to do something

**should not** indicates a recommendation not to do something

**may** indicates permission to do something

**need not** indicates permission not to do something

The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\"
are used instead, depending upon the meaning intended.

**can** indicates that something is possible

**cannot** indicates that something is impossible

The constructions \"can\" and \"cannot\" are not substitutes for \"may\"
and \"need not\".

**will** indicates that something is certain or expected to happen as a
result of action taken by an agency the behaviour of which is outside
the scope of the present document

**will not** indicates that something is certain or expected not to
happen as a result of action taken by an agency the behaviour of which
is outside the scope of the present document

**might** indicates a likelihood that something will happen as a result
of action taken by some agency the behaviour of which is outside the
scope of the present document

**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside
the scope of the present document

In addition:

**is** (or any other verb in the indicative mood) indicates a statement
of fact

**is not** (or any other negative verb in the indicative mood) indicates
a statement of fact

The constructions \"is\" and \"is not\" do not indicate requirements.

1 Scope
=======

The network feature Operator Determined Barring (ODB) allows a network
operator or service provider to regulate access by subscribers to
services (Circuit/Packet Oriented and Interworking WLAN), by the barring
of certain categories of incoming or outgoing calls/ Packet Oriented
Services or of roaming. Operator Determined Barring applies to all
bearer services and teleservices except the Emergency Call teleservice
and Emergency Bearer Services; the teleservice Short Message
Point-to-Point is therefore subject to Operator Determined Barring in
the same way as circuit-switched calls.

The application of specific categories of Operator Determined Barring to
a subscription is controlled by the network operator or service
provider, using administrative interaction at the HLR; this interface is
not standardised.

1.1 Normative references
------------------------

The following documents contain provisions which, through reference in
this text, constitute provisions of the present document.

\- References are either specific (identified by date of publication,
edition number, version number, etc.) or non‑specific.

\- For a specific reference, subsequent revisions do not apply.

\- For a non-specific reference, the latest version applies. In the case
of a reference to a 3GPP document (including a GSM document), a
non-specific reference implicitly refers to the latest version of that
document *in the same Release as the present document*.

\[1\] 3GPP TS 21.905: \"Abbreviations and acronyms\".

\[2\] 3GPP TS 22.041: \"Operator Determined Barring\".

\[3\] 3GPP TS 23.040: \"Technical realization of the Short Message
Service (SMS)\".

\[4\] 3GPP TS 23.060: \" General Packet Radio Service (GPRS) Service
description Stage 2\".

\[5\] 3GPP TS 29.234: Release 11 \"3GPP system to Wireless Local Area
Network (WLAN) interworking; stage 3\".

\[6\] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements
for Evolved Universal Terrestrial Radio Access Network (E-UTRAN)
access\".

\[7\] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".

1.2 Definitions and abbreviations
---------------------------------

Abbreviations used in this specification are listed in 3GPP TS 21.905.

2 Method of realisation
=======================

The entities which control the application of Operator Determined
Barring (ODB), and the methods used, are described in this clause. Two
cases are considered for each type of barring: the effect of
administrative action in the HLR to modify the application of the
category to a particular subscription, and the effect of the category on
the handling of calls or other traffic involving the subscriber.

2.1 Barring of Outgoing Calls or Mobile Originated Short Messages
-----------------------------------------------------------------

Barring of outgoing calls or mobile originated short messages includes
the categories \"outgoing calls\" and \"outgoing premium rate calls\"
defined in 3GPP TS 22.041 \[2\], and the \"operator specific barring\"
category where this is defined by the PLMN operator to apply to outgoing
calls or mobile originated short messages.

### 2.1.1 Application or Change of Barring in the HLR

If barring of outgoing calls or mobile originated short messages is
applied to a subscription (or existing barring of outgoing calls or
mobile originated short messages is modified or removed) by
administrative action in the HLR, the HLR will update the subscription
information accordingly, and transfer the updated subscription
information to the VLR and the SGSN using one or more Insert Subscriber
Data operations, as shown in figure 2.1.1/1.

If operator specific barring is applied to a subscription (or existing
operator specific barring is modified or removed) by administrative
action in the HLR, the HLR will update the subscription information
accordingly. If the mobile subscriber is registered in the home PLMN,
the HLR will transfer the updated subscription information to the VLR
and the SGSN using one or more Insert Subscriber Data operations, as
shown in figure2.1.1/ 1.

If the VPLMN does not support Operator Determined Barring of outgoing
calls, the VLR and the SGSN shall indicate this in the acknowledgement
of the Insert Subscriber Data message. The HLR shall then, as an
operator option, apply the Outgoing Calls Barred supplementary service,
apply barring of roaming as described in clause 2.3 or take any other
action decided by the operator of the HPLMN.

**MS MSC VLR or SGSN HLR\
**[ODB of outgoing calls applied, modified or removed]{.underline}

Insert\
Subscriber\
\<\-\-\-\-\-\-\-\-\-\--\
data

Figure 2.1.1/1: Transfer of updated subscription information to VLR or
SGSN

### 2.1.2 Invocation of Barring

Barring of outgoing calls or mobile originated short messages is invoked
in the VLR. If the VLR receives a request for subscription information
for an outgoing call or mobile originated short message which is
prohibited by Operator Determined Barring, the VLR will return a
negative response to the request for subscription information, with an
appropriate error indication. The MSC may relay this error indication
via the BSS/RNS to the mobile station over the radio path, or (in the
case of an outgoing call) may connect the mobile station to an address
to be determined by the network operator.

Barring of mobile originated short messages is invoked in the SGSN. If
the SGSN receives a request for a mobile originated short message which
is prohibited by Operator Determined Barring, the SGSN will return a
negative response to the request with an appropriate error indication
via the BSS/RNS to the mobile station over the radio path.

Barring of all international calls, barring of all international calls
except those directed to the home PLMN country, barring of all premium
rate (information) calls or barring of all premium rate (entertainment)
calls requires the VLR or the SGSN to analyse the called number to
determine whether the requested call is barred.

Barring of all outgoing calls when roaming outside the home PLMN country
requires the HLR to determine whether a request for location updating
originates from a PLMN outside the home PLMN country. If the request
does originate from a PLMN outside the home PLMN country, the HLR will
transfer subscription information to the requesting node to indicate
that the mobile station is subject to barring of all outgoing calls.

Operator Specific Barring may apply to outgoing or incoming calls, or
mobile originated or mobile terminated short messages; if it applies to
outgoing calls or mobile originated short messages, it is invoked in the
VLR or the SGSN, as described above. If the barring applies to calls
directed to a specific class of destination, the called number must be
analysed to determine whether the requested call is barred.

Indicative message flow diagrams for the handling of Operator Determined
Barring of outgoing calls or mobile originated short messages are given
in figures 2.1.2/1 and 2.1.2/2. For the case where the mobile station is
connected to an address determined by the network operator, this address
is assumed to be directly connected to the MSC, so that no inter-MSC
signalling is required.

**MS MSC VLR\
**[Outgoing call or MO SMS request barred because of ODB]{.underline}

O/G Request\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
Send Info for\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
O/G Call\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

[\
Operator option: error indication returned to MS]{.underline}

Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(Cause)

Figure 2.1.2/1: Operator Determined Barring of Outgoing Calls or Mobile
Originated Short Messages invocation in the VLR

**MS SGSN\
** [MO SMS request barred because of ODB]{.underline}

MO Short\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>

Message

[\
Error indication returned to MS]{.underline}

Reject

\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--

(cause)

Figure 2.1.2/2: Operator Determined Barring of Mobile Originated Short
Messages invocation in the SGSN

2.2 Barring of Incoming Calls or Mobile Terminated Short Messages
-----------------------------------------------------------------

### 2.2.1 Application or Change of Barring in the HLR

If barring of incoming calls or mobile terminated short messages is
applied to a subscription (or existing barring of incoming calls or
mobile terminated short messages is modified or removed) by
administrative action in the HLR, the HLR will update the subscription
information accordingly. It is not necessary to transfer the updated
subscription information to the VLR or the SGSN.

### 2.2.2 Invocation of Barring

Barring of incoming calls is invoked in the HLR. If the HLR receives a
request for routing information for a call directed to a mobile station
which is subject to barring of incoming calls, the HLR will return a
negative response to the request for routing information, with an
appropriate error indication. The Gateway MSC may relay this error
indication to the originating network using the appropriate telephony
signalling system, or may connect the call to a recorded announcement to
be determined by the network operator.

Barring of mobile terminated short messages is invoked in the HLR. If
the HLR receives a request for routing information for a short message
directed to a mobile station which is subject to barring of incoming
calls, the HLR will return a negative response to the request for
routing information, with an appropriate error indication. This error
indication will be relayed to the originating Short Message service
centre by the Gateway MSC using the protocol defined in 3GPP TS 23.040.

Operator Specific Barring may apply to outgoing or incoming calls, or
mobile originated or mobile terminated short messages; if it applies to
incoming calls or mobile terminated short messages, it is invoked in the
HLR, as described above.

An indicative message flow diagram for the handling of Operator
Determined Barring of incoming calls is given in figure 2.2.2/1. For the
case where the call is connected to an address determined by the network
operator, this address is assumed to be directly connected to the GMSC,
so that no inter-MSC signalling is required.

**HLR GMSC N/W\
**[Incoming call request barred because of ODB]{.underline}

Incoming call\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(address)\
Send routing\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
info request\
\
\
Reject\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
(cause)

[\
Operator option: error indication returned to network]{.underline}

Reject\
\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
(cause)

Figure 2.2.2/1: Operator Determined Barring of Incoming Calls

An indicative message flow diagram for the handling of Operator
Determined Barring of mobile terminated short messages is given in
figure 2.2.2/2.

**HLR SMS GMSC SMS SC\
**[MT short message request barred because of ODB]{.underline}

MT short\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
message\
Send routing\
info for SM\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
request\
\
Reject\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
(cause)\
\
Reject\
\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
(cause)

Figure 2.2.2/2: Operator Determined Barring of Mobile Terminated Short
Messages

2.3 Barring of Roaming
----------------------

### 2.3.1 Application or Change of Barring in the HLR/HSS/UDM

If barring of roaming is applied to a subscription (or modified or
removed) by administrative action in the HLR/HSS/UDM, the HLR/HSS/UDM
shall update the subscription information accordingly. If the
HLR/HSS/UDM determines from the identity of the VLR and/or the SGSN
and/or MME and/or the AMF that the mobile subscriber is currently
registered in a barred PLMN, the HLR/HSS/UDM shall put the barring into
effect by using a Cancel Location operation to the VLR and/or the SGSN
and /or to the MME when applied in HLR/HSS or a UECM Deregistration to
AMF when applied in UDM, as shown in figure 2.3.1/1. In the 5G Core
case, barring of roaming may be stored in UDR. Upon change of barring of
roaming in UDR, UDM clears also user registration in UDR using
Nudr\_DM\_Update operation and unsubscribes to changes on barring of
roaming data using Nudr\_DM\_Unsubscribe operation.

If the mobile subscriber is not currently registered in a barred PLMN,
the HLR/HSS/UDM shall take no further action.

**MS MSC VLR or SGSN or MME HLR/HSS\
**[ODB of roaming applied]{.underline}

Cancel\
\<\-\-\-\-\-\-\-\-\-\--\
location

Figure 2.3.1/1: Immediate Application of Barring of Roaming in HLR/HSS

**UE AMF UDM\
**[ODB of roaming applied]{.underline}

UECM Deregistration\
\<\-\-\-\-\-\-\-\-\--

Deregistration\
\<\-\-\-\-\-\-\-\-\--

Figure 2.3.1/2: Immediate Application of Barring of Roaming in UDM

### 2.3.2 Invocation of Barring

Barring of roaming is invoked in the HLR/HSS/UDM. If the HLR receives a
request from a VLR for location updating for a mobile which is
attempting to roam to an area prohibited by Operator Determined Barring,
the HLR shall reject the location updating request with an appropriate
error indication and this error indication shall be relayed by the MSC
and the BSS/RNS to the mobile station over the radio path. If the HLR
receives a request from a SGSN for location updating for a mobile which
is attempting to roam to an area prohibited by Operator Determined
Barring, the HLR shall reject the location updating request with an
appropriate error indication and this error indication shall be relayed
by the SGSN and the BSS/RNS to the mobile station over the radio path.
If the HSS receives a request from a MME for location updating for a
mobile which is attempting to roam to an area prohibited by Operator
Determined Barring, the HSS shall reject the location updating request
with an appropriate error indication and this error indication shall be
relayed by the MME to the mobile station over the radio path. If the UDM
receives a request from an AMF for 5G registration for a user equipment
who is attempting to roam to an area prohibited by Operator Determined
Barring, the UDM shall reject the registration request with an
appropriate error indication and this error indication shall be relayed
by the AMF to the user equipment over the radio path.

In the 5G Core case, barring of roaming can be optionally stored in UDR.
Upon change of barring of roaming in UDR, UDM clears also user
registration in UDR using Nudr\_DM\_Update operation and unsubscribes to
changes on barring of roaming data using Nudr\_DM\_Unsubscribe
operation.

Indicative message flow diagrams for the handling of Operator Determined
Barring of roaming are given in figures 2.3.2/1, 2.3.2/2, 2.3.2/3 and
2.3.2/4.

**MS MSC VLR HLR\
**[Roaming barred because of ODB]{.underline}

LR request\
\-\-\-\-\-\-\-\-\-\-\-\--\>\
Location update\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
request Update\
Location\
\-\-\-\-\-\-\-\-\-\--\>\
request\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\--\
(cause)\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.3.2/1: Operator Determined Barring of Roaming invocation in
HLR. Roaming in a prohibited VLR

**MS SGSN HLR\
**[Roaming barred because of ODB]{.underline}

LR request\
\-\-\-\-\-\-\-\-\-\-\-\--\>\
GPRS Update

Location\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
request

Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.3.2/2: Operator Determined Barring of Roaming invocation in
HLR. Roaming in a prohibited SGSN

**MS MME HSS\
**[Roaming barred because of ODB]{.underline}

LR request\
\-\-\-\-\-\-\-\-\-\-\-\--\>\
Update

Location\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
request

Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.3.2/3: Operator Determined Barring of Roaming invocation in
HSS. Roaming in a prohibited MME

**UE AMF UDM\
**[Roaming barred because of ODB]{.underline}

Registration request\
\-\-\-\-\-\-\-\-\-\-\-\--\>\
UECM Registration\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
request

Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.3.2/4: Operator Determined Barring of Roaming invocation in
UDM. Roaming in a prohibited AMF

2.4 Barring of Supplementary Services Access
--------------------------------------------

Barring of supplementary services access encompasses the general barring
of supplementary services management category specified in 3GPP
TS 22.041 \[2\] and the specific categories of barring of registration
of a call forwarded-to number and barring of invocation of call
transfer.

### 2.4.1 Application or Change of Barring in the HLR

If barring of supplementary services access is applied to a subscription
(or existing barring of supplementary services access is modified or
removed) by administrative action in the HLR, the HLR will update the
subscription information accordingly, and, if necessary, transfer the
updated subscription information to the VLR using one or more Insert
Subscriber Data operations, as shown in figure 2.1.1/1.

If the VPLMN does not support Operator Determined Barring of
supplementary service access, the VLR shall indicate this in the
acknowledgement to the Insert Subscriber Data message. The HLR shall
then, as an operator option, apply barring of roaming as described in
clause 2.3 or take any other action decided by the operator of the
HPLMN.

### 2.4.2 Invocation of Barring

Barring of supplementary services access is invoked in the HLR or the
VLR, depending on the supplementary service operation.

Barring of access to the following supplementary service operations is
invoked in the HLR:

\- registration;

\- erasure;

\- activation;

\- deactivation;

\- password registration;

\- processing unstructured SS data.

An indicative message flow diagram for the handling in the HLR of
Operator Determined Barring of access to supplementary services is given
in figure 2.4.2/1.

**MS MSC VLR HLR\
**[Access to Supplementary Services barred because of ODB]{.underline}

SS request\
\-\-\-\-\-\-\-\-\-\-\-\--\>\
SS activity\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
request\
SS\
activity\
\-\-\-\-\-\-\-\-\-\--\>\
request\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\--\
(cause)\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.4.2/1: Operator Determined Barring of Access to Supplementary
Services in the HLR

NOTE 1: Although the HLR handles interrogation of some supplementary
services, Operator Determined Barring of interrogation of all
supplementary services is invoked in the VLR. This reduces the amount of
analysis which the VLR must perform on supplementary service requests
before deciding whether to relay a supplementary service request to the
HLR or reject it because of Operator Determined Barring of access to
supplementary services. Operator Determined Barring of control of PLMN
specific supplementary services is invoked in the VLR for the same
reason.

NOTE 2: Although the VLR handles some processing of unstructured SS
data, and therefore has to check for Operator Determined Barring of
access to supplementary services, a check is also specified in the HLR
to guard against the case where the VLR does not support Operator
Determined Barring of access to supplementary services.

Barring of access to the following supplementary service operations is
invoked in the VLR:

\- interrogation;

\- invocation;

\- control of PLMN specific supplementary services;

\- processing unstructured SS data.

An indicative message flow diagram for the handling in the VLR of
Operator Determined Barring of access to supplementary services is given
in figure 2.4.2/2.

**MS MSC VLR\
**[Access to Supplementary Services barred because of ODB]{.underline}

SS request\
\-\-\-\-\-\-\-\-\-\-\-\--\>\
SS activity\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
request\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(Cause)

Figure 2.4.2/2: Operator Determined Barring of Access to Supplementary
Services in the VLR

### 2.4.3 Operator Determined Barring of access to supplementary service not supported in VLR

If the VLR does not support Operator Determined Barring of access to
supplementary services the HLR shall take the following actions:

The VLR supports only phase 1:

If the HLR receives a request which should normally be barred by the VLR
the HLR shall reject the request with the appropriate phase 1 error
(illegal SS operation or system failure).

The VLR supports phase 2 but does not support this Operator Determined
Barring category:

If the HLR receives a request which should normally be barred by the VLR
the HLR shall reject the request instead of the VLR.

Note that requests handled locally by the VLR (e.g. interrogation) will
not be barred.

2.5 Barring of MS initiated PDP context activation
--------------------------------------------------

Barring of MS initiated PDP context activation shall be performed based
on the Operator Determined Barring for Packet Oriented Services defined
in 3G TS 22.041 \[2\].

### 2.5.1 Application or Change of Barring in the HLR

If barring of Packet Oriented Services is applied to a subscription (or
existing barring of Packet Oriented Services is modified or removed) by
administrative action in the HLR, the HLR will update the subscription
information accordingly, and transfer the updated subscription
information to the SGSN using one or more Insert Subscriber Data
operations, as shown in figure 2.5.1/1.

If the VPLMN does not support Operator Determined Barring of Packet
Oriented Services, the SGSN shall indicate this in the acknowledgement
of the Insert Subscriber Data message. The HLR shall then, as an
operator option, apply barring of roaming as described in clause 2.3 or
take any other action decided by the operator of the HPLMN.

**MS SGSN HLR\
**[ODB of Packet Oriented Services applied, modified or
removed]{.underline}

Insert\
Subscriber\
\<\-\-\-\-\-\-\-\-\-\--\
data

Figure 2.5.1/1: Transfer of updated subscription information to SGSN

### 2.5.2 Invocation of Barring

Barring of MS initiated PDP context activation is invoked in the SGSN.
If the SGSN receives a request for an MS initiated PDP context
activation which is prohibited by Operator Determined Barring, the SGSN
will return a negative response to the request with an appropriate error
indication via the BSS/RNS to the mobile station over the radio path.

NOTE: Barring of MS initiated PDP context activation for Packet Oriented
Services is not applicable for Local IP Access (LIPA).

Barring of MS initiated PDP context activation is performed in the SGSN
while the SGSN selects the APN and GGSN. The APN operator identifier, a
part of selected APN is referred to make a judgement whether to be
barred or not. The detail mechanism of the ODB judgement is specified in
the 3G TS 23.060 \[4\].

Indicative message flow diagram for the handling of Operator Determined
Barring of MS initiated PDP context activation is given in figures
2.5.2/1.

**MS SGSN\
**[MS initiated PDP context activation barred because of
ODB]{.underline}

Activate PDP\
context request\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.5.2/1: Operator Determined Barring of MS initiated PDP context
activation in the SGSN

2.5A Barring of EPS Bearer context establishment
------------------------------------------------

Barring of EPS Bearer context establishment shall be performed based on
the Operator Determined Barring for Packet Oriented Services defined in
3GPP TS 22.041 \[2\].

### 2.5A.1 Application or Change of Barring in the HSS

If barring of Packet Oriented Services is applied to a subscription (or
existing barring of Packet Oriented Services is modified or removed) by
administrative action in the HSS, the HSS shall update the subscription
information accordingly, and transfer the updated subscription
information to the MME using one or more Insert Subscriber Data
operations, as shown in figure 2.5A.1/1.

If the VPLMN does not support Operator Determined Barring of Packet
Oriented Services, the MME shall indicate this in the acknowledgement of
the Insert Subscriber Data message. The HSS shall then, as an operator
option, apply barring of roaming as described in clause 2.3 or take any
other action decided by the operator of the HPLMN.

**MS MME HSS\
**[ODB of Packet Oriented Services applied, modified or
removed]{.underline}

Insert\
Subscriber\
\<\-\-\-\-\-\-\-\-\-\--\
data

Figure 2.5A.1/1: Transfer of updated subscription information to MME

### 2.5A.2 Invocation of Barring

Barring of EPS Bearer context establishment is invoked in the MME. If
the MME receives from an UE connected over E-UTRAN an attach or PDN
connectivity request which is prohibited by Operator Determined Barring,
the MME shall return a negative response to the request with an
appropriate error indication to the UE over the E-UTRAN radio path.

NOTE: Barring of EPS Bearer context establishment for Packet Oriented
Services is not applicable for Local IP Access (LIPA).

For subscribers completely barred from the Packet Oriented Services, the
MME shall reject attach requests.

Barring of EPS Bearer context establishsment for other barring
categories for the Packet Oriented Services requires the MME to selects
the APN and PDN-GW before it can determine whether a request for EPS
Bearer context establishment shall be barred or not:

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the HPLMN whilst the subscriber is roaming
in a VPLMN\", MME shall check whether or not the subscriber is located
in the HPLMN. If it is not and the PDN-GW being accessed is located in
HPLMN, then the MME shall reject the attach or PDN connectivity request,

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the roamed to VPLMN\", MME shall check
whether or not the subscriber is located in the HPLMN. If it is not and
the PDN-GW being accessed is located in VPLMN, then the MME shall reject
the attach or PDN connectivity request.

Indicative message flow diagram for the handling of Operator Determined
Barring of EPS Bearer context establishment is given in figures
2.5A.2/1.

**UE MME\
**[E-UTRAN PDN connectivity barred because of ODB]{.underline}

Attach Request, or

PDN Connectivity request\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.5A.2/1: Operator Determined Barring of EPS Bearer Context
Establishment in the MME

2.5B Barring of PDU Session establishment
-----------------------------------------

Barring of PDU Session establishment shall be performed based on the
Operator Determined Barring for Packet Oriented Services defined in 3GPP
TS 22.041 \[2\].

### 2.5B.1 Application or Change of Barring in the UDM

If barring of Packet Oriented Services is applied to a subscription (or
existing barring of Packet Oriented Services is modified or removed) by
administrative action in the UDM, the UDM shall update the subscription
information accordingly, and transfer the updated subscription
information to the AMF/SMF using Nudm\_SDM Notification operation, as
shown in figure 2.5B.1/1.

**MS AMF or SMF UDM\
**[ODB of Packet Oriented Services applied, modified or
removed]{.underline}

Nudm\_SDM\
Notification\
\<\-\-\-\-\-\-\-\-\-\--

Figure 2.5B.1/1: Transfer of updated subscription information to AMF/SMF

### 2.5B.2 Invocation of Barring

Barring of PDU Session establishment is invoked in the SMF. If the SMF
receives from an UE connected over 5GS a PDU Session connectivity
request which is prohibited by Operator Determined Barring, the SMF
shall return a negative response to the request with an appropriate
error indication to the UE over the 5G radio path.

NOTE: Barring of PDU Session establishment for Packet Oriented Services
is not applicable for Local Access Data Network (LADN).

For subscribers completely barred from the Packet Oriented Services, the
AMF may reject the registration requests.

Barring of PDU Session establishsment for other barring categories for
the Packet Oriented Services, SMF determines whether a request for PDU
Session establishment shall be barred or not:

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the HPLMN whilst the subscriber is roaming
in a VPLMN\", if the subscriber is not located in the HPLMN and the SMF
being accessed is located in HPLMN, then the SMF shall reject the PDU
connectivity request,

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the roamed to VPLMN\", if the subscriber
is not located in the HPLMN and the SMF being accessed is located in
VPLMN, then the SMF shall reject the PDU connectivity request.

Indicative message flow diagram for the handling of Operator Determined
Barring of PDU Session establishment is given in figures 2.5B.2/1.

**UE SMF\
**[5G PDU connectivity barred because of ODB]{.underline}

PDU Connectivity request\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.5B.2/1: Operator Determined Barring of PDU Session
Establishment in the SMF

2.6 Barring of Network initiated PDP context activation
-------------------------------------------------------

Barring of Network initiated PDP context activation shall be performed
based on the Operator Determined Barring for Packet Oriented Services
defined in 3G TS 22.041 \[2\].

### 2.6.1 Application or Change of Barring in the HLR

If barring of Packet Oriented Services is applied to a subscription (or
existing barring of Packet Oriented Services is modified or removed) by
administrative action in the HLR, the HLR will update the subscription
information accordingly. It is not necessary to transfer the updated
subscription information to the SGSN.

### 2.6.2 Invocation of Barring

Barring of Network initiated PDP context activation is invoked in the
HLR. If the HLR receives a request for routing information for a PDP
context activation directed to a mobile station which is subject to
barring of Packet Oriented Services, the HLR will return a negative
response to the request for routing information, with an appropriate
error indication. The GGSN may relay this error indication to the PDP
PDU incoming network using the appropriate interworking.

An indicative message flow diagram for the handling of Operator
Determined Barring of Network initiated PDP context activation is given
in figure 2.6.2/1.

**HLR GGSN N/W\
**[Network initiated PDP context activation barred because of
ODB]{.underline}

Incoming PDP PDU\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(address)\
Send routing\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
info request\
for GPRS\
\
Reject\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
(cause)

[\
Operator option: error indication returned to network]{.underline}

Reject\
\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
(cause)

Figure 2.6.2/1: Operator Determined Barring of Network initiated PDP
context activation

2.6A Barring of existing PDP contexts
-------------------------------------

Barring of existing PDP contexts shall be performed based on the
Operator Determined Barring for Packet Oriented Services defined in 3G
TS 22.041 \[2\].

### 2.6A.1 Application or Change of Barring in the HLR

If barring of Packet Oriented Services is applied to a subscription (or
existing barring of Packet Oriented Services is modified or removed) by
administrative action in the HLR, the HLR will update the subscription
information accordingly, and transfer the updated subscription
information to the SGSN using one or more Insert Subscriber Data
operations, as shown in figure 2.6A.1/1.

If the VPLMN does not support Operator Determined Barring of Packet
Oriented Services, the SGSN shall indicate this in the acknowledgement
of the Insert Subscriber Data message. The HLR shall then, as an
operator option, apply barring of roaming as described in clause 2.3 or
take any other action decided by the operator of the HPLMN.

**MS SGSN HLR\
**[ODB of Packet Oriented Services applied, modified or
removed]{.underline}

Insert\
Subscriber\
\<\-\-\-\-\-\-\-\-\-\--\
data

Figure 2.6A.1/1: Transfer of updated subscription information to SGSN

### 2.6A.2 Invocation of Barring

Barring of existing PDP contexts is invoked in the SGSN. If the SGSN
receives Insert Subsciber Data message due to barring of Packet Oriented
Services is applied to a subscription (or existing barring of Packet
Oriented Services is modified or removed) by administrative action in
the HLR, the SGSN shall take the following action depending on barring
category when one or more PDP contexts exist in SGSN.

\- For \"bar subscribers completely from the Packet Oriented Services\",
SGSN shall deactivate all existing PDP contexts.

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the HPLMN whilst the subscriber is roaming
in a VPLMN\", SGSN shall check whether or not the subscriber is located
in the HPLMN. If it is not and the GGSN being accessed is located in
HPLMN, then all associated PDP contexts with this path shall be
deactivated..

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the roamed to VPLMN\", SGSN shall check
whether or not the subscriber is located in the HPLMN. If it is not and
the GGSN being accessed is located in VPLMN, then all associated PDP
contexts with this path shall be deactivated.

NOTE: Barring of existing PDP contexts for Packet Oriented Services is
not applicable for Local IP Access (LIPA).

2.6B Barring of existing EPS Bearer contexts
--------------------------------------------

Barring of existing EPS Bearer contexts shall be performed based on the
Operator Determined Barring for Packet Oriented Services defined in 3GPP
TS 22.041 \[2\].

### 2.6B.1 Application or Change of Barring in the HSS

If barring of Packet Oriented Services is applied to a subscription (or
existing barring of Packet Oriented Services is modified or removed) by
administrative action in the HSS, the HSS shall update the subscription
information accordingly, and transfer the updated subscription
information to the MME using one or more Insert Subscriber Data
operations, as shown in figure 2.6B.1/1.

If the VPLMN does not support Operator Determined Barring of Packet
Oriented Services, the MME shall indicate this in the acknowledgement of
the Insert Subscriber Data message. The HSS shall then, as an operator
option, apply barring of roaming as described in clause 2.3 or take any
other action decided by the operator of the HPLMN.

**UE MME HSS\
**[ODB of Packet Oriented Services applied, modified or
removed]{.underline}

Insert\
Subscriber\
\<\-\-\-\-\-\-\-\-\-\--\
data

Figure 2.6B.1/1: Transfer of updated subscription information to MME

### 2.6B.2 Invocation of Barring

Barring of existing EPS Bearer contexts is invoked in the MME. If the
MME receives Insert Subscriber Data message due to barring of Packet
Oriented Services being applied to a subscription (or existing barring
of Packet Oriented Services is modified) by administrative action in the
HSS, the MME shall take the following action depending on barring
category when one or more EPS Bearer contexts exist in MME.

\- For \"bar subscribers completely from the Packet Oriented Services\",
MME shall deactivate all existing EPS Bearer contexts.

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the HPLMN whilst the subscriber is roaming
in a VPLMN\", MME shall check whether or not the subscriber is located
in the HPLMN. If it is not and the PDN-GW being accessed is located in
HPLMN, then all associated EPS Bearer contexts with this path shall be
deactivated.

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the roamed to VPLMN\", MME shall check
whether or not the subscriber is located in the HPLMN. If it is not and
the PDN-GW being accessed is located in VPLMN, then all associated EPS
Bearer contexts with this path shall be deactivated.

NOTE: Barring of existing EPS Bearer contexts for Packet Oriented
Services is not applicable for Local IP Access (LIPA).

2.6C Barring of existing PDU Sessions
-------------------------------------

Barring of existing PDU Sessions shall be performed based on the
Operator Determined Barring for Packet Oriented Services defined in 3GPP
TS 22.041 \[2\].

### 2.6C.1 Application or Change of Barring in the UDM

If barring of Packet Oriented Services is applied to a subscription (or
existing barring of Packet Oriented Services is modified or removed) by
administrative action in the UDM, the UDM shall update the subscription
information accordingly, and transfer the updated subscription
information to the AMF using Nudm\_SDM Notification operation, as shown
in figure 2.6C.1/1.

**UE AMF UDM\
**[ODB of Packet Oriented Services applied, modified or
removed]{.underline}

Nudm\_SDM\
Notification\
\<\-\-\-\-\-\-\-\-\-\--

Figure 2.6C.1/1: Transfer of updated subscription information to AMF

### 2.6C.2 Invocation of Barring

Barring of existing PDU Sessions is invoked in the AMF. If the AMF
receives Nudm\_SDM Notification message due to barring of Packet
Oriented Services being applied to a subscription (or existing barring
of Packet Oriented Services is modified) by administrative action in the
UDM, the AMF shall take the following action depending on barring
category when one or more PDU Sessions exist in AMF.

\- For \"bar subscribers completely from the Packet Oriented Services\",
AMF shall release all existing PDU Sessions.

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the HPLMN whilst the subscriber is roaming
in a VPLMN\", AMF shall check whether or not the subscriber is located
in the HPLMN. If it is not and the SMF being accessed is located in
HPLMN, then all associated PDU Sessions with this path shall be
released.

\- For \"bar a subscriber from requesting Packet Oriented Services from
access points that are within the roamed to VPLMN\", AMF shall check
whether or not the subscriber is located in the HPLMN. If it is not and
the SMF being accessed is located in VPLMN, then all associated PDU
sessions with this path shall be released.

NOTE: Barring of existing EPS Bearer contexts for Packet Oriented
Services is not applicable for Local Access Data Network (LADN).

2.7 Interactions of Operator Determined Barring with Supplementary Services
---------------------------------------------------------------------------

The following interactions of Operator Determined Barring with
supplementary services have been identified:

### 2.7.1 Call Forwarding

The interactions between Operator Determined Barring and Call Forwarding
are specified in 3GPP TS 22.041 \[2\].

The interaction where Operator Determined Barring is applied when there
is an existing Call Forwarding programme which is in contravention of
the Operator Determined Barring programme is shown in the message flow
diagram in figure 2.7.1/1. The HLR modifies the subscription information
for the mobile subscriber to show that the contravening call forwarding
programme is quiescent, and forwards the modified subscription
information to the VLR. No indication is forwarded to the mobile station
or the user.

**MS MSC VLR HLR\
**[ODB applied when Call Forwarding programme contravenes
ODB]{.underline}

Insert\
Subscriber\
\<\-\-\-\-\-\-\-\-\-\--\
data

Figure 2.7.1/1: Effect of Operator Determined Barring on Call Forwarding
programme

The interaction where the user attempts to activate or register a call
forwarding programme which is in contravention of an operator determined
barring category is shown in the message flow diagram in figure 2.7.1/2.

**MS MSC VLR HLR\
**[Request for Call Forwarding programme contravening ODB]{.underline}

SS request\
(register or\
\-\-\-\-\-\-\-\-\-\-\-\--\>\
activate CF)\
SS activity\
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\>\
request\
SS\
activity\
\-\-\-\-\-\-\-\-\-\--\>\
request\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\--\
(cause)\
\
Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

[Operator option: error indication returned to MS]{.underline}

Reject\
\<\-\-\-\-\-\-\-\-\-\-\-\--\
(cause)

Figure 2.7.1/2: Interaction between Operator Determined Barring and Call
Forwarding

### 2.7.2 Closed User Group

The interaction between Operator Determined Barring and Closed User
Group is specified in 3GPP TS 22.041 \[2\]. In order to meet the service
requirement, the checks of a call request in the HLR (for incoming
calls) or VLR (for outgoing calls) against the Operator Determined
Barring programme shall be carried out before the checks for Closed User
Group.

### 2.7.3 Call Barring

The interaction between Operator Determined Barring and the Call Barring
supplementary service is specified in 3GPP TS 22.041 \[2\]. In order to
meet the service requirement, the checks of a call request in the HLR
(for incoming calls) or VLR (for outgoing calls) against the Operator
Determined Barring programme shall be carried out before the checks for
the Call Barring supplementary service.

2.8 Barring of services in I-WLAN
---------------------------------

NOTE: The WLAN Network Selection and WLAN/3GPP Radio Interworking
features supersede the I-WLAN feature from Rel-12 onwards, therefore all
I-WLAN related requirements specified in the present Clause are no
longer maintained.

Barring of interworked services in I-WLAN upon the activation of W-APN
shall be performed based on the Operator Determined Barring for Packet
Oriented Services as defined in 3GPP TS 29.234 \[5\].

### 2.8.1 Change of Barring in the HSS

If barring of Packet Oriented Services for I-WLAN is applied to a
subscription (or existing barring of Packet Oriented Services is
modified or removed) by administrative action in the HSS, the HSS shall
update the subscription information accordingly. It is necessary to
transfer the updated User Profile Data and subscription information to
the 3GPP AAA Server if the subscriber is currently using interworked
WLAN services. After downloading the update User Profile Data the 3GPP
AAA Server shall initiate re-authorization of the W-APN if there is an
existing connection established. The HSS initiated User Profile Data
update indication followed by the 3GPP AAA Server download of the
updated User Profile Data and re-authorization request is shown in the
message flow diagram in Figure 2.8.1/1.

**WLAN-UE (Visited/Home) PDG 3GPP AAA Server HSS\
**[ODB of Packet Oriented Services applied, modified or
removed]{.underline}

Update of\
User Profile\
\<\-\-\-\-\-\-\-\-\-\--\
data

Download

User Profile\
\<\-\-\-\-\-\-\-\-\-\--\>\
data

Re-authorization Request\
if there is existing W-APN\
connection established\
\<\-\-\-\-\-\-\-\-\-\--

Figure 2.8.1/1: Transfer of updated User profile Data to 3GPP AAA Server

### 2.8.2 Barring of interworked packet services in I-WLAN

The interactions between Operator Determined Barring and W-APN
activation/authorization are specified in 3GPP TS 29.234 \[5\].

Barring of interworked WLAN packet services is invoked in the 3GPP AAA
Server. If the 3GPP AAA Server receives a request for a W-APN
activation/authorization which is prohibited by Operator Determined
Barring, the 3GPP AAA Server shall return a negative response to the
request with an appropriate error code.

Indicative message flow diagram for the handling of Operator Determined
Barring of interworked WLAN packet services is given in figure 2.8.2/1.

**WLAN-UE (Visited/Home) PDG 3GPP AAA Server HSS\
**[Activation of W-APN when interworked packet services are
barred]{.underline}

W-APN (re-)authorization\
\-\-\-\-\-\-\-\-\-\--\>\
\
Authorization Reject\
\<\-\-\-\-\-\-\-\-\-\--

Figure 2.8.2/1: Authorization attempt of a interworked packet services
when the WLAN-UE is connecting via a PDG located either in Visited or
Home PLMN

### 2.8.3 Barring of W-APN Activation in I-WLAN

The interactions between Operator Determined Barring and W-APN
activation/authorization are specified in 3GPP TS 29.234 \[5\].

Barring of specific W-APN is invoked in the 3GPP AAA Server. If the 3GPP
AAA Server receives a request for a W-APN activation/authorization which
is prohibited by Operator Determined Barring, the 3GPP AAA Server shall
return a negative response to the request with an appropriate error
code.

Indicative message flow diagram for the handling of Operator Determined
Barring of a specific W-APN is given in figure 2.8.3/1.

**WLAN-EU (Visited/Home) PDG 3GPP AAA Server HSS\
**[Activation of W-APN when the said W-APN is barred]{.underline}

W-APN (re-)authorization\
\-\-\-\-\-\-\-\-\-\--\>\
\
Authorization Reject\
\<\-\-\-\-\-\-\-\-\-\--

Figure 2.8.3/1: Authorization attempt of a W-APN when the WLAN-UE is
connecting via a PDG located either in Visited or Home PLMN

### 2.8.4 Barring of public Internet access in I-WLAN

The interactions between Operator Determined Barring and W-APN
activation/authorization are specified in 3GPP TS 29.234 \[5\].

Barring of specific public Internet access through a specific W-APN is
invoked in the 3GPP AAA Server. If the 3GPP AAA Server receives a
request for a W-APN activation/authorization where public Internet
access is prohibited by Operator Determined Barring, the 3GPP AAA Server
shall return a positive response to the request with appropriate routing
policies that allow the PDG filter IP traffic to or from public
Internet.

Indicative message flow diagram for the handling of Operator Determined
Barring of a specific W-APN is given in figure 2.8.4/1.

**WLAN-EU (Visited/Home) PDG 3GPP AAA Server HSS\
**[Activation of W-APN when access to public Internet is
barred]{.underline}

W-APN (re-)authorization\
\-\-\-\-\-\-\-\-\-\--\>\
\
Authorization Accept and\
Routing Policy Download\
\<\-\-\-\-\-\-\-\-\-\--

Figure 2.8.4/1: Authorization of a W-APN when public Internet access is
barred

2.9 Barring of Access to All Except Some Specific DNNs/APNs
-----------------------------------------------------------

### 2.9.1 General

Barring of access to all except some specific DNNs/APNs shall be
performed based on the Operator Determined Barring for Packet Oriented
Services defined in 3GPP TS 22.041 \[2\].

### 2.9.2 Application or Change of Barring in the UDM/HSS/HLR

When barring of access to all except some specific DNNs/APNs is invoked
in the UDM/HSS/HLR, the UDM/HSS/HLR shall update the subscription
profile to contain only the specific non barred DNNs/APNs as the
subscribed DNNs/APNs and indicate the updated subscription information
to the AMF, SMF, MME or the SGSN.

If the existing default DNN/APN is barred, one of the specific non
barred DNN/APNs shall be the new default DNN/APN.

The UDM/HSS/HLR shall disable any other barring of Packet Oriented
Services when this function is used.

When barring of access to all except some specific DNNs/APNs is removed
in the UDM/HSS/HLR, the UDM/HSS/HLR shall update the subscription
profile to restore the originally subscribed DNNs/APNs, including the
original default DNN/APN and indicate the updated subscription
information to the AMF, the MME or the SGSN.

### 2.9.3 Invocation of Barring

When the AMF, the SMF, the MME or the SGSN updates the subscription, and
if the subscriber has existing PDN connectivity for DNNs/APNs not in the
received list of subscribed DNN/APN, the SMF, MME or the SGSN
deactivates the PDU/PDN connectivity for these DNNs/APNs as specified in
3GPP TS 23.502 \[7\], 3GPP TS 23.401 \[6\] and 3GPP TS 23.060 \[7\].

To bar a subscriber from access to all except some specific DNNs/APNs,
when the AMF, the MME or the SGSN receives PDU/PDN Connectivity Request
message from the UE or the MS, the AMF, the MME or the SGSN shall check
whether or not the requested DNN/APN is included in the list of
subscribed DNNs/APNs for the subscriber. If included, then the AMF, the
MME or the SGSN continues the Attach or UE-requested PDU/PDN
connectivity or MS-requested PDP Context Activation procedures as
specified in 3GPP TS 23.502 \[7\], 3GPP TS 23.401 \[6\] and 3GPP
TS 23.060 \[7\]. If not included, then the AMF, the MME or the SGSN
rejects the Attach or UE-requested PDU/PDN connectivity or MS-requested
PDP Context Activation requests as specified in 3GPP TS 23.502 \[7\],
3GPP TS 23.401 \[6\] and 3GPP TS 23.060 \[7\].

3 Information stored in location registers
==========================================

3.1 Information stored in the HLR/HSS
-------------------------------------

The HLR must store subscription information for each mobile subscriber
to define which of the following categories of barring is to be applied,
independently of each other:

Barring of outgoing calls (including mobile originated short messages) -
one of:

\- Barring of all outgoing calls;

\- Barring of all outgoing international calls;

\- Barring of all outgoing international calls except those directed to
the home PLMN country;

\- Barring of all outgoing calls when roaming outside the home PLMN
country;

\- Barring of all outgoing inter-zonal calls;

\- Barring of all outgoing inter-zonal calls except those directed to
the home PLMN country;

\- Barring of all outgoing international calls except those directed to
the home PLMN country AND barring of all outgoing inter-zonal calls.

Barring of incoming calls (including mobile terminated short messages) -
one of:

\- Barring of all incoming calls;

\- Barring of all incoming calls when roaming outside the home PLMN
country;

\- Barring of all incoming calls when roaming outside the zone of the
home PLMN country.

Barring of roaming - one of:

\- Barring of roaming outside the home PLMN;

\- Barring of roaming outside the home PLMN country.

Barring of outgoing premium rate calls - one or both of:

\- Barring of outgoing premium rate (information) calls;

\- Barring of outgoing premium rate (entertainment) calls.

Barring specific to the home PLMN - when the mobile station is
registered in its home PLMN, any one or more of:

\- Operator Specific Barring (Type 1);

\- Operator Specific Barring (Type 2);

\- Operator Specific Barring (Type 3);

\- Operator Specific Barring (Type 4).

Barring of Supplementary Services Management.

Barring of registration of call forwarding - one of:

\- Barring of registration of any forwarded-to number;

\- Barring of registration of any international forwarded-to number;

\- Barring of registration of any international forwarded-to number
except a number within the HPLMN country;

\- Barring of registration of any inter-zonal forwarded-to number;

\- Barring of registration of any inter-zonal forwarded-to number except
a number within the HPLMN country.

Barring of invocation of call transfer:

one of:

\- Barring of invocation of any call transfer;

\- Barring of invocation of call transfer where at least one of the two
calls is a call charged to the served subscriber;

\- Barring of invocation of call transfer where at least one of the two
calls is a call charged to the served subscriber at international rates,
i.e. the call is either an outgoing international call or an incoming
call when the served subscriber roams outside the HPLMN country;

\- Barring of invocation of call transfer where at least one of the two
calls is a call charged to the served subscriber at inter-zonal rates,
i.e. the call is either an outgoing inter-zonal call or an incoming call
when the served subscriber roams to a VPLMN in a different zone from the
HPLMN;

and independently:

\- Barring of invocation of call transfer where both calls are calls
charged to the served subscriber;

and independently:

\- Barring of invocation of call transfer when there is an existing
transferred call for the served subscriber in the same MSC/VLR.

Barring of Packet Oriented Services - one of:

\- Barring of all Packet Oriented Services;

\- Barring of Packet Oriented Services from access points that are
within the HPLMN whilst the subscriber is roaming in a VPLMN;

\- Barring of Packet Oriented Services from access points that are
within the roamed to VPLMN;

\- Barring of access to all except some specific APNs.

3.1A Information stored in the UDM/UDR
--------------------------------------

Barring of roaming - one of:

\- Barring of roaming outside the home PLMN;

\- Barring of roaming outside the home PLMN country.

\- Barring of Packet Oriented Services - one of:

\- Barring of all Packet Oriented Services;

\- Barring of Packet Oriented Services from access points that are
within the HPLMN whilst the subscriber is roaming in a VPLMN;

\- Barring of Packet Oriented Services from access points that are
within the roamed to VPLMN;

\- Barring of access to all except some specific DNNs.

3.2 Information stored in the VLR
---------------------------------

The VLR must store subscription information for each mobile subscriber
to define which of the following categories of barring is to be applied,
independently of each other:

Barring of outgoing calls (including mobile originated short messages) -
one of:

\- Barring of all outgoing calls;

\- Barring of all outgoing international calls;

\- Barring of all outgoing international calls except those directed to
the home PLMN country;

\- Barring of all outgoing inter-zonal calls;

\- Barring of all outgoing inter-zonal calls except those directed to
the home PLMN country;

\- Barring of all outgoing international calls except those directed to
the home PLMN country AND barring of all outgoing inter-zonal calls.

Barring of outgoing premium rate calls - one or both of:

\- Barring of outgoing premium rate (information) calls;

\- Barring of outgoing premium rate (entertainment) calls.

Barring specific to the home PLMN - when the mobile station is
registered in its home PLMN, any one or more of:

\- Operator Specific Barring (Type 1);

\- Operator Specific Barring (Type 2);

\- Operator Specific Barring (Type 3);

\- Operator Specific Barring (Type 4).

Barring of Supplementary Services Management.

Barring of invocation of call transfer:

one of:

\- Barring of invocation of any call transfer;

\- Barring of invocation of call transfer where at least one of the two
calls is a call charged to the served subscriber;

\- Barring of invocation of call transfer where at least one of the two
calls is a call charged to the served subscriber at international rates,
i.e. the call is either an outgoing international call or an incoming
call when the served subscriber roams outside the HPLMN country;

\- Barring of invocation of call transfer where at least one of the two
calls is a call charged to the served subscriber at inter-zonal rates,
i.e. the call is either an outgoing inter-zonal call or an incoming call
when the served subscriber roams to a VPLMN in a different zone from the
HPLMN.

and independently:

\- Barring of invocation of call transfer where both calls are calls
charged to the served subscriber;

and independently:

\- Barring of invocation of call transfer when there is an existing
transferred call for the served subscriber in the same MSC/VLR.

3.3 Information stored in the SGSN
----------------------------------

The SGSN shall store subscription information for each mobile subscriber
to define which of the following categories of barring is to be applied,
independently of each other:

Barring of mobile originated short messages - one of:

\- Barring of all outgoing calls;

\- Barring of all outgoing international calls;

\- Barring of all outgoing international calls except those directed to
the home PLMN country;

\- Barring of all outgoing inter-zonal calls;

\- Barring of all outgoing inter-zonal calls except those directed to
the home PLMN country;

\- Barring of all outgoing international calls except those directed to
the home PLMN country AND barring of all outgoing inter-zonal calls.

Barring specific to the home PLMN of mobile originated short messages -
when the mobile station is registered in its home PLMN, any one or more
of:

\- Operator Specific Barring (Type 1);

\- Operator Specific Barring (Type 2);

\- Operator Specific Barring (Type 3);

\- Operator Specific Barring (Type 4).

Barring of Packet Oriented Services - one of:

\- Barring of all Packet Oriented Services;

\- Barring of Packet Oriented Services from access points that are
within the HPLMN whilst the subscriber is roaming in a VPLMN;

\- Barring of Packet Oriented Services from access points that are
within the roamed to VPLMN.

3.3A Information stored in the MME
----------------------------------

The MME shall store subscription information for each mobile subscriber
to define which of the following categories of barring is to be applied,
independently of each other:

Barring of mobile originated short messages - one of:

\- Barring of all outgoing calls;

\- Barring of all outgoing international calls;

\- Barring of all outgoing international calls except those directed to
the home PLMN country;

\- Barring of all outgoing inter-zonal calls;

\- Barring of all outgoing inter-zonal calls except those directed to
the home PLMN country;

\- Barring of all outgoing international calls except those directed to
the home PLMN country AND barring of all outgoing inter-zonal calls.

Barring specific to the home PLMN of mobile originated short messages -
when the mobile station is registered in its home PLMN, any one or more
of:

\- Operator Specific Barring (Type 1);

\- Operator Specific Barring (Type 2);

\- Operator Specific Barring (Type 3);

\- Operator Specific Barring (Type 4).

Barring of Packet Oriented Services - one of:

\- Barring of all Packet Oriented Services;

\- Barring of Packet Oriented Services from access points that are
within the HPLMN whilst the subscriber is roaming in a VPLMN;

\- Barring of Packet Oriented Services from access points that are
within the roamed to VPLMN.

3.4 Transfer of Subscription Information from HLR to VLR
--------------------------------------------------------

The following subscription information for Operator Determined Barring
must be transferred from the HLR to the VLR when a mobile station
registers in a VLR:

\- Barring of outgoing calls;

\- Barring of outgoing premium rate calls;

\- Barring of supplementary services management;

\- Barring of invocation of call transfer.

In addition, when a mobile station registers in a VLR in its home PLMN
the subscription information for Operator Determined Barring specific to
the home PLMN must be transferred from the HLR to the VLR.

3.5 Transfer of Subscription Information from HLR to SGSN
---------------------------------------------------------

The following subscription information for Operator Determined Barring
shall be transferred from the HLR to the SGSN when a mobile station
registers in a SGSN:

\- Barring of outgoing calls (which leads to barring of mobile
originated short messages).

The following subscription information for Operator Determined Barring
for Packet Oriented Services shall be transferred from the HLR to the
SGSN when a mobile station registers in a SGSN:

\- Barring of all Packet Oriented Services;

\- Barring of Packet Oriented Services from access points that are
within the HPLMN whilst the subscriber is roaming in a VPLMN;

\- Barring of Packet Oriented Services from access points that are
within the roamed to VPLMN.

In addition, when a mobile station registers in a SGSN in its home PLMN
the subscription information for Operator Determined Barring specific to
the home PLMN shall be transferred from the HLR to the SGSN.

3.5A Transfer of Subscription Information from HSS to MME
---------------------------------------------------------

The following subscription information for Operator Determined Barring
shall be transferred from the HLR to the MME when a mobile station
registers in a MME:

\- Barring of outgoing calls (which leads to barring of mobile
originated short messages).

The following subscription information for Operator Determined Barring
for Packet Oriented Services shall be transferred from the HSS to the
MME when a mobile station registers in a MME:

\- Barring of all Packet Oriented Services;

\- Barring of Packet Oriented Services from access points that are
within the HPLMN whilst the subscriber is roaming in a VPLMN;

\- Barring of Packet Oriented Services from access points that are
within the roamed to VPLMN.

In addition, when a mobile station registers in an MME in its home PLMN
the subscription information for Operator Determined Barring specific to
the home PLMN shall be transferred from the HLR to the MME.

3.6 I-WLAN Information stored in the HSS
----------------------------------------

The HSS shall store subscription information for each I-WLAN subscriber
to define which of the following categories of barring is to be applied,
independently of each other. These barring categories are applied to
WLAN 3GPP IP Access:

\- Barring of Interworking WLAN completely from the interworked service
capabilities.

\- Barring of a subscriber from requesting interworking through Packet
Data Gateways that are within the HPLMN whilst the subscriber is WLAN
connected via a VPLMN.

\- Barring a subscriber from requesting packet-oriented services from
Packet Data Gateways that are within the roamed to VPLMN.

\- Barring of a subscriber from requesting direct Internet access from
Packet Data Gateways that are within the I-WLAN.

3.7 Transfer of User Profile Data from HSS to 3GPP AAA Server
-------------------------------------------------------------

The following User Profile Data for Operator Determined Barring must be
transferred from the HSS to the 3GPP AAA Server when a WLAN-UE
authenticates to 3GPP AAA Server and the I-WLAN service:

\- Barring of Interworking WLAN completely from the interworked service
capabilities

\- Barring of a subscriber from requesting interworking through Packet
Data Gateways that are within the HPLMN whilst the subscriber is WLAN
connected via a VPLMN

\- Barring a subscriber from requesting packet-oriented services from
Packet Data Gateways that are within the roamed to VPLMN

\- Barring of a subscriber from requesting direct Internet access from
Packet Data Gateways that are within the I-WLAN

3.8 Information stored in the AMF/SMF
-------------------------------------

Barring of Packet Oriented Services - one of:

\- Barring of all Packet Oriented Services;

\- Barring of Packet Oriented Services from access points that are
within the HPLMN whilst the subscriber is roaming in a VPLMN;

\- Barring of Packet Oriented Services from access points that are
within the roamed to VPLMN.

3.9 Transfer of Subscription Information from UDM to AMF/SMF
------------------------------------------------------------

The following subscription information for Operator Determined Barring
for Packet Oriented Services shall be transferred from the UDM to the
AMF/SMF:

\- Barring of all Packet Oriented Services;

\- Barring of Packet Oriented Services from access points that are
within the HPLMN whilst the subscriber is roaming in a VPLMN;

\- Barring of Packet Oriented Services from access points that are
within the roamed to VPLMN.

In addition, when a mobile station registers in an AMF in its home PLMN
the subscription information for Operator Determined Barring specific to
the home PLMN shall be transferred from the UDM to the AMF/SMF.

########  Annex A: Change History

  ---------------- ----------- --------- -------- ----------- ------------- ---------------------------------------------------------------------------------------------
  Change history                                                            
  TSG CN\#         Spec        Version   CR       \<Phase\>   New Version   Subject/Comment
  Apr 1999         GSM 03.15   6.0.0                                        Transferred to 3GPP CN1
  CN\#03           23.015                                     3.0.0         Approved at CN\#03
  CN\#04           23.015      3.0.0     001                  3.1.0         Corrections to text to introduce barring of SMS calls for GPRS
  CN\#11           23.015      3.1.0              Rel-4       4.0.0         Version updated from R99 to Rel-4 after CN\#11
  CN\#11           23.015      3.1.0     002      Rel-4       4.0.0         Add PDP context activation barring scenario, etc
  CN\#15           23.015      4.0.0              Rel-4       4.0.1         References updated
  CN\#16           23.015      4.0.1              Rel-5       5.0.0         Release 5 after CN\#16
  CN\#24           23.015      5.0.0     007r2    Rel-6       6.0.0         ODB handling for existing PDP contexts
  CT\#35           23.015      6.0.0     0008r1   Rel-7       7.0.0         Realization of Operator Determined Barring
  CT\#40           23.015      7.0.0     0009r1   Rel-8       8.0.0         ODB for 3GPP access in EPS
  CT\#42           23.015      8.0.0              Rel-8       8.0.1         Copyright Notification updated
  CT\#42           23.015      8.0.1     0011r1   Rel-8       8.1.0         Operator Determined Barring for EPS
  CT\#46           \-          8.1.0     \-       Rel-9       9.0.0         Update to Rel-9 version (MCC)
  CT\#50           23.015      9.0.0     0012r2   Rel-10      10.0.0        LIPA for ODB case
  CT\#57           23.015      10.0.0             Rel-11      11.0.0        Update to Rel-11 version (MCC)
  CT\#58           23.015      11.0.0    0014r3   Rel-11      11.1.0        Addition of APN to the condition of the ODB judgment
  CT\#59           23.015      11.1.0    0015r1   Rel-11      11.2.0        Updating Default APN by HSS when Barring of access to all except some specific APNs applied
  CT\#59           23.015      11.1.0    0016r1   Rel-11      11.2.0        Barring of Access to All Except Some Specific APNs
  CT\#59           23.015      11.1.0    0017     Rel-11      11.2.0        ODB Not Applied to Emergency Bearer Services
  CT\#60           23.015      11.2.0    0018r1   Rel-11      11.3.0        SMS in MME
  2014-09          \-          11.3.0    \-       Rel-12      12.0.0        Update to Rel-12 version (MCC)
  CT\#68           23.015      12.0.0    0019r1   Rel-12      12.1.0        Correction to the I-WLAN reference
  2015-12          23.015      12.0.0    \-       Rel-13      13.0.0        Update to Rel-13 version (MCC)
  2017-03          23.015      13.0.0    \-       Rel-14      14.0.0        Update to Rel-14 version (MCC)
  2018-06          23.015      14.0.0    \-       Rel-15      15.0.0        Update to Rel-15 version (MCC)
  ---------------- ----------- --------- -------- ----------- ------------- ---------------------------------------------------------------------------------------------

  -------------------- ------------- ----------- -------- --------- --------- ------------------------------------------- -----------------
  **Change history**                                                                                                      
  **Date**             **Meeting**   **TDoc**    **CR**   **Rev**   **Cat**   **Subject/Comment**                         **New version**
  2018-12              CT\#82        CP-183092   0020r3   3         F         Introduction of Barring of Roaming in 5GC   15.1.0
  2020-03              CT\#87e       CP-200045   0021     1         F         Invocation of ODB                           16.0.0
  2021-03              CT\#91e       CP-210053   0022     1         F         ODB handling in SMF                         16.1.0
  -------------------- ------------- ----------- -------- --------- --------- ------------------------------------------- -----------------
